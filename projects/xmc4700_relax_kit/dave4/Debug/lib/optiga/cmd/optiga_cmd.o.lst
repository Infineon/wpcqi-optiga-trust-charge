   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,4
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "optiga_cmd.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.optiga_cmd_prepare_tag_header,"ax",%progbits
  20              	 .align 1
  21              	 .thumb
  22              	 .thumb_func
  24              	optiga_cmd_prepare_tag_header:
  25              	.LFB2:
  26              	 .file 1 "C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd/optiga_cmd.c"
   1:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /**
   2:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * \copyright
   3:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * MIT License
   4:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
   5:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Copyright (c) 2020 Infineon Technologies AG
   6:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
   7:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Permission is hereby granted, free of charge, to any person obtaining a copy
   8:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * of this software and associated documentation files (the "Software"), to deal
   9:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * in the Software without restriction, including without limitation the rights
  10:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  11:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * copies of the Software, and to permit persons to whom the Software is
  12:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * furnished to do so, subject to the following conditions:
  13:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
  14:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * The above copyright notice and this permission notice shall be included in all
  15:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * copies or substantial portions of the Software.
  16:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
  17:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  18:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  19:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  20:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  21:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  22:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  23:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * SOFTWARE
  24:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
  25:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * \endcopyright
  26:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
  27:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * \author Infineon Technologies AG
  28:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
  29:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * \file optiga_cmd.c
  30:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
  31:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * \brief   This file implements cmd modules which covers OPTIGA command formation, locking mechanis
  32:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *          acquisition and asynchronous data handling
  33:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
  34:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * \ingroup  grOptigaCmd
  35:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *
  36:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * @{
  37:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
  38:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  39:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  40:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/cmd/optiga_cmd.h"
  41:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/common/optiga_lib_common_internal.h"
  42:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/common/optiga_lib_logger.h"
  43:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/comms/optiga_comms.h"
  44:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_os_event.h"
  45:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_os_lock.h"
  46:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_os_timer.h"
  47:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_os_memory.h"
  48:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_ifx_i2c_config.h"
  49:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  50:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for clearing last error code
  51:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_CLEAR_LAST_ERROR                      (0x80)
  52:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for OpenApplication command
  53:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OPEN_APPLICATION                      (0x70 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  54:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for CloseApplication command
  55:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_CLOSE_APPLICATION                     (0x71 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  56:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for GetDataObject command
  57:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_DATA_OBJECT                       (0x01 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  58:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for SetDataObject command
  59:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SET_DATA_OBJECT                       (0x02 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  60:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for GetRandom command
  61:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_RANDOM                            (0x0C | OPTIGA_CMD_CLEAR_LAST_ERROR)
  62:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for CalcHash command
  63:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_CALC_HASH                             (0x30 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  64:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for CalcSign command
  65:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_CALC_SIGN                             (0x31 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  66:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for VerifySign command
  67:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN                           (0x32 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  68:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for GenKeyPair command
  69:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEYPAIR                           (0x38 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  70:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //cmd byte for SetObjectProtected command
  71:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SET_OBJECT_PROTECTED                  (0x03 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  72:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  73:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  74:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_MAX_NUMBER_OF_SESSIONS                (0x04)
  75:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_START_SESSION_OID                     (0xE100)
  76:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  77:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Considering the size w.r.t maximum APDU size + shielded connection if enabled.
  78:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_TOTAL_COMMS_BUFFER_SIZE               (OPTIGA_MAX_COMMS_BUFFER_SIZE + OPTIGA_COM
  79:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  80:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_APDU_HEADER_SIZE                      (0x04)
  81:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  82:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LAST_ERROR_CODE                       (0xF1C2)
  83:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  84:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_APDU_INDATA_OFFSET                    (OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_COMM
  85:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Hash header size(hash_input_header_size + context_header_size)
  86:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_HASH_HEADER_SIZE                      (0x06)
  87:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Intermediate context header size
  88:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_INTERMEDIATE_CONTEXT_HEADER           (0x03)
  89:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Zero length or value
  90:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ZERO_LENGTH_OR_VALUE                  (0x0000)
  91:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // One length or value
  92:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ONE_LENGTH_OR_VALUE                   (0x0001)
  93:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // OID data length
  94:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OID_DATA_LENGTH                       (0x0006)
  95:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Number of bits in a byte
  96:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_NO_OF_BITS_IN_BYTE                    (0x0008)
  97:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
  98:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //Number of bytes in tag
  99:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_NO_OF_BYTES_IN_TAG                    (0x01)
 100:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 101:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //Number of bytes in OFFSET
 102:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_UINT16_SIZE_IN_BYTES                  (0x02)
 103:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 104:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_APDU_SUCCESS                          (0x00)
 105:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_APDU_FAILURE                          (0xFF)
 106:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 107:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_WRITE_ONLY                                   (0x00)
 108:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_READ_DATA                                    (0x00)
 109:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_DATA_OBJECT_NO_ERROR_CLEAR               (0x01)
 110:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 111:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //Calc sign tag values
 112:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SIGN_DIGEST_TAG                              (0x01)
 113:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SIGN_OID_TAG                                 (0x03)
 114:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SIGN_OID_LEN                                 (0x0002)
 115:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 116:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //Verify sign tag values
 117:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN_DIGEST_TAG                       (0x01)
 118:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN_SIGNATURE_TAG                    (0x02)
 119:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_TAG             (0x04)
 120:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_LENGTH          (0x0002)
 121:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_ALGO_ID_TAG                           (0x05)
 122:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_ALGO_ID_LENGTH                        (0x0001)
 123:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_PUBLIC_KEY_TAG                        (0x06)
 124:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 125:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //Generate key pair tag and length value
 126:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_TAG             (0x01)
 127:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_LENGTH          (0x0002)
 128:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_TAG                   (0x02)
 129:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_LENGTH                (0x0001)
 130:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_TAG                  (0x07)
 131:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_LENGTH               (0x0000)
 132:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_PUBLIC_KEY_TAG                  (0x02)
 133:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_TAG                 (0x01)
 134:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 135:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_PROTECTION_LEVEL_MASK                            (0x03)
 136:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         
 137:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ERROR_CODE_PREPARE                           (0x01)
 138:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ERROR_CODE_TX                                (0x02)
 139:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ERROR_CODE_RX                                (0x03)
 140:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ERROR_CODE_STATE_MASK                        (0x03)
 141:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ENTER_HANDLER_CALL_MASK                      (0x80)
 142:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ENTER_HANDLER_CALL                           (0x80)
 143:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_EXIT_HANDLER_CALL                            (0x00)
 144:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OUT_OF_BOUNDARY_ERROR                        (0x08)
 145:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 146:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /// Set object protected tag
 147:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SET_OBJECT_PROTECTED_TAG                     (0x30)
 148:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 149:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_TAG_LENGTH_SIZE                              (0x03)
 150:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT                 (0x00)
 151:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 152:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Function to set given bits
 153:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define SET_DEV_ERROR_HANDLER_STATE(state){\
 154:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                    (me->device_error_status) &= ~OPTIGA_CMD_ERROR_CODE_STATE_MASK;\
 155:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                    (me->device_error_status) |= state & OPTIGA_CMD_ERROR_CODE_STATE
 156:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 157:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define SET_DEV_ERROR_NOTIFICATION(bits_value){\
 158:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   (me->device_error_status) &= ~OPTIGA_CMD_ENTER_HANDLER_CALL_MASK;
 159:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   (me->device_error_status) |= bits_value & OPTIGA_CMD_ENTER_HANDLE
 160:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 161:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 162:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define EXIT_STATE_WITH_ERROR(ctx, exit_machine){\
 163:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   ctx->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;\
 164:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   ctx->exit_status = OPTIGA_CMD_ERROR;\
 165:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   exit_machine = FALSE;}
 166:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 167:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #if defined (OPTIGA_LIB_ENABLE_LOGGING) && defined (OPTIGA_LIB_ENABLE_CMD_LOGGING)
 168:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 169:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Logs the message provided from Command layer
 170:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_MESSAGE(msg) \
 171:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {\
 172:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_print_message(msg,OPTIGA_COMMAND_LAYER,OPTIGA_COMMAND_LAYER_COLOR);\
 173:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 174:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 175:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Logs the byte array buffer provided from Command layer in hexadecimal format
 176:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //lint --e{750} suppress "The unused OPTIGA_CMD_LOG_HEX_DATA macro is kept for future enhancements"
 177:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_HEX_DATA(array,array_len) \
 178:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {\
 179:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_print_array_hex_format(array,array_len,OPTIGA_UNPROTECTED_DATA_COLOR);\
 180:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 181:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 182:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Logs the status info provided from Command layer
 183:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //lint --e{750} suppress "The unused OPTIGA_CMD_LOG_STATUS macro is kept for future enhancements"
 184:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_STATUS(return_value) \
 185:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** { \
 186:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if (OPTIGA_LIB_SUCCESS != return_value) \
 187:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     { \
 188:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_lib_print_status(OPTIGA_COMMAND_LAYER,OPTIGA_ERROR_COLOR,return_value); \
 189:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } \
 190:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     else\
 191:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     { \
 192:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_lib_print_status(OPTIGA_COMMAND_LAYER,OPTIGA_COMMAND_LAYER_COLOR,return_value); \
 193:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } \
 194:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 195:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #else
 196:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 197:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_MESSAGE(msg) {}
 198:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //lint --e{750} suppress "The unused OPTIGA_CMD_LOG_HEX_DATA macro is kept for future enhancements"
 199:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_HEX_DATA(array, array_len) {}
 200:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //lint --e{750} suppress "The unused OPTIGA_CMD_LOG_STATUS macro is kept for future enhancements"
 201:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_STATUS(return_value) {}
 202:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 203:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif // (OPTIGA_LIB_ENABLE_LOGGING) && (OPTIGA_LIB_ENABLE_CMD_LOGGING)
 204:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 205:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Set data for apdu_data
 206:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SET_APDU_DATA(apdu_cmd, apdu_info) ((apdu_info << OPTIGA_CMD_NO_OF_BITS_IN_BYTE)
 207:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 208:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Get APDU cmd value from apdu_data
 209:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_APDU_CMD(apdu_data)  ((uint8_t)apdu_data)
 210:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 211:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Get APDU info value from apdu_data
 212:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_APDU_INFO(apdu_data) ((uint8_t)(apdu_data >> OPTIGA_CMD_NO_OF_BITS_IN_BYTE))
 213:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 214:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Scheduler definitions
 215:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 216:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Optiga execution slot states
 217:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_NOT_ASSIGNED           (0x00)
 218:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_ASSIGNED               (0x01)
 219:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_REQUEST                (0x02)
 220:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_PROCESSING             (0x04)
 221:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_RESUME                 (0x08)
 222:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 223:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Optiga session state
 224:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_SESSION_NOT_ASSIGNED         (0x00)
 225:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_SESSION_ASSIGNED             (0x10)
 226:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //Session not assigned to optiga cmd instance
 227:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_NO_SESSION_OID               (0x0000)
 228:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_ALL_SESSION_ASSIGNED         (0x10101010)
 229:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 230:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Optiga slot request types
 231:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_REQUEST_LOCK           (0x21)
 232:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK    (0x23)
 233:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_REQUEST_SESSION        (0x22)
 234:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_NO_REQUEST             (0x00)
 235:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 236:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Type of slot, Do not change the values
 237:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_SLOT_STATE             (0x09)
 238:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Type of lock, Do not change the values
 239:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE         (0x08)
 240:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Frequency of scheduler polling when no asynchronous requests are pending
 241:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS     (1000U)
 242:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Frequency of scheduler polling when asynchronous requests is being processed
 243:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_SCHEDULER_RUNNING_TIME_MS    (50U)
 244:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 245:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /** \brief The enum represents diffrent main state of command handler */
 246:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** typedef enum optiga_cmd_state
 247:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 248:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_OPEN = 0,
 249:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_CLOSE,
 250:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_PREPARE_COMMAND,
 251:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_PROCESS_RESPONSE,
 252:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_ERROR_HANDLER
 253:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** } optiga_cmd_state_t;
 254:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 255:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /** \brief The enum represents diffrent sub state of command handler */
 256:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** typedef enum optiga_cmd_sub_state
 257:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 258:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_OPEN_ACQUIRE_LOCK = 0,
 259:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_OPEN_START,
 260:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_OPEN_DONE,
 261:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 262:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_CLOSE_START,
 263:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE,
 264:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 265:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_REQUEST_SESSION,
 266:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_REQUEST_LOCK,
 267:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_REQUEST_STRICT_LOCK,
 268:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_PREPARE_APDU,
 269:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 270:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE,
 271:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_GET_DEVICE_ERROR,
 272:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_RELEASE_LOCK,
 273:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_STATE_EXIT
 274:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 275:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** } optiga_cmd_sub_state_t;
 276:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 277:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** typedef optiga_lib_status_t (*optiga_cmd_handler_t)(optiga_cmd_t * me);
 278:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 279:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /** \brief The structure represents the slot in the execution queue */
 280:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** typedef struct optiga_cmd_queue_slot
 281:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 282:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Registered context
 283:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     void * registered_ctx;
 284:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Arrival time of the optiga cmd instance in the execution queue
 285:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint32_t arrival_time;
 286:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Request for command lock or session
 287:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t request_type;
 288:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// state of the slot
 289:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t state_of_entry;
 290:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }optiga_cmd_queue_slot_t;
 291:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 292:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 293:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /**
 294:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * \brief OPTIGA Context which holds the communication buffer, comms instance and other required.
 295:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *   This would be maintained and consumed by OPTIGA Cmd.
 296:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 297:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** struct optiga_context
 298:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 299:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Context of OPTIGA Communication.
 300:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_comms_t * p_optiga_comms;
 301:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// comms tx size
 302:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t comms_tx_size;
 303:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// comms rx size
 304:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t comms_rx_size;
 305:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Structure which maintains the session and contexts of requesters to acquire session.
 306:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t sessions[OPTIGA_CMD_MAX_NUMBER_OF_SESSIONS];
 307:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Indicates if instance is initialized
 308:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t instance_init_state;
 309:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Communication buffer to send/receive APDUs.
 310:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t optiga_comms_buffer[OPTIGA_CMD_TOTAL_COMMS_BUFFER_SIZE];
 311:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// optiga execution queue
 312:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_slot_t optiga_cmd_execution_queue[OPTIGA_CMD_MAX_REGISTRATIONS];
 313:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// pal os event instance/context
 314:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     pal_os_event_t * p_pal_os_event_ctx;
 315:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Last processed cmd time stamp
 316:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint32_t last_time_stamp;
 317:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// optiga context handle buffer
 318:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t optiga_context_handle_buffer[APP_CONTEXT_SIZE];
 319:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 320:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Protection level status flag
 321:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t protection_level_state;
 322:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 323:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** };
 324:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 325:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // static instance of optiga
 326:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_context_t g_optiga = {0};
 327:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 328:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // List of optiga instances
 329:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //lint --e{843} suppress "Not changing to const as this gets assigned to another context variable w
 330:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_context_t * g_optiga_list[] = {&g_optiga};
 331:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 332:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // hibernate data store for each instance of optiga
 333:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //lint --e{843} suppress "Not changing to const as this is used for unit testing as well"
 334:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H uint16_t g_hibernate_datastore_id_list[] = {OPTIGA_HIBERNATE_CONTEXT_ID};
 335:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 336:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** const uint8_t g_optiga_unique_application_identifier[] =
 337:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 338:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     0xD2, 0x76, 0x00, 0x00, 0x04, 0x47, 0x65, 0x6E, 0x41, 0x75, 0x74, 0x68, 0x41, 0x70, 0x70, 0x6C,
 339:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** };
 340:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 341:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /**
 342:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * \brief Command context
 343:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 344:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** struct optiga_cmd
 345:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 346:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Pointer to OPTIGA context which holds the communication buffer, comms instance and other re
 347:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_context_t * p_optiga;
 348:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Internal handlers for prepare and process
 349:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_handler_t cmd_hdlrs;
 350:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Command execution input parameters
 351:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     void * p_input;
 352:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 353:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Caller context
 354:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     void* caller_context;
 355:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Callback handler
 356:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     callback_handler_t handler;
 357:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Holds a Session OID allotted to this instance.
 358:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t session_oid;
 359:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// State of the command next execution state
 360:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_state_t cmd_next_execution_state;
 361:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// State of the command next execution state
 362:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t cmd_sub_execution_state;
 363:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Chaining flag
 364:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t chaining_ongoing;
 365:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Param value for the respective command to be processed
 366:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t cmd_param;
 367:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 368:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// To provide the encryption and decryption need for command and response
 369:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t protection_level;
 370:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// To provide the presentation layer protocol version to be used
 371:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t protocol_version;
 372:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// To provide the manage context options
 373:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t manage_context_operation;
 374:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 375:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// To provide error state
 376:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t device_error_status;
 377:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Assigned slot from execution queue
 378:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t queue_id;
 379:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Exit status value
 380:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t exit_status;
 381:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// Datastore ID for optiga context
 382:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t optiga_context_datastore_id;
 383:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /// To Store APDU command information which is last processed
 384:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t apdu_data;
 385:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** };
 386:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 387:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_get_error_code_handler(optiga_cmd_t * me);
 388:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 389:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 390:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //lint --e{714} suppress "This function is defined here but referred from other modules"
 391:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** void optiga_cmd_set_shielded_connection_option(optiga_cmd_t * me,
 392:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                uint8_t value,
 393:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                uint8_t shielded_connection_option)
 394:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 395:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch (shielded_connection_option)
 396:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 397:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Protection Level
 398:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_SET_PROTECTION_LEVEL:
 399:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 400:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->protection_level = value;
 401:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 402:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 403:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Protocol Version
 404:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_SET_PROTECTION_VERSION:
 405:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 406:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->protocol_version = value;
 407:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 408:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 409:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Manage Context
 410:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_SET_MANAGE_CONTEXT:
 411:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 412:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->manage_context_operation = value;
 413:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 414:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 415:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
 416:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 417:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 418:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 419:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 420:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif // OPTIGA_COMMS_SHIELDED_CONNECTION
 421:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 422:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Cmd execute handler
 423:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute(optiga_cmd_t * me,
 424:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   uint8_t cmd_param,
 425:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_handler_t cmd_hdlrs,
 426:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_state_t start_state,
 427:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_sub_state_t sub_state,
 428:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   void * input,
 429:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   uint16_t apdu_data);
 430:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 431:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** // Cmd State machine handler
 432:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_handler(void * p_ctx,
 433:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           optiga_lib_status_t event);
 434:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 435:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** //
 436:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_prepare_apdu_header(uint8_t cmd, uint8_t param,
 437:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               uint16_t in_data_length,
 438:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               uint8_t * p_apdu_buffer)
 439:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [0] = cmd;
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 444:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 445:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 446:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 447:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_prepare_tag_header(uint8_t tag,
 448:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                              uint16_t tag_length,
 449:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                              uint8_t * buffer,
 450:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                              uint16_t * position)
 451:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
  27              	 .loc 1 451 0
  28              	 .cfi_startproc
  29              	 
  30              	 
  31              	.LVL0:
  32 0000 30B5     	 push {r4,r5,lr}
  33              	.LCFI0:
  34              	 .cfi_def_cfa_offset 12
  35              	 .cfi_offset 4,-12
  36              	 .cfi_offset 5,-8
  37              	 .cfi_offset 14,-4
 452:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t start_position = *position;
  38              	 .loc 1 452 0
  39 0002 1C88     	 ldrh r4,[r3]
  40              	.LVL1:
 453:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 454:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     buffer[start_position++] = tag;
  41              	 .loc 1 454 0
  42 0004 1055     	 strb r0,[r2,r4]
  43              	.LVL2:
  44 0006 601C     	 adds r0,r4,#1
  45              	.LVL3:
 455:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     buffer[start_position++] = (uint8_t )(tag_length >> 8);
  46              	 .loc 1 455 0
  47 0008 80B2     	 uxth r0,r0
  48 000a 0D0A     	 lsrs r5,r1,#8
  49 000c 1554     	 strb r5,[r2,r0]
  50              	.LVL4:
  51 000e A01C     	 adds r0,r4,#2
 456:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     buffer[start_position++] = (uint8_t )(tag_length);
  52              	 .loc 1 456 0
  53 0010 80B2     	 uxth r0,r0
  54 0012 0334     	 adds r4,r4,#3
  55              	.LVL5:
  56 0014 1154     	 strb r1,[r2,r0]
 457:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 458:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     *position = start_position;
  57              	 .loc 1 458 0
  58 0016 1C80     	 strh r4,[r3]
  59 0018 30BD     	 pop {r4,r5,pc}
  60              	 .cfi_endproc
  61              	.LFE2:
  63              	 .section .text.optiga_cmd_queue_update_slot,"ax",%progbits
  64              	 .align 1
  65              	 .thumb
  66              	 .thumb_func
  68              	optiga_cmd_queue_update_slot:
  69              	.LFB13:
 459:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 460:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 461:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 462:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_event_trigger_execute(void * p_ctx)
 463:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 464:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(p_ctx, OPTIGA_LIB_SUCCESS);
 465:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 466:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 467:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute(optiga_cmd_t * me,
 468:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   uint8_t cmd_param,
 469:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_handler_t cmd_hdlrs,
 470:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_state_t start_state,
 471:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_sub_state_t sub_state,
 472:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   void * input,
 473:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   uint16_t apdu_data)
 474:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_input = input;
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 483:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 484:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 485:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 486:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Checks if optiga session is available or not
 487:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Returns TRUE, if slot is available
 488:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Returns FALSE, if slot is not available
 489:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 490:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H bool_t optiga_cmd_session_available(const optiga_context_t * p_optiga)
 491:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 492:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint32_t status_check;
 493:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // Consider the array as uin32_t value and check against 0x10101010
 494:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // where 0x10 is value of OPTIGA_CMD_SESSION_ASSIGNED
 495:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     status_check = optiga_common_get_uint32(p_optiga->sessions);
 496:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return ((status_check < OPTIGA_CMD_ALL_SESSION_ASSIGNED)? (TRUE):(FALSE));
 497:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 498:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 499:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 500:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * 1. If a optiga cmd instance does not have session, assigns an available session
 501:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 502:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_session_assign(optiga_cmd_t * me)
 503:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 504:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t * p_optiga_sessions = me->p_optiga->sessions;
 505:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t count;
 506:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if (OPTIGA_CMD_NO_SESSION_OID == me->session_oid)
 507:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 508:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         for (count = 0; count < OPTIGA_CMD_MAX_NUMBER_OF_SESSIONS; count++)
 509:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 510:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_SESSION_ASSIGNED != p_optiga_sessions[count])
 511:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 512:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->session_oid = (OPTIGA_CMD_START_SESSION_OID | count);
 513:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_sessions[count] = OPTIGA_CMD_SESSION_ASSIGNED;
 514:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 515:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 516:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 517:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 518:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 519:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 520:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 521:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Frees a session
 522:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 523:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_session_free(optiga_cmd_t * me)
 524:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 525:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t * p_optiga_sessions = me->p_optiga->sessions;
 526:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t count;
 527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if (OPTIGA_CMD_NO_SESSION_OID != me->session_oid)
 528:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 529:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         count = me->session_oid & 0x0F;
 530:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->session_oid = OPTIGA_CMD_NO_SESSION_OID;
 531:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         p_optiga_sessions[count] = OPTIGA_CMD_SESSION_NOT_ASSIGNED;
 532:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 533:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 534:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 535:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 536:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *  Returns the requested info in the queue slot input cmd instance
 537:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 538:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H  uint8_t optiga_cmd_queue_get_state_of(const optiga_cmd_t * me, uint8_t slot_member)
 539:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 540:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t state = 0;
 541:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch (slot_member)
 542:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 543:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE:
 544:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 545:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             state = me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type;
 546:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 547:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 548:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_QUEUE_SLOT_STATE:
 549:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 550:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             state = me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry;
 551:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 552:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 553:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
 554:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
 555:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 556:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (state);
 557:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 558:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 559:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 560:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Returns the count of number of slots with requested state
 561:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 562:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H  uint8_t optiga_cmd_queue_get_count_of(const optiga_context_t * p_optiga,
 563:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                  uint8_t slot_member,
 564:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                  uint8_t state_to_check)
 565:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 566:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t index;
 567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t count = 0;
 568:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t slot_value = 0;
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     for (index = 0; index < OPTIGA_CMD_MAX_REGISTRATIONS ; index++)
 570:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 571:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         switch (slot_member)
 572:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 573:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE:
 574:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 575:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 slot_value = p_optiga->optiga_cmd_execution_queue[index].request_type;
 576:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 577:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
 578:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_QUEUE_SLOT_STATE:
 579:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 580:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 slot_value = p_optiga->optiga_cmd_execution_queue[index].state_of_entry;
 581:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 582:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
 583:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             default:
 584:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 585:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (state_to_check == slot_value)
 587:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             count++;
 589:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 590:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 591:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (count);
 592:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 593:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 594:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 595:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Assigns an available slot to a optiga cmd instance and marks the slot as not available for anothe
 596:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 597:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_assign_slot(const optiga_cmd_t * me, uint8_t * queue_index_store)
 598:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 599:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t index;
 600:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     for (index = 0; index < OPTIGA_CMD_MAX_REGISTRATIONS ; index++)
 601:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 602:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_CMD_QUEUE_NOT_ASSIGNED == me->p_optiga->optiga_cmd_execution_queue[index].state_
 603:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 604:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             * queue_index_store =  index;
 605:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->optiga_cmd_execution_queue[index].state_of_entry = OPTIGA_CMD_QUEUE_ASSIG
 606:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****            break;
 607:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 608:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 609:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 610:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 611:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 612:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * De-assigns a slot from a optiga cmd instance and makes the slot available for next optiga cmd ins
 613:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 614:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_deassign_slot(optiga_cmd_t * me)
 615:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 616:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry = OPTIGA_CMD_QUEUE_NOT_AS
 617:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type = OPTIGA_CMD_QUEUE_NO_REQUE
 618:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->queue_id = 0;
 619:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 620:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 621:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 622:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Select next optiga cmd instance from the execution queue based on a rule
 623:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * 1. A slot with OPTIGA_CMD_QUEUE_RESUME state should exist
 624:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * 2. Pick the slot which has acquired the strict slot
 625:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * 3. If no slot with OPTIGA_CMD_QUEUE_RESUME exists, slot must be in OPTIGA_CMD_QUEUE_REQUEST state
 626:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * 4. The arrival time must be the earliest provided
 627:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *     a. The request type is lock
 628:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** *     b. If request type is session, either session is already assigned or atleast session is avail
 629:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 630:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_scheduler(void * p_optiga)
 631:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 632:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint32_t reference_time_stamp = 0xFFFFFFFF;
 633:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_slot_t * p_queue_entry;
 634:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t index;
 635:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t prefered_index = 0xFF;
 636:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t overflow_detected = FALSE;
 637:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 638:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_context_t * p_optiga_ctx = (optiga_context_t * )p_optiga;
 639:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 640:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     pal_os_event_t * my_os_event = p_optiga_ctx->p_pal_os_event_ctx;
 641:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 642:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 643:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if (((0 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE, OPTIGA_CMD_
 644:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****          (0 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE, OPTIGA_CMD_
 645:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****          ((1 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE , OPTIGA_CM
 646:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****          (0 < optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE, OPTIGA_C
 647:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 648:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // call self
 649:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         pal_os_event_register_callback_oneshot(my_os_event, optiga_cmd_queue_scheduler,
 650:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                p_optiga_ctx,OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
 651:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 652:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     else
 653:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 654:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         pal_os_event_stop(my_os_event);
 655:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // continue checking if no context selected and overflow detected
 656:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         do
 657:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 658:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //reset overflow detected flag and the last_time stamp
 659:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if(overflow_detected == TRUE)
 660:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 661:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_ctx->last_time_stamp = 0;
 662:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 overflow_detected = FALSE;
 663:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 664:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 665:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // Select optiga command based on rule
 666:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             for (index = 0; index < OPTIGA_CMD_MAX_REGISTRATIONS; index++)
 667:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 668:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_queue_entry = &(p_optiga_ctx->optiga_cmd_execution_queue[index]);
 669:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 670:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // if any slot has acquired strict lock, highest priority is given to it
 671:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (1 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE , 
 672:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 673:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     // Select the slot which has acquired strict lock
 674:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     if ((OPTIGA_CMD_QUEUE_RESUME == p_queue_entry->state_of_entry) &&
 675:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == p_queue_entry->request_type))
 676:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     {
 677:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         reference_time_stamp = p_queue_entry->arrival_time;
 678:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         prefered_index = index;
 679:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     }
 680:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 681:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 682:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
 683:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 684:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     // pick only requested queue slot and earliest arrival time
 685:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     if (p_queue_entry->state_of_entry == OPTIGA_CMD_QUEUE_REQUEST)
 686:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     {
 687:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         // remember that overflow has occurred in one of the entry
 688:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         if (p_queue_entry->arrival_time < p_optiga_ctx->last_time_stamp)
 689:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         {
 690:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             overflow_detected = TRUE;
 691:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         }
 692:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 693:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         // if lock request or session request and session available(either already 
 694:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         if (((p_queue_entry->arrival_time <= reference_time_stamp) && (p_queue_entr
 695:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             (((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && 
 696:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             ((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && (
 697:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             (OPTIGA_CMD_QUEUE_REQUEST_LOCK == p_queue_entry->request_type) ||
 698:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == p_queue_entry->request_type)))
 699:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         {
 700:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             reference_time_stamp = p_queue_entry->arrival_time;
 701:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             prefered_index = index;
 702:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         }
 703:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     }
 704:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 705:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 706:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         } while((0xFF == prefered_index) && (TRUE == overflow_detected));
 707:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 708:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Improve : check the index and max queue size check
 709:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // If slot is identified then go further
 710:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (0xFF != prefered_index)
 711:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 712:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             p_queue_entry = &(p_optiga_ctx->optiga_cmd_execution_queue[prefered_index]);
 713:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // assign session
 714:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if ((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_optiga_ctx->optiga_cmd_execution_queue[prefe
 715:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (OPTIGA_CMD_NO_SESSION_OID == ((optiga_cmd_t *)p_queue_entry->registered_ctx)->sess
 716:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 717:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_session_assign((optiga_cmd_t *)(p_optiga_ctx->optiga_cmd_execution_queue
 718:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // Improve : Change the state of the type here. This will reduce 0x0000 check
 719:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 720:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 721:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // schedule with selected context
 722:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             my_os_event = ((optiga_cmd_t *)(p_optiga_ctx->optiga_cmd_execution_queue[prefered_index
 723:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(my_os_event,
 724:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    optiga_cmd_event_trigger_execute,
 725:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    ((optiga_cmd_t *)(p_optiga_ctx->optiga_cmd_execu
 726:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    OPTIGA_CMD_SCHEDULER_RUNNING_TIME_MS);
 727:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             p_optiga_ctx->optiga_cmd_execution_queue[prefered_index].state_of_entry = OPTIGA_CMD_QU
 728:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             p_optiga_ctx->last_time_stamp = reference_time_stamp;
 729:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 730:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         else
 731:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 732:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot( my_os_event, optiga_cmd_queue_scheduler,
 733:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                     p_optiga_ctx,OPTIGA_CMD_SCHEDULER_IDLING_TIME_M
 734:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 735:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 736:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 737:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 738:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 739:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Updates a execution queue slot
 740:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 741:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_update_slot(optiga_cmd_t * me, uint8_t request_type)
 742:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
  70              	 .loc 1 742 0
  71              	 .cfi_startproc
  72              	 
  73              	 
  74              	.LVL6:
  75 0000 F8B5     	 push {r3,r4,r5,r6,r7,lr}
  76              	.LCFI1:
  77              	 .cfi_def_cfa_offset 24
  78              	 .cfi_offset 3,-24
  79              	 .cfi_offset 4,-20
  80              	 .cfi_offset 5,-16
  81              	 .cfi_offset 6,-12
  82              	 .cfi_offset 7,-8
  83              	 .cfi_offset 14,-4
 743:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != me->p_optiga->optiga_cmd_execution_queue[me->queue
  84              	 .loc 1 743 0
  85 0002 0768     	 ldr r7,[r0]
  86 0004 857F     	 ldrb r5,[r0,#30]
  87 0006 0C23     	 movs r3,#12
  88 0008 03FB0573 	 mla r3,r3,r5,r7
 742:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != me->p_optiga->optiga_cmd_execution_queue[me->queue
  89              	 .loc 1 742 0
  90 000c 0446     	 mov r4,r0
  91              	 .loc 1 743 0
  92 000e 93F83836 	 ldrb r3,[r3,#1592]
  93 0012 232B     	 cmp r3,#35
 742:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != me->p_optiga->optiga_cmd_execution_queue[me->queue
  94              	 .loc 1 742 0
  95 0014 0E46     	 mov r6,r1
  96              	 .loc 1 743 0
  97 0016 01D1     	 bne .L3
  98              	 .loc 1 743 0 is_stmt 0 discriminator 1
  99 0018 2329     	 cmp r1,#35
 100 001a 06D0     	 beq .L4
 101              	.L3:
 744:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****        ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == me->p_optiga->optiga_cmd_execution_queue[me->queue
 745:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****        (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != request_type)))
 746:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 747:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         //add time stamp
 748:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->p_optiga->optiga_cmd_execution_queue[me->queue_id].arrival_time = pal_os_timer_get_time
 102              	 .loc 1 748 0 is_stmt 1
 103 001c FFF7FEFF 	 bl pal_os_timer_get_time_in_microseconds
 104              	.LVL7:
 105 0020 0C23     	 movs r3,#12
 106 0022 03FB0575 	 mla r5,r3,r5,r7
 107 0026 C5F83406 	 str r0,[r5,#1588]
 108              	.L4:
 749:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 750:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 751:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     //add optiga_cmd ctx
 752:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].registered_ctx = (void * )me;
 109              	 .loc 1 752 0
 110 002a 2168     	 ldr r1,[r4]
 111 002c A27F     	 ldrb r2,[r4,#30]
 112 002e 0C23     	 movs r3,#12
 113 0030 03FB0212 	 mla r2,r3,r2,r1
 114 0034 C2F83046 	 str r4,[r2,#1584]
 753:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // set the state of slot to Requested state
 754:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == me->p_optiga->optiga_cmd_execution_queue[me->queue
 115              	 .loc 1 754 0
 116 0038 A27F     	 ldrb r2,[r4,#30]
 117 003a 03FB0210 	 mla r0,r3,r2,r1
 118 003e 00F5C765 	 add r5,r0,#1592
 119 0042 90F83806 	 ldrb r0,[r0,#1592]
 120 0046 2328     	 cmp r0,#35
 121 0048 04D1     	 bne .L5
 122              	 .loc 1 754 0 is_stmt 0 discriminator 1
 123 004a 232E     	 cmp r6,#35
 124 004c 02D1     	 bne .L5
 755:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == request_type))
 756:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 757:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry = OPTIGA_CMD_QUEUE_RE
 125              	 .loc 1 757 0 is_stmt 1
 126 004e 0823     	 movs r3,#8
 127 0050 6B70     	 strb r3,[r5,#1]
 128 0052 04E0     	 b .L6
 129              	.L5:
 758:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 759:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     else
 760:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 761:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry = OPTIGA_CMD_QUEUE_RE
 130              	 .loc 1 761 0
 131 0054 03FB0213 	 mla r3,r3,r2,r1
 132 0058 0222     	 movs r2,#2
 133 005a 83F83926 	 strb r2,[r3,#1593]
 134              	.L6:
 762:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 763:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     //add request type
 764:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type = request_type;
 135              	 .loc 1 764 0
 136 005e 2368     	 ldr r3,[r4]
 137 0060 A27F     	 ldrb r2,[r4,#30]
 138 0062 0C21     	 movs r1,#12
 139 0064 01FB0233 	 mla r3,r1,r2,r3
 140 0068 83F83866 	 strb r6,[r3,#1592]
 141 006c F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 142              	 .cfi_endproc
 143              	.LFE13:
 145              	 .section .text.optiga_cmd_queue_reset_slot,"ax",%progbits
 146              	 .align 1
 147              	 .thumb
 148              	 .thumb_func
 150              	optiga_cmd_queue_reset_slot:
 151              	.LFB14:
 765:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 766:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 767:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
 768:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Resets a execution slot
 769:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
 770:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_reset_slot(const optiga_cmd_t * me)
 771:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 152              	 .loc 1 771 0
 153              	 .cfi_startproc
 154              	 
 155              	 
 156              	.LVL8:
 157 0000 10B5     	 push {r4,lr}
 158              	.LCFI2:
 159              	 .cfi_def_cfa_offset 8
 160              	 .cfi_offset 4,-8
 161              	 .cfi_offset 14,-4
 772:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // Reset the arrival time
 773:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].arrival_time = 0xFFFFFFFF;
 162              	 .loc 1 773 0
 163 0002 0168     	 ldr r1,[r0]
 164 0004 827F     	 ldrb r2,[r0,#30]
 165 0006 0C23     	 movs r3,#12
 166 0008 03FB0212 	 mla r2,r3,r2,r1
 167 000c 4FF0FF34 	 mov r4,#-1
 168 0010 C2F83446 	 str r4,[r2,#1588]
 774:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     //add optiga_cmd ctx
 775:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].registered_ctx = NULL;
 169              	 .loc 1 775 0
 170 0014 827F     	 ldrb r2,[r0,#30]
 171 0016 03FB0212 	 mla r2,r3,r2,r1
 172 001a 0024     	 movs r4,#0
 173 001c C2F83046 	 str r4,[r2,#1584]
 776:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     //add request type
 777:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type = 0;
 174              	 .loc 1 777 0
 175 0020 827F     	 ldrb r2,[r0,#30]
 176 0022 03FB0212 	 mla r2,r3,r2,r1
 177 0026 82F83846 	 strb r4,[r2,#1592]
 778:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // set the slot state to assigned
 779:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry = OPTIGA_CMD_QUEUE_ASSIGN
 178              	 .loc 1 779 0
 179 002a 0168     	 ldr r1,[r0]
 180 002c 827F     	 ldrb r2,[r0,#30]
 181 002e 03FB0213 	 mla r3,r3,r2,r1
 182 0032 0122     	 movs r2,#1
 183 0034 83F83926 	 strb r2,[r3,#1593]
 780:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // start the event scheduler
 781:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     pal_os_event_start(me->p_optiga->p_pal_os_event_ctx, optiga_cmd_queue_scheduler, me->p_optiga);
 184              	 .loc 1 781 0
 185 0038 0268     	 ldr r2,[r0]
 186 003a 0349     	 ldr r1,.L12
 187 003c D2F87806 	 ldr r0,[r2,#1656]
 188              	.LVL9:
 782:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 189              	 .loc 1 782 0
 190 0040 BDE81040 	 pop {r4,lr}
 191              	.LCFI3:
 192              	 .cfi_restore 14
 193              	 .cfi_restore 4
 194              	 .cfi_def_cfa_offset 0
 781:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 195              	 .loc 1 781 0
 196 0044 FFF7FEBF 	 b pal_os_event_start
 197              	.LVL10:
 198              	.L13:
 199              	 .align 2
 200              	.L12:
 201 0048 00000000 	 .word optiga_cmd_queue_scheduler
 202              	 .cfi_endproc
 203              	.LFE14:
 205              	 .section .text.optiga_cmd_execute_handler,"ax",%progbits
 206              	 .align 1
 207              	 .thumb
 208              	 .thumb_func
 210              	optiga_cmd_execute_handler:
 211              	.LFB29:
 783:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 784:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 785:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_request_session(optiga_cmd_t * me)
 786:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 787:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_update_slot(me , OPTIGA_CMD_QUEUE_REQUEST_SESSION);
 788:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 789:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 790:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 791:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_release_session(optiga_cmd_t * me)
 792:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 793:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_session_free(me);
 794:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 795:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 796:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 797:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_request_lock(optiga_cmd_t * me, uint8_t lock_type)
 798:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 799:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_update_slot(me , lock_type);
 800:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 801:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 802:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 803:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_release_lock(const optiga_cmd_t * me)
 804:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 805:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_reset_slot(me);
 806:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 807:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 808:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 809:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_restore_context(const optiga_cmd_t * me)
 810:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 811:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OF_CONTEXT_HANDLE_4TH_BYTE         (0x04)
 812:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t context_handle_length;
 813:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 814:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
 815:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 816:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id)
 817:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 818:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             context_handle_length = sizeof(me->p_optiga->optiga_context_handle_buffer);
 819:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Reading context handle secret from datastore
 820:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = pal_os_datastore_read(me->optiga_context_datastore_id,
 821:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                   me->p_optiga->optiga_context_handle_buffer,
 822:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                   &context_handle_length);
 823:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (PAL_STATUS_SUCCESS != return_status)
 824:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 825:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 826:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 827:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 828:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Check for valid context value
 829:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (0 == optiga_common_get_uint32(me->p_optiga->optiga_context_handle_buffer) &&
 830:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             0 == optiga_common_get_uint32(&me->p_optiga->optiga_context_handle_buffer[OPTIGA_CMD_OF
 831:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 832:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_CMD_ERROR;
 833:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
 834:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 835:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 836:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         return_status = OPTIGA_LIB_SUCCESS;
 837:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
 838:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_OFFSET_OF_NEXT_BYTE
 839:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
 840:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 841:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_store_context(const optiga_cmd_t * me)
 842:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 843:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 844:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
 845:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 846:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id)
 847:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 848:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Reading context handle secret from datastore
 849:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = pal_os_datastore_write(me->optiga_context_datastore_id,
 850:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    me->p_optiga->optiga_context_handle_buffer,
 851:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    sizeof(me->p_optiga->optiga_context_handle_buffe
 852:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (PAL_STATUS_SUCCESS != return_status)
 853:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 854:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 855:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 856:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 857:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 858:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         return_status = OPTIGA_LIB_SUCCESS;
 859:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
 860:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
 861:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 862:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 863:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 864:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_clear_app_ctx(void * p_ctx)
 865:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 866:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_t * me = (optiga_cmd_t *)p_ctx;
 867:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     /*In the case of hibernate if any low level error occurs while performing
 868:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****       close application this section clears the saved application context.*/
 869:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT != me->cmd_param) &&
 870:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         (OPTIGA_COMMS_SESSION_CONTEXT_SAVE == me->manage_context_operation))
 871:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 872:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         pal_os_memset(me->p_optiga->optiga_context_handle_buffer,0,
 873:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         sizeof(me->p_optiga->optiga_context_handle_buffer));
 874:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if ((OPTIGA_HIBERNATE_CONTEXT_ID == me->optiga_context_datastore_id) &&
 875:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id))
 876:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 877:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Clearing context handle secret from datastore
 878:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->exit_status = pal_os_datastore_write(me->optiga_context_datastore_id,
 879:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                      me->p_optiga->optiga_context_handle_buffer,
 880:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                      sizeof(me->p_optiga->optiga_context_handle_buf
 881:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (PAL_STATUS_SUCCESS != me->exit_status)
 882:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 883:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
 884:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 885:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 886:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 887:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 888:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif
 889:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 890:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_comms_open(optiga_cmd_t * me, uint8_t * exit_loop)
 891:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 892:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
 893:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 894:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 895:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_sub_execution_state)
 896:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 897:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_OPEN_ACQUIRE_LOCK:
 898:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 899:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 900:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // add to queue and exit
 901:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_cmd_request_lock(me, OPTIGA_CMD_QUEUE_REQUEST_LOCK);
 902:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 903:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 904:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 905:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
 906:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 907:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_OPEN_START;
 908:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 909:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 910:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_OPEN_START:
 911:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 912:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 913:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protection_level =  me->protection_level;
 914:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 915:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->manage_context_operation = me->manage_context_operati
 916:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->p_pal_os_event_ctx = me->p_optiga->p_pal_os_event_ctx
 917:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 918:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 919:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (void)optiga_comms_set_callback_context(me->p_optiga->p_optiga_comms, me);
 920:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_open(me->p_optiga->p_optiga_comms);
 921:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 922:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 923:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 924:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 925:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
 926:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 927:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_OPEN_DONE;
 928:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 929:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 930:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_OPEN_DONE:
 931:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 932:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 933:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        (register_callback)optiga_cmd_event_trigger_
 934:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        me, OPTIGA_CMD_SCHEDULER_RUNNING_TIME_MS);
 935:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PREPARE_COMMAND;
 936:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
 937:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 938:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 939:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             default:
 940:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 EXIT_STATE_WITH_ERROR(me,*exit_loop);
 941:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
 942:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
 943:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 944:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 945:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while ((FALSE == *exit_loop) && (OPTIGA_CMD_EXEC_COMMS_OPEN == me->cmd_next_execution_state))
 946:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 947:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 948:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_comms_close(optiga_cmd_t * me, uint8_t * exit_loop)
 949:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 950:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
 951:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 952:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 953:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_sub_execution_state)
 954:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 955:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_CLOSE_START:
 956:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 957:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 958:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // In case PRL is enabled and save context is not invoked or is PRL is not enabled,
 959:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //change state to OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE, since it synchronous in nature
 960:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_COMMS_SESSION_CONTEXT_SAVE != me->manage_context_operation)
 961:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 962:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE;
 963:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 964:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protection_level =  me->protection_level;
 965:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 966:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (0 != me->p_optiga->protection_level_state)
 967:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 968:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->p_optiga->p_optiga_comms->manage_context_operation = me->manage_context_ope
 969:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 970:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
 971:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 972:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->p_optiga->p_optiga_comms->manage_context_operation = OPTIGA_COMMS_SESSION_C
 973:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 974:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->protection_level_state = 0;
 975:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 976:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE;
 977:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 978:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->p_pal_os_event_ctx = me->p_optiga->p_pal_os_event_ctx
 979:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 980:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (void)optiga_comms_set_callback_context(me->p_optiga->p_optiga_comms, me);
 981:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_close(me->p_optiga->p_optiga_comms);
 982:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 983:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 984:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 985:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 986:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
 987:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 988:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 989:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 990:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // In case PRL is enabled and save context is requested,
 991:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //change state to OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE, since it asynchronous in nature
 992:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_COMMS_SESSION_CONTEXT_SAVE == me->manage_context_operation)
 993:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 994:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE;
 995:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *exit_loop = TRUE;
 996:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 997:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // For synchronous behavior: After exit from optiga_comms_close, release lock
 998:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
 999:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1000:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->exit_status = optiga_cmd_release_lock(me);
1001:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1002:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #else
1003:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_cmd_release_lock(me);
1004:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1005:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1006:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1007:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE:
1008:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1009:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->handler(me->caller_context, OPTIGA_LIB_SUCCESS);
1010:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1011:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // For asynchronous behavior, change state to release the lock
1012:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_COMMS_SESSION_CONTEXT_SAVE == me->manage_context_operation)
1013:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1014:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->exit_status = optiga_cmd_release_lock(me);
1015:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1016:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1017:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1018:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1019:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             default:
1020:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 EXIT_STATE_WITH_ERROR(me,*exit_loop);
1021:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1022:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
1023:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1024:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while ((FALSE == *exit_loop) && (OPTIGA_CMD_EXEC_COMMS_CLOSE == me->cmd_next_execution_state)
1025:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1026:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1027:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_prepare_command(optiga_cmd_t * me, uint8_t * exit_loop)
1028:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1029:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_handler_t optiga_cmd_handler = me->cmd_hdlrs;
1030:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
1031:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1032:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_sub_execution_state)
1033:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1034:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_REQUEST_LOCK:
1035:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_REQUEST_SESSION:
1036:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1037:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
1038:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (me->cmd_sub_execution_state == OPTIGA_CMD_EXEC_REQUEST_SESSION)
1039:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1040:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->exit_status = optiga_cmd_request_session(me);
1041:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1042:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
1043:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1044:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->exit_status = optiga_cmd_request_lock(me, OPTIGA_CMD_QUEUE_REQUEST_LOCK);
1045:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1046:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
1047:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1048:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
1049:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
1050:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1051:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1052:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
1053:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1054:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1055:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_REQUEST_STRICT_LOCK:
1056:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1057:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_cmd_request_lock(me, OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK)
1058:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
1059:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1060:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
1061:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
1062:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1063:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
1064:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
1065:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1066:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1067:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_PREPARE_APDU:
1068:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1069:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
1070:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_cmd_handler(me);
1071:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
1072:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1073:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
1074:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *exit_loop = FALSE;
1075:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
1076:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1077:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->comms_rx_size = OPTIGA_CMD_TOTAL_COMMS_BUFFER_SIZE;
1078:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1079:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protection_level = me->protection_level;
1080:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
1081:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->protection_level_state |= me->protection_level;
1082:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1083:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (void)optiga_comms_set_callback_context(me->p_optiga->p_optiga_comms, me);
1084:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_transceive(me->p_optiga->p_optiga_comms,
1085:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->optiga_comms_buffer,
1086:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->comms_tx_size,
1087:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->optiga_comms_buffer,
1088:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                           &(me->p_optiga->comms_rx_size));
1089:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1090:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
1091:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1092:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
1093:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
1094:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1095:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1096:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PROCESS_RESPONSE;
1097:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE;
1098:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_ENTER_HANDLER_CALL);
1099:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1100:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1101:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             default:
1102:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 EXIT_STATE_WITH_ERROR(me,*exit_loop);
1103:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1104:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
1105:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1106:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while ((FALSE == *exit_loop) && (OPTIGA_CMD_EXEC_PREPARE_COMMAND == me->cmd_next_execution_st
1107:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1108:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1109:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_get_device_error(optiga_cmd_t * me, uint8_t * exit_loop)
1110:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1111:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
1112:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1113:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
1114:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->exit_status = optiga_cmd_get_error_code_handler(me);
1115:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (((OPTIGA_LIB_SUCCESS != me->exit_status) && !(OPTIGA_DEVICE_ERROR & me->exit_status)) |
1116:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             ((OPTIGA_DEVICE_ERROR == me->exit_status) &&
1117:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             ((me->device_error_status & OPTIGA_CMD_ERROR_CODE_STATE_MASK) == OPTIGA_CMD_ERROR_CODE_
1118:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1119:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
1120:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             *exit_loop = FALSE;
1121:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1122:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1123:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1124:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1125:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1126:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_process_optiga_response(optiga_cmd_t * me, uint8_t * exit_loop)
1127:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1128:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_handler_t optiga_cmd_handler = me->cmd_hdlrs;
1129:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
1130:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1131:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
1132:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_CMD_ZERO_LENGTH_OR_VALUE != (me->device_error_status & OPTIGA_CMD_ENTER_HANDLER_
1133:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1134:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->exit_status = optiga_cmd_handler(me);
1135:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1136:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         else
1137:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1138:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
1139:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             *exit_loop = FALSE;
1140:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1141:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1142:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_LIB_SUCCESS == me->exit_status)
1143:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1144:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // After successful Close Application, change state to invoke optiga_comms_close
1145:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_CLOSE_APPLICATION == OPTIGA_CMD_GET_APDU_CMD(me->apdu_data))
1146:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1147:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
1148:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        (register_callback)optiga_cmd_event_trigger_
1149:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        me,
1150:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
1151:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
1152:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_next_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE;
1153:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_START;
1154:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1155:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
1156:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1157:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (FALSE == me->chaining_ongoing)
1158:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1159:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     if (OPTIGA_CMD_STATE_EXIT != me->cmd_sub_execution_state)
1160:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     {
1161:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_RELEASE_LOCK;
1162:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     }
1163:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *exit_loop = FALSE;
1164:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
1165:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1166:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // for chaining, trigger preparing of next command
1167:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
1168:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1169:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
1170:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                            (register_callback)optiga_cmd_event_trig
1171:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                            (void*)me,
1172:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                            OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
1173:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *exit_loop = TRUE;
1174:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1175:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1176:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->protection_level &= OPTIGA_PROTECTION_LEVEL_MASK;
1177:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1178:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1179:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PREPARE_COMMAND;
1180:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
1181:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1182:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1183:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1184:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         else
1185:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1186:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // After OPTIGA error is analyzed, invoke upper layer handler and release lock
1187:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT == me->exit_status)
1188:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1189:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_RELEASE_LOCK;
1190:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = FALSE;
1191:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1192:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1193:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // After OPTIGA responds with failure, invoke the next state to check which error occur
1194:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
1195:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1196:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_GET_DEVICE_ERROR;
1197:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_PREPARE);
1198:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = FALSE;
1199:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1200:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1201:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1202:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1203:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1204:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_process_response(optiga_cmd_t * me, uint8_t * exit_loop)
1205:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1206:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
1207:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1208:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_sub_execution_state)
1209:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1210:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE:
1211:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1212:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_process_optiga_response(me, exit_loop);
1213:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1214:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1215:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_GET_DEVICE_ERROR:
1216:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1217:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_get_device_error(me, exit_loop);
1218:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1219:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1220:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_RELEASE_LOCK:
1221:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1222:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{534} suppress "The return code is not checked because this is exit state
1223:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_release_lock(me);
1224:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_STATE_EXIT;
1225:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = FALSE;
1226:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1227:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1228:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_STATE_EXIT:
1229:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1230:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->handler(me->caller_context, me->exit_status);
1231:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
1232:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1233:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1234:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             default:
1235:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 EXIT_STATE_WITH_ERROR(me,*exit_loop);
1236:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1237:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
1238:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1239:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while ((FALSE == *exit_loop) && (OPTIGA_CMD_EXEC_PROCESS_RESPONSE == me->cmd_next_execution_s
1240:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1241:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1242:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_error_handler(const optiga_cmd_t * me, uint8_t * exit_loop)
1243:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1244:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
1245:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1246:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         //lint --e{534} suppress "The return code is not checked because this is exit state."
1247:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_cmd_release_lock(me);
1248:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->handler(me->caller_context, me->exit_status);
1249:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
1250:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1251:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1252:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1253:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_handler(void * p_ctx, optiga_lib_status_t event)
1254:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 212              	 .loc 1 1254 0
 213              	 .cfi_startproc
 214              	 
 215              	 
 216              	.LVL11:
 217 0000 F7B5     	 push {r0,r1,r2,r4,r5,r6,r7,lr}
 218              	.LCFI4:
 219              	 .cfi_def_cfa_offset 32
 220              	 .cfi_offset 4,-20
 221              	 .cfi_offset 5,-16
 222              	 .cfi_offset 6,-12
 223              	 .cfi_offset 7,-8
 224              	 .cfi_offset 14,-4
 225              	 .loc 1 1254 0
 226 0002 0446     	 mov r4,r0
1255:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t exit_loop = TRUE;
1256:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_t * me = (optiga_cmd_t *)p_ctx;
1257:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1258:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // in event of no success, release lock and exit
1259:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if (OPTIGA_LIB_SUCCESS != event)
 227              	 .loc 1 1259 0
 228 0004 0D46     	 mov r5,r1
 229 0006 B9B1     	 cbz r1,.L15
 230              	.LVL12:
 231              	.LBB104:
 232              	.LBB105:
 869:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         (OPTIGA_COMMS_SESSION_CONTEXT_SAVE == me->manage_context_operation))
 233              	 .loc 1 869 0
 234 0008 437E     	 ldrb r3,[r0,#25]
 235 000a 93B1     	 cbz r3,.L17
 236 000c 037F     	 ldrb r3,[r0,#28]
 237 000e 222B     	 cmp r3,#34
 238 0010 0FD1     	 bne .L17
 872:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         sizeof(me->p_optiga->optiga_context_handle_buffer));
 239              	 .loc 1 872 0
 240 0012 0068     	 ldr r0,[r0]
 241              	.LVL13:
 242 0014 0021     	 movs r1,#0
 243              	.LVL14:
 244 0016 00F5D060 	 add r0,r0,#1664
 245 001a 0822     	 movs r2,#8
 246 001c FFF7FEFF 	 bl pal_os_memset
 247              	.LVL15:
 874:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id))
 248              	 .loc 1 874 0
 249 0020 608C     	 ldrh r0,[r4,#34]
 250 0022 3328     	 cmp r0,#51
 251 0024 05D1     	 bne .L17
 879:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                      sizeof(me->p_optiga->optiga_context_handle_buf
 252              	 .loc 1 879 0
 253 0026 2168     	 ldr r1,[r4]
 878:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                      me->p_optiga->optiga_context_handle_buffer,
 254              	 .loc 1 878 0
 255 0028 0822     	 movs r2,#8
 256 002a 01F5D061 	 add r1,r1,#1664
 257 002e FFF7FEFF 	 bl pal_os_datastore_write
 258              	.LVL16:
 259              	.L17:
 260              	.LBE105:
 261              	.LBE104:
1260:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1261:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1262:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_cmd_clear_app_ctx(p_ctx);
1263:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1264:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
 262              	 .loc 1 1264 0
 263 0032 0423     	 movs r3,#4
 264 0034 A375     	 strb r3,[r4,#22]
1265:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->exit_status = event;
 265              	 .loc 1 1265 0
 266 0036 2584     	 strh r5,[r4,#32]
 267              	.LVL17:
 268              	.L15:
1254:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t exit_loop = TRUE;
 269              	 .loc 1 1254 0
 270 0038 0123     	 movs r3,#1
 271              	.LVL18:
 272              	.L19:
1266:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
1267:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1268:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
1269:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1270:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_next_execution_state)
 273              	 .loc 1 1270 0
 274 003a A27D     	 ldrb r2,[r4,#22]
 275 003c 042A     	 cmp r2,#4
 276 003e 00F2BF81 	 bhi .L20
 277 0042 DFE812F0 	 tbh [pc,r2,lsl#1]
 278              	.L22:
 279 0046 0500     	 .2byte (.L21-.L22)/2
 280 0048 3C00     	 .2byte (.L23-.L22)/2
 281 004a 8100     	 .2byte (.L24-.L22)/2
 282 004c E000     	 .2byte (.L93-.L22)/2
 283 004e B301     	 .2byte (.L26-.L22)/2
 284              	 .p2align 1
 285              	.L21:
 286              	.LVL19:
 287              	.LBB106:
 288              	.LBB107:
 895:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 289              	 .loc 1 895 0
 290 0050 E57D     	 ldrb r5,[r4,#23]
 291 0052 012D     	 cmp r5,#1
 292 0054 15D0     	 beq .L28
 293 0056 0CD3     	 bcc .L29
 294 0058 022D     	 cmp r5,#2
 295 005a 40F0C480 	 bne .L44
 932:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        (register_callback)optiga_cmd_event_trigger_
 296              	 .loc 1 932 0
 297 005e 2368     	 ldr r3,[r4]
 298 0060 A849     	 ldr r1,.L115
 299 0062 D3F87806 	 ldr r0,[r3,#1656]
 300 0066 2246     	 mov r2,r4
 301 0068 3223     	 movs r3,#50
 302 006a FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 303              	.LVL20:
 935:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
 304              	 .loc 1 935 0
 305 006e A575     	 strb r5,[r4,#22]
 306 0070 05E1     	 b .L111
 307              	.L29:
 308              	.LVL21:
 309              	.LBB108:
 310              	.LBB109:
 799:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 311              	 .loc 1 799 0
 312 0072 2046     	 mov r0,r4
 313 0074 2121     	 movs r1,#33
 314 0076 FFF7FEFF 	 bl optiga_cmd_queue_update_slot
 315              	.LVL22:
 316              	.LBE109:
 317              	.LBE108:
 901:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 318              	 .loc 1 901 0
 319 007a 0023     	 movs r3,#0
 320 007c 2384     	 strh r3,[r4,#32]
 907:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 321              	 .loc 1 907 0
 322 007e 0123     	 movs r3,#1
 323 0080 FEE0     	 b .L110
 324              	.LVL23:
 325              	.L28:
 913:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 326              	 .loc 1 913 0
 327 0082 2368     	 ldr r3,[r4]
 328 0084 A27E     	 ldrb r2,[r4,#26]
 329 0086 1B68     	 ldr r3,[r3]
 330 0088 9A73     	 strb r2,[r3,#14]
 914:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->manage_context_operation = me->manage_context_operati
 331              	 .loc 1 914 0
 332 008a 2368     	 ldr r3,[r4]
 333 008c E27E     	 ldrb r2,[r4,#27]
 334 008e 1B68     	 ldr r3,[r3]
 335 0090 DA73     	 strb r2,[r3,#15]
 915:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->p_pal_os_event_ctx = me->p_optiga->p_pal_os_event_ctx
 336              	 .loc 1 915 0
 337 0092 2368     	 ldr r3,[r4]
 338 0094 227F     	 ldrb r2,[r4,#28]
 339 0096 1B68     	 ldr r3,[r3]
 340 0098 1A74     	 strb r2,[r3,#16]
 916:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 341              	 .loc 1 916 0
 342 009a 2368     	 ldr r3,[r4]
 343 009c 1868     	 ldr r0,[r3]
 344 009e D3F87836 	 ldr r3,[r3,#1656]
 345 00a2 4361     	 str r3,[r0,#20]
 919:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_open(me->p_optiga->p_optiga_comms);
 346              	 .loc 1 919 0
 347 00a4 2146     	 mov r1,r4
 348 00a6 FFF7FEFF 	 bl optiga_comms_set_callback_context
 349              	.LVL24:
 920:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 350              	 .loc 1 920 0
 351 00aa 2368     	 ldr r3,[r4]
 352 00ac 1868     	 ldr r0,[r3]
 353 00ae FFF7FEFF 	 bl optiga_comms_open
 354              	.LVL25:
 355 00b2 2084     	 strh r0,[r4,#32]
 922:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 356              	 .loc 1 922 0
 357 00b4 0028     	 cmp r0,#0
 358 00b6 40F09680 	 bne .L44
 927:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 359              	 .loc 1 927 0
 360 00ba 0223     	 movs r3,#2
 361 00bc E0E0     	 b .L110
 362              	.LVL26:
 363              	.L23:
 364              	.LBE107:
 365              	.LBE106:
 366              	.LBB110:
 367              	.LBB111:
 953:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 368              	 .loc 1 953 0
 369 00be E37D     	 ldrb r3,[r4,#23]
 370 00c0 032B     	 cmp r3,#3
 371 00c2 02D0     	 beq .L35
 372 00c4 042B     	 cmp r3,#4
 373 00c6 31D0     	 beq .L36
 374 00c8 8DE0     	 b .L44
 375              	.L35:
 960:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 376              	 .loc 1 960 0
 377 00ca 237F     	 ldrb r3,[r4,#28]
 964:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 378              	 .loc 1 964 0
 379 00cc A27E     	 ldrb r2,[r4,#26]
 960:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 380              	 .loc 1 960 0
 381 00ce 222B     	 cmp r3,#34
 962:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 382              	 .loc 1 962 0
 383 00d0 1CBF     	 itt ne
 384 00d2 0423     	 movne r3,#4
 385 00d4 E375     	 strbne r3,[r4,#23]
 964:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 386              	 .loc 1 964 0
 387 00d6 2368     	 ldr r3,[r4]
 388 00d8 1B68     	 ldr r3,[r3]
 389 00da 9A73     	 strb r2,[r3,#14]
 965:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (0 != me->p_optiga->protection_level_state)
 390              	 .loc 1 965 0
 391 00dc 2368     	 ldr r3,[r4]
 392 00de E27E     	 ldrb r2,[r4,#27]
 393 00e0 1B68     	 ldr r3,[r3]
 394 00e2 DA73     	 strb r2,[r3,#15]
 966:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 395              	 .loc 1 966 0
 396 00e4 2368     	 ldr r3,[r4]
 397 00e6 93F88826 	 ldrb r2,[r3,#1672]
 398 00ea 1B68     	 ldr r3,[r3]
 399 00ec 0AB1     	 cbz r2,.L38
 968:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 400              	 .loc 1 968 0
 401 00ee 227F     	 ldrb r2,[r4,#28]
 402 00f0 00E0     	 b .L107
 403              	.L38:
 972:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 404              	 .loc 1 972 0
 405 00f2 3322     	 movs r2,#51
 406              	.L107:
 407 00f4 1A74     	 strb r2,[r3,#16]
 974:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 408              	 .loc 1 974 0
 409 00f6 2368     	 ldr r3,[r4]
 410 00f8 0022     	 movs r2,#0
 411 00fa 83F88826 	 strb r2,[r3,#1672]
 978:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 412              	 .loc 1 978 0
 413 00fe 2368     	 ldr r3,[r4]
 414 0100 1868     	 ldr r0,[r3]
 415 0102 D3F87836 	 ldr r3,[r3,#1656]
 976:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 416              	 .loc 1 976 0
 417 0106 0425     	 movs r5,#4
 418 0108 E575     	 strb r5,[r4,#23]
 980:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_close(me->p_optiga->p_optiga_comms);
 419              	 .loc 1 980 0
 420 010a 2146     	 mov r1,r4
 978:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 421              	 .loc 1 978 0
 422 010c 4361     	 str r3,[r0,#20]
 980:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_close(me->p_optiga->p_optiga_comms);
 423              	 .loc 1 980 0
 424 010e FFF7FEFF 	 bl optiga_comms_set_callback_context
 425              	.LVL27:
 981:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 426              	 .loc 1 981 0
 427 0112 2368     	 ldr r3,[r4]
 428 0114 1868     	 ldr r0,[r3]
 429 0116 FFF7FEFF 	 bl optiga_comms_close
 430              	.LVL28:
 431 011a 2084     	 strh r0,[r4,#32]
 983:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 432              	 .loc 1 983 0
 433 011c 08B1     	 cbz r0,.L40
 985:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
 434              	 .loc 1 985 0
 435 011e A575     	 strb r5,[r4,#22]
 436 0120 63E0     	 b .L106
 437              	.L40:
 992:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 438              	 .loc 1 992 0
 439 0122 237F     	 ldrb r3,[r4,#28]
 440 0124 222B     	 cmp r3,#34
 441 0126 09D1     	 bne .L42
 994:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *exit_loop = TRUE;
 442              	 .loc 1 994 0
 443 0128 E575     	 strb r5,[r4,#23]
 444 012a 4CE1     	 b .L14
 445              	.L36:
1009:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 446              	 .loc 1 1009 0
 447 012c 2369     	 ldr r3,[r4,#16]
 448 012e E068     	 ldr r0,[r4,#12]
 449 0130 0021     	 movs r1,#0
 450 0132 9847     	 blx r3
 451              	.LVL29:
1012:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 452              	 .loc 1 1012 0
 453 0134 237F     	 ldrb r3,[r4,#28]
 454 0136 222B     	 cmp r3,#34
 455 0138 40F04581 	 bne .L14
 456              	.L42:
 457              	.LVL30:
 458              	.LBB112:
 459              	.LBB113:
 805:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 460              	 .loc 1 805 0
 461 013c 2046     	 mov r0,r4
 462 013e FFF7FEFF 	 bl optiga_cmd_queue_reset_slot
 463              	.LVL31:
 464              	.LBE113:
 465              	.LBE112:
1000:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 466              	 .loc 1 1000 0
 467 0142 0023     	 movs r3,#0
 468 0144 2384     	 strh r3,[r4,#32]
 469 0146 3EE1     	 b .L14
 470              	.LVL32:
 471              	.L24:
 472              	.LBE111:
 473              	.LBE110:
 474              	.LBB114:
 475              	.LBB115:
1032:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 476              	 .loc 1 1032 0
 477 0148 E37D     	 ldrb r3,[r4,#23]
 478              	.LVL33:
1029:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
 479              	 .loc 1 1029 0
 480 014a 6168     	 ldr r1,[r4,#4]
 481              	.LVL34:
1032:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 482              	 .loc 1 1032 0
 483 014c 5A1F     	 subs r2,r3,#5
 484 014e 032A     	 cmp r2,#3
 485 0150 49D8     	 bhi .L44
 486 0152 DFE802F0 	 tbb [pc,r2]
 487              	.L46:
 488 0156 02       	 .byte (.L45-.L46)/2
 489 0157 02       	 .byte (.L45-.L46)/2
 490 0158 0D       	 .byte (.L47-.L46)/2
 491 0159 14       	 .byte (.L48-.L46)/2
 492              	 .p2align 1
 493              	.L45:
 494              	.LVL35:
1038:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 495              	 .loc 1 1038 0
 496 015a 052B     	 cmp r3,#5
 497              	.LBB116:
 498              	.LBB117:
 787:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 499              	 .loc 1 787 0
 500 015c 2046     	 mov r0,r4
 501 015e 4FF00005 	 mov r5,#0
 502              	.LVL36:
 503 0162 0CBF     	 ite eq
 504 0164 2221     	 moveq r1,#34
 505              	.LVL37:
 506              	.LBE117:
 507              	.LBE116:
 508              	.LBB118:
 509              	.LBB119:
 799:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 510              	 .loc 1 799 0
 511 0166 2121     	 movne r1,#33
 512 0168 FFF7FEFF 	 bl optiga_cmd_queue_update_slot
 513              	.LVL38:
 514              	.LBE119:
 515              	.LBE118:
1044:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 516              	 .loc 1 1044 0
 517 016c 2584     	 strh r5,[r4,#32]
 518 016e 86E0     	 b .L111
 519              	.LVL39:
 520              	.L47:
 521              	.LBB120:
 522              	.LBB121:
 799:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 523              	 .loc 1 799 0
 524 0170 2046     	 mov r0,r4
 525 0172 2321     	 movs r1,#35
 526              	.LVL40:
 527 0174 FFF7FEFF 	 bl optiga_cmd_queue_update_slot
 528              	.LVL41:
 529              	.LBE121:
 530              	.LBE120:
1057:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 531              	 .loc 1 1057 0
 532 0178 0023     	 movs r3,#0
 533 017a 2384     	 strh r3,[r4,#32]
 534 017c 7FE0     	 b .L111
 535              	.LVL42:
 536              	.L48:
1070:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 537              	 .loc 1 1070 0
 538 017e 2046     	 mov r0,r4
 539 0180 8847     	 blx r1
 540              	.LVL43:
 541 0182 2084     	 strh r0,[r4,#32]
1071:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 542              	 .loc 1 1071 0
 543 0184 18B1     	 cbz r0,.L52
1073:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *exit_loop = FALSE;
 544              	 .loc 1 1073 0
 545 0186 0423     	 movs r3,#4
 546 0188 A375     	 strb r3,[r4,#22]
 547              	.LVL44:
 548              	.L71:
 549 018a 0023     	 movs r3,#0
 550 018c 55E7     	 b .L19
 551              	.LVL45:
 552              	.L52:
1077:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 553              	 .loc 1 1077 0
 554 018e 2368     	 ldr r3,[r4]
 555 0190 40F22262 	 movw r2,#1570
 556 0194 DA80     	 strh r2,[r3,#6]
1079:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 557              	 .loc 1 1079 0
 558 0196 1B68     	 ldr r3,[r3]
 559 0198 A27E     	 ldrb r2,[r4,#26]
 560 019a 9A73     	 strb r2,[r3,#14]
1080:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->protection_level_state |= me->protection_level;
 561              	 .loc 1 1080 0
 562 019c 2368     	 ldr r3,[r4]
 563 019e E27E     	 ldrb r2,[r4,#27]
 564 01a0 1B68     	 ldr r3,[r3]
 565 01a2 DA73     	 strb r2,[r3,#15]
1081:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 566              	 .loc 1 1081 0
 567 01a4 2268     	 ldr r2,[r4]
 568 01a6 A17E     	 ldrb r1,[r4,#26]
 569 01a8 92F88836 	 ldrb r3,[r2,#1672]
 570 01ac 0B43     	 orrs r3,r3,r1
 571 01ae 82F88836 	 strb r3,[r2,#1672]
1083:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_transceive(me->p_optiga->p_optiga_comms,
 572              	 .loc 1 1083 0
 573 01b2 2368     	 ldr r3,[r4]
 574 01b4 2146     	 mov r1,r4
 575 01b6 1868     	 ldr r0,[r3]
 576 01b8 FFF7FEFF 	 bl optiga_comms_set_callback_context
 577              	.LVL46:
1084:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->optiga_comms_buffer,
 578              	 .loc 1 1084 0
 579 01bc 2368     	 ldr r3,[r4]
 580 01be 981D     	 adds r0,r3,#6
 581 01c0 9A88     	 ldrh r2,[r3,#4]
 582 01c2 0090     	 str r0,[sp]
1087:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                           &(me->p_optiga->comms_rx_size));
 583              	 .loc 1 1087 0
 584 01c4 03F10D01 	 add r1,r3,#13
1084:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->optiga_comms_buffer,
 585              	 .loc 1 1084 0
 586 01c8 1868     	 ldr r0,[r3]
 587 01ca 0B46     	 mov r3,r1
 588 01cc FFF7FEFF 	 bl optiga_comms_transceive
 589              	.LVL47:
 590 01d0 2084     	 strh r0,[r4,#32]
1090:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 591              	 .loc 1 1090 0
 592 01d2 40B9     	 cbnz r0,.L44
1096:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE;
 593              	 .loc 1 1096 0
 594 01d4 0323     	 movs r3,#3
 595 01d6 A375     	 strb r3,[r4,#22]
1097:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_ENTER_HANDLER_CALL);
 596              	 .loc 1 1097 0
 597 01d8 0923     	 movs r3,#9
 598 01da E375     	 strb r3,[r4,#23]
1098:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 599              	 .loc 1 1098 0
 600 01dc 637F     	 ldrb r3,[r4,#29]
 601 01de 63F07F03 	 orn r3,r3,#127
 602 01e2 6377     	 strb r3,[r4,#29]
 603 01e4 EFE0     	 b .L14
 604              	.LVL48:
 605              	.L44:
1102:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
 606              	 .loc 1 1102 0
 607 01e6 0423     	 movs r3,#4
 608 01e8 A375     	 strb r3,[r4,#22]
 609              	.L106:
 610 01ea 40F20223 	 movw r3,#514
 611 01ee 2384     	 strh r3,[r4,#32]
 612              	.LVL49:
 613 01f0 CBE7     	 b .L71
 614              	.LVL50:
 615              	.L55:
 616              	.LBE115:
 617              	.LBE114:
 618              	.LBB122:
 619              	.LBB123:
 620              	.LBB124:
 621              	.LBB125:
1132:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 622              	 .loc 1 1132 0
 623 01f2 94F91D20 	 ldrsb r2,[r4,#29]
1128:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
 624              	 .loc 1 1128 0
 625 01f6 6368     	 ldr r3,[r4,#4]
 626              	.LVL51:
1132:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 627              	 .loc 1 1132 0
 628 01f8 002A     	 cmp r2,#0
 629 01fa 15DB     	 blt .L113
 630              	.LVL52:
 631              	.L60:
1138:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             *exit_loop = FALSE;
 632              	 .loc 1 1138 0
 633 01fc 0423     	 movs r3,#4
 634 01fe A375     	 strb r3,[r4,#22]
 635              	.LVL53:
 636              	.L63:
 637              	.LBE125:
 638              	.LBE124:
1239:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 639              	 .loc 1 1239 0
 640 0200 A37D     	 ldrb r3,[r4,#22]
 641 0202 032B     	 cmp r3,#3
 642 0204 C1D1     	 bne .L71
 643              	.LVL54:
 644              	.L93:
1208:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 645              	 .loc 1 1208 0
 646 0206 E37D     	 ldrb r3,[r4,#23]
 647 0208 093B     	 subs r3,r3,#9
 648 020a 032B     	 cmp r3,#3
 649 020c 00F2C880 	 bhi .L54
 650 0210 01A2     	 adr r2,.L56
 651 0212 52F823F0 	 ldr pc,[r2,r3,lsl#2]
 652 0216 00BF     	 .p2align 2
 653              	.L56:
 654 0218 F3010000 	 .word .L55+1
 655 021c 9D020000 	 .word .L57+1
 656 0220 95030000 	 .word .L58+1
 657 0224 B3030000 	 .word .L112+1
 658              	.LVL55:
 659              	 .p2align 1
 660              	.L113:
 661              	.LBB127:
 662              	.LBB126:
1134:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 663              	 .loc 1 1134 0
 664 0228 2046     	 mov r0,r4
 665 022a 9847     	 blx r3
 666              	.LVL56:
 667 022c 2084     	 strh r0,[r4,#32]
1142:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 668              	 .loc 1 1142 0
 669 022e 48BB     	 cbnz r0,.L114
1145:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 670              	 .loc 1 1145 0
 671 0230 94F82430 	 ldrb r3,[r4,#36]
 672 0234 F12B     	 cmp r3,#241
 673 0236 0CD1     	 bne .L64
1147:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        (register_callback)optiga_cmd_event_trigger_
 674              	 .loc 1 1147 0
 675 0238 2368     	 ldr r3,[r4]
 676 023a 3249     	 ldr r1,.L115
 677 023c D3F87806 	 ldr r0,[r3,#1656]
 678 0240 2246     	 mov r2,r4
 679 0242 4FF47A73 	 mov r3,#1000
 680 0246 FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 681              	.LVL57:
1152:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_START;
 682              	 .loc 1 1152 0
 683 024a 0123     	 movs r3,#1
 684 024c A375     	 strb r3,[r4,#22]
1153:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 685              	 .loc 1 1153 0
 686 024e 0323     	 movs r3,#3
 687 0250 16E0     	 b .L110
 688              	.L64:
1157:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 689              	 .loc 1 1157 0
 690 0252 237E     	 ldrb r3,[r4,#24]
 691 0254 23B9     	 cbnz r3,.L65
1159:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     {
 692              	 .loc 1 1159 0
 693 0256 E37D     	 ldrb r3,[r4,#23]
 694 0258 0C2B     	 cmp r3,#12
 695 025a D1D0     	 beq .L63
 696              	.L66:
1161:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     }
 697              	 .loc 1 1161 0
 698 025c 0B23     	 movs r3,#11
 699 025e 9DE0     	 b .L109
 700              	.L65:
1169:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                            (register_callback)optiga_cmd_event_trig
 701              	 .loc 1 1169 0
 702 0260 2368     	 ldr r3,[r4]
 703 0262 2849     	 ldr r1,.L115
 704 0264 D3F87806 	 ldr r0,[r3,#1656]
 705 0268 2246     	 mov r2,r4
 706 026a 4FF47A73 	 mov r3,#1000
 707 026e FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 708              	.LVL58:
1176:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 709              	 .loc 1 1176 0
 710 0272 A37E     	 ldrb r3,[r4,#26]
 711 0274 03F00303 	 and r3,r3,#3
 712 0278 A376     	 strb r3,[r4,#26]
1179:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
 713              	 .loc 1 1179 0
 714 027a 0223     	 movs r3,#2
 715 027c A375     	 strb r3,[r4,#22]
 716              	.LVL59:
 717              	.L111:
1180:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 718              	 .loc 1 1180 0
 719 027e 0823     	 movs r3,#8
 720              	.L110:
 721 0280 E375     	 strb r3,[r4,#23]
 722 0282 A0E0     	 b .L14
 723              	.LVL60:
 724              	.L114:
1187:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 725              	 .loc 1 1187 0
 726 0284 B0F5017F 	 cmp r0,#516
 727 0288 E8D0     	 beq .L66
1196:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_PREPARE);
 728              	 .loc 1 1196 0
 729 028a 0A23     	 movs r3,#10
 730 028c E375     	 strb r3,[r4,#23]
1197:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = FALSE;
 731              	 .loc 1 1197 0
 732 028e 637F     	 ldrb r3,[r4,#29]
 733 0290 23F00303 	 bic r3,r3,#3
 734 0294 43F00103 	 orr r3,r3,#1
 735 0298 6377     	 strb r3,[r4,#29]
 736              	.LVL61:
 737 029a B1E7     	 b .L63
 738              	.LVL62:
 739              	.L57:
 740              	.LBE126:
 741              	.LBE127:
 742              	.LBB128:
 743              	.LBB129:
 744              	.LBB130:
 745              	.LBB131:
1271:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1272:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_OPEN:
1273:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1274:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_comms_open(me, &exit_loop);
1275:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1276:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1277:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_CLOSE:
1278:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1279:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_comms_close(me, &exit_loop);
1280:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1281:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1282:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1283:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1284:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_prepare_command(me, &exit_loop);
1285:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1286:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1287:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1288:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1289:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_process_response(me, &exit_loop);
1290:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1291:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1292:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_ERROR_HANDLER:
1293:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1294:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_error_handler(me, &exit_loop);
1295:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1296:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1297:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             default :
1298:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1299:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
1300:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1301:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE == exit_loop);
1302:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1303:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1304:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_cmd_t * optiga_cmd_create(uint8_t optiga_instance_id, callback_handler_t handler, void * cal
1305:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1306:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_t * me = NULL;
1307:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1308:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     pal_os_lock_enter_critical_section();
1309:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
1310:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1311:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Get number of free slots
1312:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (0 == optiga_cmd_queue_get_count_of(g_optiga_list[optiga_instance_id],
1313:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_QUEUE_SLOT_STATE,
1314:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_QUEUE_NOT_ASSIGNED))
1315:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1316:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1317:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1318:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1319:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me = (optiga_cmd_t *)pal_os_calloc(1, sizeof(optiga_cmd_t));
1320:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (NULL == me)
1321:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1322:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1323:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1324:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1325:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->handler = handler;
1326:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->caller_context = caller_context;
1327:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1328:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->p_optiga = g_optiga_list[optiga_instance_id];
1329:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->optiga_context_datastore_id = g_hibernate_datastore_id_list[optiga_instance_id];
1330:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1331:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (FALSE == me->p_optiga->instance_init_state)
1332:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1333:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //create pal os event
1334:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_pal_os_event_ctx = pal_os_event_create(optiga_cmd_queue_scheduler, me->
1335:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms = optiga_comms_create(optiga_cmd_execute_handler, me);
1336:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (NULL == me->p_optiga->p_optiga_comms)
1337:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1338:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_free(me);
1339:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me = NULL;
1340:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1341:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1342:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->instance_init_state = TRUE;
1343:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->p_pal_os_event_ctx = me->p_optiga->p_pal_os_event_ctx;
1344:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1345:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // attach optiga cmd queue entry
1346:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_cmd_queue_assign_slot(me, &(me->queue_id));
1347:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1348:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1349:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     pal_os_lock_exit_critical_section();
1350:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (me);
1351:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1352:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1353:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_destroy(optiga_cmd_t * me)
1354:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1355:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
1356:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
1357:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1358:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (NULL != me)
1359:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1360:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = optiga_cmd_release_session(me);
1361:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // attach optiga cmd queue entry
1362:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_queue_deassign_slot(me);
1363:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_free(me);
1364:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{838} suppress "Release session API returns success. Status is checked for fu
1365:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1366:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1367:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1368:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
1369:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1370:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1371:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1372:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
1373:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Last error code handler
1374:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
1375:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_get_error_code_handler(optiga_cmd_t * me)
1376:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1377:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_context_t * p_optiga;
1378:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_DEVICE_ERROR;
1379:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
1380:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1381:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OFFSET                     (0x0000)
1382:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_BYTES_TO_READ              (0x0001)
1383:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_DATA_OBJECT_CMD        (0x01)
1384:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_PARAM                      (0x00)
1385:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1386:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_optiga = me->p_optiga;
1387:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1388:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch (me->device_error_status & OPTIGA_CMD_ERROR_CODE_STATE_MASK)
 746              	 .loc 1 1388 0
 747 029c 677F     	 ldrb r7,[r4,#29]
1386:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 748              	 .loc 1 1386 0
 749 029e 2668     	 ldr r6,[r4]
 750              	.LVL63:
 751              	 .loc 1 1388 0
 752 02a0 07F00307 	 and r7,r7,#3
 753 02a4 022F     	 cmp r7,#2
 754 02a6 2FD0     	 beq .L68
 755 02a8 032F     	 cmp r7,#3
 756 02aa 4ED0     	 beq .L69
 757 02ac 012F     	 cmp r7,#1
 758 02ae 61D1     	 bne .L77
1389:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1390:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_ERROR_CODE_PREPARE:
1391:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1392:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), OPTIGA_C
 759              	 .loc 1 1392 0
 760 02b0 06F11600 	 add r0,r6,#22
 761 02b4 4FF2C211 	 movw r1,#61890
 762 02b8 FFF7FEFF 	 bl optiga_common_set_uint16
 763              	.LVL64:
1393:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1394:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), OPTIGA_C
 764              	 .loc 1 1394 0
 765 02bc 2068     	 ldr r0,[r4]
 766 02be 0021     	 movs r1,#0
 767 02c0 1830     	 adds r0,r0,#24
 768 02c2 FFF7FEFF 	 bl optiga_common_set_uint16
 769              	.LVL65:
1395:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1396:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), OPTIGA_C
 770              	 .loc 1 1396 0
 771 02c6 2068     	 ldr r0,[r4]
 772 02c8 3946     	 mov r1,r7
 773 02ca 1A30     	 adds r0,r0,#26
 774 02cc FFF7FEFF 	 bl optiga_common_set_uint16
 775              	.LVL66:
1397:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1398:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1399:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_GET_DATA_OBJECT_CMD,
1400:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            OPTIGA_CMD_PARAM,
1401:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSE
1402:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
 776              	 .loc 1 1402 0
 777 02d0 2368     	 ldr r3,[r4]
 778              	.LVL67:
1403:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1404:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (uint16_t)(index_for_data - OPTIGA_COMMS_DATA_OFFSET);
1405:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_TX);
1406:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 779              	 .loc 1 1406 0
 780 02d2 0C49     	 ldr r1,.L115
 781              	.LBB132:
 782              	.LBB133:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 783              	 .loc 1 440 0
 784 02d4 9F74     	 strb r7,[r3,#18]
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 785              	 .loc 1 441 0
 786 02d6 0022     	 movs r2,#0
 787 02d8 DA74     	 strb r2,[r3,#19]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 788              	 .loc 1 442 0
 789 02da 1A75     	 strb r2,[r3,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 790              	 .loc 1 443 0
 791 02dc 0622     	 movs r2,#6
 792 02de 5A75     	 strb r2,[r3,#21]
 793              	.LBE133:
 794              	.LBE132:
1404:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_TX);
 795              	 .loc 1 1404 0
 796 02e0 2268     	 ldr r2,[r4]
 797 02e2 0A23     	 movs r3,#10
 798              	.LVL68:
 799 02e4 9380     	 strh r3,[r2,#4]
1405:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 800              	 .loc 1 1405 0
 801 02e6 637F     	 ldrb r3,[r4,#29]
 802 02e8 23F00303 	 bic r3,r3,#3
 803 02ec 43F00203 	 orr r3,r3,#2
 804 02f0 6377     	 strb r3,[r4,#29]
 805              	 .loc 1 1406 0
 806 02f2 D2F87806 	 ldr r0,[r2,#1656]
 807 02f6 4FF47A73 	 mov r3,#1000
 808 02fa 2246     	 mov r2,r4
 809 02fc FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 810              	.LVL69:
 811 0300 38E0     	 b .L77
 812              	.L116:
 813 0302 00BF     	 .align 2
 814              	.L115:
 815 0304 00000000 	 .word optiga_cmd_event_trigger_execute
 816              	.LVL70:
 817              	.L68:
1407:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    (register_callback)optiga_cmd_event_trigger_exec
1408:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    me, OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
1409:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1410:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1411:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_ERROR_CODE_TX:
1412:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1413:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_rx_size = OPTIGA_CMD_TOTAL_COMMS_BUFFER_SIZE;
 818              	 .loc 1 1413 0
 819 0308 40F22263 	 movw r3,#1570
 820 030c F380     	 strh r3,[r6,#6]
1414:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1415:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1416:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->protection_level = me->protection_level;
 821              	 .loc 1 1416 0
 822 030e 3368     	 ldr r3,[r6]
 823 0310 A27E     	 ldrb r2,[r4,#26]
 824 0312 9A73     	 strb r2,[r3,#14]
1417:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 825              	 .loc 1 1417 0
 826 0314 2368     	 ldr r3,[r4]
 827 0316 E27E     	 ldrb r2,[r4,#27]
 828 0318 1B68     	 ldr r3,[r3]
1418:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1419:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1420:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             (void)optiga_comms_set_callback_context(p_optiga->p_optiga_comms, (void*)me);
 829              	 .loc 1 1420 0
 830 031a 3546     	 mov r5,r6
1417:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 831              	 .loc 1 1417 0
 832 031c DA73     	 strb r2,[r3,#15]
 833              	 .loc 1 1420 0
 834 031e 55F80D0B 	 ldr r0,[r5],#13
 835 0322 2146     	 mov r1,r4
 836 0324 FFF7FEFF 	 bl optiga_comms_set_callback_context
 837              	.LVL71:
1421:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = optiga_comms_transceive(p_optiga->p_optiga_comms,
 838              	 .loc 1 1421 0
 839 0328 B31D     	 adds r3,r6,#6
 840 032a B288     	 ldrh r2,[r6,#4]
 841 032c 0093     	 str r3,[sp]
 842 032e 2946     	 mov r1,r5
 843 0330 2B46     	 mov r3,r5
 844 0332 3068     	 ldr r0,[r6]
 845 0334 FFF7FEFF 	 bl optiga_comms_transceive
 846              	.LVL72:
1422:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->optiga_comms_buffer,
1423:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->comms_tx_size,
1424:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->optiga_comms_buffer,
1425:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                     &p_optiga->comms_rx_size);
1426:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_COMMS_SUCCESS != return_status)
 847              	 .loc 1 1426 0
 848 0338 0546     	 mov r5,r0
 849 033a C0B9     	 cbnz r0,.L76
1427:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1428:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR;
1429:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1430:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1431:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_RX);
 850              	 .loc 1 1431 0
 851 033c 637F     	 ldrb r3,[r4,#29]
 852 033e 23F00303 	 bic r3,r3,#3
 853 0342 43F00303 	 orr r3,r3,#3
 854 0346 6377     	 strb r3,[r4,#29]
 855 0348 16E0     	 b .L67
 856              	.LVL73:
 857              	.L69:
1432:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1433:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1434:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_ERROR_CODE_RX:
1435:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1436:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_FAILURE == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
 858              	 .loc 1 1436 0
 859 034a B37C     	 ldrb r3,[r6,#18]
 860 034c FF2B     	 cmp r3,#255
 861 034e 11D0     	 beq .L77
1437:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1438:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1439:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET];
 862              	 .loc 1 1440 0
 863 0350 B57D     	 ldrb r5,[r6,#22]
 864              	.LVL74:
1441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = return_status | OPTIGA_DEVICE_ERROR;
1442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PROCESS_RESPONSE;
1443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE;
1444:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 865              	 .loc 1 1444 0
 866 0352 D6F87806 	 ldr r0,[r6,#1656]
1442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE;
 867              	 .loc 1 1442 0
 868 0356 A775     	 strb r7,[r4,#22]
1443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 869              	 .loc 1 1443 0
 870 0358 0923     	 movs r3,#9
 871 035a E375     	 strb r3,[r4,#23]
 872              	 .loc 1 1444 0
 873 035c 1B49     	 ldr r1,.L117
 874 035e 2246     	 mov r2,r4
 875 0360 4FF47A73 	 mov r3,#1000
1441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = return_status | OPTIGA_DEVICE_ERROR;
 876              	 .loc 1 1441 0
 877 0364 45F40045 	 orr r5,r5,#32768
 878              	.LVL75:
 879              	 .loc 1 1444 0
 880 0368 FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 881              	.LVL76:
 882 036c 04E0     	 b .L67
 883              	.LVL77:
 884              	.L76:
1428:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 885              	 .loc 1 1428 0
 886 036e 40F20225 	 movw r5,#514
 887 0372 01E0     	 b .L67
 888              	.LVL78:
 889              	.L77:
1378:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 890              	 .loc 1 1378 0
 891 0374 4FF40045 	 mov r5,#32768
 892              	.LVL79:
 893              	.L67:
 894              	.LBE131:
 895              	.LBE130:
1115:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             ((OPTIGA_DEVICE_ERROR == me->exit_status) &&
 896              	 .loc 1 1115 0
 897 0378 2BB2     	 sxth r3,r5
 898 037a 002B     	 cmp r3,#0
1114:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (((OPTIGA_LIB_SUCCESS != me->exit_status) && !(OPTIGA_DEVICE_ERROR & me->exit_status)) |
 899              	 .loc 1 1114 0
 900 037c 2584     	 strh r5,[r4,#32]
1115:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             ((OPTIGA_DEVICE_ERROR == me->exit_status) &&
 901              	 .loc 1 1115 0
 902 037e 3FF73DAF 	 bgt .L60
 903 0382 B5F5004F 	 cmp r5,#32768
 904 0386 1ED1     	 bne .L14
 905              	.LVL80:
1117:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 906              	 .loc 1 1117 0
 907 0388 637F     	 ldrb r3,[r4,#29]
1116:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             ((me->device_error_status & OPTIGA_CMD_ERROR_CODE_STATE_MASK) == OPTIGA_CMD_ERROR_CODE_
 908              	 .loc 1 1116 0
 909 038a 03F00303 	 and r3,r3,#3
 910 038e 032B     	 cmp r3,#3
 911 0390 19D1     	 bne .L14
 912 0392 33E7     	 b .L60
 913              	.LVL81:
 914              	.L58:
 915              	.LBE129:
 916              	.LBE128:
 917              	.LBB134:
 918              	.LBB135:
 805:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 919              	 .loc 1 805 0
 920 0394 2046     	 mov r0,r4
 921 0396 FFF7FEFF 	 bl optiga_cmd_queue_reset_slot
 922              	.LVL82:
 923              	.LBE135:
 924              	.LBE134:
1224:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *exit_loop = FALSE;
 925              	 .loc 1 1224 0
 926 039a 0C23     	 movs r3,#12
 927              	.LVL83:
 928              	.L109:
 929 039c E375     	 strb r3,[r4,#23]
 930              	.LVL84:
 931 039e 2FE7     	 b .L63
 932              	.LVL85:
 933              	.L54:
1235:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
 934              	 .loc 1 1235 0
 935 03a0 0423     	 movs r3,#4
 936 03a2 A375     	 strb r3,[r4,#22]
 937 03a4 40F20223 	 movw r3,#514
 938 03a8 2384     	 strh r3,[r4,#32]
 939              	.LVL86:
 940 03aa 29E7     	 b .L63
 941              	.LVL87:
 942              	.L26:
 943              	.LBE123:
 944              	.LBE122:
 945              	.LBB136:
 946              	.LBB137:
 947              	.LBB138:
 948              	.LBB139:
 805:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 949              	 .loc 1 805 0
 950 03ac 2046     	 mov r0,r4
 951 03ae FFF7FEFF 	 bl optiga_cmd_queue_reset_slot
 952              	.LVL88:
 953              	.L112:
 954              	.LBE139:
 955              	.LBE138:
1248:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 956              	 .loc 1 1248 0
 957 03b2 2369     	 ldr r3,[r4,#16]
 958 03b4 E068     	 ldr r0,[r4,#12]
 959 03b6 218C     	 ldrh r1,[r4,#32]
 960              	.LBE137:
 961              	.LBE136:
1302:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 962              	 .loc 1 1302 0
 963 03b8 03B0     	 add sp,sp,#12
 964              	.LCFI5:
 965              	 .cfi_remember_state
 966              	 .cfi_def_cfa_offset 20
 967              	 
 968 03ba BDE8F040 	 pop {r4,r5,r6,r7,lr}
 969              	.LCFI6:
 970              	 .cfi_restore 14
 971              	 .cfi_restore 7
 972              	 .cfi_restore 6
 973              	 .cfi_restore 5
 974              	 .cfi_restore 4
 975              	 .cfi_def_cfa_offset 0
 976              	.LVL89:
 977              	.LBB141:
 978              	.LBB140:
1248:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 979              	 .loc 1 1248 0
 980 03be 1847     	 bx r3
 981              	.LVL90:
 982              	.L20:
 983              	.LBE140:
 984              	.LBE141:
1301:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 985              	 .loc 1 1301 0
 986 03c0 002B     	 cmp r3,#0
 987 03c2 3FF4E2AE 	 beq .L71
 988              	.LVL91:
 989              	.L14:
 990              	.LCFI7:
 991              	 .cfi_restore_state
1302:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 992              	 .loc 1 1302 0
 993 03c6 03B0     	 add sp,sp,#12
 994              	.LCFI8:
 995              	 .cfi_def_cfa_offset 20
 996              	 
 997 03c8 F0BD     	 pop {r4,r5,r6,r7,pc}
 998              	.LVL92:
 999              	.L118:
 1000 03ca 00BF     	 .align 2
 1001              	.L117:
 1002 03cc 00000000 	 .word optiga_cmd_event_trigger_execute
 1003              	 .cfi_endproc
 1004              	.LFE29:
 1006              	 .section .text.optiga_cmd_event_trigger_execute,"ax",%progbits
 1007              	 .align 1
 1008              	 .thumb
 1009              	 .thumb_func
 1011              	optiga_cmd_event_trigger_execute:
 1012              	.LFB3:
 463:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(p_ctx, OPTIGA_LIB_SUCCESS);
 1013              	 .loc 1 463 0
 1014              	 .cfi_startproc
 1015              	 
 1016              	 
 1017              	 
 1018              	.LVL93:
 464:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1019              	 .loc 1 464 0
 1020 0000 0021     	 movs r1,#0
 1021 0002 FFF7FEBF 	 b optiga_cmd_execute_handler
 1022              	.LVL94:
 1023              	 .cfi_endproc
 1024              	.LFE3:
 1026              	 .section .text.optiga_cmd_get_data_object_handler,"ax",%progbits
 1027              	 .align 1
 1028              	 .thumb
 1029              	 .thumb_func
 1031              	optiga_cmd_get_data_object_handler:
 1032              	.LFB37:
1445:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    (register_callback)optiga_cmd_event_trigger_exec
1446:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    me, OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
1447:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1448:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1449:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
1450:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1451:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
1452:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1453:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_OFFSET
1454:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_BYTES_TO_READ
1455:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_GET_DATA_OBJECT_CMD
1456:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_PARAM
1457:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
1458:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1459:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1460:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
1461:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Open Application handler
1462:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
1463:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_open_application_handler(optiga_cmd_t * me)
1464:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1465:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
1466:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
1467:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1468:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
1469:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1470:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1471:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1472:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1473:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending open app command...");
1474:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + sizeof(g_optiga_unique_application_id
1476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length += ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_param) ? (0) 
1477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     (sizeof(me->p_optiga->optiga_context_handle_buffer)));
1478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{774} suppress "If OPTIGA_MAX_COMMS_BUFFER_SIZE is set to lesser value it wil
1479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
1480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1483:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1484:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT != me->cmd_param)
1485:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1486:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///optiga context restore operation
1487:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != optiga_cmd_restore_context(me))
1488:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1489:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
1490:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1491:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1492:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_OPEN_APPLICATION,
1493:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1494:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
1495:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (sizeof(g_optiga_unique_application_identifier)) :
1496:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (sizeof(g_optiga_unique_application_identifier) +
1497:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            sizeof(me->p_optiga->optiga_context_handle_buffer))),
1498:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
1499:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1500:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
1501:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           g_optiga_unique_application_identifier,
1502:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           sizeof(g_optiga_unique_application_identifier));
1503:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT != me->cmd_param)
1504:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1505:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET +
1506:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               sizeof(g_optiga_unique_application_identifier)],
1507:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_context_handle_buffer,
1508:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               sizeof(me->p_optiga->optiga_context_handle_buffer));
1509:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1510:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1511:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (OPTIGA_CMD_APDU_HEADER_SIZE +
1512:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
1513:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            sizeof(g_optiga_unique_application_identifier):
1514:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (sizeof(g_optiga_unique_application_identifier) +
1515:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            sizeof(me->p_optiga->optiga_context_handle_buffer))));
1516:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1517:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_memset(me->p_optiga->optiga_context_handle_buffer,
1518:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           0,
1519:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           sizeof(me->p_optiga->optiga_context_handle_buffer));
1520:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id)
1521:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1522:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //Clearing context handle secret from datastore
1523:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = pal_os_datastore_write(me->optiga_context_datastore_id,
1524:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        me->p_optiga->optiga_context_handle_buffer,
1525:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        sizeof(me->p_optiga->optiga_context_handle_b
1526:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (PAL_STATUS_SUCCESS != return_status)
1527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1528:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR;
1529:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
1530:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1531:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1532:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1533:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1534:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1535:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1536:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1537:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for open app command...");
1538:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1539:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
1540:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1541:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing open app response...");
1542:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1543:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1544:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
1545:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1546:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1547:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1548:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->manage_context_operation = OPTIGA_COMMS_SESSION_CONTEXT_N
1549:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1550:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of open app command is processed...");
1551:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1552:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1553:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1554:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1555:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
1556:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1557:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
1558:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1559:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
1560:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1561:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1562:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1563:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_open_application(optiga_cmd_t * me, uint8_t cmd_param, void * params
1564:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1565:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1566:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
1567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1568:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_open_application_handler,
1569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_COMMS_OPEN,
1570:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_COMMS_OPEN_ACQUIRE_LOCK,
1571:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        params,
1572:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1573:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_OPEN_APPLICATION, OPTIGA_CMD_ZERO_LENGTH
1574:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1575:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
1576:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1577:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1578:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
1579:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Close Application handler
1580:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
1581:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_close_application_handler(optiga_cmd_t * me)
1582:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1583:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
1584:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
1585:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
1587:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1589:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1590:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1591:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending close app command..");
1592:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1593:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE;
1594:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{774} suppress "If OPTIGA_MAX_COMMS_BUFFER_SIZE is set to lesser value it wil
1595:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
1596:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1597:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1598:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1599:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1600:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_CLOSE_APPLICATION,
1601:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1602:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
1603:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
1604:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1605:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = OPTIGA_CMD_APDU_HEADER_SIZE;
1606:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1607:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1608:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1609:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1610:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1611:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for close app command...");
1612:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if the close app was successful
1613:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
1614:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1615:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing close app response...");
1616:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1617:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1618:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
1619:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1620:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1621:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT != me->cmd_param)
1622:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1623:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_context_handle_buffer,
1624:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
1625:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               sizeof(me->p_optiga->optiga_context_handle_buffer));
1626:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///Optiga context store operation
1627:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != optiga_cmd_store_context(me))
1628:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1629:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     pal_os_memset(me->p_optiga->optiga_context_handle_buffer,0,
1630:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     sizeof(me->p_optiga->optiga_context_handle_buffer));
1631:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
1632:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1633:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1634:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of close app command is processed...");
1635:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1636:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1637:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1638:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1639:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
1640:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1641:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
1642:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1643:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
1644:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1645:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1646:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_close_application(optiga_cmd_t * me, uint8_t cmd_param, void * param
1647:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1648:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1649:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
1650:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1651:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_close_application_handler,
1652:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
1653:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
1654:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        params,
1655:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1656:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_CLOSE_APPLICATION, OPTIGA_CMD_ZERO_LENGT
1657:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1658:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
1659:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1660:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1661:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
1662:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Get Data Object handler
1663:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
1664:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_get_data_object_handler(optiga_cmd_t * me)
1665:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 1033              	 .loc 1 1665 0
 1034              	 .cfi_startproc
 1035              	 
 1036              	 
 1037              	.LVL95:
 1038 0000 F8B5     	 push {r3,r4,r5,r6,r7,lr}
 1039              	.LCFI9:
 1040              	 .cfi_def_cfa_offset 24
 1041              	 .cfi_offset 3,-24
 1042              	 .cfi_offset 4,-20
 1043              	 .cfi_offset 5,-16
 1044              	 .cfi_offset 6,-12
 1045              	 .cfi_offset 7,-8
 1046              	 .cfi_offset 14,-4
1666:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
1667:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_get_data_object_params_t * p_optiga_read_data = (optiga_get_data_object_params_t *)me->p
1668:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
1669:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
1670:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t size_to_read, data_read;
1671:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t cmd = OPTIGA_CMD_GET_DATA_OBJECT;
1672:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 1047              	 .loc 1 1672 0
 1048 0002 837D     	 ldrb r3,[r0,#22]
1667:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 1049              	 .loc 1 1667 0
 1050 0004 8468     	 ldr r4,[r0,#8]
 1051              	.LVL96:
 1052              	 .loc 1 1672 0
 1053 0006 022B     	 cmp r3,#2
1665:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 1054              	 .loc 1 1665 0
 1055 0008 0646     	 mov r6,r0
 1056              	 .loc 1 1672 0
 1057 000a 02D0     	 beq .L122
 1058 000c 032B     	 cmp r3,#3
 1059 000e 34D0     	 beq .L123
 1060 0010 74E0     	 b .L135
 1061              	.L122:
 1062              	.LVL97:
1673:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1674:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1675:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1676:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending read data command...");
1677:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // APDU header size + oid 2bytes + offset 2 bytes + length 2 bytes
1678:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
1679:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_UINT16_SIZE_IN_BYT
1680:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{774} suppress "If OPTIGA_MAX_COMMS_BUFFER_SIZE is set to lesser value it wil
1681:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
1682:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1683:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1684:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
1685:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1686:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1687:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //oid
1688:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
 1063              	 .loc 1 1688 0
 1064 0012 0068     	 ldr r0,[r0]
 1065              	.LVL98:
 1066 0014 2188     	 ldrh r1,[r4]
 1067 0016 1630     	 adds r0,r0,#22
 1068 0018 FFF7FEFF 	 bl optiga_common_set_uint16
 1069              	.LVL99:
1689:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      p_optiga_read_data->oid);
1690:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1691:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1692:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             size_to_read = MIN((OPTIGA_MAX_COMMS_BUFFER_SIZE - OPTIGA_CMD_APDU_HEADER_SIZE),
 1070              	 .loc 1 1692 0
 1071 001c E188     	 ldrh r1,[r4,#6]
 1072 001e A388     	 ldrh r3,[r4,#4]
 1073 0020 40F21162 	 movw r2,#1553
 1074 0024 5B1A     	 subs r3,r3,r1
 1075 0026 9342     	 cmp r3,r2
 1076 0028 A8BF     	 it ge
 1077 002a 1346     	 movge r3,r2
 1078 002c 9DB2     	 uxth r5,r3
 1079              	.LVL100:
1693:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                (p_optiga_read_data->bytes_to_read - p_optiga_read_data->accumulated
1694:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1695:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_READ_DATA == p_optiga_read_data->data_or_metadata)
 1080              	 .loc 1 1695 0
 1081 002e A37A     	 ldrb r3,[r4,#10]
 1082 0030 6BB9     	 cbnz r3,.L133
1696:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1697:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //offset
1698:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
 1083              	 .loc 1 1698 0
 1084 0032 6388     	 ldrh r3,[r4,#2]
 1085 0034 3068     	 ldr r0,[r6]
 1086 0036 1944     	 add r1,r1,r3
 1087 0038 1830     	 adds r0,r0,#24
 1088 003a 89B2     	 uxth r1,r1
 1089 003c FFF7FEFF 	 bl optiga_common_set_uint16
 1090              	.LVL101:
1699:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            (p_optiga_read_data->offset + p_optiga_read_data->accumulated_size));
1700:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1701:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1702:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //length
1703:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
 1091              	 .loc 1 1703 0
 1092 0040 3068     	 ldr r0,[r6]
 1093 0042 2946     	 mov r1,r5
 1094 0044 1A30     	 adds r0,r0,#26
 1095 0046 FFF7FEFF 	 bl optiga_common_set_uint16
 1096              	.LVL102:
1704:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          size_to_read);
1705:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 1097              	 .loc 1 1705 0
 1098 004a 0F23     	 movs r3,#15
 1099 004c 00E0     	 b .L124
 1100              	.LVL103:
 1101              	.L133:
1690:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1102              	 .loc 1 1690 0
 1103 004e 0B23     	 movs r3,#11
 1104              	.LVL104:
 1105              	.L124:
1706:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1707:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // If OID is for Last error code, don't clear the error code in read
1708:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_LAST_ERROR_CODE == p_optiga_read_data->oid)
 1106              	 .loc 1 1708 0
 1107 0050 2288     	 ldrh r2,[r4]
1709:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1710:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 cmd = OPTIGA_CMD_GET_DATA_OBJECT_NO_ERROR_CLEAR;
1711:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1712:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //prepare APDU header
1713:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(cmd,
 1108              	 .loc 1 1713 0
 1109 0052 707E     	 ldrb r0,[r6,#25]
1710:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 1110              	 .loc 1 1710 0
 1111 0054 4FF2C211 	 movw r1,#61890
 1112 0058 8A42     	 cmp r2,r1
 1113 005a 14BF     	 ite ne
 1114 005c 8121     	 movne r1,#129
 1115 005e 0121     	 moveq r1,#1
 1116              	.LVL105:
1714:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1715:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSET),
1716:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_O
 1117              	 .loc 1 1716 0
 1118 0060 3268     	 ldr r2,[r6]
 1119              	.LVL106:
 1120              	.LBB142:
 1121              	.LBB143:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1122              	 .loc 1 440 0
 1123 0062 9174     	 strb r1,[r2,#18]
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 1124              	 .loc 1 441 0
 1125 0064 D074     	 strb r0,[r2,#19]
 1126              	.LBE143:
 1127              	.LBE142:
1713:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 1128              	 .loc 1 1713 0
 1129 0066 A3F10901 	 sub r1,r3,#9
 1130              	.LVL107:
 1131              	.LBB145:
 1132              	.LBB144:
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1133              	 .loc 1 442 0
 1134 006a 0020     	 movs r0,#0
 1135              	.LVL108:
 1136 006c 1075     	 strb r0,[r2,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1137              	 .loc 1 443 0
 1138 006e 5175     	 strb r1,[r2,#21]
 1139              	.LBE144:
 1140              	.LBE145:
1717:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1718:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = index_for_data - OPTIGA_COMMS_DATA_OFFSET;
 1141              	 .loc 1 1718 0
 1142 0070 3268     	 ldr r2,[r6]
 1143              	.LVL109:
 1144 0072 053B     	 subs r3,r3,#5
 1145              	.LVL110:
 1146 0074 9380     	 strh r3,[r2,#4]
1719:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             p_optiga_read_data->last_read_size = size_to_read;
 1147              	 .loc 1 1719 0
 1148 0076 2581     	 strh r5,[r4,#8]
 1149              	.LVL111:
1720:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1721:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1722:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 1150              	 .loc 1 1722 0
 1151 0078 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1152              	.LVL112:
 1153              	.L123:
1723:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1724:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1725:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for read data command...");
1726:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->chaining_ongoing = FALSE;
 1154              	 .loc 1 1726 0
 1155 007a 0023     	 movs r3,#0
1727:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if the read was successful
1728:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
 1156              	 .loc 1 1728 0
 1157 007c 0168     	 ldr r1,[r0]
1726:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if the read was successful
 1158              	 .loc 1 1726 0
 1159 007e 0376     	 strb r3,[r0,#24]
 1160              	 .loc 1 1728 0
 1161 0080 8D7C     	 ldrb r5,[r1,#18]
 1162 0082 65B1     	 cbz r5,.L126
1729:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1730:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing read data response...");
1731:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //check if it is out of boundary issue
1732:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_CMD_ZERO_LENGTH_OR_VALUE != p_optiga_read_data->accumulated_size)
 1163              	 .loc 1 1732 0
 1164 0084 E288     	 ldrh r2,[r4,#6]
 1165 0086 437F     	 ldrb r3,[r0,#29]
 1166 0088 1AB1     	 cbz r2,.L127
1733:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1734:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_ENTER_HANDLER_CALL);
 1167              	 .loc 1 1734 0
 1168 008a 63F07F03 	 orn r3,r3,#127
 1169 008e 4377     	 strb r3,[r0,#29]
 1170 0090 34E0     	 b .L135
 1171              	.L127:
1735:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1736:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //flag used to setting the received buffer length to 0, in case unexpected error
1737:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
1738:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1739:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for
1740:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for
1741:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
 1172              	 .loc 1 1741 0
 1173 0092 03F07F03 	 and r3,r3,#127
 1174 0096 4377     	 strb r3,[r0,#29]
1742:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
 1175              	 .loc 1 1742 0
 1176 0098 E368     	 ldr r3,[r4,#12]
 1177 009a 1A80     	 strh r2,[r3]
 1178 009c 2EE0     	 b .L135
 1179              	.L126:
1743:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1744:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR;
1745:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1746:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else if (me->exit_status == (optiga_lib_status_t)(OPTIGA_CMD_OUT_OF_BOUNDARY_ERROR | OP
 1180              	 .loc 1 1746 0
 1181 009e 028C     	 ldrh r2,[r0,#32]
 1182 00a0 48F20803 	 movw r3,#32776
 1183 00a4 9A42     	 cmp r2,r3
 1184 00a6 03D1     	 bne .L128
1747:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1748:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_read_data->ref_bytes_to_read) = p_optiga_read_data->accumulated_size;
 1185              	 .loc 1 1748 0
 1186 00a8 E368     	 ldr r3,[r4,#12]
 1187 00aa E288     	 ldrh r2,[r4,#6]
 1188 00ac 1A80     	 strh r2,[r3]
 1189              	.LVL113:
 1190 00ae 23E0     	 b .L136
 1191              	.LVL114:
 1192              	.L128:
1749:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_LIB_SUCCESS;
1750:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1751:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
1752:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1753:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //copy data from optiga comms buffer to user provided buffer
1754:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 data_read = me->p_optiga->comms_rx_size - OPTIGA_CMD_APDU_HEADER_SIZE;
 1193              	 .loc 1 1754 0
 1194 00b0 CF88     	 ldrh r7,[r1,#6]
1755:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1756:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // check if the data received is greater than the size of read buffer
1757:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_read_data->bytes_to_read < data_read)
 1195              	 .loc 1 1757 0
 1196 00b2 A388     	 ldrh r3,[r4,#4]
1754:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1197              	 .loc 1 1754 0
 1198 00b4 043F     	 subs r7,r7,#4
 1199 00b6 BFB2     	 uxth r7,r7
 1200              	.LVL115:
 1201              	 .loc 1 1757 0
 1202 00b8 BB42     	 cmp r3,r7
 1203 00ba 04D2     	 bcs .L129
 1204              	.LVL116:
1758:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1759:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Error in processing read data response...");
1760:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1761:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
 1205              	 .loc 1 1761 0
 1206 00bc E368     	 ldr r3,[r4,#12]
1760:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
 1207              	 .loc 1 1760 0
 1208 00be 4FF40170 	 mov r0,#516
 1209              	.LVL117:
 1210              	 .loc 1 1761 0
 1211 00c2 1D80     	 strh r5,[r3]
1762:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
 1212              	 .loc 1 1762 0
 1213 00c4 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1214              	.LVL118:
 1215              	.L129:
1763:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1764:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1765:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //copy data from optiga comms buffer to user provided buffer
1766:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(p_optiga_read_data->buffer + p_optiga_read_data->accumulated_size,
 1216              	 .loc 1 1766 0
 1217 00c6 E388     	 ldrh r3,[r4,#6]
 1218 00c8 2069     	 ldr r0,[r4,#16]
 1219              	.LVL119:
 1220 00ca 3A46     	 mov r2,r7
 1221 00cc 1844     	 add r0,r0,r3
 1222 00ce 1631     	 adds r1,r1,#22
 1223 00d0 FFF7FEFF 	 bl pal_os_memcpy
 1224              	.LVL120:
1767:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
1768:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               data_read);
1769:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1770:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_read_data->accumulated_size += data_read;
 1225              	 .loc 1 1770 0
 1226 00d4 E388     	 ldrh r3,[r4,#6]
1771:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1772:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if ((p_optiga_read_data->last_read_size > data_read) ||
 1227              	 .loc 1 1772 0
 1228 00d6 2289     	 ldrh r2,[r4,#8]
1770:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1229              	 .loc 1 1770 0
 1230 00d8 3B44     	 add r3,r3,r7
 1231 00da 9BB2     	 uxth r3,r3
 1232              	 .loc 1 1772 0
 1233 00dc BA42     	 cmp r2,r7
1770:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1234              	 .loc 1 1770 0
 1235 00de E380     	 strh r3,[r4,#6]
 1236              	 .loc 1 1772 0
 1237 00e0 02D8     	 bhi .L130
 1238              	 .loc 1 1772 0 is_stmt 0 discriminator 1
 1239 00e2 A288     	 ldrh r2,[r4,#4]
 1240 00e4 9A42     	 cmp r2,r3
 1241 00e6 05D1     	 bne .L131
 1242              	.L130:
1773:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     (p_optiga_read_data->accumulated_size == p_optiga_read_data->bytes_to_read))
1774:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1775:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = p_optiga_read_data->accumulated_size
 1243              	 .loc 1 1775 0 is_stmt 1
 1244 00e8 E268     	 ldr r2,[r4,#12]
1776:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     p_optiga_read_data->accumulated_size = 0;
 1245              	 .loc 1 1776 0
 1246 00ea 0020     	 movs r0,#0
1775:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     p_optiga_read_data->accumulated_size = 0;
 1247              	 .loc 1 1775 0
 1248 00ec 1380     	 strh r3,[r2]
 1249              	 .loc 1 1776 0
 1250 00ee E080     	 strh r0,[r4,#6]
1777:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     p_optiga_read_data->last_read_size = 0;
 1251              	 .loc 1 1777 0
 1252 00f0 2081     	 strh r0,[r4,#8]
 1253 00f2 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1254              	.LVL121:
 1255              	.L131:
1778:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1779:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
1780:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
1781:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->chaining_ongoing = TRUE;
 1256              	 .loc 1 1781 0
 1257 00f4 0123     	 movs r3,#1
 1258 00f6 3376     	 strb r3,[r6,#24]
 1259              	.LVL122:
 1260              	.L136:
1782:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
1783:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Response of read data command is processed...");
1784:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_LIB_SUCCESS;
 1261              	 .loc 1 1784 0
 1262 00f8 2846     	 mov r0,r5
 1263 00fa F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1264              	.LVL123:
 1265              	.L135:
1668:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 1266              	 .loc 1 1668 0
 1267 00fc 40F20220 	 movw r0,#514
 1268              	.LVL124:
1785:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1786:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1787:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1788:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
1789:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1790:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
1791:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1792:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
1793:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1269              	 .loc 1 1793 0
 1270 0100 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1271              	 .cfi_endproc
 1272              	.LFE37:
 1274              	 .section .text.optiga_cmd_set_data_object_handler,"ax",%progbits
 1275              	 .align 1
 1276              	 .thumb
 1277              	 .thumb_func
 1279              	optiga_cmd_set_data_object_handler:
 1280              	.LFB39:
1794:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1795:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_get_data_object(optiga_cmd_t * me, uint8_t cmd_param,
1796:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                optiga_get_data_object_params_t * params)
1797:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1798:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1799:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
1800:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1801:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_get_data_object_handler,
1802:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
1803:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
1804:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        params,
1805:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1806:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_GET_DATA_OBJECT, OPTIGA_CMD_ZERO_LENGTH_
1807:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1808:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
1809:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1810:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1811:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
1812:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Set Data Object handler
1813:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
1814:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_set_data_object_handler(optiga_cmd_t * me)
1815:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 1281              	 .loc 1 1815 0
 1282              	 .cfi_startproc
 1283              	 
 1284              	 
 1285              	.LVL125:
 1286 0000 F8B5     	 push {r3,r4,r5,r6,r7,lr}
 1287              	.LCFI10:
 1288              	 .cfi_def_cfa_offset 24
 1289              	 .cfi_offset 3,-24
 1290              	 .cfi_offset 4,-20
 1291              	 .cfi_offset 5,-16
 1292              	 .cfi_offset 6,-12
 1293              	 .cfi_offset 7,-8
 1294              	 .cfi_offset 14,-4
1816:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
1817:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_set_data_object_params_t * p_optiga_write_data = (optiga_set_data_object_params_t *)me->
1818:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
1819:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t size_to_send;
1820:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
1821:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1822:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 1295              	 .loc 1 1822 0
 1296 0002 837D     	 ldrb r3,[r0,#22]
1817:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 1297              	 .loc 1 1817 0
 1298 0004 8568     	 ldr r5,[r0,#8]
 1299              	.LVL126:
 1300              	 .loc 1 1822 0
 1301 0006 022B     	 cmp r3,#2
1815:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 1302              	 .loc 1 1815 0
 1303 0008 0446     	 mov r4,r0
 1304              	 .loc 1 1822 0
 1305 000a 02D0     	 beq .L139
 1306 000c 032B     	 cmp r3,#3
 1307 000e 47D0     	 beq .L140
 1308 0010 4EE0     	 b .L150
 1309              	.L139:
1823:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1824:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1825:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1826:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1827:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending set data command...");
1828:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->chaining_ongoing = FALSE;
 1310              	 .loc 1 1828 0
 1311 0012 0023     	 movs r3,#0
 1312 0014 0376     	 strb r3,[r0,#24]
1829:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //oid
1830:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
 1313              	 .loc 1 1830 0
 1314 0016 0068     	 ldr r0,[r0]
 1315              	.LVL127:
 1316 0018 2988     	 ldrh r1,[r5]
 1317 001a 1630     	 adds r0,r0,#22
 1318 001c FFF7FEFF 	 bl optiga_common_set_uint16
 1319              	.LVL128:
1831:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      p_optiga_write_data->oid);
1832:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1833:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1834:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //offset
1835:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
 1320              	 .loc 1 1835 0
 1321 0020 6B88     	 ldrh r3,[r5,#2]
 1322 0022 E988     	 ldrh r1,[r5,#6]
 1323 0024 2068     	 ldr r0,[r4]
 1324 0026 1944     	 add r1,r1,r3
 1325 0028 1830     	 adds r0,r0,#24
 1326 002a 89B2     	 uxth r1,r1
 1327 002c FFF7FEFF 	 bl optiga_common_set_uint16
 1328              	.LVL129:
1836:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      (p_optiga_write_data->offset + p_optiga_write_data->written_si
1837:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1838:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1839:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // Check maximum size that can be written, based on optiga comms buffer size
1840:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             size_to_send = MIN((OPTIGA_MAX_COMMS_BUFFER_SIZE + OPTIGA_COMMS_DATA_OFFSET - index_for
 1329              	 .loc 1 1840 0
 1330 0030 AB88     	 ldrh r3,[r5,#4]
 1331 0032 EE88     	 ldrh r6,[r5,#6]
 1332 0034 9E1B     	 subs r6,r3,r6
 1333 0036 40F20D63 	 movw r3,#1549
 1334 003a 9E42     	 cmp r6,r3
 1335 003c A8BF     	 it ge
 1336 003e 1E46     	 movge r6,r3
 1337 0040 B6B2     	 uxth r6,r6
 1338              	.LVL130:
1841:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                ((p_optiga_write_data->size) - p_optiga_write_data->written_size));
1842:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1843:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // APDU header size + oid 2 bytes + offset 2 bytes + size of data to send
1844:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
 1339              	 .loc 1 1844 0
 1340 0042 06F10807 	 add r7,r6,#8
 1341 0046 BFB2     	 uxth r7,r7
 1342              	.LVL131:
1845:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_UINT16_SIZE_IN_BYTES + size_to_send;
1846:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
 1343              	 .loc 1 1846 0
 1344 0048 40F21563 	 movw r3,#1557
 1345 004c 9F42     	 cmp r7,r3
 1346 004e 32D8     	 bhi .L146
1847:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1848:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1849:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1850:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1851:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1852:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // prepare apdu
1853:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_SET_DATA_OBJECT,
1854:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1855:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (OPTIGA_CMD_APDU_HEADER_SIZE + size_to_send),
1856:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
 1347              	 .loc 1 1856 0
 1348 0050 2368     	 ldr r3,[r4]
 1349              	.LVL132:
1853:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 1350              	 .loc 1 1853 0
 1351 0052 617E     	 ldrb r1,[r4,#25]
 1352              	.LVL133:
 1353              	.LBB146:
 1354              	.LBB147:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 1355              	 .loc 1 441 0
 1356 0054 D974     	 strb r1,[r3,#19]
 1357              	.LBE147:
 1358              	.LBE146:
1853:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 1359              	 .loc 1 1853 0
 1360 0056 321D     	 adds r2,r6,#4
 1361 0058 92B2     	 uxth r2,r2
 1362              	.LVL134:
 1363              	.LBB149:
 1364              	.LBB148:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1365              	 .loc 1 440 0
 1366 005a 8220     	 movs r0,#130
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1367              	 .loc 1 442 0
 1368 005c 110A     	 lsrs r1,r2,#8
 1369              	.LVL135:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1370              	 .loc 1 440 0
 1371 005e 9874     	 strb r0,[r3,#18]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1372              	 .loc 1 442 0
 1373 0060 1975     	 strb r1,[r3,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1374              	 .loc 1 443 0
 1375 0062 5A75     	 strb r2,[r3,#21]
 1376              	.LBE148:
 1377              	.LBE149:
1857:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //data to be written
1858:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_UTIL_COUNT_DATA_OBJECT == me->cmd_param)
 1378              	 .loc 1 1858 0
 1379 0064 637E     	 ldrb r3,[r4,#25]
 1380              	.LVL136:
 1381 0066 2068     	 ldr r0,[r4]
 1382 0068 022B     	 cmp r3,#2
 1383 006a 02D1     	 bne .L141
1859:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1860:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data) = p_optiga_write_data->count;
 1384              	 .loc 1 1860 0
 1385 006c AB7B     	 ldrb r3,[r5,#14]
 1386 006e 8376     	 strb r3,[r0,#26]
 1387 0070 06E0     	 b .L142
 1388              	.L141:
1861:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1862:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
1863:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1864:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
 1389              	 .loc 1 1864 0
 1390 0072 EB88     	 ldrh r3,[r5,#6]
 1391 0074 A968     	 ldr r1,[r5,#8]
 1392 0076 1A30     	 adds r0,r0,#26
 1393 0078 1944     	 add r1,r1,r3
 1394 007a 3246     	 mov r2,r6
 1395              	.LVL137:
 1396 007c FFF7FEFF 	 bl pal_os_memcpy
 1397              	.LVL138:
 1398              	.L142:
1865:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_write_data->buffer + p_optiga_write_data->written_size,
1866:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               size_to_send);
1867:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1868:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             p_optiga_write_data->written_size += size_to_send;
 1399              	 .loc 1 1868 0
 1400 0080 EB88     	 ldrh r3,[r5,#6]
 1401 0082 1E44     	 add r6,r6,r3
 1402              	.LVL139:
1869:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1870:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (index_for_data + size_to_send - OPTIGA_COMMS_DATA_OFFSET
 1403              	 .loc 1 1870 0
 1404 0084 2368     	 ldr r3,[r4]
1868:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1405              	 .loc 1 1868 0
 1406 0086 B6B2     	 uxth r6,r6
 1407 0088 EE80     	 strh r6,[r5,#6]
 1408              	 .loc 1 1870 0
 1409 008a 9F80     	 strh r7,[r3,#4]
1871:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1872:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if chaining is required based on size written and the user requested write
1873:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (p_optiga_write_data->written_size != p_optiga_write_data->size)
 1410              	 .loc 1 1873 0
 1411 008c AB88     	 ldrh r3,[r5,#4]
 1412 008e B342     	 cmp r3,r6
 1413 0090 01D1     	 bne .L143
 1414              	.LVL140:
 1415              	.L144:
1874:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1875:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->chaining_ongoing = TRUE;
1876:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // For chaining, the 2nd loop will be Write only
1877:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_param = OPTIGA_CMD_WRITE_ONLY;
1878:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1879:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 1416              	 .loc 1 1879 0
 1417 0092 0020     	 movs r0,#0
 1418 0094 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1419              	.LVL141:
 1420              	.L143:
1875:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // For chaining, the 2nd loop will be Write only
 1421              	 .loc 1 1875 0
 1422 0096 0123     	 movs r3,#1
1877:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 1423              	 .loc 1 1877 0
 1424 0098 0020     	 movs r0,#0
1875:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // For chaining, the 2nd loop will be Write only
 1425              	 .loc 1 1875 0
 1426 009a 2376     	 strb r3,[r4,#24]
1877:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 1427              	 .loc 1 1877 0
 1428 009c 6076     	 strb r0,[r4,#25]
 1429 009e F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1430              	.LVL142:
 1431              	.L140:
1880:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1881:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1882:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1883:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1884:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for set data command...");
1885:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if the write was successful
1886:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
 1432              	 .loc 1 1886 0
 1433 00a0 0368     	 ldr r3,[r0]
 1434 00a2 9B7C     	 ldrb r3,[r3,#18]
 1435 00a4 002B     	 cmp r3,#0
 1436 00a6 F4D0     	 beq .L144
1887:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1888:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing set data response...");
1889:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1890:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1891:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
 1437              	 .loc 1 1891 0
 1438 00a8 437F     	 ldrb r3,[r0,#29]
 1439 00aa 03F07F03 	 and r3,r3,#127
 1440 00ae 4377     	 strb r3,[r0,#29]
 1441              	.L150:
1818:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t size_to_send;
 1442              	 .loc 1 1818 0
 1443 00b0 40F20220 	 movw r0,#514
 1444              	.LVL143:
 1445 00b4 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1446              	.LVL144:
 1447              	.L146:
1848:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 1448              	 .loc 1 1848 0
 1449 00b6 4FF40170 	 mov r0,#516
 1450              	.LVL145:
1892:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1893:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1894:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of set data command is processed...");
1895:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1896:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1897:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
1898:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
1899:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1900:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
1901:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
1902:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1451              	 .loc 1 1902 0
 1452 00ba F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 1453              	 .cfi_endproc
 1454              	.LFE39:
 1456              	 .section .text.optiga_cmd_get_random_handler,"ax",%progbits
 1457              	 .align 1
 1458              	 .thumb
 1459              	 .thumb_func
 1461              	optiga_cmd_get_random_handler:
 1462              	.LFB41:
1903:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1904:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1905:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_set_data_object(optiga_cmd_t * me, uint8_t cmd_param,
1906:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                optiga_set_data_object_params_t * params)
1907:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1908:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1909:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
1910:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1911:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_set_data_object_handler,
1912:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
1913:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
1914:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        params,
1915:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1916:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_SET_DATA_OBJECT, OPTIGA_CMD_ZERO_LENGTH_
1917:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1918:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
1919:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1920:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1921:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_RANDOM_ENABLED
1922:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
1923:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Get Random handler
1924:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
1925:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_get_random_handler(optiga_cmd_t * me)
1926:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 1463              	 .loc 1 1926 0
 1464              	 .cfi_startproc
 1465              	 
 1466              	 
 1467              	.LVL146:
 1468 0000 38B5     	 push {r3,r4,r5,lr}
 1469              	.LCFI11:
 1470              	 .cfi_def_cfa_offset 16
 1471              	 .cfi_offset 3,-16
 1472              	 .cfi_offset 4,-12
 1473              	 .cfi_offset 5,-8
 1474              	 .cfi_offset 14,-4
1927:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_get_random_params_t * p_random_params = (optiga_get_random_params_t *)me->p_input;
1928:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
1929:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
1930:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1931:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 1475              	 .loc 1 1931 0
 1476 0002 847D     	 ldrb r4,[r0,#22]
1927:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_get_random_params_t * p_random_params = (optiga_get_random_params_t *)me->p_input;
 1477              	 .loc 1 1927 0
 1478 0004 8368     	 ldr r3,[r0,#8]
 1479              	.LVL147:
 1480              	 .loc 1 1931 0
 1481 0006 022C     	 cmp r4,#2
1926:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_get_random_params_t * p_random_params = (optiga_get_random_params_t *)me->p_input;
 1482              	 .loc 1 1926 0
 1483 0008 0546     	 mov r5,r0
 1484              	 .loc 1 1931 0
 1485 000a 02D0     	 beq .L153
 1486 000c 032C     	 cmp r4,#3
 1487 000e 11D0     	 beq .L154
 1488 0010 1FE0     	 b .L157
 1489              	.L153:
1932:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
1933:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1934:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1935:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending get random command...");
1936:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1937:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             /// Copy the random data length
1938:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
 1490              	 .loc 1 1938 0
 1491 0012 0068     	 ldr r0,[r0]
 1492              	.LVL148:
 1493 0014 1988     	 ldrh r1,[r3]
 1494 0016 1630     	 adds r0,r0,#22
 1495 0018 FFF7FEFF 	 bl optiga_common_set_uint16
 1496              	.LVL149:
1939:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      p_random_params->random_data_length);
1940:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1941:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1942:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_GET_RANDOM,
1943:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1944:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSET),
1945:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
 1497              	 .loc 1 1945 0
 1498 001c 2B68     	 ldr r3,[r5]
 1499              	.LVL150:
1942:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 1500              	 .loc 1 1942 0
 1501 001e 6A7E     	 ldrb r2,[r5,#25]
 1502              	.LVL151:
 1503              	.LBB150:
 1504              	.LBB151:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 1505              	 .loc 1 441 0
 1506 0020 DA74     	 strb r2,[r3,#19]
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1507              	 .loc 1 440 0
 1508 0022 8C21     	 movs r1,#140
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1509              	 .loc 1 442 0
 1510 0024 0020     	 movs r0,#0
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1511              	 .loc 1 440 0
 1512 0026 9974     	 strb r1,[r3,#18]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1513              	 .loc 1 442 0
 1514 0028 1875     	 strb r0,[r3,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1515              	 .loc 1 443 0
 1516 002a 5C75     	 strb r4,[r3,#21]
 1517              	.LBE151:
 1518              	.LBE150:
1946:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1947:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = index_for_data - OPTIGA_COMMS_DATA_OFFSET;
 1519              	 .loc 1 1947 0
 1520 002c 2B68     	 ldr r3,[r5]
 1521              	.LVL152:
 1522 002e 0622     	 movs r2,#6
 1523              	.LVL153:
 1524 0030 9A80     	 strh r2,[r3,#4]
 1525              	.LVL154:
1948:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1949:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1950:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1951:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 1526              	 .loc 1 1951 0
 1527 0032 38BD     	 pop {r3,r4,r5,pc}
 1528              	.LVL155:
 1529              	.L154:
1952:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1953:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
1954:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for get random command...");
1955:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if the random data retrieval app was successful
1956:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
 1530              	 .loc 1 1956 0
 1531 0034 0168     	 ldr r1,[r0]
 1532 0036 8C7C     	 ldrb r4,[r1,#18]
 1533 0038 24B1     	 cbz r4,.L155
1957:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
1958:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing get random response...");
1959:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1960:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1961:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
 1534              	 .loc 1 1961 0
 1535 003a 437F     	 ldrb r3,[r0,#29]
 1536              	.LVL156:
 1537 003c 03F07F03 	 and r3,r3,#127
 1538 0040 4377     	 strb r3,[r0,#29]
 1539 0042 06E0     	 b .L157
 1540              	.LVL157:
 1541              	.L155:
1962:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
1963:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
1964:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             
1965:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //copy data from optiga comms buffer to user provided buffer
1966:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(p_random_params->random_data,
 1542              	 .loc 1 1966 0
 1543 0044 5868     	 ldr r0,[r3,#4]
 1544              	.LVL158:
 1545 0046 1A88     	 ldrh r2,[r3]
 1546 0048 1631     	 adds r1,r1,#22
 1547 004a FFF7FEFF 	 bl pal_os_memcpy
 1548              	.LVL159:
1967:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
1968:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_random_params->random_data_length);
1969:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1970:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of get random command is processed...");
1971:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 1549              	 .loc 1 1971 0
 1550 004e 2046     	 mov r0,r4
1972:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
1973:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 1551              	 .loc 1 1973 0
 1552 0050 38BD     	 pop {r3,r4,r5,pc}
 1553              	.LVL160:
 1554              	.L157:
1928:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 1555              	 .loc 1 1928 0
 1556 0052 40F20220 	 movw r0,#514
 1557              	.LVL161:
1974:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
1975:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
1976:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
1977:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1978:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
1979:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1558              	 .loc 1 1979 0
 1559 0056 38BD     	 pop {r3,r4,r5,pc}
 1560              	 .cfi_endproc
 1561              	.LFE41:
 1563              	 .section .text.optiga_cmd_calc_sign_handler,"ax",%progbits
 1564              	 .align 1
 1565              	 .thumb
 1566              	 .thumb_func
 1568              	optiga_cmd_calc_sign_handler:
 1569              	.LFB43:
1980:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1981:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1982:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_get_random(optiga_cmd_t * me, uint8_t cmd_param, optiga_get_random_p
1983:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
1984:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t cmd_handler_state = OPTIGA_CMD_EXEC_REQUEST_LOCK;
1985:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1986:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1987:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
1988:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1989:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_get_random_handler,
1990:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
1991:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        cmd_handler_state,
1992:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        params,
1993:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1994:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_GET_RANDOM, OPTIGA_CMD_ZERO_LENGTH_OR_VA
1995:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
1996:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
1997:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
1998:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_RANDOM_ENABLED
1999:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2000:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_ECDSA_SIGN_ENABLED
2001:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
2002:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * CalcSign handler
2003:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
2004:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_calc_sign_handler(optiga_cmd_t * me)
2005:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 1570              	 .loc 1 2005 0
 1571              	 .cfi_startproc
 1572              	 
 1573              	 
 1574              	.LVL162:
 1575 0000 73B5     	 push {r0,r1,r4,r5,r6,lr}
 1576              	.LCFI12:
 1577              	 .cfi_def_cfa_offset 24
 1578              	 .cfi_offset 4,-16
 1579              	 .cfi_offset 5,-12
 1580              	 .cfi_offset 6,-8
 1581              	 .cfi_offset 14,-4
2006:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
2007:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_sign_params_t * p_optiga_ecdsa_sign = (optiga_calc_sign_params_t *)me->p_input;
2008:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
2009:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t private_key_oid;
2010:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
2011:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2012:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 1582              	 .loc 1 2012 0
 1583 0002 857D     	 ldrb r5,[r0,#22]
2007:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 1584              	 .loc 1 2007 0
 1585 0004 8668     	 ldr r6,[r0,#8]
 1586              	.LVL163:
2010:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1587              	 .loc 1 2010 0
 1588 0006 0923     	 movs r3,#9
 1589              	 .loc 1 2012 0
 1590 0008 022D     	 cmp r5,#2
2005:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 1591              	 .loc 1 2005 0
 1592 000a 0446     	 mov r4,r0
2010:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1593              	 .loc 1 2010 0
 1594 000c ADF80630 	 strh r3,[sp,#6]
 1595              	 .loc 1 2012 0
 1596 0010 02D0     	 beq .L160
 1597 0012 032D     	 cmp r5,#3
 1598 0014 3CD0     	 beq .L161
 1599 0016 56E0     	 b .L168
 1600              	.L160:
 1601              	.LVL164:
2013:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2014:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2015:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2016:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // APDU headed length + TLV of Digest + TLV of signature key OID
2017:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending calculate sign command..");
2018:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_TAG_LENGTH_SIZE + p_optiga
2019:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2020:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
2021:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2022:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2023:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_ecdsa_sign->p_signature_length) = 0x00;
2024:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2025:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2026:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // Tag and length for digest
2027:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header(OPTIGA_CMD_SIGN_DIGEST_TAG,
2028:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_ecdsa_sign->digest_length,
2029:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
 1602              	 .loc 1 2029 0
 1603 0018 0268     	 ldr r2,[r0]
2027:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_ecdsa_sign->digest_length,
 1604              	 .loc 1 2027 0
 1605 001a B17B     	 ldrb r1,[r6,#14]
 1606 001c 0120     	 movs r0,#1
 1607              	.LVL165:
 1608 001e 0D32     	 adds r2,r2,#13
 1609 0020 0DF10603 	 add r3,sp,#6
 1610 0024 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 1611              	.LVL166:
2030:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2031:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Digest data
2032:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
 1612              	 .loc 1 2032 0
 1613 0028 BDF80630 	 ldrh r3,[sp,#6]
 1614 002c 2068     	 ldr r0,[r4]
 1615 002e 3168     	 ldr r1,[r6]
 1616 0030 B27B     	 ldrb r2,[r6,#14]
 1617 0032 1844     	 add r0,r0,r3
 1618 0034 0D30     	 adds r0,r0,#13
 1619 0036 FFF7FEFF 	 bl pal_os_memcpy
 1620              	.LVL167:
2033:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_optiga_ecdsa_sign->p_digest,
2034:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_optiga_ecdsa_sign->digest_length);
2035:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2036:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_ecdsa_sign->digest_length;
 1621              	 .loc 1 2036 0
 1622 003a B27B     	 ldrb r2,[r6,#14]
 1623 003c BDF80630 	 ldrh r3,[sp,#6]
 1624 0040 1344     	 add r3,r3,r2
2037:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2038:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // Tag and length for OID of signature key
2039:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header(OPTIGA_CMD_SIGN_OID_TAG,
2040:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           OPTIGA_CMD_SIGN_OID_LEN,
2041:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
 1625              	 .loc 1 2041 0
 1626 0042 2268     	 ldr r2,[r4]
2036:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1627              	 .loc 1 2036 0
 1628 0044 ADF80630 	 strh r3,[sp,#6]
2039:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           OPTIGA_CMD_SIGN_OID_LEN,
 1629              	 .loc 1 2039 0
 1630 0048 2946     	 mov r1,r5
 1631 004a 0320     	 movs r0,#3
 1632 004c 0D32     	 adds r2,r2,#13
 1633 004e 0DF10603 	 add r3,sp,#6
 1634 0052 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 1635              	.LVL168:
2042:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2043:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //oid
2044:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             private_key_oid = me->session_oid;
2045:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_KEY_ID_SESSION_BASED != p_optiga_ecdsa_sign->private_key_oid)
2046:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2047:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 private_key_oid = (uint16_t)p_optiga_ecdsa_sign->private_key_oid;
2048:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2049:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
 1636              	 .loc 1 2049 0
 1637 0056 BDF80630 	 ldrh r3,[sp,#6]
 1638 005a 2068     	 ldr r0,[r4]
2044:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_KEY_ID_SESSION_BASED != p_optiga_ecdsa_sign->private_key_oid)
 1639              	 .loc 1 2044 0
 1640 005c A28A     	 ldrh r2,[r4,#20]
 1641              	.LVL169:
2045:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 1642              	 .loc 1 2045 0
 1643 005e B189     	 ldrh r1,[r6,#12]
 1644              	.LVL170:
 1645              	 .loc 1 2049 0
 1646 0060 1844     	 add r0,r0,r3
 1647 0062 0029     	 cmp r1,#0
 1648 0064 08BF     	 it eq
 1649 0066 1146     	 moveq r1,r2
 1650              	.LVL171:
 1651 0068 0D30     	 adds r0,r0,#13
 1652 006a FFF7FEFF 	 bl optiga_common_set_uint16
 1653              	.LVL172:
2050:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      private_key_oid);
2051:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 1654              	 .loc 1 2051 0
 1655 006e BDF80630 	 ldrh r3,[sp,#6]
2052:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2053:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // prepare apdu
2054:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_CALC_SIGN,
2055:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
2056:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSET),
2057:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
 1656              	 .loc 1 2057 0
 1657 0072 2268     	 ldr r2,[r4]
 1658              	.LVL173:
2054:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 1659              	 .loc 1 2054 0
 1660 0074 607E     	 ldrb r0,[r4,#25]
 1661              	.LVL174:
 1662              	.LBB152:
 1663              	.LBB153:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 1664              	 .loc 1 441 0
 1665 0076 D074     	 strb r0,[r2,#19]
 1666              	.LBE153:
 1667              	.LBE152:
2054:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 1668              	 .loc 1 2054 0
 1669 0078 D91F     	 subs r1,r3,#7
 1670 007a 89B2     	 uxth r1,r1
 1671              	.LVL175:
 1672              	.LBB155:
 1673              	.LBB154:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1674              	 .loc 1 440 0
 1675 007c B125     	 movs r5,#177
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1676              	 .loc 1 442 0
 1677 007e 080A     	 lsrs r0,r1,#8
 1678              	.LVL176:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1679              	 .loc 1 440 0
 1680 0080 9574     	 strb r5,[r2,#18]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1681              	 .loc 1 442 0
 1682 0082 1075     	 strb r0,[r2,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1683              	 .loc 1 443 0
 1684 0084 5175     	 strb r1,[r2,#21]
 1685              	.LBE154:
 1686              	.LBE155:
2058:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2059:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (index_for_data - OPTIGA_COMMS_DATA_OFFSET);
 1687              	 .loc 1 2059 0
 1688 0086 2268     	 ldr r2,[r4]
 1689              	.LVL177:
 1690 0088 033B     	 subs r3,r3,#3
 1691 008a 9380     	 strh r3,[r2,#4]
 1692              	.LVL178:
 1693              	.L169:
2060:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 1694              	 .loc 1 2060 0
 1695 008c 0020     	 movs r0,#0
2061:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2062:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
 1696              	 .loc 1 2062 0
 1697 008e 1CE0     	 b .L159
 1698              	.LVL179:
 1699              	.L161:
2063:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2064:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2065:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for calculate sign command...");
2066:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if the calculate signature command was successful
2067:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
 1700              	 .loc 1 2067 0
 1701 0090 0168     	 ldr r1,[r0]
 1702 0092 8D7C     	 ldrb r5,[r1,#18]
 1703 0094 85B9     	 cbnz r5,.L163
2068:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2069:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // if the received signature length is greater than the user provided signature buf
2070:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if ((*(p_optiga_ecdsa_sign->p_signature_length)) <
 1704              	 .loc 1 2070 0
 1705 0096 B368     	 ldr r3,[r6,#8]
2071:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     (me->p_optiga->comms_rx_size - OPTIGA_CMD_APDU_HEADER_SIZE))
 1706              	 .loc 1 2071 0
 1707 0098 CA88     	 ldrh r2,[r1,#6]
2070:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     (me->p_optiga->comms_rx_size - OPTIGA_CMD_APDU_HEADER_SIZE))
 1708              	 .loc 1 2070 0
 1709 009a 1888     	 ldrh r0,[r3]
 1710              	.LVL180:
 1711              	 .loc 1 2071 0
 1712 009c 043A     	 subs r2,r2,#4
2070:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     (me->p_optiga->comms_rx_size - OPTIGA_CMD_APDU_HEADER_SIZE))
 1713              	 .loc 1 2070 0
 1714 009e 9042     	 cmp r0,r2
 1715 00a0 03DA     	 bge .L164
2072:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2073:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Error in processing calculate sign response...");
2074:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_ecdsa_sign->p_signature_length) = 0x00;
 1716              	 .loc 1 2074 0
 1717 00a2 1D80     	 strh r5,[r3]
 1718              	.LVL181:
2075:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
 1719              	 .loc 1 2075 0
 1720 00a4 4FF40170 	 mov r0,#516
 1721 00a8 0FE0     	 b .L159
 1722              	.LVL182:
 1723              	.L164:
2076:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2077:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
2078:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2079:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_ecdsa_sign->p_signature_length) = me->p_optiga->comms_rx_size - OPTI
 1724              	 .loc 1 2079 0
 1725 00aa 92B2     	 uxth r2,r2
 1726 00ac 1A80     	 strh r2,[r3]
2080:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     //copy signed data from optiga comms buffer to user provided buffer
2081:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2082:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     pal_os_memcpy(p_optiga_ecdsa_sign->p_signature,
 1727              	 .loc 1 2082 0
 1728 00ae 7068     	 ldr r0,[r6,#4]
 1729 00b0 1631     	 adds r1,r1,#22
 1730 00b2 FFF7FEFF 	 bl pal_os_memcpy
 1731              	.LVL183:
 1732 00b6 E9E7     	 b .L169
 1733              	.LVL184:
 1734              	.L163:
2083:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET
2084:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   *(p_optiga_ecdsa_sign->p_signature_length));
2085:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Response of calculate sign command is processed...");
2086:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
2087:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2088:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2089:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
2090:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2091:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing calculate sign response...");
2092:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2093:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2094:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
 1735              	 .loc 1 2094 0
 1736 00b8 437F     	 ldrb r3,[r0,#29]
 1737 00ba 03F07F03 	 and r3,r3,#127
 1738 00be 4377     	 strb r3,[r0,#29]
2095:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_ecdsa_sign->p_signature_length) = 0x00;
 1739              	 .loc 1 2095 0
 1740 00c0 B368     	 ldr r3,[r6,#8]
 1741 00c2 0022     	 movs r2,#0
 1742 00c4 1A80     	 strh r2,[r3]
 1743              	.L168:
2008:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t private_key_oid;
 1744              	 .loc 1 2008 0
 1745 00c6 40F20220 	 movw r0,#514
 1746              	.LVL185:
 1747              	.L159:
2096:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2097:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2098:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2099:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
2100:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
2101:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2102:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2103:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
2104:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1748              	 .loc 1 2104 0
 1749 00ca 02B0     	 add sp,sp,#8
 1750              	.LCFI13:
 1751              	 .cfi_def_cfa_offset 16
 1752              	 
 1753 00cc 70BD     	 pop {r4,r5,r6,pc}
 1754              	 .cfi_endproc
 1755              	.LFE43:
 1757              	 .section .text.optiga_cmd_verify_sign_handler,"ax",%progbits
 1758              	 .align 1
 1759              	 .thumb
 1760              	 .thumb_func
 1762              	optiga_cmd_verify_sign_handler:
 1763              	.LFB45:
2105:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2106:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2107:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_calc_sign(optiga_cmd_t * me, uint8_t cmd_param, optiga_calc_sign_par
2108:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
2109:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR_INVALID_INPUT;
2110:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_sign_params_t * p_optiga_ecdsa_sign = (optiga_calc_sign_params_t*)params;
2111:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t cmd_handler_state = OPTIGA_CMD_EXEC_REQUEST_LOCK;
2112:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2113:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
2114:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2115:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecdsa_sign->private_key_oid)
2116:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2117:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_ZERO_LENGTH_OR_VALUE == me->session_oid)
2118:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2119:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2120:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2121:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             cmd_handler_state = OPTIGA_CMD_EXEC_REQUEST_SESSION;
2122:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2123:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2124:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2125:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_cmd_execute(me,
2126:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            cmd_param,
2127:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            optiga_cmd_calc_sign_handler,
2128:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2129:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            cmd_handler_state,
2130:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            params,
2131:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and 
2132:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_CALC_SIGN, OPTIGA_CMD_ZERO_LENGTH_OR
2133:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2134:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         return_status = OPTIGA_LIB_SUCCESS;
2135:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
2136:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
2137:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
2138:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //(OPTIGA_CRYPT_ECDSA_SIGN_ENABLED)
2139:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2140:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_ECDSA_VERIFY_ENABLED
2141:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
2142:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * VerifySign handler
2143:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
2144:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_verify_sign_handler(optiga_cmd_t * me)
2145:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 1764              	 .loc 1 2145 0
 1765              	 .cfi_startproc
 1766              	 
 1767              	 
 1768              	.LVL186:
 1769 0000 37B5     	 push {r0,r1,r2,r4,r5,lr}
 1770              	.LCFI14:
 1771              	 .cfi_def_cfa_offset 24
 1772              	 .cfi_offset 4,-12
 1773              	 .cfi_offset 5,-8
 1774              	 .cfi_offset 14,-4
2146:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
2147:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_verify_sign_params_t * p_optiga_verify_sign = (optiga_verify_sign_params_t *)me->p_input
2148:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 1775              	 .loc 1 2148 0
 1776 0002 0923     	 movs r3,#9
 1777 0004 ADF80630 	 strh r3,[sp,#6]
2149:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
2150:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2151:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 1778              	 .loc 1 2151 0
 1779 0008 837D     	 ldrb r3,[r0,#22]
2147:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 1780              	 .loc 1 2147 0
 1781 000a 8568     	 ldr r5,[r0,#8]
 1782              	.LVL187:
 1783              	 .loc 1 2151 0
 1784 000c 022B     	 cmp r3,#2
2145:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 1785              	 .loc 1 2145 0
 1786 000e 0446     	 mov r4,r0
 1787              	 .loc 1 2151 0
 1788 0010 03D0     	 beq .L172
 1789 0012 032B     	 cmp r3,#3
 1790 0014 00F09480 	 beq .L173
 1791 0018 9AE0     	 b .L181
 1792              	.L172:
 1793 001a AB89     	 ldrh r3,[r5,#12]
2152:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2153:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2154:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2155:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending verify sign command..");
2156:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // APDU header length + TLV of digest + TLV of signature +
2157:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // If public key from OID (TLV of public key OID)
2158:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // If public key from host (TLV of algo ID + TLV of public key)
2159:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_TAG_LENGTH_SIZE + p_optiga
 1794              	 .loc 1 2159 0
 1795 001c 2979     	 ldrb r1,[r5,#4]
 1796 001e 0A33     	 adds r3,r3,#10
 1797 0020 9AB2     	 uxth r2,r3
 1798 0022 AB7B     	 ldrb r3,[r5,#14]
 1799 0024 23B1     	 cbz r3,.L178
2160:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
2161:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CRYPT_OID_DATA == p_optiga_verify_sign->public_key_sour
2162:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      (OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES)
2163:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
2164:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      p_optiga_verify_sign->public_key->length));
 1800              	 .loc 1 2164 0 discriminator 1
 1801 0026 2B69     	 ldr r3,[r5,#16]
2159:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 1802              	 .loc 1 2159 0 discriminator 1
 1803 0028 9B88     	 ldrh r3,[r3,#4]
 1804 002a 0933     	 adds r3,r3,#9
 1805 002c 98B2     	 uxth r0,r3
 1806              	.LVL188:
 1807 002e 00E0     	 b .L174
 1808              	.LVL189:
 1809              	.L178:
2159:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 1810              	 .loc 1 2159 0 is_stmt 0
 1811 0030 0520     	 movs r0,#5
 1812              	.LVL190:
 1813              	.L174:
 1814 0032 5318     	 adds r3,r2,r1
2159:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 1815              	 .loc 1 2159 0 discriminator 4
 1816 0034 0344     	 add r3,r3,r0
2165:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
 1817              	 .loc 1 2165 0 is_stmt 1 discriminator 4
 1818 0036 9BB2     	 uxth r3,r3
 1819 0038 40F21562 	 movw r2,#1557
 1820              	.LVL191:
 1821 003c 9342     	 cmp r3,r2
 1822 003e 00F28A80 	 bhi .L179
2166:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2167:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2168:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2169:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2170:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //TLV formation for digest
2171:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_SIGN_DIGEST_TAG,
2172:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->digest_length,
2173:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
 1823              	 .loc 1 2173 0
 1824 0042 2268     	 ldr r2,[r4]
2171:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->digest_length,
 1825              	 .loc 1 2171 0
 1826 0044 0120     	 movs r0,#1
 1827 0046 0D32     	 adds r2,r2,#13
 1828 0048 0DF10603 	 add r3,sp,#6
 1829 004c FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 1830              	.LVL192:
2174:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2175:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2176:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
 1831              	 .loc 1 2176 0
 1832 0050 BDF80630 	 ldrh r3,[sp,#6]
 1833 0054 2068     	 ldr r0,[r4]
 1834 0056 2968     	 ldr r1,[r5]
 1835 0058 2A79     	 ldrb r2,[r5,#4]
 1836 005a 1844     	 add r0,r0,r3
 1837 005c 0D30     	 adds r0,r0,#13
 1838 005e FFF7FEFF 	 bl pal_os_memcpy
 1839              	.LVL193:
2177:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->p_digest,
2178:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->digest_length);
2179:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_verify_sign->digest_length;
 1840              	 .loc 1 2179 0
 1841 0062 2A79     	 ldrb r2,[r5,#4]
 1842 0064 BDF80630 	 ldrh r3,[sp,#6]
2180:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2181:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //TLV formation for signature
2182:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_SIGN_SIGNATURE_TAG,
 1843              	 .loc 1 2182 0
 1844 0068 A989     	 ldrh r1,[r5,#12]
2179:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1845              	 .loc 1 2179 0
 1846 006a 1344     	 add r3,r3,r2
2183:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->signature_length,
2184:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
 1847              	 .loc 1 2184 0
 1848 006c 2268     	 ldr r2,[r4]
2179:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1849              	 .loc 1 2179 0
 1850 006e ADF80630 	 strh r3,[sp,#6]
2182:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->signature_length,
 1851              	 .loc 1 2182 0
 1852 0072 0220     	 movs r0,#2
 1853 0074 0D32     	 adds r2,r2,#13
 1854 0076 0DF10603 	 add r3,sp,#6
 1855 007a FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 1856              	.LVL194:
2185:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2186:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2187:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
 1857              	 .loc 1 2187 0
 1858 007e BDF80630 	 ldrh r3,[sp,#6]
 1859 0082 2068     	 ldr r0,[r4]
 1860 0084 AA89     	 ldrh r2,[r5,#12]
 1861 0086 A968     	 ldr r1,[r5,#8]
 1862 0088 1844     	 add r0,r0,r3
 1863 008a 0D30     	 adds r0,r0,#13
 1864 008c FFF7FEFF 	 bl pal_os_memcpy
 1865              	.LVL195:
2188:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->p_signature,
2189:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->signature_length);
2190:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_verify_sign->signature_length;
 1866              	 .loc 1 2190 0
 1867 0090 AA89     	 ldrh r2,[r5,#12]
 1868 0092 BDF80630 	 ldrh r3,[sp,#6]
 1869 0096 1344     	 add r3,r3,r2
 1870 0098 ADF80630 	 strh r3,[sp,#6]
2191:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2192:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CRYPT_OID_DATA == p_optiga_verify_sign->public_key_source_type)
 1871              	 .loc 1 2192 0
 1872 009c AB7B     	 ldrb r3,[r5,#14]
 1873 009e 2268     	 ldr r2,[r4]
 1874 00a0 93B9     	 cbnz r3,.L175
2193:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2194:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //TLV formation for public key certificate OID
2195:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_TAG,
 1875              	 .loc 1 2195 0
 1876 00a2 0420     	 movs r0,#4
 1877 00a4 0221     	 movs r1,#2
 1878 00a6 0D32     	 adds r2,r2,#13
 1879 00a8 0DF10603 	 add r3,sp,#6
 1880 00ac FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 1881              	.LVL196:
2196:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_LENGTH,
2197:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2198:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
2199:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2200:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 1882              	 .loc 1 2200 0
 1883 00b0 BDF80630 	 ldrh r3,[sp,#6]
 1884 00b4 2068     	 ldr r0,[r4]
 1885 00b6 A98A     	 ldrh r1,[r5,#20]
 1886 00b8 1844     	 add r0,r0,r3
 1887 00ba 0D30     	 adds r0,r0,#13
 1888 00bc FFF7FEFF 	 bl optiga_common_set_uint16
 1889              	.LVL197:
2201:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          p_optiga_verify_sign->certificate_oid);
2202:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 1890              	 .loc 1 2202 0
 1891 00c0 BDF80630 	 ldrh r3,[sp,#6]
 1892 00c4 0233     	 adds r3,r3,#2
 1893 00c6 28E0     	 b .L182
 1894              	.L175:
2203:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2204:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
2205:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2206:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //TLV formation for public key from host
2207:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_ALGO_ID_TAG,
 1895              	 .loc 1 2207 0
 1896 00c8 0520     	 movs r0,#5
 1897 00ca 0121     	 movs r1,#1
 1898 00cc 0D32     	 adds r2,r2,#13
 1899 00ce 0DF10603 	 add r3,sp,#6
 1900 00d2 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 1901              	.LVL198:
2208:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_VERIFY_ALGO_ID_LENGTH,
2209:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2210:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
2211:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2212:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data++) = (uint8_t)p_optiga_verify_
 1902              	 .loc 1 2212 0
 1903 00d6 BDF80630 	 ldrh r3,[sp,#6]
 1904 00da 2168     	 ldr r1,[r4]
 1905 00dc 5A1C     	 adds r2,r3,#1
 1906 00de ADF80620 	 strh r2,[sp,#6]
 1907 00e2 2A69     	 ldr r2,[r5,#16]
 1908 00e4 0B44     	 add r3,r3,r1
 1909 00e6 9279     	 ldrb r2,[r2,#6]
 1910 00e8 5A73     	 strb r2,[r3,#13]
2213:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2214:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_PUBLIC_KEY_TAG,
 1911              	 .loc 1 2214 0
 1912 00ea 2B69     	 ldr r3,[r5,#16]
2215:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               p_optiga_verify_sign->public_key->length,
2216:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
 1913              	 .loc 1 2216 0
 1914 00ec 2268     	 ldr r2,[r4]
2214:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               p_optiga_verify_sign->public_key->length,
 1915              	 .loc 1 2214 0
 1916 00ee 9988     	 ldrh r1,[r3,#4]
 1917 00f0 0620     	 movs r0,#6
 1918 00f2 0DEB0003 	 add r3,sp,r0
 1919 00f6 0D32     	 adds r2,r2,#13
 1920 00f8 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 1921              	.LVL199:
2217:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
2218:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2219:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
 1922              	 .loc 1 2219 0
 1923 00fc BDF80630 	 ldrh r3,[sp,#6]
 1924 0100 2068     	 ldr r0,[r4]
2220:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_verify_sign->public_key->public_key,
 1925              	 .loc 1 2220 0
 1926 0102 2A69     	 ldr r2,[r5,#16]
2219:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_verify_sign->public_key->public_key,
 1927              	 .loc 1 2219 0
 1928 0104 1844     	 add r0,r0,r3
 1929 0106 1168     	 ldr r1,[r2]
 1930 0108 9288     	 ldrh r2,[r2,#4]
 1931 010a 0D30     	 adds r0,r0,#13
 1932 010c FFF7FEFF 	 bl pal_os_memcpy
 1933              	.LVL200:
2221:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_verify_sign->public_key->length);
2222:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += p_optiga_verify_sign->public_key->length;
 1934              	 .loc 1 2222 0
 1935 0110 2B69     	 ldr r3,[r5,#16]
 1936 0112 9A88     	 ldrh r2,[r3,#4]
 1937 0114 BDF80630 	 ldrh r3,[sp,#6]
 1938 0118 1344     	 add r3,r3,r2
 1939              	.L182:
 1940 011a ADF80630 	 strh r3,[sp,#6]
2223:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2224:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2225:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //form apdu header
2226:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_VERIFY_SIGN,
 1941              	 .loc 1 2226 0
 1942 011e BDF80630 	 ldrh r3,[sp,#6]
2227:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
2228:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSE
2229:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
 1943              	 .loc 1 2229 0
 1944 0122 2268     	 ldr r2,[r4]
 1945              	.LVL201:
2226:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 1946              	 .loc 1 2226 0
 1947 0124 607E     	 ldrb r0,[r4,#25]
 1948              	.LVL202:
 1949              	.LBB156:
 1950              	.LBB157:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 1951              	 .loc 1 441 0
 1952 0126 D074     	 strb r0,[r2,#19]
 1953              	.LBE157:
 1954              	.LBE156:
2226:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 1955              	 .loc 1 2226 0
 1956 0128 A3F10901 	 sub r1,r3,#9
 1957 012c 89B2     	 uxth r1,r1
 1958              	.LVL203:
 1959              	.LBB159:
 1960              	.LBB158:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1961              	 .loc 1 440 0
 1962 012e B225     	 movs r5,#178
 1963              	.LVL204:
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1964              	 .loc 1 442 0
 1965 0130 080A     	 lsrs r0,r1,#8
 1966              	.LVL205:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 1967              	 .loc 1 440 0
 1968 0132 9574     	 strb r5,[r2,#18]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 1969              	 .loc 1 442 0
 1970 0134 1075     	 strb r0,[r2,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 1971              	 .loc 1 443 0
 1972 0136 5175     	 strb r1,[r2,#21]
 1973              	.LBE158:
 1974              	.LBE159:
2230:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2231:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (uint16_t)(index_for_data - OPTIGA_COMMS_DATA_OFFSET);
 1975              	 .loc 1 2231 0
 1976 0138 2268     	 ldr r2,[r4]
 1977              	.LVL206:
 1978 013a 053B     	 subs r3,r3,#5
 1979 013c 9380     	 strh r3,[r2,#4]
 1980              	.LVL207:
 1981 013e 0DE0     	 b .L180
 1982              	.LVL208:
 1983              	.L173:
2232:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2233:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2234:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2235:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2236:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2237:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2238:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for verify sign command...");
2239:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_FAILURE == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
 1984              	 .loc 1 2239 0
 1985 0140 0368     	 ldr r3,[r0]
 1986 0142 9B7C     	 ldrb r3,[r3,#18]
 1987 0144 FF2B     	 cmp r3,#255
 1988 0146 09D1     	 bne .L180
2240:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2241:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing verify sign response...");
2242:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2243:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2244:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
 1989              	 .loc 1 2244 0
 1990 0148 437F     	 ldrb r3,[r0,#29]
 1991 014a 03F07F03 	 and r3,r3,#127
 1992 014e 4377     	 strb r3,[r0,#29]
 1993              	.L181:
2149:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 1994              	 .loc 1 2149 0
 1995 0150 40F20220 	 movw r0,#514
 1996              	.LVL209:
 1997 0154 03E0     	 b .L171
 1998              	.L179:
2167:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 1999              	 .loc 1 2167 0
 2000 0156 4FF40170 	 mov r0,#516
 2001 015a 00E0     	 b .L171
 2002              	.LVL210:
 2003              	.L180:
2245:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2246:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2247:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of veriy sign command is processed...");
2248:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 2004              	 .loc 1 2248 0
 2005 015c 0020     	 movs r0,#0
 2006              	.L171:
 2007              	.LVL211:
2249:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2250:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2251:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
2252:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
2253:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2254:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2255:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
2256:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 2008              	 .loc 1 2256 0
 2009 015e 03B0     	 add sp,sp,#12
 2010              	.LCFI15:
 2011              	 .cfi_def_cfa_offset 12
 2012              	 
 2013 0160 30BD     	 pop {r4,r5,pc}
 2014              	 .cfi_endproc
 2015              	.LFE45:
 2017              	 .section .text.optiga_cmd_set_object_protected_handler,"ax",%progbits
 2018              	 .align 1
 2019              	 .thumb
 2020              	 .thumb_func
 2022              	optiga_cmd_set_object_protected_handler:
 2023              	.LFB52:
2257:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2258:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_verify_sign(optiga_cmd_t * me,
2259:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            uint8_t cmd_param,
2260:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            optiga_verify_sign_params_t * params)
2261:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
2262:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2263:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
2264:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        cmd_param,
2265:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_verify_sign_handler,
2266:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2267:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
2268:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        params,
2269:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
2270:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_VERIFY_SIGN, OPTIGA_CMD_ZERO_LENGTH_OR_V
2271:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2272:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
2273:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
2274:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_ECDSA_VERIFY_ENABLED
2275:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2276:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED
2277:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
2278:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * GenKeyPair handler
2279:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
2280:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_gen_keypair_handler(optiga_cmd_t * me)
2281:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
2282:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
2283:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_gen_keypair_params_t * p_optiga_ecc_gen_keypair = (optiga_gen_keypair_params_t *)me->p_i
2284:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t header_offset;
2285:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t private_key_length;
2286:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
2287:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t out_data_size;
2288:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t public_key_length;
2289:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
2290:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2291:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
2292:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2293:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2294:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2295:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending generate keypair command..");
2296:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // APDU header length +
2297:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // If private key option to store in OID (TLV of private key + TLV of key usages)
2298:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // If private key option to export (TLV of export key pair)
2299:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE +
2300:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     (FALSE == p_optiga_ecc_gen_keypair->export_private_key ?
2301:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
2302:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CMD_TAG_LENGTH_SIZE ));
2303:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
2304:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2305:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2306:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *p_optiga_ecc_gen_keypair->public_key_length = 0;
2307:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2308:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2309:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (FALSE == p_optiga_ecc_gen_keypair->export_private_key)
2310:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2311:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for private key OID
2312:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header (OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_TAG,
2313:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_LENGTH,
2314:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                me->p_optiga->optiga_comms_buffer,
2315:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
2316:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///Update OID based on input param
2317:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2318:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
2319:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          me->session_oid:(uint16_t)p_optiga_ecc_gen_keypair->privat
2320:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2321:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2322:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for key usage
2323:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header (OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_TAG,
2324:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_LENGTH,
2325:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                me->p_optiga->optiga_comms_buffer,
2326:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
2327:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2328:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data++) = p_optiga_ecc_gen_keypair-
2329:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2330:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
2331:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2332:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for export key
2333:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header (OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_TAG,
2334:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_LENGTH,
2335:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                me->p_optiga->optiga_comms_buffer,
2336:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
2337:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2338:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2339:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //form apdu header
2340:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_GEN_KEYPAIR, me->cmd_param,
2341:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                             (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFS
2342:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OFFSET);
2343:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2344:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (uint16_t)(index_for_data - OPTIGA_COMMS_DATA_OFFSET);
2345:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2346:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2347:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2348:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2349:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2350:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2351:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for generate keypair command...");
2352:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if the write was successful
2353:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_FAILURE == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
2354:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2355:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing generate keypair response...");
2356:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *p_optiga_ecc_gen_keypair->public_key_length = 0;
2357:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2358:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2359:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
2360:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2361:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2362:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             header_offset = 0;
2363:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFS
2364:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      &out_data_size);
2365:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2366:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             while (out_data_size > header_offset)
2367:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2368:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_CMD_GEN_KEY_PAIR_PUBLIC_KEY_TAG ==
2369:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + header_offset
2370:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2371:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_IND
2372:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                 header_offset + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &pu
2373:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     if (public_key_length > *p_optiga_ecc_gen_keypair->public_key_length)
2374:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     {
2375:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         OPTIGA_CMD_LOG_MESSAGE("Error in processing generate keypair response...");
2376:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2377:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         *p_optiga_ecc_gen_keypair->public_key_length = 0;
2378:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         break;
2379:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     }
2380:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     *p_optiga_ecc_gen_keypair->public_key_length = public_key_length;
2381:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     pal_os_memcpy(p_optiga_ecc_gen_keypair->public_key,
2382:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
2383:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                    OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_NO_OF_BYTES_IN_TAG]
2384:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                    *p_optiga_ecc_gen_keypair->public_key_length);
2385:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     header_offset +=  (uint16_t)OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_B
2386:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                         *p_optiga_ecc_gen_keypair->public_key_length;
2387:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
2388:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2389:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else if (OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_TAG == me->p_optiga->optiga_comms_buff
2390:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                              header_offset])
2391:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2392:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_IND
2393:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                              + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &private_key_length)
2394:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2395:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     pal_os_memcpy(p_optiga_ecc_gen_keypair->private_key,
2396:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
2397:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TAG], 
2398:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     header_offset +=  OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TA
2399:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
2400:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2401:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 else
2402:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2403:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
2404:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2405:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2406:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of generate keypair command is processed...");
2407:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2408:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2409:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
2410:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
2411:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2412:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2413:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
2414:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
2415:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2416:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_gen_keypair(optiga_cmd_t * me, uint8_t cmd_param, optiga_gen_keypair
2417:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
2418:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_gen_keypair_params_t * p_optiga_ecc_gen_keypair = (optiga_gen_keypair_params_t*)params;
2419:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2420:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2421:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair->private_key_oid)
2422:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         && (FALSE == p_optiga_ecc_gen_keypair->export_private_key))
2423:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2424:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_cmd_execute(me,
2425:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            cmd_param,
2426:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            optiga_cmd_gen_keypair_handler,
2427:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2428:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_REQUEST_SESSION,
2429:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            params,
2430:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and 
2431:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_GEN_KEYPAIR, OPTIGA_CMD_ZERO_LENGTH_
2432:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2433:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     else
2434:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2435:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_cmd_execute(me,
2436:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            cmd_param,
2437:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            optiga_cmd_gen_keypair_handler,
2438:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2439:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_REQUEST_LOCK,
2440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            params,
2441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and 
2442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_GEN_KEYPAIR, OPTIGA_CMD_ZERO_LENGTH_
2443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2444:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2445:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
2446:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
2447:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED
2448:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2449:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_HASH_ENABLED
2450:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2451:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_calc_hash_set_current_hash_sequence(const optiga_cmd_t * me)
2452:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
2453:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t *)me->p_input;
2454:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint32_t apparent_comms_buffer_size = (OPTIGA_MAX_COMMS_BUFFER_SIZE - (OPTIGA_CMD_APDU_INDATA_O
2455:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           + OPTIGA_CMD_INTERMEDIATE_CONTEXT_HEADER));
2456:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2457:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_optiga_calc_hash->current_hash_sequence = p_optiga_calc_hash->hash_sequence;
2458:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2459:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // Check for hash sequence as S&F
2460:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if(OPTIGA_CRYPT_HASH_START_FINAL == p_optiga_calc_hash->hash_sequence)
2461:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2462:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Calculate the apparent comms buffer size and compare with hash data length
2463:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if(apparent_comms_buffer_size < p_optiga_calc_hash->p_hash_data->length)
2464:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2465:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // sent data is 0 hence change the hash sequence to S
2466:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if( 0 == p_optiga_calc_hash->data_sent)
2467:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2468:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->current_hash_sequence = OPTIGA_CRYPT_HASH_START;
2469:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2470:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // sent data is greater than 0 and next fragment is greater than apparent_comms_buffer_
2471:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else if((p_optiga_calc_hash->data_sent + apparent_comms_buffer_size) < p_optiga_calc_ha
2472:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2473:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->current_hash_sequence = OPTIGA_CRYPT_HASH_CONTINUE;
2474:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // sent data is greater than 0 and next fragment is less than apparent_comms_buffer_siz
2476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
2477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->current_hash_sequence = OPTIGA_CRYPT_HASH_FINAL;
2479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
2483:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2484:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
2485:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * CalCHash handler
2486:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
2487:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_calc_hash_handler(optiga_cmd_t * me)
2488:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
2489:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t *)me->p_input;
2490:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
2491:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t out_data_size;
2492:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint32_t length_to_hash;
2493:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
2494:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2495:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2496:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
2497:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2498:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2499:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2500:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_calc_hash_set_current_hash_sequence(me);
2501:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending calculate hash command..");
2502:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Hash Input
2503:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // tag setting
2504:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->chaining_ongoing = FALSE;
2505:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2506:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // add data if available
2507:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (NULL != p_optiga_calc_hash->p_hash_data)
2508:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2509:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                  //lint --e{734} suppress "length_to_hash parameter is of uint16 type, while the ar
2510:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                  //calculating are of uint32 type. The final value calculated never crosses uint16 
2511:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                  // future use case, explicit type-casting is not done "
2512:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 length_to_hash = MIN(((OPTIGA_MAX_COMMS_BUFFER_SIZE - (index_for_data + OPTIGA_CMD_
2513:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                        p_optiga_calc_hash->apparent_context_size),(p_optiga_calc_ha
2514:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2515:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data++) = p_optiga_calc_hash->curre
2516:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2517:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // add length
2518:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), leng
2519:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2520:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2521:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2522:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_data->buffer + p_optiga_calc_hash->data_se
2523:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               length_to_hash);
2524:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += length_to_hash;
2525:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2526:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->data_sent += length_to_hash;
2527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_calc_hash->data_sent != p_optiga_calc_hash->p_hash_data->length)
2528:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2529:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->chaining_ongoing = TRUE;
2530:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2531:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2532:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else if (NULL != p_optiga_calc_hash->p_hash_oid)
2533:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2534:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //OID data
2535:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(p_optiga_calc_hash->current_hash_sequence,
2536:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_OID_DATA_LENGTH,
2537:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2538:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               (uint16_t*)&index_for_data);
2539:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2540:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2541:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->oid);
2542:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2543:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2544:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->offset);
2545:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2546:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2547:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->length);
2548:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2549:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2550:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
2551:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2552:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // Tag header in case of sequence as START
2553:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header (p_optiga_calc_hash->current_hash_sequence,
2554:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
2555:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                me->p_optiga->optiga_comms_buffer,
2556:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                (uint16_t*)&index_for_data);
2557:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2558:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Hash Context
2559:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if ((NULL != p_optiga_calc_hash->p_hash_context) &&
2560:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (0 != p_optiga_calc_hash->apparent_context_size))
2561:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2562:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data++) = OPTIGA_CRYPT_INTERMEDIATE
2563:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2564:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           (uint16_t )p_optiga_calc_hash->p_hash_context->context_bu
2565:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2566:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2568:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_context->context_buffer,
2569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               (uint16_t)p_optiga_calc_hash->p_hash_context->context_buffer_length);
2570:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2571:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += (uint16_t)p_optiga_calc_hash->p_hash_context->context_buffer_leng
2572:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->apparent_context_size = 0;
2573:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2574:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2575:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Export Option
2576:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if((TRUE == p_optiga_calc_hash->export_hash_ctx) && (FALSE == me->chaining_ongoing))
2577:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2578:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(OPTIGA_CRYPT_HASH_CONTX_OUT,
2579:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
2580:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2581:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               (uint16_t*)&index_for_data);
2582:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2583:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2584:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //form apdu header
2585:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_CALC_HASH,
2586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
2587:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSE
2588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
2589:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2590:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (uint16_t)(index_for_data - OPTIGA_COMMS_DATA_OFFSET);
2591:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2592:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2593:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2594:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2595:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2596:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for calculate hash command...");
2597:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check for response status code
2598:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_FAILURE == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
2599:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2600:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing calculate hash response...");
2601:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2602:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2603:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
2604:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2605:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2606:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // Copy the digest to buffer, if chaining is false and digest out buffer is not NULL
2607:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if((FALSE == me->chaining_ongoing) && (NULL != p_optiga_calc_hash->p_out_digest))
2608:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2609:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // If the out data tag is not the digest out then return failure
2610:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_CRYPT_HASH_START_FINAL != me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_A
2611:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2612:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                    break;
2613:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2614:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_
2615:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &out_data_size);
2616:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2617:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(p_optiga_calc_hash->p_out_digest,
2618:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
2619:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               OPTIGA_CMD_NO_OF_BYTES_IN_TAG], out_data_size);
2620:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2621:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // Copy the intermediate hash context
2622:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else if ((TRUE == p_optiga_calc_hash->export_hash_ctx) && (FALSE == me->chaining_ongoin
2623:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2624:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 // If the out data tag is not the intermediate tag then return failure
2625:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_CRYPT_INTERMEDIATE != me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_
2626:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2627:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
2628:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2629:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2630:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_
2631:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &out_data_size);
2632:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_calc_hash->p_hash_context->context_buffer_length < out_data_size)
2633:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
2634:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Error in processing calculate hash response...");
2635:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2636:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
2637:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
2638:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2639:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(p_optiga_calc_hash->p_hash_context->context_buffer,
2640:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
2641:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               OPTIGA_CMD_NO_OF_BYTES_IN_TAG], out_data_size);
2642:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->p_hash_context->context_buffer_length = out_data_size;
2643:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2644:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of calculate hash command is processed...");
2645:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2646:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2647:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2648:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
2649:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
2650:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2651:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2652:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
2653:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
2654:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2655:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_calc_hash(optiga_cmd_t * me,
2656:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          uint8_t cmd_param,
2657:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          optiga_calc_hash_params_t * params)
2658:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
2659:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t*)params;
2660:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2661:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2662:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_optiga_calc_hash->data_sent = 0;
2663:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2664:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
2665:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        cmd_param,
2666:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_calc_hash_handler,
2667:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2668:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
2669:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        params,
2670:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
2671:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_CALC_HASH, OPTIGA_CMD_ZERO_LENGTH_OR_VAL
2672:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2673:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
2674:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
2675:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_HASH_ENABLED
2676:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2677:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** /*
2678:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** * Set Data Object handler for protected update
2679:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** */
2680:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_set_object_protected_handler(optiga_cmd_t * me)
2681:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 2024              	 .loc 1 2681 0
 2025              	 .cfi_startproc
 2026              	 
 2027              	 
 2028              	.LVL212:
 2029 0000 73B5     	 push {r0,r1,r4,r5,r6,lr}
 2030              	.LCFI16:
 2031              	 .cfi_def_cfa_offset 24
 2032              	 .cfi_offset 4,-16
 2033              	 .cfi_offset 5,-12
 2034              	 .cfi_offset 6,-8
 2035              	 .cfi_offset 14,-4
2682:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
2683:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_set_object_protected_params_t * p_optiga_write_protected_data = (optiga_set_object_prote
2684:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
2685:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 2036              	 .loc 1 2685 0
 2037 0002 0923     	 movs r3,#9
 2038 0004 ADF80630 	 strh r3,[sp,#6]
2686:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2687:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 2039              	 .loc 1 2687 0
 2040 0008 837D     	 ldrb r3,[r0,#22]
2683:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 2041              	 .loc 1 2683 0
 2042 000a 8668     	 ldr r6,[r0,#8]
 2043              	.LVL213:
 2044              	 .loc 1 2687 0
 2045 000c 022B     	 cmp r3,#2
2681:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 2046              	 .loc 1 2681 0
 2047 000e 0546     	 mov r5,r0
 2048              	 .loc 1 2687 0
 2049 0010 02D0     	 beq .L185
 2050 0012 032B     	 cmp r3,#3
 2051 0014 2FD0     	 beq .L186
 2052 0016 45E0     	 b .L191
 2053              	.L185:
2688:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2689:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2690:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2691:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending set data object command..");
2692:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->chaining_ongoing = FALSE;
 2054              	 .loc 1 2692 0
 2055 0018 0024     	 movs r4,#0
 2056 001a 0476     	 strb r4,[r0,#24]
2693:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2694:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // APDU header size + Set Object protected tag 1 bytes + length of buffer 2 bytes + siz
2695:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_NO_OF_BYTES_IN_TAG + OPTIG
2696:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                 p_optiga_write_protected_data->p_protected_update_buffer_length;
 2057              	 .loc 1 2696 0
 2058 001c B188     	 ldrh r1,[r6,#4]
 2059              	.LVL214:
2695:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                 p_optiga_write_protected_data->p_protected_update_buffer_length;
 2060              	 .loc 1 2695 0
 2061 001e CB1D     	 adds r3,r1,#7
2697:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
 2062              	 .loc 1 2697 0
 2063 0020 9BB2     	 uxth r3,r3
 2064 0022 40F21562 	 movw r2,#1557
 2065 0026 9342     	 cmp r3,r2
 2066 0028 3FD8     	 bhi .L190
2698:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2699:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2700:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2701:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2702:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2703:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // Copy the tag and protected length
2704:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header((OPTIGA_CMD_SET_OBJECT_PROTECTED_TAG |
 2067              	 .loc 1 2704 0
 2068 002a B079     	 ldrb r0,[r6,#6]
 2069              	.LVL215:
2705:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (uint8_t)p_optiga_write_protected_data->set_obj_protecte
2706:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_write_protected_data->p_protected_update_buffer_
2707:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
 2070              	 .loc 1 2707 0
 2071 002c 2A68     	 ldr r2,[r5]
2704:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (uint8_t)p_optiga_write_protected_data->set_obj_protecte
 2072              	 .loc 1 2704 0
 2073 002e 40F03000 	 orr r0,r0,#48
 2074 0032 0D32     	 adds r2,r2,#13
 2075 0034 0DF10603 	 add r3,sp,#6
 2076 0038 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 2077              	.LVL216:
2708:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2709:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // data to be written
2710:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
 2078              	 .loc 1 2710 0
 2079 003c BDF80630 	 ldrh r3,[sp,#6]
 2080 0040 2868     	 ldr r0,[r5]
 2081 0042 3168     	 ldr r1,[r6]
 2082 0044 B288     	 ldrh r2,[r6,#4]
 2083 0046 1844     	 add r0,r0,r3
 2084 0048 0D30     	 adds r0,r0,#13
 2085 004a FFF7FEFF 	 bl pal_os_memcpy
 2086              	.LVL217:
2711:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_optiga_write_protected_data->p_protected_update_buffer,
2712:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           p_optiga_write_protected_data->p_protected_update_buffer_length);
2713:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2714:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_write_protected_data->p_protected_update_buffer_length;
 2087              	 .loc 1 2714 0
 2088 004e B288     	 ldrh r2,[r6,#4]
 2089 0050 BDF80630 	 ldrh r3,[sp,#6]
2715:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // prepare apdu
2716:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_SET_OBJECT_PROTECTED,
 2090              	 .loc 1 2716 0
 2091 0054 687E     	 ldrb r0,[r5,#25]
2714:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // prepare apdu
 2092              	 .loc 1 2714 0
 2093 0056 1344     	 add r3,r3,r2
 2094 0058 9BB2     	 uxth r3,r3
2717:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
2718:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSET),
2719:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
 2095              	 .loc 1 2719 0
 2096 005a 2A68     	 ldr r2,[r5]
 2097              	.LVL218:
2716:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 2098              	 .loc 1 2716 0
 2099 005c A3F10901 	 sub r1,r3,#9
 2100 0060 89B2     	 uxth r1,r1
 2101              	.LVL219:
 2102              	.LBB160:
 2103              	.LBB161:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 2104              	 .loc 1 441 0
 2105 0062 D074     	 strb r0,[r2,#19]
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 2106              	 .loc 1 440 0
 2107 0064 8326     	 movs r6,#131
 2108              	.LVL220:
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 2109              	 .loc 1 442 0
 2110 0066 080A     	 lsrs r0,r1,#8
 2111              	.LVL221:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 2112              	 .loc 1 440 0
 2113 0068 9674     	 strb r6,[r2,#18]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 2114              	 .loc 1 442 0
 2115 006a 1075     	 strb r0,[r2,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 2116              	 .loc 1 443 0
 2117 006c 5175     	 strb r1,[r2,#21]
 2118              	.LBE161:
 2119              	.LBE160:
2720:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2721:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (index_for_data - OPTIGA_COMMS_DATA_OFFSET);
 2120              	 .loc 1 2721 0
 2121 006e 2A68     	 ldr r2,[r5]
 2122              	.LVL222:
 2123 0070 053B     	 subs r3,r3,#5
 2124 0072 9380     	 strh r3,[r2,#4]
 2125              	.LVL223:
 2126 0074 14E0     	 b .L192
 2127              	.LVL224:
 2128              	.L186:
2722:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2723:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2724:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2725:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2726:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2727:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2728:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2729:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for set data object data command...");
2730:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             // check if the write was successful
2731:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
 2129              	 .loc 1 2731 0
 2130 0076 0268     	 ldr r2,[r0]
 2131 0078 947C     	 ldrb r4,[r2,#18]
 2132 007a 24B1     	 cbz r4,.L187
2732:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2733:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing set data object response...");
2734:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2735:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2736:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
 2133              	 .loc 1 2736 0
 2134 007c 437F     	 ldrb r3,[r0,#29]
 2135 007e 03F07F03 	 and r3,r3,#127
 2136 0082 4377     	 strb r3,[r0,#29]
 2137 0084 0EE0     	 b .L191
 2138              	.L187:
2737:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
2738:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2739:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_SET_PROTECTED_UPDATE_FINAL == p_optiga_write_protected_data->set_obj_protect
 2139              	 .loc 1 2739 0
 2140 0086 B379     	 ldrb r3,[r6,#6]
 2141 0088 012B     	 cmp r3,#1
 2142 008a 02D1     	 bne .L188
2740:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2741:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_RELEASE_LOCK;
 2143              	 .loc 1 2741 0
 2144 008c 0B23     	 movs r3,#11
 2145 008e C375     	 strb r3,[r0,#23]
 2146 0090 06E0     	 b .L192
 2147              	.L188:
2742:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2743:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             else
2744:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
2745:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_STATE_EXIT;
 2148              	 .loc 1 2745 0
 2149 0092 0C23     	 movs r3,#12
 2150 0094 C375     	 strb r3,[r0,#23]
2746:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 pal_os_event_start(me->p_optiga->p_pal_os_event_ctx, optiga_cmd_queue_scheduler, me
 2151              	 .loc 1 2746 0
 2152 0096 0749     	 ldr r1,.L193
 2153 0098 D2F87806 	 ldr r0,[r2,#1656]
 2154              	.LVL225:
 2155 009c FFF7FEFF 	 bl pal_os_event_start
 2156              	.LVL226:
 2157              	.L192:
2747:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
2748:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of set data object command is processed...");
2749:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 2158              	 .loc 1 2749 0
 2159 00a0 2046     	 mov r0,r4
 2160 00a2 04E0     	 b .L184
 2161              	.LVL227:
 2162              	.L191:
2684:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 2163              	 .loc 1 2684 0
 2164 00a4 40F20220 	 movw r0,#514
 2165              	.LVL228:
 2166 00a8 01E0     	 b .L184
 2167              	.LVL229:
 2168              	.L190:
2699:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 2169              	 .loc 1 2699 0
 2170 00aa 4FF40170 	 mov r0,#516
 2171              	.LVL230:
 2172              	.L184:
2750:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2751:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         break;
2752:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
2753:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             break;
2754:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2755:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
2756:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 2173              	 .loc 1 2756 0
 2174 00ae 02B0     	 add sp,sp,#8
 2175              	.LCFI17:
 2176              	 .cfi_def_cfa_offset 16
 2177              	 
 2178 00b0 70BD     	 pop {r4,r5,r6,pc}
 2179              	.LVL231:
 2180              	.L194:
 2181 00b2 00BF     	 .align 2
 2182              	.L193:
 2183 00b4 00000000 	 .word optiga_cmd_queue_scheduler
 2184              	 .cfi_endproc
 2185              	.LFE52:
 2187              	 .section .text.optiga_cmd_gen_keypair_handler,"ax",%progbits
 2188              	 .align 1
 2189              	 .thumb
 2190              	 .thumb_func
 2192              	optiga_cmd_gen_keypair_handler:
 2193              	.LFB47:
2281:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 2194              	 .loc 1 2281 0
 2195              	 .cfi_startproc
 2196              	 
 2197              	 
 2198              	.LVL232:
 2199 0000 73B5     	 push {r0,r1,r4,r5,r6,lr}
 2200              	.LCFI18:
 2201              	 .cfi_def_cfa_offset 24
 2202              	 .cfi_offset 4,-16
 2203              	 .cfi_offset 5,-12
 2204              	 .cfi_offset 6,-8
 2205              	 .cfi_offset 14,-4
2291:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2206              	 .loc 1 2291 0
 2207 0002 817D     	 ldrb r1,[r0,#22]
2283:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t header_offset;
 2208              	 .loc 1 2283 0
 2209 0004 8668     	 ldr r6,[r0,#8]
 2210              	.LVL233:
2286:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t out_data_size;
 2211              	 .loc 1 2286 0
 2212 0006 0923     	 movs r3,#9
2291:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2213              	 .loc 1 2291 0
 2214 0008 0229     	 cmp r1,#2
2281:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 2215              	 .loc 1 2281 0
 2216 000a 0446     	 mov r4,r0
2286:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t out_data_size;
 2217              	 .loc 1 2286 0
 2218 000c ADF80230 	 strh r3,[sp,#2]
 2219              	.LVL234:
2291:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2220              	 .loc 1 2291 0
 2221 0010 02D0     	 beq .L197
 2222 0012 0329     	 cmp r1,#3
 2223 0014 43D0     	 beq .L198
 2224 0016 8FE0     	 b .L210
 2225              	.L197:
 2226              	.LVL235:
2309:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2227              	 .loc 1 2309 0
 2228 0018 7378     	 ldrb r3,[r6,#1]
 2229 001a 0268     	 ldr r2,[r0]
 2230 001c 33BB     	 cbnz r3,.L199
2312:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_LENGTH,
 2231              	 .loc 1 2312 0
 2232 001e 0120     	 movs r0,#1
 2233              	.LVL236:
 2234 0020 0DF10203 	 add r3,sp,#2
 2235 0024 0D32     	 adds r2,r2,#13
 2236 0026 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 2237              	.LVL237:
2317:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 2238              	 .loc 1 2317 0
 2239 002a BDF80230 	 ldrh r3,[sp,#2]
 2240 002e 2068     	 ldr r0,[r4]
2318:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          me->session_oid:(uint16_t)p_optiga_ecc_gen_keypair->privat
 2241              	 .loc 1 2318 0
 2242 0030 7188     	 ldrh r1,[r6,#2]
2317:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 2243              	 .loc 1 2317 0
 2244 0032 1844     	 add r0,r0,r3
 2245 0034 0D30     	 adds r0,r0,#13
 2246 0036 01B9     	 cbnz r1,.L200
2317:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 2247              	 .loc 1 2317 0 is_stmt 0 discriminator 1
 2248 0038 A18A     	 ldrh r1,[r4,#20]
 2249              	.L200:
2317:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 2250              	 .loc 1 2317 0 discriminator 4
 2251 003a FFF7FEFF 	 bl optiga_common_set_uint16
 2252              	.LVL238:
2321:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for key usage
 2253              	 .loc 1 2321 0 is_stmt 1 discriminator 4
 2254 003e BDF80230 	 ldrh r3,[sp,#2]
2325:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
 2255              	 .loc 1 2325 0 discriminator 4
 2256 0042 2268     	 ldr r2,[r4]
2321:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for key usage
 2257              	 .loc 1 2321 0 discriminator 4
 2258 0044 0233     	 adds r3,r3,#2
2323:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_LENGTH,
 2259              	 .loc 1 2323 0 discriminator 4
 2260 0046 0220     	 movs r0,#2
2321:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for key usage
 2261              	 .loc 1 2321 0 discriminator 4
 2262 0048 ADF80230 	 strh r3,[sp,#2]
2323:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_LENGTH,
 2263              	 .loc 1 2323 0 discriminator 4
 2264 004c 0121     	 movs r1,#1
 2265 004e 0D32     	 adds r2,r2,#13
 2266 0050 0DEB0003 	 add r3,sp,r0
 2267 0054 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 2268              	.LVL239:
2328:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 2269              	 .loc 1 2328 0 discriminator 4
 2270 0058 BDF80230 	 ldrh r3,[sp,#2]
 2271 005c 2168     	 ldr r1,[r4]
 2272 005e 5A1C     	 adds r2,r3,#1
 2273 0060 ADF80220 	 strh r2,[sp,#2]
 2274 0064 0B44     	 add r3,r3,r1
 2275 0066 3278     	 ldrb r2,[r6]
 2276 0068 5A73     	 strb r2,[r3,#13]
 2277 006a 06E0     	 b .L201
 2278              	.LVL240:
 2279              	.L199:
2333:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_LENGTH,
 2280              	 .loc 1 2333 0
 2281 006c 0720     	 movs r0,#7
 2282              	.LVL241:
 2283 006e 0021     	 movs r1,#0
 2284 0070 0D32     	 adds r2,r2,#13
 2285 0072 0DF10203 	 add r3,sp,#2
 2286 0076 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 2287              	.LVL242:
 2288              	.L201:
2340:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                             (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFS
 2289              	 .loc 1 2340 0
 2290 007a BDF80230 	 ldrh r3,[sp,#2]
2342:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2291              	 .loc 1 2342 0
 2292 007e 2268     	 ldr r2,[r4]
 2293              	.LVL243:
2340:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                             (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFS
 2294              	 .loc 1 2340 0
 2295 0080 607E     	 ldrb r0,[r4,#25]
 2296              	.LVL244:
 2297              	.LBB162:
 2298              	.LBB163:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 2299              	 .loc 1 441 0
 2300 0082 D074     	 strb r0,[r2,#19]
 2301              	.LBE163:
 2302              	.LBE162:
2340:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                             (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFS
 2303              	 .loc 1 2340 0
 2304 0084 A3F10901 	 sub r1,r3,#9
 2305 0088 89B2     	 uxth r1,r1
 2306              	.LVL245:
 2307              	.LBB165:
 2308              	.LBB164:
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 2309              	 .loc 1 442 0
 2310 008a 080A     	 lsrs r0,r1,#8
 2311              	.LVL246:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 2312              	 .loc 1 440 0
 2313 008c B825     	 movs r5,#184
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 2314              	 .loc 1 442 0
 2315 008e 1075     	 strb r0,[r2,#20]
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 2316              	 .loc 1 440 0
 2317 0090 9574     	 strb r5,[r2,#18]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 2318              	 .loc 1 443 0
 2319 0092 5175     	 strb r1,[r2,#21]
 2320              	.LBE164:
 2321              	.LBE165:
2344:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2322              	 .loc 1 2344 0
 2323 0094 2268     	 ldr r2,[r4]
 2324              	.LVL247:
 2325 0096 053B     	 subs r3,r3,#5
 2326 0098 9380     	 strh r3,[r2,#4]
 2327              	.LVL248:
2346:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 2328              	 .loc 1 2346 0
 2329 009a 0020     	 movs r0,#0
2348:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 2330              	 .loc 1 2348 0
 2331 009c 4EE0     	 b .L196
 2332              	.LVL249:
 2333              	.L198:
2353:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2334              	 .loc 1 2353 0
 2335 009e 0068     	 ldr r0,[r0]
 2336              	.LVL250:
 2337 00a0 837C     	 ldrb r3,[r0,#18]
 2338 00a2 FF2B     	 cmp r3,#255
 2339 00a4 07D1     	 bne .L202
2356:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
 2340              	 .loc 1 2356 0
 2341 00a6 3369     	 ldr r3,[r6,#16]
 2342 00a8 0022     	 movs r2,#0
 2343 00aa 1A80     	 strh r2,[r3]
2359:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 2344              	 .loc 1 2359 0
 2345 00ac 637F     	 ldrb r3,[r4,#29]
 2346 00ae 03F07F03 	 and r3,r3,#127
 2347 00b2 6377     	 strb r3,[r4,#29]
 2348 00b4 40E0     	 b .L210
 2349              	.L202:
 2350              	.LVL251:
2363:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                      &out_data_size);
 2351              	 .loc 1 2363 0
 2352 00b6 1430     	 adds r0,r0,#20
 2353 00b8 01A9     	 add r1,sp,#4
 2354 00ba FFF7FEFF 	 bl optiga_common_get_uint16
 2355              	.LVL252:
2362:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFS
 2356              	 .loc 1 2362 0
 2357 00be 0025     	 movs r5,#0
2289:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2358              	 .loc 1 2289 0
 2359 00c0 40F20220 	 movw r0,#514
 2360              	.LVL253:
 2361              	.L203:
2366:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2362              	 .loc 1 2366 0
 2363 00c4 BDF80430 	 ldrh r3,[sp,#4]
 2364 00c8 AB42     	 cmp r3,r5
 2365 00ca 37D9     	 bls .L196
2369:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 2366              	 .loc 1 2369 0
 2367 00cc 2368     	 ldr r3,[r4]
 2368 00ce 5A19     	 adds r2,r3,r5
 2369 00d0 927D     	 ldrb r2,[r2,#22]
2368:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + header_offset
 2370              	 .loc 1 2368 0
 2371 00d2 022A     	 cmp r2,#2
 2372 00d4 1AD1     	 bne .L204
2371:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                 header_offset + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &pu
 2373              	 .loc 1 2371 0
 2374 00d6 5819     	 adds r0,r3,r5
 2375 00d8 0DF10601 	 add r1,sp,#6
 2376 00dc 1730     	 adds r0,r0,#23
 2377 00de FFF7FEFF 	 bl optiga_common_get_uint16
 2378              	.LVL254:
2373:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     {
 2379              	 .loc 1 2373 0
 2380 00e2 3369     	 ldr r3,[r6,#16]
 2381 00e4 BDF80620 	 ldrh r2,[sp,#6]
 2382 00e8 1988     	 ldrh r1,[r3]
 2383 00ea 9142     	 cmp r1,r2
 2384 00ec 04D2     	 bcs .L205
 2385              	.LVL255:
2377:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         break;
 2386              	 .loc 1 2377 0
 2387 00ee 0022     	 movs r2,#0
 2388 00f0 1A80     	 strh r2,[r3]
2376:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         *p_optiga_ecc_gen_keypair->public_key_length = 0;
 2389              	 .loc 1 2376 0
 2390 00f2 4FF40170 	 mov r0,#516
2378:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     }
 2391              	 .loc 1 2378 0
 2392 00f6 21E0     	 b .L196
 2393              	.LVL256:
 2394              	.L205:
2382:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                    OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_NO_OF_BYTES_IN_TAG]
 2395              	 .loc 1 2382 0
 2396 00f8 2168     	 ldr r1,[r4]
2380:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     pal_os_memcpy(p_optiga_ecc_gen_keypair->public_key,
 2397              	 .loc 1 2380 0
 2398 00fa 1A80     	 strh r2,[r3]
2382:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                    OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_NO_OF_BYTES_IN_TAG]
 2399              	 .loc 1 2382 0
 2400 00fc 2944     	 add r1,r1,r5
2381:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
 2401              	 .loc 1 2381 0
 2402 00fe F068     	 ldr r0,[r6,#12]
 2403 0100 1931     	 adds r1,r1,#25
 2404 0102 FFF7FEFF 	 bl pal_os_memcpy
 2405              	.LVL257:
2386:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
 2406              	 .loc 1 2386 0
 2407 0106 3369     	 ldr r3,[r6,#16]
 2408 0108 1B88     	 ldrh r3,[r3]
 2409 010a 10E0     	 b .L211
 2410              	.L204:
2389:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                              header_offset])
 2411              	 .loc 1 2389 0
 2412 010c 012A     	 cmp r2,#1
 2413 010e 15D1     	 bne .L196
2392:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                              + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &private_key_length)
 2414              	 .loc 1 2392 0
 2415 0110 5819     	 adds r0,r3,r5
 2416 0112 1730     	 adds r0,r0,#23
 2417 0114 6946     	 mov r1,sp
 2418 0116 FFF7FEFF 	 bl optiga_common_get_uint16
 2419              	.LVL258:
2396:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TAG], 
 2420              	 .loc 1 2396 0
 2421 011a 2168     	 ldr r1,[r4]
2395:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
 2422              	 .loc 1 2395 0
 2423 011c 7068     	 ldr r0,[r6,#4]
 2424 011e BDF80020 	 ldrh r2,[sp]
2396:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TAG], 
 2425              	 .loc 1 2396 0
 2426 0122 2944     	 add r1,r1,r5
2395:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
 2427              	 .loc 1 2395 0
 2428 0124 1931     	 adds r1,r1,#25
 2429 0126 FFF7FEFF 	 bl pal_os_memcpy
 2430              	.LVL259:
 2431 012a BDF80030 	 ldrh r3,[sp]
 2432              	.L211:
 2433 012e 0333     	 adds r3,r3,#3
2398:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
 2434              	 .loc 1 2398 0
 2435 0130 1D44     	 add r5,r5,r3
 2436              	.LVL260:
 2437 0132 ADB2     	 uxth r5,r5
 2438              	.LVL261:
 2439 0134 0020     	 movs r0,#0
 2440 0136 C5E7     	 b .L203
 2441              	.LVL262:
 2442              	.L210:
2289:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2443              	 .loc 1 2289 0
 2444 0138 40F20220 	 movw r0,#514
 2445              	.LVL263:
 2446              	.L196:
2414:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2447              	 .loc 1 2414 0
 2448 013c 02B0     	 add sp,sp,#8
 2449              	.LCFI19:
 2450              	 .cfi_def_cfa_offset 16
 2451              	 
 2452 013e 70BD     	 pop {r4,r5,r6,pc}
 2453              	 .cfi_endproc
 2454              	.LFE47:
 2456              	 .section .text.optiga_cmd_calc_hash_handler,"ax",%progbits
 2457              	 .align 1
 2458              	 .thumb
 2459              	 .thumb_func
 2461              	optiga_cmd_calc_hash_handler:
 2462              	.LFB50:
2488:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t *)me->p_input;
 2463              	 .loc 1 2488 0
 2464              	 .cfi_startproc
 2465              	 
 2466              	 
 2467              	.LVL264:
 2468 0000 F7B5     	 push {r0,r1,r2,r4,r5,r6,r7,lr}
 2469              	.LCFI20:
 2470              	 .cfi_def_cfa_offset 32
 2471              	 .cfi_offset 4,-20
 2472              	 .cfi_offset 5,-16
 2473              	 .cfi_offset 6,-12
 2474              	 .cfi_offset 7,-8
 2475              	 .cfi_offset 14,-4
2496:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2476              	 .loc 1 2496 0
 2477 0002 827D     	 ldrb r2,[r0,#22]
2489:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 2478              	 .loc 1 2489 0
 2479 0004 8468     	 ldr r4,[r0,#8]
 2480              	.LVL265:
2490:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t out_data_size;
 2481              	 .loc 1 2490 0
 2482 0006 0923     	 movs r3,#9
2496:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2483              	 .loc 1 2496 0
 2484 0008 022A     	 cmp r2,#2
2488:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t *)me->p_input;
 2485              	 .loc 1 2488 0
 2486 000a 0546     	 mov r5,r0
2490:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t out_data_size;
 2487              	 .loc 1 2490 0
 2488 000c ADF80430 	 strh r3,[sp,#4]
 2489              	.LVL266:
2496:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2490              	 .loc 1 2496 0
 2491 0010 03D0     	 beq .L214
 2492 0012 032A     	 cmp r2,#3
 2493 0014 00F0CC80 	 beq .L215
 2494 0018 07E1     	 b .L231
 2495              	.L214:
 2496              	.LVL267:
 2497              	.LBB170:
 2498              	.LBB171:
2457:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2499              	 .loc 1 2457 0
 2500 001a 237B     	 ldrb r3,[r4,#12]
 2501 001c 6373     	 strb r3,[r4,#13]
2460:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2502              	 .loc 1 2460 0
 2503 001e 012B     	 cmp r3,#1
 2504 0020 0FD1     	 bne .L216
2463:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 2505              	 .loc 1 2463 0
 2506 0022 6368     	 ldr r3,[r4,#4]
 2507 0024 5968     	 ldr r1,[r3,#4]
 2508 0026 40F20363 	 movw r3,#1539
 2509 002a 9942     	 cmp r1,r3
 2510 002c 09D9     	 bls .L216
2466:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2511              	 .loc 1 2466 0
 2512 002e 2369     	 ldr r3,[r4,#16]
 2513 0030 33B1     	 cbz r3,.L243
2471:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2514              	 .loc 1 2471 0
 2515 0032 03F20363 	 addw r3,r3,#1539
 2516 0036 8B42     	 cmp r3,r1
 2517 0038 01D2     	 bcs .L218
2473:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 2518              	 .loc 1 2473 0
 2519 003a 6273     	 strb r2,[r4,#13]
 2520 003c 01E0     	 b .L216
 2521              	.L218:
2478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 2522              	 .loc 1 2478 0
 2523 003e 0323     	 movs r3,#3
 2524              	.L243:
 2525 0040 6373     	 strb r3,[r4,#13]
 2526              	.L216:
 2527              	.LBE171:
 2528              	.LBE170:
2504:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2529              	 .loc 1 2504 0
 2530 0042 0023     	 movs r3,#0
 2531 0044 2B76     	 strb r3,[r5,#24]
2507:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2532              	 .loc 1 2507 0
 2533 0046 6168     	 ldr r1,[r4,#4]
 2534 0048 2A68     	 ldr r2,[r5]
 2535 004a 607B     	 ldrb r0,[r4,#13]
 2536              	.LVL268:
 2537 004c 0029     	 cmp r1,#0
 2538 004e 32D0     	 beq .L219
2512:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                        p_optiga_calc_hash->apparent_context_size),(p_optiga_calc_ha
 2539              	 .loc 1 2512 0
 2540 0050 E669     	 ldr r6,[r4,#28]
 2541 0052 4968     	 ldr r1,[r1,#4]
 2542 0054 C6F5C063 	 rsb r3,r6,#1536
 2543 0058 2669     	 ldr r6,[r4,#16]
2515:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2544              	 .loc 1 2515 0
 2545 005a 9075     	 strb r0,[r2,#22]
2512:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                        p_optiga_calc_hash->apparent_context_size),(p_optiga_calc_ha
 2546              	 .loc 1 2512 0
 2547 005c 8E1B     	 subs r6,r1,r6
 2548 005e 0333     	 adds r3,r3,#3
 2549 0060 9E42     	 cmp r6,r3
 2550 0062 28BF     	 it cs
 2551 0064 1E46     	 movcs r6,r3
 2552              	.LVL269:
2518:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 2553              	 .loc 1 2518 0
 2554 0066 2868     	 ldr r0,[r5]
 2555 0068 B7B2     	 uxth r7,r6
2515:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2556              	 .loc 1 2515 0
 2557 006a 0A23     	 movs r3,#10
2518:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 2558              	 .loc 1 2518 0
 2559 006c 1730     	 adds r0,r0,#23
 2560 006e 3946     	 mov r1,r7
2515:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2561              	 .loc 1 2515 0
 2562 0070 ADF80430 	 strh r3,[sp,#4]
2518:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 2563              	 .loc 1 2518 0
 2564 0074 FFF7FEFF 	 bl optiga_common_set_uint16
 2565              	.LVL270:
2519:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2566              	 .loc 1 2519 0
 2567 0078 BDF80430 	 ldrh r3,[sp,#4]
2521:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_data->buffer + p_optiga_calc_hash->data_se
 2568              	 .loc 1 2521 0
 2569 007c 2868     	 ldr r0,[r5]
2519:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2570              	 .loc 1 2519 0
 2571 007e 0233     	 adds r3,r3,#2
 2572 0080 9BB2     	 uxth r3,r3
 2573 0082 ADF80430 	 strh r3,[sp,#4]
2521:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_data->buffer + p_optiga_calc_hash->data_se
 2574              	 .loc 1 2521 0
 2575 0086 1844     	 add r0,r0,r3
2522:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               length_to_hash);
 2576              	 .loc 1 2522 0
 2577 0088 6368     	 ldr r3,[r4,#4]
2521:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_data->buffer + p_optiga_calc_hash->data_se
 2578              	 .loc 1 2521 0
 2579 008a 1968     	 ldr r1,[r3]
 2580 008c 2369     	 ldr r3,[r4,#16]
 2581 008e 3246     	 mov r2,r6
 2582 0090 1944     	 add r1,r1,r3
 2583 0092 0D30     	 adds r0,r0,#13
 2584 0094 FFF7FEFF 	 bl pal_os_memcpy
 2585              	.LVL271:
2526:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_calc_hash->data_sent != p_optiga_calc_hash->p_hash_data->length)
 2586              	 .loc 1 2526 0
 2587 0098 2369     	 ldr r3,[r4,#16]
2524:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2588              	 .loc 1 2524 0
 2589 009a BDF80410 	 ldrh r1,[sp,#4]
2526:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_calc_hash->data_sent != p_optiga_calc_hash->p_hash_data->length)
 2590              	 .loc 1 2526 0
 2591 009e 1E44     	 add r6,r6,r3
 2592              	.LVL272:
2527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 2593              	 .loc 1 2527 0
 2594 00a0 6368     	 ldr r3,[r4,#4]
2526:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_calc_hash->data_sent != p_optiga_calc_hash->p_hash_data->length)
 2595              	 .loc 1 2526 0
 2596 00a2 2661     	 str r6,[r4,#16]
2527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 2597              	 .loc 1 2527 0
 2598 00a4 5B68     	 ldr r3,[r3,#4]
2524:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2599              	 .loc 1 2524 0
 2600 00a6 3944     	 add r1,r1,r7
2527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 2601              	 .loc 1 2527 0
 2602 00a8 9E42     	 cmp r6,r3
2524:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2603              	 .loc 1 2524 0
 2604 00aa ADF80410 	 strh r1,[sp,#4]
2527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 2605              	 .loc 1 2527 0
 2606 00ae 36D0     	 beq .L220
2529:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 }
 2607              	 .loc 1 2529 0
 2608 00b0 0123     	 movs r3,#1
 2609 00b2 2B76     	 strb r3,[r5,#24]
 2610 00b4 33E0     	 b .L220
 2611              	.L219:
2532:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2612              	 .loc 1 2532 0
 2613 00b6 2168     	 ldr r1,[r4]
 2614 00b8 69B3     	 cbz r1,.L221
2535:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_OID_DATA_LENGTH,
 2615              	 .loc 1 2535 0
 2616 00ba 0D32     	 adds r2,r2,#13
 2617 00bc 0621     	 movs r1,#6
 2618 00be 01AB     	 add r3,sp,#4
 2619 00c0 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 2620              	.LVL273:
2540:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->oid);
 2621              	 .loc 1 2540 0
 2622 00c4 BDF80430 	 ldrh r3,[sp,#4]
 2623 00c8 2868     	 ldr r0,[r5]
 2624 00ca 1844     	 add r0,r0,r3
 2625 00cc 2368     	 ldr r3,[r4]
 2626 00ce 0D30     	 adds r0,r0,#13
 2627 00d0 1988     	 ldrh r1,[r3]
 2628 00d2 FFF7FEFF 	 bl optiga_common_set_uint16
 2629              	.LVL274:
2542:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 2630              	 .loc 1 2542 0
 2631 00d6 BDF80430 	 ldrh r3,[sp,#4]
2543:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->offset);
 2632              	 .loc 1 2543 0
 2633 00da 2868     	 ldr r0,[r5]
2542:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 2634              	 .loc 1 2542 0
 2635 00dc 0233     	 adds r3,r3,#2
 2636 00de 9BB2     	 uxth r3,r3
 2637 00e0 ADF80430 	 strh r3,[sp,#4]
2543:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->offset);
 2638              	 .loc 1 2543 0
 2639 00e4 1844     	 add r0,r0,r3
 2640 00e6 2368     	 ldr r3,[r4]
 2641 00e8 0D30     	 adds r0,r0,#13
 2642 00ea 5988     	 ldrh r1,[r3,#2]
 2643 00ec FFF7FEFF 	 bl optiga_common_set_uint16
 2644              	.LVL275:
2545:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 2645              	 .loc 1 2545 0
 2646 00f0 BDF80430 	 ldrh r3,[sp,#4]
2546:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->length);
 2647              	 .loc 1 2546 0
 2648 00f4 2868     	 ldr r0,[r5]
2545:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 2649              	 .loc 1 2545 0
 2650 00f6 0233     	 adds r3,r3,#2
 2651 00f8 9BB2     	 uxth r3,r3
 2652 00fa ADF80430 	 strh r3,[sp,#4]
2546:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->length);
 2653              	 .loc 1 2546 0
 2654 00fe 1844     	 add r0,r0,r3
 2655 0100 2368     	 ldr r3,[r4]
 2656 0102 0D30     	 adds r0,r0,#13
 2657 0104 9988     	 ldrh r1,[r3,#4]
 2658 0106 FFF7FEFF 	 bl optiga_common_set_uint16
 2659              	.LVL276:
2548:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 2660              	 .loc 1 2548 0
 2661 010a BDF80430 	 ldrh r3,[sp,#4]
 2662 010e 0233     	 adds r3,r3,#2
 2663 0110 ADF80430 	 strh r3,[sp,#4]
 2664 0114 03E0     	 b .L220
 2665              	.L221:
2553:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
 2666              	 .loc 1 2553 0
 2667 0116 0D32     	 adds r2,r2,#13
 2668 0118 01AB     	 add r3,sp,#4
 2669 011a FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 2670              	.LVL277:
 2671              	.L220:
2559:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (0 != p_optiga_calc_hash->apparent_context_size))
 2672              	 .loc 1 2559 0
 2673 011e A368     	 ldr r3,[r4,#8]
 2674 0120 4BB3     	 cbz r3,.L222
2559:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (0 != p_optiga_calc_hash->apparent_context_size))
 2675              	 .loc 1 2559 0 is_stmt 0 discriminator 1
 2676 0122 E369     	 ldr r3,[r4,#28]
 2677 0124 3BB3     	 cbz r3,.L222
2562:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 2678              	 .loc 1 2562 0 is_stmt 1
 2679 0126 2968     	 ldr r1,[r5]
 2680 0128 BDF80420 	 ldrh r2,[sp,#4]
 2681 012c 531C     	 adds r3,r2,#1
 2682 012e 0A44     	 add r2,r2,r1
 2683 0130 0621     	 movs r1,#6
 2684 0132 5173     	 strb r1,[r2,#13]
2563:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           (uint16_t )p_optiga_calc_hash->p_hash_context->context_bu
 2685              	 .loc 1 2563 0
 2686 0134 2868     	 ldr r0,[r5]
2562:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 2687              	 .loc 1 2562 0
 2688 0136 9BB2     	 uxth r3,r3
 2689 0138 ADF80430 	 strh r3,[sp,#4]
2563:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           (uint16_t )p_optiga_calc_hash->p_hash_context->context_bu
 2690              	 .loc 1 2563 0
 2691 013c 1844     	 add r0,r0,r3
2564:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 2692              	 .loc 1 2564 0
 2693 013e A368     	 ldr r3,[r4,#8]
2563:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                           (uint16_t )p_optiga_calc_hash->p_hash_context->context_bu
 2694              	 .loc 1 2563 0
 2695 0140 0D30     	 adds r0,r0,#13
 2696 0142 9988     	 ldrh r1,[r3,#4]
 2697 0144 FFF7FEFF 	 bl optiga_common_set_uint16
 2698              	.LVL278:
2565:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2699              	 .loc 1 2565 0
 2700 0148 BDF80430 	 ldrh r3,[sp,#4]
2567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_context->context_buffer,
 2701              	 .loc 1 2567 0
 2702 014c 2868     	 ldr r0,[r5]
2568:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               (uint16_t)p_optiga_calc_hash->p_hash_context->context_buffer_length);
 2703              	 .loc 1 2568 0
 2704 014e A268     	 ldr r2,[r4,#8]
2565:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2705              	 .loc 1 2565 0
 2706 0150 0233     	 adds r3,r3,#2
 2707 0152 9BB2     	 uxth r3,r3
2567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_context->context_buffer,
 2708              	 .loc 1 2567 0
 2709 0154 1844     	 add r0,r0,r3
 2710 0156 1168     	 ldr r1,[r2]
 2711 0158 9288     	 ldrh r2,[r2,#4]
2565:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2712              	 .loc 1 2565 0
 2713 015a ADF80430 	 strh r3,[sp,#4]
2567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_context->context_buffer,
 2714              	 .loc 1 2567 0
 2715 015e 0D30     	 adds r0,r0,#13
 2716 0160 FFF7FEFF 	 bl pal_os_memcpy
 2717              	.LVL279:
2571:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->apparent_context_size = 0;
 2718              	 .loc 1 2571 0
 2719 0164 A368     	 ldr r3,[r4,#8]
 2720 0166 5A68     	 ldr r2,[r3,#4]
 2721 0168 BDF80430 	 ldrh r3,[sp,#4]
 2722 016c 1344     	 add r3,r3,r2
 2723 016e ADF80430 	 strh r3,[sp,#4]
2572:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 2724              	 .loc 1 2572 0
 2725 0172 0023     	 movs r3,#0
 2726 0174 E361     	 str r3,[r4,#28]
 2727              	.L222:
2576:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2728              	 .loc 1 2576 0
 2729 0176 237E     	 ldrb r3,[r4,#24]
 2730 0178 012B     	 cmp r3,#1
 2731 017a 07D1     	 bne .L223
2576:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2732              	 .loc 1 2576 0 is_stmt 0 discriminator 1
 2733 017c 297E     	 ldrb r1,[r5,#24]
 2734 017e 29B9     	 cbnz r1,.L223
2580:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               (uint16_t*)&index_for_data);
 2735              	 .loc 1 2580 0 is_stmt 1
 2736 0180 2A68     	 ldr r2,[r5]
2578:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
 2737              	 .loc 1 2578 0
 2738 0182 0720     	 movs r0,#7
 2739 0184 0D32     	 adds r2,r2,#13
 2740 0186 01AB     	 add r3,sp,#4
 2741 0188 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 2742              	.LVL280:
 2743              	.L223:
2585:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 2744              	 .loc 1 2585 0
 2745 018c BDF80430 	 ldrh r3,[sp,#4]
2588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2746              	 .loc 1 2588 0
 2747 0190 2A68     	 ldr r2,[r5]
 2748              	.LVL281:
2585:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 2749              	 .loc 1 2585 0
 2750 0192 687E     	 ldrb r0,[r5,#25]
 2751              	.LVL282:
 2752              	.LBB172:
 2753              	.LBB173:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 2754              	 .loc 1 441 0
 2755 0194 D074     	 strb r0,[r2,#19]
 2756              	.LBE173:
 2757              	.LBE172:
2585:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 2758              	 .loc 1 2585 0
 2759 0196 A3F10901 	 sub r1,r3,#9
 2760 019a 89B2     	 uxth r1,r1
 2761              	.LVL283:
 2762              	.LBB175:
 2763              	.LBB174:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 2764              	 .loc 1 440 0
 2765 019c B024     	 movs r4,#176
 2766              	.LVL284:
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 2767              	 .loc 1 442 0
 2768 019e 080A     	 lsrs r0,r1,#8
 2769              	.LVL285:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 2770              	 .loc 1 440 0
 2771 01a0 9474     	 strb r4,[r2,#18]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 2772              	 .loc 1 442 0
 2773 01a2 1075     	 strb r0,[r2,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 2774              	 .loc 1 443 0
 2775 01a4 5175     	 strb r1,[r2,#21]
 2776              	.LBE174:
 2777              	.LBE175:
2590:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 2778              	 .loc 1 2590 0
 2779 01a6 2A68     	 ldr r2,[r5]
 2780              	.LVL286:
 2781 01a8 053B     	 subs r3,r3,#5
 2782 01aa 9380     	 strh r3,[r2,#4]
 2783              	.LVL287:
 2784              	.L244:
2591:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 2785              	 .loc 1 2591 0
 2786 01ac 0020     	 movs r0,#0
2593:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 2787              	 .loc 1 2593 0
 2788 01ae 41E0     	 b .L213
 2789              	.LVL288:
 2790              	.L215:
2598:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2791              	 .loc 1 2598 0
 2792 01b0 0068     	 ldr r0,[r0]
 2793              	.LVL289:
 2794 01b2 837C     	 ldrb r3,[r0,#18]
 2795 01b4 FF2B     	 cmp r3,#255
 2796 01b6 04D1     	 bne .L224
2603:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 2797              	 .loc 1 2603 0
 2798 01b8 6B7F     	 ldrb r3,[r5,#29]
 2799 01ba 03F07F03 	 and r3,r3,#127
 2800 01be 6B77     	 strb r3,[r5,#29]
 2801 01c0 33E0     	 b .L231
 2802              	.L224:
2607:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2803              	 .loc 1 2607 0
 2804 01c2 2E7E     	 ldrb r6,[r5,#24]
 2805 01c4 8EB9     	 cbnz r6,.L225
2607:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2806              	 .loc 1 2607 0 is_stmt 0 discriminator 1
 2807 01c6 6369     	 ldr r3,[r4,#20]
 2808 01c8 7BB1     	 cbz r3,.L225
2610:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 2809              	 .loc 1 2610 0 is_stmt 1
 2810 01ca 837D     	 ldrb r3,[r0,#22]
 2811 01cc 012B     	 cmp r3,#1
 2812 01ce 2CD1     	 bne .L231
2614:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &out_data_size);
 2813              	 .loc 1 2614 0
 2814 01d0 0DF10601 	 add r1,sp,#6
 2815 01d4 1730     	 adds r0,r0,#23
 2816 01d6 FFF7FEFF 	 bl optiga_common_get_uint16
 2817              	.LVL290:
2618:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               OPTIGA_CMD_NO_OF_BYTES_IN_TAG], out_data_size);
 2818              	 .loc 1 2618 0
 2819 01da 2968     	 ldr r1,[r5]
2617:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
 2820              	 .loc 1 2617 0
 2821 01dc 6069     	 ldr r0,[r4,#20]
 2822 01de BDF80620 	 ldrh r2,[sp,#6]
 2823 01e2 1931     	 adds r1,r1,#25
 2824 01e4 FFF7FEFF 	 bl pal_os_memcpy
 2825              	.LVL291:
 2826 01e8 E0E7     	 b .L244
 2827              	.L225:
2622:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2828              	 .loc 1 2622 0
 2829 01ea 237E     	 ldrb r3,[r4,#24]
 2830 01ec 012B     	 cmp r3,#1
 2831 01ee DDD1     	 bne .L244
2622:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2832              	 .loc 1 2622 0 is_stmt 0 discriminator 1
 2833 01f0 002E     	 cmp r6,#0
 2834 01f2 DBD1     	 bne .L244
2622:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2835              	 .loc 1 2622 0 discriminator 2
 2836 01f4 A368     	 ldr r3,[r4,#8]
 2837 01f6 002B     	 cmp r3,#0
 2838 01f8 D8D0     	 beq .L244
2625:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 2839              	 .loc 1 2625 0 is_stmt 1
 2840 01fa 837D     	 ldrb r3,[r0,#22]
 2841 01fc 062B     	 cmp r3,#6
 2842 01fe 14D1     	 bne .L231
2630:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                          OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &out_data_size);
 2843              	 .loc 1 2630 0
 2844 0200 0DF10601 	 add r1,sp,#6
 2845 0204 1730     	 adds r0,r0,#23
 2846 0206 FFF7FEFF 	 bl optiga_common_get_uint16
 2847              	.LVL292:
2632:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 2848              	 .loc 1 2632 0
 2849 020a A368     	 ldr r3,[r4,#8]
 2850 020c BDF80620 	 ldrh r2,[sp,#6]
 2851 0210 5968     	 ldr r1,[r3,#4]
 2852 0212 9142     	 cmp r1,r2
 2853 0214 0CD3     	 bcc .L232
2640:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               OPTIGA_CMD_NO_OF_BYTES_IN_TAG], out_data_size);
 2854              	 .loc 1 2640 0
 2855 0216 2968     	 ldr r1,[r5]
2639:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
 2856              	 .loc 1 2639 0
 2857 0218 1868     	 ldr r0,[r3]
 2858 021a 1931     	 adds r1,r1,#25
 2859 021c FFF7FEFF 	 bl pal_os_memcpy
 2860              	.LVL293:
2642:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             }
 2861              	 .loc 1 2642 0
 2862 0220 A368     	 ldr r3,[r4,#8]
 2863 0222 BDF80620 	 ldrh r2,[sp,#6]
 2864 0226 5A60     	 str r2,[r3,#4]
 2865 0228 C0E7     	 b .L244
 2866              	.L231:
2493:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2867              	 .loc 1 2493 0
 2868 022a 40F20220 	 movw r0,#514
 2869 022e 01E0     	 b .L213
 2870              	.L232:
2635:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     break;
 2871              	 .loc 1 2635 0
 2872 0230 4FF40170 	 mov r0,#516
 2873              	.LVL294:
 2874              	.L213:
2653:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2875              	 .loc 1 2653 0
 2876 0234 03B0     	 add sp,sp,#12
 2877              	.LCFI21:
 2878              	 .cfi_def_cfa_offset 20
 2879              	 
 2880 0236 F0BD     	 pop {r4,r5,r6,r7,pc}
 2881              	 .cfi_endproc
 2882              	.LFE50:
 2884              	 .section .text.optiga_cmd_close_application_handler,"ax",%progbits
 2885              	 .align 1
 2886              	 .thumb
 2887              	 .thumb_func
 2889              	optiga_cmd_close_application_handler:
 2890              	.LFB35:
1582:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 2891              	 .loc 1 1582 0
 2892              	 .cfi_startproc
 2893              	 
 2894              	 
 2895              	.LVL295:
 2896 0000 38B5     	 push {r3,r4,r5,lr}
 2897              	.LCFI22:
 2898              	 .cfi_def_cfa_offset 16
 2899              	 .cfi_offset 3,-16
 2900              	 .cfi_offset 4,-12
 2901              	 .cfi_offset 5,-8
 2902              	 .cfi_offset 14,-4
1586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2903              	 .loc 1 1586 0
 2904 0002 837D     	 ldrb r3,[r0,#22]
 2905 0004 022B     	 cmp r3,#2
1582:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 2906              	 .loc 1 1582 0
 2907 0006 0446     	 mov r4,r0
1586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 2908              	 .loc 1 1586 0
 2909 0008 02D0     	 beq .L247
 2910 000a 032B     	 cmp r3,#3
 2911 000c 0CD0     	 beq .L248
 2912 000e 2BE0     	 b .L259
 2913              	.L247:
 2914              	.LVL296:
1603:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 2915              	 .loc 1 1603 0
 2916 0010 0368     	 ldr r3,[r0]
 2917              	.LVL297:
1600:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 2918              	 .loc 1 1600 0
 2919 0012 427E     	 ldrb r2,[r0,#25]
 2920              	.LVL298:
 2921              	.LBB184:
 2922              	.LBB185:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 2923              	 .loc 1 441 0
 2924 0014 DA74     	 strb r2,[r3,#19]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 2925              	 .loc 1 442 0
 2926 0016 0020     	 movs r0,#0
 2927              	.LVL299:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 2928              	 .loc 1 440 0
 2929 0018 F121     	 movs r1,#241
 2930 001a 9974     	 strb r1,[r3,#18]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 2931              	 .loc 1 442 0
 2932 001c 1875     	 strb r0,[r3,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 2933              	 .loc 1 443 0
 2934 001e 5875     	 strb r0,[r3,#21]
 2935              	.LBE185:
 2936              	.LBE184:
1605:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 2937              	 .loc 1 1605 0
 2938 0020 2368     	 ldr r3,[r4]
 2939              	.LVL300:
 2940 0022 0422     	 movs r2,#4
 2941              	.LVL301:
 2942 0024 9A80     	 strh r2,[r3,#4]
 2943              	.LVL302:
1608:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 2944              	 .loc 1 1608 0
 2945 0026 38BD     	 pop {r3,r4,r5,pc}
 2946              	.LVL303:
 2947              	.L248:
1613:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2948              	 .loc 1 1613 0
 2949 0028 0168     	 ldr r1,[r0]
 2950 002a 8D7C     	 ldrb r5,[r1,#18]
 2951 002c 25B1     	 cbz r5,.L249
1618:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 2952              	 .loc 1 1618 0
 2953 002e 437F     	 ldrb r3,[r0,#29]
 2954 0030 03F07F03 	 and r3,r3,#127
 2955 0034 4377     	 strb r3,[r0,#29]
 2956 0036 17E0     	 b .L259
 2957              	.L249:
1621:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2958              	 .loc 1 1621 0
 2959 0038 407E     	 ldrb r0,[r0,#25]
 2960              	.LVL304:
 2961 003a C8B1     	 cbz r0,.L258
1623:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
 2962              	 .loc 1 1623 0
 2963 003c 01F5D060 	 add r0,r1,#1664
 2964 0040 0822     	 movs r2,#8
 2965 0042 1631     	 adds r1,r1,#22
 2966 0044 FFF7FEFF 	 bl pal_os_memcpy
 2967              	.LVL305:
 2968              	.LBB186:
 2969              	.LBB187:
 846:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 2970              	 .loc 1 846 0
 2971 0048 608C     	 ldrh r0,[r4,#34]
 2972 004a 80B1     	 cbz r0,.L250
 850:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    sizeof(me->p_optiga->optiga_context_handle_buffe
 2973              	 .loc 1 850 0
 2974 004c 2168     	 ldr r1,[r4]
 849:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    me->p_optiga->optiga_context_handle_buffer,
 2975              	 .loc 1 849 0
 2976 004e 0822     	 movs r2,#8
 2977 0050 01F5D061 	 add r1,r1,#1664
 2978 0054 FFF7FEFF 	 bl pal_os_datastore_write
 2979              	.LVL306:
 852:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 2980              	 .loc 1 852 0
 2981 0058 48B1     	 cbz r0,.L250
 2982              	.LVL307:
 2983              	.LBE187:
 2984              	.LBE186:
 2985              	.LBB188:
 2986              	.LBB189:
1629:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                     sizeof(me->p_optiga->optiga_context_handle_buffer));
 2987              	 .loc 1 1629 0
 2988 005a 2068     	 ldr r0,[r4]
 2989              	.LVL308:
 2990 005c 2946     	 mov r1,r5
 2991 005e 00F5D060 	 add r0,r0,#1664
 2992 0062 0822     	 movs r2,#8
 2993 0064 FFF7FEFF 	 bl pal_os_memset
 2994              	.LVL309:
 2995              	.L259:
 2996 0068 40F20220 	 movw r0,#514
 2997 006c 38BD     	 pop {r3,r4,r5,pc}
 2998              	.LVL310:
 2999              	.L250:
 3000              	.LBE189:
 3001              	.LBE188:
1635:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3002              	 .loc 1 1635 0
 3003 006e 0020     	 movs r0,#0
 3004              	.LVL311:
 3005              	.L258:
1644:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3006              	 .loc 1 1644 0
 3007 0070 38BD     	 pop {r3,r4,r5,pc}
 3008              	 .cfi_endproc
 3009              	.LFE35:
 3011              	 .section .text.optiga_cmd_open_application_handler,"ax",%progbits
 3012              	 .align 1
 3013              	 .thumb
 3014              	 .thumb_func
 3016              	optiga_cmd_open_application_handler:
 3017              	.LFB33:
1464:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 3018              	 .loc 1 1464 0
 3019              	 .cfi_startproc
 3020              	 
 3021              	 
 3022              	.LVL312:
1468:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3023              	 .loc 1 1468 0
 3024 0000 837D     	 ldrb r3,[r0,#22]
 3025 0002 022B     	 cmp r3,#2
1464:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 3026              	 .loc 1 1464 0
 3027 0004 13B5     	 push {r0,r1,r4,lr}
 3028              	.LCFI23:
 3029              	 .cfi_def_cfa_offset 16
 3030              	 .cfi_offset 4,-8
 3031              	 .cfi_offset 14,-4
1464:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
 3032              	 .loc 1 1464 0
 3033 0006 0446     	 mov r4,r0
1468:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3034              	 .loc 1 1468 0
 3035 0008 02D0     	 beq .L262
 3036 000a 032B     	 cmp r3,#3
 3037 000c 53D0     	 beq .L263
 3038 000e 5EE0     	 b .L286
 3039              	.L262:
 3040              	.LVL313:
1484:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3041              	 .loc 1 1484 0
 3042 0010 437E     	 ldrb r3,[r0,#25]
 3043 0012 E3B9     	 cbnz r3,.L264
 3044              	.LVL314:
 3045              	.L271:
 3046              	.LBB196:
 3047              	.LBB197:
1494:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            (sizeof(g_optiga_unique_application_identifier)) :
 3048              	 .loc 1 1494 0
 3049 0014 627E     	 ldrb r2,[r4,#25]
1498:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3050              	 .loc 1 1498 0
 3051 0016 2368     	 ldr r3,[r4]
 3052              	.LVL315:
1492:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3053              	 .loc 1 1492 0
 3054 0018 002A     	 cmp r2,#0
 3055              	.LBB198:
 3056              	.LBB199:
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
 3057              	 .loc 1 441 0
 3058 001a DA74     	 strb r2,[r3,#19]
 3059              	.LBE199:
 3060              	.LBE198:
1492:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3061              	 .loc 1 1492 0
 3062 001c 0CBF     	 ite eq
 3063 001e 1021     	 moveq r1,#16
 3064 0020 1821     	 movne r1,#24
 3065              	.LVL316:
 3066              	.LBB201:
 3067              	.LBB200:
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 3068              	 .loc 1 440 0
 3069 0022 F020     	 movs r0,#240
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 3070              	 .loc 1 442 0
 3071 0024 0022     	 movs r2,#0
 3072              	.LVL317:
 3073 0026 1A75     	 strb r2,[r3,#20]
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 3074              	 .loc 1 443 0
 3075 0028 5975     	 strb r1,[r3,#21]
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
 3076              	 .loc 1 440 0
 3077 002a 9874     	 strb r0,[r3,#18]
 3078              	.LBE200:
 3079              	.LBE201:
1500:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           g_optiga_unique_application_identifier,
 3080              	 .loc 1 1500 0
 3081 002c 2068     	 ldr r0,[r4]
 3082 002e 2A49     	 ldr r1,.L289
 3083              	.LVL318:
 3084 0030 1630     	 adds r0,r0,#22
 3085 0032 1022     	 movs r2,#16
 3086 0034 FFF7FEFF 	 bl pal_os_memcpy
 3087              	.LVL319:
1503:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3088              	 .loc 1 1503 0
 3089 0038 637E     	 ldrb r3,[r4,#25]
 3090 003a 2BB3     	 cbz r3,.L272
1505:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                               sizeof(g_optiga_unique_application_identifier)],
 3091              	 .loc 1 1505 0
 3092 003c 2168     	 ldr r1,[r4]
 3093 003e 0822     	 movs r2,#8
 3094 0040 01F12600 	 add r0,r1,#38
 3095 0044 01F5D061 	 add r1,r1,#1664
 3096 0048 FFF7FEFF 	 bl pal_os_memcpy
 3097              	.LVL320:
 3098 004c 1CE0     	 b .L272
 3099              	.LVL321:
 3100              	.L264:
 3101              	.LBE197:
 3102              	.LBE196:
 3103              	.LBB203:
 3104              	.LBB204:
 816:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3105              	 .loc 1 816 0
 3106 004e 408C     	 ldrh r0,[r0,#34]
 3107              	.LVL322:
 3108 0050 38B9     	 cbnz r0,.L267
 3109              	.LVL323:
 3110              	.L270:
 829:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             0 == optiga_common_get_uint32(&me->p_optiga->optiga_context_handle_buffer[OPTIGA_CMD_OF
 3111              	 .loc 1 829 0
 3112 0052 2068     	 ldr r0,[r4]
 3113 0054 00F5D060 	 add r0,r0,#1664
 3114 0058 FFF7FEFF 	 bl optiga_common_get_uint32
 3115              	.LVL324:
 3116 005c 0028     	 cmp r0,#0
 3117 005e D9D1     	 bne .L271
 3118 0060 0BE0     	 b .L288
 3119              	.LVL325:
 3120              	.L267:
 818:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Reading context handle secret from datastore
 3121              	 .loc 1 818 0
 3122 0062 02AA     	 add r2,sp,#8
 821:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                   &context_handle_length);
 3123              	 .loc 1 821 0
 3124 0064 2168     	 ldr r1,[r4]
 818:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //Reading context handle secret from datastore
 3125              	 .loc 1 818 0
 3126 0066 0823     	 movs r3,#8
 3127 0068 22F8023D 	 strh r3,[r2,#-2]!
 820:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                   me->p_optiga->optiga_context_handle_buffer,
 3128              	 .loc 1 820 0
 3129 006c 01F5D061 	 add r1,r1,#1664
 3130 0070 FFF7FEFF 	 bl pal_os_datastore_read
 3131              	.LVL326:
 823:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3132              	 .loc 1 823 0
 3133 0074 0028     	 cmp r0,#0
 3134 0076 ECD0     	 beq .L270
 3135 0078 29E0     	 b .L286
 3136              	.LVL327:
 3137              	.L288:
 830:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3138              	 .loc 1 830 0
 3139 007a 2068     	 ldr r0,[r4]
 3140 007c 00F28460 	 addw r0,r0,#1668
 3141 0080 FFF7FEFF 	 bl optiga_common_get_uint32
 3142              	.LVL328:
 829:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             0 == optiga_common_get_uint32(&me->p_optiga->optiga_context_handle_buffer[OPTIGA_CMD_OF
 3143              	 .loc 1 829 0
 3144 0084 18B3     	 cbz r0,.L286
 3145 0086 C5E7     	 b .L271
 3146              	.LVL329:
 3147              	.L272:
 3148              	.LBE204:
 3149              	.LBE203:
 3150              	.LBB205:
 3151              	.LBB202:
1511:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
 3152              	 .loc 1 1511 0
 3153 0088 637E     	 ldrb r3,[r4,#25]
 3154 008a 2068     	 ldr r0,[r4]
 3155 008c 002B     	 cmp r3,#0
 3156 008e 0CBF     	 ite eq
 3157 0090 1423     	 moveq r3,#20
 3158 0092 1C23     	 movne r3,#28
 3159 0094 8380     	 strh r3,[r0,#4]
1517:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                           0,
 3160              	 .loc 1 1517 0
 3161 0096 0021     	 movs r1,#0
 3162 0098 00F5D060 	 add r0,r0,#1664
 3163 009c 0822     	 movs r2,#8
 3164 009e FFF7FEFF 	 bl pal_os_memset
 3165              	.LVL330:
1520:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3166              	 .loc 1 1520 0
 3167 00a2 608C     	 ldrh r0,[r4,#34]
 3168 00a4 A8B1     	 cbz r0,.L261
1524:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        sizeof(me->p_optiga->optiga_context_handle_b
 3169              	 .loc 1 1524 0
 3170 00a6 2168     	 ldr r1,[r4]
1523:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                        me->p_optiga->optiga_context_handle_buffer,
 3171              	 .loc 1 1523 0
 3172 00a8 0822     	 movs r2,#8
 3173 00aa 01F5D061 	 add r1,r1,#1664
 3174 00ae FFF7FEFF 	 bl pal_os_datastore_write
 3175              	.LVL331:
1526:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 3176              	 .loc 1 1526 0
 3177 00b2 60B9     	 cbnz r0,.L286
 3178 00b4 0DE0     	 b .L261
 3179              	.LVL332:
 3180              	.L263:
 3181              	.LBE202:
 3182              	.LBE205:
1539:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3183              	 .loc 1 1539 0
 3184 00b6 0368     	 ldr r3,[r0]
 3185 00b8 987C     	 ldrb r0,[r3,#18]
 3186              	.LVL333:
 3187 00ba 20B1     	 cbz r0,.L275
1544:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 3188              	 .loc 1 1544 0
 3189 00bc 637F     	 ldrb r3,[r4,#29]
 3190 00be 03F07F03 	 and r3,r3,#127
 3191 00c2 6377     	 strb r3,[r4,#29]
 3192 00c4 03E0     	 b .L286
 3193              	.L275:
1548:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 3194              	 .loc 1 1548 0
 3195 00c6 1B68     	 ldr r3,[r3]
 3196 00c8 3322     	 movs r2,#51
 3197 00ca 1A74     	 strb r2,[r3,#16]
 3198              	.LVL334:
1554:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         default:
 3199              	 .loc 1 1554 0
 3200 00cc 01E0     	 b .L261
 3201              	.LVL335:
 3202              	.L286:
1466:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3203              	 .loc 1 1466 0
 3204 00ce 40F20220 	 movw r0,#514
 3205              	.LVL336:
 3206              	.L261:
1560:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3207              	 .loc 1 1560 0
 3208 00d2 02B0     	 add sp,sp,#8
 3209              	.LCFI24:
 3210              	 .cfi_def_cfa_offset 8
 3211              	 
 3212 00d4 10BD     	 pop {r4,pc}
 3213              	.LVL337:
 3214              	.L290:
 3215 00d6 00BF     	 .align 2
 3216              	.L289:
 3217 00d8 00000000 	 .word .LANCHOR0
 3218              	 .cfi_endproc
 3219              	.LFE33:
 3221              	 .section .text.optiga_cmd_queue_scheduler,"ax",%progbits
 3222              	 .align 1
 3223              	 .thumb
 3224              	 .thumb_func
 3226              	optiga_cmd_queue_scheduler:
 3227              	.LFB12:
 631:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint32_t reference_time_stamp = 0xFFFFFFFF;
 3228              	 .loc 1 631 0
 3229              	 .cfi_startproc
 3230              	 
 3231              	 
 3232              	.LVL338:
 3233 0000 2DE9F74F 	 push {r0,r1,r2,r4,r5,r6,r7,r8,r9,r10,fp,lr}
 3234              	.LCFI25:
 3235              	 .cfi_def_cfa_offset 48
 3236              	 .cfi_offset 4,-36
 3237              	 .cfi_offset 5,-32
 3238              	 .cfi_offset 6,-28
 3239              	 .cfi_offset 7,-24
 3240              	 .cfi_offset 8,-20
 3241              	 .cfi_offset 9,-16
 3242              	 .cfi_offset 10,-12
 3243              	 .cfi_offset 11,-8
 3244              	 .cfi_offset 14,-4
 640:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3245              	 .loc 1 640 0
 3246 0004 D0F87886 	 ldr r8,[r0,#1656]
 3247              	.LVL339:
 631:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint32_t reference_time_stamp = 0xFFFFFFFF;
 3248              	 .loc 1 631 0
 3249 0008 0446     	 mov r4,r0
 3250 000a 00F14809 	 add r9,r0,#72
 640:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3251              	 .loc 1 640 0
 3252 000e 0246     	 mov r2,r0
 3253              	.LBB220:
 3254              	.LBB221:
 567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t slot_value = 0;
 3255              	 .loc 1 567 0
 3256 0010 0023     	 movs r3,#0
 3257              	.LVL340:
 3258              	.L293:
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3259              	 .loc 1 586 0
 3260 0012 92F83916 	 ldrb r1,[r2,#1593]
 3261 0016 0229     	 cmp r1,#2
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3262              	 .loc 1 588 0
 3263 0018 08BF     	 it eq
 3264 001a 0133     	 addeq r3,r3,#1
 3265              	.LVL341:
 3266 001c 02F10C02 	 add r2,r2,#12
 3267              	.LVL342:
 3268 0020 08BF     	 it eq
 3269 0022 DBB2     	 uxtbeq r3,r3
 3270              	.LVL343:
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3271              	 .loc 1 569 0
 3272 0024 4A45     	 cmp r2,r9
 3273 0026 F4D1     	 bne .L293
 3274              	.LBE221:
 3275              	.LBE220:
 3276 0028 2246     	 mov r2,r4
 3277              	.LVL344:
 643:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****          (0 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE, OPTIGA_CMD_
 3278              	 .loc 1 643 0
 3279 002a 73B9     	 cbnz r3,.L323
 3280              	.LVL345:
 3281              	.L296:
 3282              	.LBB222:
 3283              	.LBB223:
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3284              	 .loc 1 586 0
 3285 002c 92F83916 	 ldrb r1,[r2,#1593]
 3286 0030 0829     	 cmp r1,#8
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3287              	 .loc 1 588 0
 3288 0032 08BF     	 it eq
 3289 0034 0133     	 addeq r3,r3,#1
 3290              	.LVL346:
 3291 0036 02F10C02 	 add r2,r2,#12
 3292              	.LVL347:
 3293 003a 08BF     	 it eq
 3294 003c DBB2     	 uxtbeq r3,r3
 3295              	.LVL348:
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3296              	 .loc 1 569 0
 3297 003e 4A45     	 cmp r2,r9
 3298 0040 F4D1     	 bne .L296
 3299              	.LBE223:
 3300              	.LBE222:
 643:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****          (0 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE, OPTIGA_CMD_
 3301              	 .loc 1 643 0
 3302 0042 002B     	 cmp r3,#0
 3303 0044 00F0AA80 	 beq .L345
 3304 0048 2246     	 mov r2,r4
 3305              	.LVL349:
 3306              	.L323:
 3307 004a 0023     	 movs r3,#0
 3308              	.L332:
 3309              	.LVL350:
 3310              	.LBB224:
 3311              	.LBB225:
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3312              	 .loc 1 586 0
 3313 004c 92F83916 	 ldrb r1,[r2,#1593]
 3314 0050 0429     	 cmp r1,#4
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3315              	 .loc 1 588 0
 3316 0052 08BF     	 it eq
 3317 0054 0133     	 addeq r3,r3,#1
 3318              	.LVL351:
 3319 0056 02F10C02 	 add r2,r2,#12
 3320              	.LVL352:
 3321 005a 08BF     	 it eq
 3322 005c DBB2     	 uxtbeq r3,r3
 3323              	.LVL353:
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3324              	 .loc 1 569 0
 3325 005e 4A45     	 cmp r2,r9
 3326 0060 F4D1     	 bne .L332
 3327              	.LBE225:
 3328              	.LBE224:
 644:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****          ((1 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE , OPTIGA_CM
 3329              	 .loc 1 644 0
 3330 0062 012B     	 cmp r3,#1
 3331 0064 0FD1     	 bne .L299
 3332 0066 2246     	 mov r2,r4
 3333              	.LVL354:
 3334 0068 0023     	 movs r3,#0
 3335              	.LVL355:
 3336              	.L301:
 3337              	.LBB226:
 3338              	.LBB227:
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3339              	 .loc 1 586 0
 3340 006a 92F83816 	 ldrb r1,[r2,#1592]
 3341 006e 2329     	 cmp r1,#35
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3342              	 .loc 1 588 0
 3343 0070 08BF     	 it eq
 3344 0072 0133     	 addeq r3,r3,#1
 3345              	.LVL356:
 3346 0074 02F10C02 	 add r2,r2,#12
 3347              	.LVL357:
 3348 0078 08BF     	 it eq
 3349 007a DBB2     	 uxtbeq r3,r3
 3350              	.LVL358:
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3351              	 .loc 1 569 0
 3352 007c 4A45     	 cmp r2,r9
 3353 007e F4D1     	 bne .L301
 3354              	.LBE227:
 3355              	.LBE226:
 645:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****          (0 < optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE, OPTIGA_C
 3356              	 .loc 1 645 0
 3357 0080 002B     	 cmp r3,#0
 3358 0082 40F08B80 	 bne .L345
 3359              	.LVL359:
 3360              	.L299:
 654:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // continue checking if no context selected and overflow detected
 3361              	 .loc 1 654 0
 3362 0086 4046     	 mov r0,r8
 3363              	.LVL360:
 3364 0088 FFF7FEFF 	 bl pal_os_event_stop
 3365              	.LVL361:
 632:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_slot_t * p_queue_entry;
 3366              	 .loc 1 632 0
 3367 008c 4FF0FF3A 	 mov r10,#-1
 3368              	.LVL362:
 3369              	.L302:
 632:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_slot_t * p_queue_entry;
 3370              	 .loc 1 632 0 is_stmt 0 discriminator 1
 3371 0090 0026     	 movs r6,#0
 3372 0092 2546     	 mov r5,r4
 3373 0094 B346     	 mov fp,r6
 3374 0096 FF27     	 movs r7,#255
 3375              	.LVL363:
 3376              	.L314:
 3377 0098 F2B2     	 uxtb r2,r6
 3378              	.LVL364:
 668:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3379              	 .loc 1 668 0 is_stmt 1
 3380 009a 2146     	 mov r1,r4
 3381              	.LBB228:
 3382              	.LBB229:
 567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t slot_value = 0;
 3383              	 .loc 1 567 0
 3384 009c 0023     	 movs r3,#0
 3385              	.LVL365:
 3386              	.L305:
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3387              	 .loc 1 586 0
 3388 009e 91F83906 	 ldrb r0,[r1,#1593]
 3389 00a2 0828     	 cmp r0,#8
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3390              	 .loc 1 588 0
 3391 00a4 08BF     	 it eq
 3392 00a6 0133     	 addeq r3,r3,#1
 3393              	.LVL366:
 3394 00a8 01F10C01 	 add r1,r1,#12
 3395              	.LVL367:
 3396 00ac 08BF     	 it eq
 3397 00ae DBB2     	 uxtbeq r3,r3
 3398              	.LVL368:
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3399              	 .loc 1 569 0
 3400 00b0 4945     	 cmp r1,r9
 3401 00b2 F4D1     	 bne .L305
 3402              	.LBE229:
 3403              	.LBE228:
 671:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 {
 3404              	 .loc 1 671 0
 3405 00b4 012B     	 cmp r3,#1
 3406 00b6 08D1     	 bne .L306
 674:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == p_queue_entry->request_type))
 3407              	 .loc 1 674 0
 3408 00b8 0C23     	 movs r3,#12
 3409              	.LVL369:
 3410 00ba 03FB0643 	 mla r3,r3,r6,r4
 3411 00be B3F83816 	 ldrh r1,[r3,#1592]
 3412              	.LVL370:
 3413 00c2 40F62303 	 movw r3,#2083
 3414 00c6 9942     	 cmp r1,r3
 3415 00c8 19E0     	 b .L348
 3416              	.LVL371:
 3417              	.L306:
 685:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                     {
 3418              	 .loc 1 685 0
 3419 00ca 95F83936 	 ldrb r3,[r5,#1593]
 3420              	.LVL372:
 3421 00ce 022B     	 cmp r3,#2
 3422 00d0 1FD1     	 bne .L307
 688:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         {
 3423              	 .loc 1 688 0
 3424 00d2 D5F83416 	 ldr r1,[r5,#1588]
 3425 00d6 D4F87C36 	 ldr r3,[r4,#1660]
 3426 00da 9942     	 cmp r1,r3
 3427 00dc 02D2     	 bcs .L349
 690:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                         }
 3428              	 .loc 1 690 0
 3429 00de 4FF0010B 	 mov fp,#1
 3430 00e2 16E0     	 b .L307
 3431              	.L349:
 694:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             (((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && 
 3432              	 .loc 1 694 0
 3433 00e4 5145     	 cmp r1,r10
 3434 00e6 14D8     	 bhi .L307
 694:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             (((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && 
 3435              	 .loc 1 694 0 is_stmt 0 discriminator 2
 3436 00e8 95F83836 	 ldrb r3,[r5,#1592]
 3437 00ec 222B     	 cmp r3,#34
 3438 00ee 5FD0     	 beq .L309
 3439              	.LVL373:
 3440              	.L312:
 696:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             (OPTIGA_CMD_QUEUE_REQUEST_LOCK == p_queue_entry->request_type) ||
 3441              	 .loc 1 696 0 is_stmt 1
 3442 00f0 95F83836 	 ldrb r3,[r5,#1592]
 695:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             ((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && (
 3443              	 .loc 1 695 0
 3444 00f4 222B     	 cmp r3,#34
 3445 00f6 07D0     	 beq .L350
 696:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             (OPTIGA_CMD_QUEUE_REQUEST_LOCK == p_queue_entry->request_type) ||
 3446              	 .loc 1 696 0 discriminator 1
 3447 00f8 03F0FD03 	 and r3,r3,#253
 3448 00fc 212B     	 cmp r3,#33
 3449              	.L348:
 3450 00fe 08D1     	 bne .L307
 3451              	.L313:
 700:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             prefered_index = index;
 3452              	 .loc 1 700 0
 3453 0100 D5F834A6 	 ldr r10,[r5,#1588]
 3454              	.LVL374:
 3455 0104 1746     	 mov r7,r2
 3456 0106 04E0     	 b .L307
 3457              	.LVL375:
 3458              	.L350:
 696:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                             (OPTIGA_CMD_QUEUE_REQUEST_LOCK == p_queue_entry->request_type) ||
 3459              	 .loc 1 696 0
 3460 0108 D5F83036 	 ldr r3,[r5,#1584]
 3461 010c 9B8A     	 ldrh r3,[r3,#20]
 3462 010e 002B     	 cmp r3,#0
 3463 0110 F6D1     	 bne .L313
 3464              	.L307:
 3465              	.LVL376:
 3466 0112 0136     	 adds r6,r6,#1
 3467              	.LVL377:
 666:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3468              	 .loc 1 666 0 discriminator 2
 3469 0114 062E     	 cmp r6,#6
 3470 0116 05F10C05 	 add r5,r5,#12
 3471 011a BDD1     	 bne .L314
 706:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3472              	 .loc 1 706 0
 3473 011c FF2F     	 cmp r7,#255
 3474 011e 06D1     	 bne .L315
 706:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3475              	 .loc 1 706 0 is_stmt 0 discriminator 1
 3476 0120 BBF1000F 	 cmp fp,#0
 3477 0124 3AD0     	 beq .L345
 3478              	.LVL378:
 661:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 overflow_detected = FALSE;
 3479              	 .loc 1 661 0 is_stmt 1
 3480 0126 0023     	 movs r3,#0
 3481 0128 C4F87C36 	 str r3,[r4,#1660]
 3482              	.LVL379:
 3483 012c B0E7     	 b .L302
 3484              	.LVL380:
 3485              	.L315:
 714:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (OPTIGA_CMD_NO_SESSION_OID == ((optiga_cmd_t *)p_queue_entry->registered_ctx)->sess
 3486              	 .loc 1 714 0
 3487 012e 0C23     	 movs r3,#12
 3488 0130 03FB0743 	 mla r3,r3,r7,r4
 3489 0134 93F83826 	 ldrb r2,[r3,#1592]
 3490 0138 222A     	 cmp r2,#34
 3491 013a 1BD1     	 bne .L318
 715:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3492              	 .loc 1 715 0 discriminator 1
 3493 013c D3F83006 	 ldr r0,[r3,#1584]
 714:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 (OPTIGA_CMD_NO_SESSION_OID == ((optiga_cmd_t *)p_queue_entry->registered_ctx)->sess
 3494              	 .loc 1 714 0 discriminator 1
 3495 0140 838A     	 ldrh r3,[r0,#20]
 3496 0142 BBB9     	 cbnz r3,.L318
 3497              	.LVL381:
 3498              	.LBB230:
 3499              	.LBB231:
 504:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t count;
 3500              	 .loc 1 504 0
 3501 0144 0368     	 ldr r3,[r0]
 3502              	.LVL382:
 3503 0146 03F10805 	 add r5,r3,#8
 3504              	.LVL383:
 3505 014a 03F10C01 	 add r1,r3,#12
 3506 014e 2B46     	 mov r3,r5
 3507              	.LVL384:
 3508              	.L320:
 510:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3509              	 .loc 1 510 0
 3510 0150 1E46     	 mov r6,r3
 3511 0152 5A1B     	 subs r2,r3,r5
 3512 0154 96F800E0 	 ldrb lr,[r6]
 3513 0158 BEF1100F 	 cmp lr,#16
 3514 015c D2B2     	 uxtb r2,r2
 3515              	.LVL385:
 3516 015e 03F10103 	 add r3,r3,#1
 3517 0162 05D0     	 beq .L319
 512:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 p_optiga_sessions[count] = OPTIGA_CMD_SESSION_ASSIGNED;
 3518              	 .loc 1 512 0
 3519 0164 42F46143 	 orr r3,r2,#57600
 3520 0168 8382     	 strh r3,[r0,#20]
 513:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 break;
 3521              	 .loc 1 513 0
 3522 016a 1023     	 movs r3,#16
 3523 016c 3370     	 strb r3,[r6]
 3524 016e 01E0     	 b .L318
 3525              	.L319:
 3526              	.LVL386:
 508:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3527              	 .loc 1 508 0
 3528 0170 8B42     	 cmp r3,r1
 3529 0172 EDD1     	 bne .L320
 3530              	.LVL387:
 3531              	.L318:
 3532              	.LBE231:
 3533              	.LBE230:
 722:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(my_os_event,
 3534              	 .loc 1 722 0
 3535 0174 0C23     	 movs r3,#12
 3536 0176 03FB0747 	 mla r7,r3,r7,r4
 3537              	.LVL388:
 723:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    optiga_cmd_event_trigger_execute,
 3538              	 .loc 1 723 0
 3539 017a 1249     	 ldr r1,.L351
 722:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(my_os_event,
 3540              	 .loc 1 722 0
 3541 017c D7F83026 	 ldr r2,[r7,#1584]
 3542              	.LVL389:
 3543 0180 1368     	 ldr r3,[r2]
 723:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                    optiga_cmd_event_trigger_execute,
 3544              	 .loc 1 723 0
 3545 0182 D3F87806 	 ldr r0,[r3,#1656]
 3546 0186 3223     	 movs r3,#50
 3547 0188 FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 3548              	.LVL390:
 727:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             p_optiga_ctx->last_time_stamp = reference_time_stamp;
 3549              	 .loc 1 727 0
 3550 018c 0423     	 movs r3,#4
 3551 018e 87F83936 	 strb r3,[r7,#1593]
 728:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3552              	 .loc 1 728 0
 3553 0192 C4F87CA6 	 str r10,[r4,#1660]
 736:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3554              	 .loc 1 736 0
 3555 0196 03B0     	 add sp,sp,#12
 3556              	.LCFI26:
 3557              	 .cfi_remember_state
 3558              	 .cfi_def_cfa_offset 36
 3559              	 
 3560 0198 BDE8F08F 	 pop {r4,r5,r6,r7,r8,r9,r10,fp,pc}
 3561              	.LVL391:
 3562              	.L345:
 3563              	.LCFI27:
 3564              	 .cfi_restore_state
 732:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                     p_optiga_ctx,OPTIGA_CMD_SCHEDULER_IDLING_TIME_M
 3565              	 .loc 1 732 0
 3566 019c 0A49     	 ldr r1,.L351+4
 3567 019e 4046     	 mov r0,r8
 3568 01a0 2246     	 mov r2,r4
 3569 01a2 4FF47A73 	 mov r3,#1000
 736:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3570              	 .loc 1 736 0
 3571 01a6 03B0     	 add sp,sp,#12
 3572              	.LCFI28:
 3573              	 .cfi_remember_state
 3574              	 .cfi_def_cfa_offset 36
 3575              	 
 3576 01a8 BDE8F04F 	 pop {r4,r5,r6,r7,r8,r9,r10,fp,lr}
 3577              	.LCFI29:
 3578              	 .cfi_restore 14
 3579              	 .cfi_restore 11
 3580              	 .cfi_restore 10
 3581              	 .cfi_restore 9
 3582              	 .cfi_restore 8
 3583              	 .cfi_restore 7
 3584              	 .cfi_restore 6
 3585              	 .cfi_restore 5
 3586              	 .cfi_restore 4
 3587              	 .cfi_def_cfa_offset 0
 3588              	.LVL392:
 732:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                     p_optiga_ctx,OPTIGA_CMD_SCHEDULER_IDLING_TIME_M
 3589              	 .loc 1 732 0
 3590 01ac FFF7FEBF 	 b pal_os_event_register_callback_oneshot
 3591              	.LVL393:
 3592              	.L309:
 3593              	.LCFI30:
 3594              	 .cfi_restore_state
 3595              	.LBB232:
 3596              	.LBB233:
 495:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return ((status_check < OPTIGA_CMD_ALL_SESSION_ASSIGNED)? (TRUE):(FALSE));
 3597              	 .loc 1 495 0
 3598 01b0 04F10800 	 add r0,r4,#8
 3599              	.LVL394:
 3600 01b4 0192     	 str r2,[sp,#4]
 3601              	.LVL395:
 3602 01b6 FFF7FEFF 	 bl optiga_common_get_uint32
 3603              	.LVL396:
 496:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 3604              	 .loc 1 496 0
 3605 01ba B0F1103F 	 cmp r0,#269488144
 3606 01be 019A     	 ldr r2,[sp,#4]
 3607 01c0 96D2     	 bcs .L312
 3608 01c2 9DE7     	 b .L313
 3609              	.L352:
 3610              	 .align 2
 3611              	.L351:
 3612 01c4 00000000 	 .word optiga_cmd_event_trigger_execute
 3613 01c8 00000000 	 .word optiga_cmd_queue_scheduler
 3614              	.LBE233:
 3615              	.LBE232:
 3616              	 .cfi_endproc
 3617              	.LFE12:
 3619              	 .section .text.optiga_cmd_set_shielded_connection_option,"ax",%progbits
 3620              	 .align 1
 3621              	 .global optiga_cmd_set_shielded_connection_option
 3622              	 .thumb
 3623              	 .thumb_func
 3625              	optiga_cmd_set_shielded_connection_option:
 3626              	.LFB0:
 394:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     switch (shielded_connection_option)
 3627              	 .loc 1 394 0
 3628              	 .cfi_startproc
 3629              	 
 3630              	 
 3631              	 
 3632              	.LVL397:
 395:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3633              	 .loc 1 395 0
 3634 0000 012A     	 cmp r2,#1
 3635 0002 05D0     	 beq .L355
 3636 0004 02D3     	 bcc .L356
 3637 0006 022A     	 cmp r2,#2
 3638 0008 04D0     	 beq .L357
 3639 000a 7047     	 bx lr
 3640              	.L356:
 400:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3641              	 .loc 1 400 0
 3642 000c 8176     	 strb r1,[r0,#26]
 402:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Protocol Version
 3643              	 .loc 1 402 0
 3644 000e 7047     	 bx lr
 3645              	.L355:
 406:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3646              	 .loc 1 406 0
 3647 0010 C176     	 strb r1,[r0,#27]
 408:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         // Manage Context
 3648              	 .loc 1 408 0
 3649 0012 7047     	 bx lr
 3650              	.L357:
 412:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3651              	 .loc 1 412 0
 3652 0014 0177     	 strb r1,[r0,#28]
 3653 0016 7047     	 bx lr
 3654              	 .cfi_endproc
 3655              	.LFE0:
 3657              	 .section .text.optiga_cmd_request_session,"ax",%progbits
 3658              	 .align 1
 3659              	 .global optiga_cmd_request_session
 3660              	 .thumb
 3661              	 .thumb_func
 3663              	optiga_cmd_request_session:
 3664              	.LFB15:
 786:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_update_slot(me , OPTIGA_CMD_QUEUE_REQUEST_SESSION);
 3665              	 .loc 1 786 0
 3666              	 .cfi_startproc
 3667              	 
 3668              	 
 3669              	.LVL398:
 3670 0000 08B5     	 push {r3,lr}
 3671              	.LCFI31:
 3672              	 .cfi_def_cfa_offset 8
 3673              	 .cfi_offset 3,-8
 3674              	 .cfi_offset 14,-4
 787:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 3675              	 .loc 1 787 0
 3676 0002 2221     	 movs r1,#34
 3677 0004 FFF7FEFF 	 bl optiga_cmd_queue_update_slot
 3678              	.LVL399:
 789:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3679              	 .loc 1 789 0
 3680 0008 0020     	 movs r0,#0
 3681 000a 08BD     	 pop {r3,pc}
 3682              	 .cfi_endproc
 3683              	.LFE15:
 3685              	 .section .text.optiga_cmd_release_session,"ax",%progbits
 3686              	 .align 1
 3687              	 .global optiga_cmd_release_session
 3688              	 .thumb
 3689              	 .thumb_func
 3691              	optiga_cmd_release_session:
 3692              	.LFB16:
 792:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_session_free(me);
 3693              	 .loc 1 792 0
 3694              	 .cfi_startproc
 3695              	 
 3696              	 
 3697              	 
 3698              	.LVL400:
 3699              	.LBB236:
 3700              	.LBB237:
 527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3701              	 .loc 1 527 0
 3702 0000 838A     	 ldrh r3,[r0,#20]
 525:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t count;
 3703              	 .loc 1 525 0
 3704 0002 0168     	 ldr r1,[r0]
 3705              	.LVL401:
 527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3706              	 .loc 1 527 0
 3707 0004 2BB1     	 cbz r3,.L360
 3708              	.LVL402:
 531:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 3709              	 .loc 1 531 0
 3710 0006 03F00F03 	 and r3,r3,#15
 3711              	.LVL403:
 3712 000a 0B44     	 add r3,r3,r1
 530:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         p_optiga_sessions[count] = OPTIGA_CMD_SESSION_NOT_ASSIGNED;
 3713              	 .loc 1 530 0
 3714 000c 0022     	 movs r2,#0
 3715 000e 8282     	 strh r2,[r0,#20]
 3716              	.LVL404:
 531:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 3717              	 .loc 1 531 0
 3718 0010 1A72     	 strb r2,[r3,#8]
 3719              	.L360:
 3720              	.LBE237:
 3721              	.LBE236:
 795:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3722              	 .loc 1 795 0
 3723 0012 0020     	 movs r0,#0
 3724              	.LVL405:
 3725 0014 7047     	 bx lr
 3726              	 .cfi_endproc
 3727              	.LFE16:
 3729              	 .section .text.optiga_cmd_request_lock,"ax",%progbits
 3730              	 .align 1
 3731              	 .global optiga_cmd_request_lock
 3732              	 .thumb
 3733              	 .thumb_func
 3735              	optiga_cmd_request_lock:
 3736              	.LFB17:
 798:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_update_slot(me , lock_type);
 3737              	 .loc 1 798 0
 3738              	 .cfi_startproc
 3739              	 
 3740              	 
 3741              	.LVL406:
 3742 0000 08B5     	 push {r3,lr}
 3743              	.LCFI32:
 3744              	 .cfi_def_cfa_offset 8
 3745              	 .cfi_offset 3,-8
 3746              	 .cfi_offset 14,-4
 799:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 3747              	 .loc 1 799 0
 3748 0002 FFF7FEFF 	 bl optiga_cmd_queue_update_slot
 3749              	.LVL407:
 801:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3750              	 .loc 1 801 0
 3751 0006 0020     	 movs r0,#0
 3752 0008 08BD     	 pop {r3,pc}
 3753              	 .cfi_endproc
 3754              	.LFE17:
 3756              	 .section .text.optiga_cmd_release_lock,"ax",%progbits
 3757              	 .align 1
 3758              	 .global optiga_cmd_release_lock
 3759              	 .thumb
 3760              	 .thumb_func
 3762              	optiga_cmd_release_lock:
 3763              	.LFB18:
 804:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_reset_slot(me);
 3764              	 .loc 1 804 0
 3765              	 .cfi_startproc
 3766              	 
 3767              	 
 3768              	.LVL408:
 3769 0000 08B5     	 push {r3,lr}
 3770              	.LCFI33:
 3771              	 .cfi_def_cfa_offset 8
 3772              	 .cfi_offset 3,-8
 3773              	 .cfi_offset 14,-4
 805:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 3774              	 .loc 1 805 0
 3775 0002 FFF7FEFF 	 bl optiga_cmd_queue_reset_slot
 3776              	.LVL409:
 807:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3777              	 .loc 1 807 0
 3778 0006 0020     	 movs r0,#0
 3779 0008 08BD     	 pop {r3,pc}
 3780              	 .cfi_endproc
 3781              	.LFE18:
 3783              	 .section .text.optiga_cmd_create,"ax",%progbits
 3784              	 .align 1
 3785              	 .global optiga_cmd_create
 3786              	 .thumb
 3787              	 .thumb_func
 3789              	optiga_cmd_create:
 3790              	.LFB30:
1305:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_t * me = NULL;
 3791              	 .loc 1 1305 0
 3792              	 .cfi_startproc
 3793              	 
 3794              	 
 3795              	.LVL410:
 3796 0000 F8B5     	 push {r3,r4,r5,r6,r7,lr}
 3797              	.LCFI34:
 3798              	 .cfi_def_cfa_offset 24
 3799              	 .cfi_offset 3,-24
 3800              	 .cfi_offset 4,-20
 3801              	 .cfi_offset 5,-16
 3802              	 .cfi_offset 6,-12
 3803              	 .cfi_offset 7,-8
 3804              	 .cfi_offset 14,-4
1305:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_t * me = NULL;
 3805              	 .loc 1 1305 0
 3806 0002 1646     	 mov r6,r2
 3807 0004 0F46     	 mov r7,r1
1308:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
 3808              	 .loc 1 1308 0
 3809 0006 FFF7FEFF 	 bl pal_os_lock_enter_critical_section
 3810              	.LVL411:
 3811 000a 0022     	 movs r2,#0
 3812              	.LBB242:
 3813              	.LBB243:
 567:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t slot_value = 0;
 3814              	 .loc 1 567 0
 3815 000c 1346     	 mov r3,r2
 3816              	.LVL412:
 3817              	.L368:
 3818 000e 254D     	 ldr r5,.L381
 3819 0010 A918     	 adds r1,r5,r2
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3820              	 .loc 1 586 0
 3821 0012 91F83916 	 ldrb r1,[r1,#1593]
 3822 0016 09B9     	 cbnz r1,.L367
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3823              	 .loc 1 588 0
 3824 0018 0133     	 adds r3,r3,#1
 3825              	.LVL413:
 3826 001a DBB2     	 uxtb r3,r3
 3827              	.LVL414:
 3828              	.L367:
 3829 001c 0C32     	 adds r2,r2,#12
 3830              	.LVL415:
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3831              	 .loc 1 569 0
 3832 001e 482A     	 cmp r2,#72
 3833 0020 F5D1     	 bne .L368
 3834              	.LBE243:
 3835              	.LBE242:
1312:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_QUEUE_SLOT_STATE,
 3836              	 .loc 1 1312 0
 3837 0022 0BB9     	 cbnz r3,.L369
 3838              	.LVL416:
 3839              	.L371:
1306:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3840              	 .loc 1 1306 0
 3841 0024 0024     	 movs r4,#0
 3842 0026 39E0     	 b .L370
 3843              	.LVL417:
 3844              	.L369:
1319:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (NULL == me)
 3845              	 .loc 1 1319 0
 3846 0028 0120     	 movs r0,#1
 3847 002a 2821     	 movs r1,#40
 3848 002c FFF7FEFF 	 bl pal_os_calloc
 3849              	.LVL418:
1320:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3850              	 .loc 1 1320 0
 3851 0030 0446     	 mov r4,r0
 3852 0032 0028     	 cmp r0,#0
 3853 0034 F6D0     	 beq .L371
1326:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3854              	 .loc 1 1326 0
 3855 0036 C660     	 str r6,[r0,#12]
1329:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3856              	 .loc 1 1329 0
 3857 0038 3323     	 movs r3,#51
1328:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->optiga_context_datastore_id = g_hibernate_datastore_id_list[optiga_instance_id];
 3858              	 .loc 1 1328 0
 3859 003a 0560     	 str r5,[r0]
1329:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3860              	 .loc 1 1329 0
 3861 003c 4384     	 strh r3,[r0,#34]
1331:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3862              	 .loc 1 1331 0
 3863 003e 2B7B     	 ldrb r3,[r5,#12]
1325:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->caller_context = caller_context;
 3864              	 .loc 1 1325 0
 3865 0040 0761     	 str r7,[r0,#16]
1328:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         me->optiga_context_datastore_id = g_hibernate_datastore_id_list[optiga_instance_id];
 3866              	 .loc 1 1328 0
 3867 0042 184E     	 ldr r6,.L381
 3868              	.LVL419:
1331:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3869              	 .loc 1 1331 0
 3870 0044 CBB9     	 cbnz r3,.L372
1334:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms = optiga_comms_create(optiga_cmd_execute_handler, me);
 3871              	 .loc 1 1334 0
 3872 0046 3146     	 mov r1,r6
 3873 0048 1748     	 ldr r0,.L381+4
 3874              	.LVL420:
 3875 004a FFF7FEFF 	 bl pal_os_event_create
 3876              	.LVL421:
1335:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (NULL == me->p_optiga->p_optiga_comms)
 3877              	 .loc 1 1335 0
 3878 004e 2146     	 mov r1,r4
1334:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms = optiga_comms_create(optiga_cmd_execute_handler, me);
 3879              	 .loc 1 1334 0
 3880 0050 C6F87806 	 str r0,[r6,#1656]
1335:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (NULL == me->p_optiga->p_optiga_comms)
 3881              	 .loc 1 1335 0
 3882 0054 1548     	 ldr r0,.L381+8
 3883 0056 2568     	 ldr r5,[r4]
 3884 0058 FFF7FEFF 	 bl optiga_comms_create
 3885              	.LVL422:
1336:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3886              	 .loc 1 1336 0
 3887 005c 2368     	 ldr r3,[r4]
1335:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             if (NULL == me->p_optiga->p_optiga_comms)
 3888              	 .loc 1 1335 0
 3889 005e 2860     	 str r0,[r5]
1336:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 3890              	 .loc 1 1336 0
 3891 0060 1D68     	 ldr r5,[r3]
 3892 0062 1DB9     	 cbnz r5,.L373
1338:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                 me = NULL;
 3893              	 .loc 1 1338 0
 3894 0064 2046     	 mov r0,r4
 3895 0066 FFF7FEFF 	 bl pal_os_free
 3896              	.LVL423:
 3897 006a DBE7     	 b .L371
 3898              	.LVL424:
 3899              	.L373:
1342:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->p_pal_os_event_ctx = me->p_optiga->p_pal_os_event_ctx;
 3900              	 .loc 1 1342 0
 3901 006c 0122     	 movs r2,#1
 3902 006e 1A73     	 strb r2,[r3,#12]
1343:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 3903              	 .loc 1 1343 0
 3904 0070 2368     	 ldr r3,[r4]
 3905 0072 1A68     	 ldr r2,[r3]
 3906 0074 D3F87836 	 ldr r3,[r3,#1656]
 3907 0078 5361     	 str r3,[r2,#20]
 3908              	.L372:
 3909              	.LVL425:
 3910              	.LBB244:
 3911              	.LBB245:
 602:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3912              	 .loc 1 602 0
 3913 007a 2168     	 ldr r1,[r4]
 3914 007c 0023     	 movs r3,#0
 3915              	.LVL426:
 3916              	.L375:
 3917 007e 0C22     	 movs r2,#12
 3918 0080 02FB0312 	 mla r2,r2,r3,r1
 3919 0084 D8B2     	 uxtb r0,r3
 3920              	.LVL427:
 3921 0086 92F83956 	 ldrb r5,[r2,#1593]
 3922 008a 25B9     	 cbnz r5,.L374
 605:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****            break;
 3923              	 .loc 1 605 0
 3924 008c 0123     	 movs r3,#1
 604:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             me->p_optiga->optiga_cmd_execution_queue[index].state_of_entry = OPTIGA_CMD_QUEUE_ASSIG
 3925              	 .loc 1 604 0
 3926 008e A077     	 strb r0,[r4,#30]
 605:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****            break;
 3927              	 .loc 1 605 0
 3928 0090 82F83936 	 strb r3,[r2,#1593]
 3929 0094 02E0     	 b .L370
 3930              	.L374:
 3931              	.LVL428:
 3932 0096 0133     	 adds r3,r3,#1
 3933              	.LVL429:
 600:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3934              	 .loc 1 600 0
 3935 0098 062B     	 cmp r3,#6
 3936 009a F0D1     	 bne .L375
 3937              	.LVL430:
 3938              	.L370:
 3939              	.LBE245:
 3940              	.LBE244:
1349:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (me);
 3941              	 .loc 1 1349 0
 3942 009c FFF7FEFF 	 bl pal_os_lock_exit_critical_section
 3943              	.LVL431:
1351:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 3944              	 .loc 1 1351 0
 3945 00a0 2046     	 mov r0,r4
 3946 00a2 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 3947              	.LVL432:
 3948              	.L382:
 3949              	 .align 2
 3950              	.L381:
 3951 00a4 00000000 	 .word .LANCHOR1
 3952 00a8 00000000 	 .word optiga_cmd_queue_scheduler
 3953 00ac 00000000 	 .word optiga_cmd_execute_handler
 3954              	 .cfi_endproc
 3955              	.LFE30:
 3957              	 .section .text.optiga_cmd_destroy,"ax",%progbits
 3958              	 .align 1
 3959              	 .global optiga_cmd_destroy
 3960              	 .thumb
 3961              	 .thumb_func
 3963              	optiga_cmd_destroy:
 3964              	.LFB31:
1354:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 3965              	 .loc 1 1354 0
 3966              	 .cfi_startproc
 3967              	 
 3968              	 
 3969              	.LVL433:
 3970 0000 10B5     	 push {r4,lr}
 3971              	.LCFI35:
 3972              	 .cfi_def_cfa_offset 8
 3973              	 .cfi_offset 4,-8
 3974              	 .cfi_offset 14,-4
1358:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 3975              	 .loc 1 1358 0
 3976 0002 D8B1     	 cbz r0,.L386
 3977              	.LVL434:
 3978              	.LBB252:
 3979              	.LBB253:
 3980              	.LBB254:
 527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3981              	 .loc 1 527 0
 3982 0004 838A     	 ldrh r3,[r0,#20]
 525:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     uint8_t count;
 3983              	 .loc 1 525 0
 3984 0006 0168     	 ldr r1,[r0]
 3985              	.LVL435:
 527:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 3986              	 .loc 1 527 0
 3987 0008 2BB1     	 cbz r3,.L385
 3988              	.LVL436:
 531:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 3989              	 .loc 1 531 0
 3990 000a 03F00F03 	 and r3,r3,#15
 3991              	.LVL437:
 3992 000e 0B44     	 add r3,r3,r1
 530:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         p_optiga_sessions[count] = OPTIGA_CMD_SESSION_NOT_ASSIGNED;
 3993              	 .loc 1 530 0
 3994 0010 0022     	 movs r2,#0
 3995 0012 8282     	 strh r2,[r0,#20]
 3996              	.LVL438:
 531:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 3997              	 .loc 1 531 0
 3998 0014 1A72     	 strb r2,[r3,#8]
 3999              	.L385:
 4000              	.LVL439:
 4001              	.LBE254:
 4002              	.LBE253:
 4003              	.LBE252:
 4004              	.LBB255:
 4005              	.LBB256:
 616:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type = OPTIGA_CMD_QUEUE_NO_REQUE
 4006              	 .loc 1 616 0
 4007 0016 0268     	 ldr r2,[r0]
 4008 0018 837F     	 ldrb r3,[r0,#30]
 4009 001a 0C21     	 movs r1,#12
 4010              	.LVL440:
 4011 001c 01FB0323 	 mla r3,r1,r3,r2
 4012 0020 0024     	 movs r4,#0
 4013 0022 83F83946 	 strb r4,[r3,#1593]
 617:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->queue_id = 0;
 4014              	 .loc 1 617 0
 4015 0026 827F     	 ldrb r2,[r0,#30]
 4016 0028 0368     	 ldr r3,[r0]
 4017 002a 01FB0233 	 mla r3,r1,r2,r3
 4018 002e 83F83846 	 strb r4,[r3,#1592]
 618:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4019              	 .loc 1 618 0
 4020 0032 8477     	 strb r4,[r0,#30]
 4021              	.LBE256:
 4022              	.LBE255:
1363:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             //lint --e{838} suppress "Release session API returns success. Status is checked for fu
 4023              	 .loc 1 1363 0
 4024 0034 FFF7FEFF 	 bl pal_os_free
 4025              	.LVL441:
1365:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 4026              	 .loc 1 1365 0
 4027 0038 2046     	 mov r0,r4
 4028 003a 10BD     	 pop {r4,pc}
 4029              	.LVL442:
 4030              	.L386:
1355:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     do
 4031              	 .loc 1 1355 0
 4032 003c 40F20220 	 movw r0,#514
 4033              	.LVL443:
1369:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 4034              	 .loc 1 1369 0
 4035 0040 10BD     	 pop {r4,pc}
 4036              	 .cfi_endproc
 4037              	.LFE31:
 4039              	 .section .text.optiga_cmd_open_application,"ax",%progbits
 4040              	 .align 1
 4041              	 .global optiga_cmd_open_application
 4042              	 .thumb
 4043              	 .thumb_func
 4045              	optiga_cmd_open_application:
 4046              	.LFB34:
1564:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
 4047              	 .loc 1 1564 0
 4048              	 .cfi_startproc
 4049              	 
 4050              	 
 4051              	.LVL444:
 4052 0000 10B5     	 push {r4,lr}
 4053              	.LCFI36:
 4054              	 .cfi_def_cfa_offset 8
 4055              	 .cfi_offset 4,-8
 4056              	 .cfi_offset 14,-4
 4057              	.LBB257:
 4058              	.LBB258:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4059              	 .loc 1 475 0
 4060 0002 8260     	 str r2,[r0,#8]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4061              	 .loc 1 478 0
 4062 0004 064A     	 ldr r2,.L391
 4063              	.LVL445:
 4064 0006 4260     	 str r2,[r0,#4]
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4065              	 .loc 1 476 0
 4066 0008 0024     	 movs r4,#0
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4067              	 .loc 1 481 0
 4068 000a F022     	 movs r2,#240
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4069              	 .loc 1 476 0
 4070 000c 8475     	 strb r4,[r0,#22]
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4071              	 .loc 1 477 0
 4072 000e C475     	 strb r4,[r0,#23]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4073              	 .loc 1 479 0
 4074 0010 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4075              	 .loc 1 480 0
 4076 0012 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4077              	 .loc 1 481 0
 4078 0014 8284     	 strh r2,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4079              	 .loc 1 482 0
 4080 0016 2146     	 mov r1,r4
 4081              	.LVL446:
 4082 0018 FFF7FEFF 	 bl optiga_cmd_execute_handler
 4083              	.LVL447:
 4084              	.LBE258:
 4085              	.LBE257:
1576:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 4086              	 .loc 1 1576 0
 4087 001c 2046     	 mov r0,r4
 4088 001e 10BD     	 pop {r4,pc}
 4089              	.L392:
 4090              	 .align 2
 4091              	.L391:
 4092 0020 00000000 	 .word optiga_cmd_open_application_handler
 4093              	 .cfi_endproc
 4094              	.LFE34:
 4096              	 .section .text.optiga_cmd_close_application,"ax",%progbits
 4097              	 .align 1
 4098              	 .global optiga_cmd_close_application
 4099              	 .thumb
 4100              	 .thumb_func
 4102              	optiga_cmd_close_application:
 4103              	.LFB36:
1647:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
 4104              	 .loc 1 1647 0
 4105              	 .cfi_startproc
 4106              	 
 4107              	 
 4108              	.LVL448:
 4109 0000 10B5     	 push {r4,lr}
 4110              	.LCFI37:
 4111              	 .cfi_def_cfa_offset 8
 4112              	 .cfi_offset 4,-8
 4113              	 .cfi_offset 14,-4
 4114              	.LBB259:
 4115              	.LBB260:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4116              	 .loc 1 475 0
 4117 0002 8260     	 str r2,[r0,#8]
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4118              	 .loc 1 476 0
 4119 0004 0222     	 movs r2,#2
 4120              	.LVL449:
 4121 0006 8275     	 strb r2,[r0,#22]
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4122              	 .loc 1 477 0
 4123 0008 0622     	 movs r2,#6
 4124 000a C275     	 strb r2,[r0,#23]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4125              	 .loc 1 478 0
 4126 000c 054A     	 ldr r2,.L394
 4127 000e 4260     	 str r2,[r0,#4]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4128              	 .loc 1 479 0
 4129 0010 0024     	 movs r4,#0
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4130              	 .loc 1 481 0
 4131 0012 F122     	 movs r2,#241
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4132              	 .loc 1 479 0
 4133 0014 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4134              	 .loc 1 480 0
 4135 0016 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4136              	 .loc 1 481 0
 4137 0018 8284     	 strh r2,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4138              	 .loc 1 482 0
 4139 001a 2146     	 mov r1,r4
 4140              	.LVL450:
 4141 001c FFF7FEFF 	 bl optiga_cmd_execute_handler
 4142              	.LVL451:
 4143              	.LBE260:
 4144              	.LBE259:
1659:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 4145              	 .loc 1 1659 0
 4146 0020 2046     	 mov r0,r4
 4147 0022 10BD     	 pop {r4,pc}
 4148              	.L395:
 4149              	 .align 2
 4150              	.L394:
 4151 0024 00000000 	 .word optiga_cmd_close_application_handler
 4152              	 .cfi_endproc
 4153              	.LFE36:
 4155              	 .section .text.optiga_cmd_get_data_object,"ax",%progbits
 4156              	 .align 1
 4157              	 .global optiga_cmd_get_data_object
 4158              	 .thumb
 4159              	 .thumb_func
 4161              	optiga_cmd_get_data_object:
 4162              	.LFB38:
1797:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
 4163              	 .loc 1 1797 0
 4164              	 .cfi_startproc
 4165              	 
 4166              	 
 4167              	.LVL452:
 4168 0000 10B5     	 push {r4,lr}
 4169              	.LCFI38:
 4170              	 .cfi_def_cfa_offset 8
 4171              	 .cfi_offset 4,-8
 4172              	 .cfi_offset 14,-4
 4173              	.LBB261:
 4174              	.LBB262:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4175              	 .loc 1 475 0
 4176 0002 8260     	 str r2,[r0,#8]
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4177              	 .loc 1 476 0
 4178 0004 0222     	 movs r2,#2
 4179              	.LVL453:
 4180 0006 8275     	 strb r2,[r0,#22]
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4181              	 .loc 1 477 0
 4182 0008 0622     	 movs r2,#6
 4183 000a C275     	 strb r2,[r0,#23]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4184              	 .loc 1 478 0
 4185 000c 054A     	 ldr r2,.L397
 4186 000e 4260     	 str r2,[r0,#4]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4187              	 .loc 1 479 0
 4188 0010 0024     	 movs r4,#0
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4189              	 .loc 1 481 0
 4190 0012 8122     	 movs r2,#129
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4191              	 .loc 1 479 0
 4192 0014 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4193              	 .loc 1 480 0
 4194 0016 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4195              	 .loc 1 481 0
 4196 0018 8284     	 strh r2,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4197              	 .loc 1 482 0
 4198 001a 2146     	 mov r1,r4
 4199              	.LVL454:
 4200 001c FFF7FEFF 	 bl optiga_cmd_execute_handler
 4201              	.LVL455:
 4202              	.LBE262:
 4203              	.LBE261:
1809:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 4204              	 .loc 1 1809 0
 4205 0020 2046     	 mov r0,r4
 4206 0022 10BD     	 pop {r4,pc}
 4207              	.L398:
 4208              	 .align 2
 4209              	.L397:
 4210 0024 00000000 	 .word optiga_cmd_get_data_object_handler
 4211              	 .cfi_endproc
 4212              	.LFE38:
 4214              	 .section .text.optiga_cmd_set_data_object,"ax",%progbits
 4215              	 .align 1
 4216              	 .global optiga_cmd_set_data_object
 4217              	 .thumb
 4218              	 .thumb_func
 4220              	optiga_cmd_set_data_object:
 4221              	.LFB40:
1907:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
 4222              	 .loc 1 1907 0
 4223              	 .cfi_startproc
 4224              	 
 4225              	 
 4226              	.LVL456:
 4227 0000 10B5     	 push {r4,lr}
 4228              	.LCFI39:
 4229              	 .cfi_def_cfa_offset 8
 4230              	 .cfi_offset 4,-8
 4231              	 .cfi_offset 14,-4
 4232              	.LBB263:
 4233              	.LBB264:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4234              	 .loc 1 475 0
 4235 0002 8260     	 str r2,[r0,#8]
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4236              	 .loc 1 476 0
 4237 0004 0222     	 movs r2,#2
 4238              	.LVL457:
 4239 0006 8275     	 strb r2,[r0,#22]
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4240              	 .loc 1 477 0
 4241 0008 0622     	 movs r2,#6
 4242 000a C275     	 strb r2,[r0,#23]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4243              	 .loc 1 478 0
 4244 000c 054A     	 ldr r2,.L400
 4245 000e 4260     	 str r2,[r0,#4]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4246              	 .loc 1 479 0
 4247 0010 0024     	 movs r4,#0
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4248              	 .loc 1 481 0
 4249 0012 8222     	 movs r2,#130
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4250              	 .loc 1 479 0
 4251 0014 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4252              	 .loc 1 480 0
 4253 0016 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4254              	 .loc 1 481 0
 4255 0018 8284     	 strh r2,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4256              	 .loc 1 482 0
 4257 001a 2146     	 mov r1,r4
 4258              	.LVL458:
 4259 001c FFF7FEFF 	 bl optiga_cmd_execute_handler
 4260              	.LVL459:
 4261              	.LBE264:
 4262              	.LBE263:
1919:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 4263              	 .loc 1 1919 0
 4264 0020 2046     	 mov r0,r4
 4265 0022 10BD     	 pop {r4,pc}
 4266              	.L401:
 4267              	 .align 2
 4268              	.L400:
 4269 0024 00000000 	 .word optiga_cmd_set_data_object_handler
 4270              	 .cfi_endproc
 4271              	.LFE40:
 4273              	 .section .text.optiga_cmd_get_random,"ax",%progbits
 4274              	 .align 1
 4275              	 .global optiga_cmd_get_random
 4276              	 .thumb
 4277              	 .thumb_func
 4279              	optiga_cmd_get_random:
 4280              	.LFB42:
1983:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t cmd_handler_state = OPTIGA_CMD_EXEC_REQUEST_LOCK;
 4281              	 .loc 1 1983 0
 4282              	 .cfi_startproc
 4283              	 
 4284              	 
 4285              	.LVL460:
 4286 0000 10B5     	 push {r4,lr}
 4287              	.LCFI40:
 4288              	 .cfi_def_cfa_offset 8
 4289              	 .cfi_offset 4,-8
 4290              	 .cfi_offset 14,-4
 4291              	.LBB265:
 4292              	.LBB266:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4293              	 .loc 1 475 0
 4294 0002 8260     	 str r2,[r0,#8]
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4295              	 .loc 1 476 0
 4296 0004 0222     	 movs r2,#2
 4297              	.LVL461:
 4298 0006 8275     	 strb r2,[r0,#22]
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4299              	 .loc 1 477 0
 4300 0008 0622     	 movs r2,#6
 4301 000a C275     	 strb r2,[r0,#23]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4302              	 .loc 1 478 0
 4303 000c 054A     	 ldr r2,.L403
 4304 000e 4260     	 str r2,[r0,#4]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4305              	 .loc 1 479 0
 4306 0010 0024     	 movs r4,#0
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4307              	 .loc 1 481 0
 4308 0012 8C22     	 movs r2,#140
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4309              	 .loc 1 479 0
 4310 0014 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4311              	 .loc 1 480 0
 4312 0016 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4313              	 .loc 1 481 0
 4314 0018 8284     	 strh r2,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4315              	 .loc 1 482 0
 4316 001a 2146     	 mov r1,r4
 4317              	.LVL462:
 4318 001c FFF7FEFF 	 bl optiga_cmd_execute_handler
 4319              	.LVL463:
 4320              	.LBE266:
 4321              	.LBE265:
1997:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_RANDOM_ENABLED
 4322              	 .loc 1 1997 0
 4323 0020 2046     	 mov r0,r4
 4324 0022 10BD     	 pop {r4,pc}
 4325              	.L404:
 4326              	 .align 2
 4327              	.L403:
 4328 0024 00000000 	 .word optiga_cmd_get_random_handler
 4329              	 .cfi_endproc
 4330              	.LFE42:
 4332              	 .section .text.optiga_cmd_calc_sign,"ax",%progbits
 4333              	 .align 1
 4334              	 .global optiga_cmd_calc_sign
 4335              	 .thumb
 4336              	 .thumb_func
 4338              	optiga_cmd_calc_sign:
 4339              	.LFB44:
2108:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR_INVALID_INPUT;
 4340              	 .loc 1 2108 0
 4341              	 .cfi_startproc
 4342              	 
 4343              	 
 4344              	.LVL464:
2115:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 4345              	 .loc 1 2115 0
 4346 0000 9389     	 ldrh r3,[r2,#12]
2108:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR_INVALID_INPUT;
 4347              	 .loc 1 2108 0
 4348 0002 10B5     	 push {r4,lr}
 4349              	.LCFI41:
 4350              	 .cfi_def_cfa_offset 8
 4351              	 .cfi_offset 4,-8
 4352              	 .cfi_offset 14,-4
2115:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
 4353              	 .loc 1 2115 0
 4354 0004 1BB9     	 cbnz r3,.L408
2117:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             {
 4355              	 .loc 1 2117 0
 4356 0006 838A     	 ldrh r3,[r0,#20]
 4357 0008 93B1     	 cbz r3,.L409
2121:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 4358              	 .loc 1 2121 0
 4359 000a 0523     	 movs r3,#5
 4360 000c 00E0     	 b .L406
 4361              	.L408:
2111:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
 4362              	 .loc 1 2111 0
 4363 000e 0623     	 movs r3,#6
 4364              	.L406:
 4365              	.LVL465:
 4366              	.LBB267:
 4367              	.LBB268:
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4368              	 .loc 1 477 0
 4369 0010 C375     	 strb r3,[r0,#23]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4370              	 .loc 1 478 0
 4371 0012 094B     	 ldr r3,.L410
 4372              	.LVL466:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4373              	 .loc 1 475 0
 4374 0014 8260     	 str r2,[r0,#8]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4375              	 .loc 1 479 0
 4376 0016 0024     	 movs r4,#0
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4377              	 .loc 1 476 0
 4378 0018 0222     	 movs r2,#2
 4379              	.LVL467:
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4380              	 .loc 1 478 0
 4381 001a 4360     	 str r3,[r0,#4]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4382              	 .loc 1 481 0
 4383 001c B123     	 movs r3,#177
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4384              	 .loc 1 476 0
 4385 001e 8275     	 strb r2,[r0,#22]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4386              	 .loc 1 479 0
 4387 0020 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4388              	 .loc 1 480 0
 4389 0022 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4390              	 .loc 1 481 0
 4391 0024 8384     	 strh r3,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4392              	 .loc 1 482 0
 4393 0026 2146     	 mov r1,r4
 4394              	.LVL468:
 4395 0028 FFF7FEFF 	 bl optiga_cmd_execute_handler
 4396              	.LVL469:
 4397              	.LBE268:
 4398              	.LBE267:
2134:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
 4399              	 .loc 1 2134 0
 4400 002c 2046     	 mov r0,r4
 4401 002e 10BD     	 pop {r4,pc}
 4402              	.LVL470:
 4403              	.L409:
2109:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_sign_params_t * p_optiga_ecdsa_sign = (optiga_calc_sign_params_t*)params;
 4404              	 .loc 1 2109 0
 4405 0030 40F20320 	 movw r0,#515
 4406              	.LVL471:
2137:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //(OPTIGA_CRYPT_ECDSA_SIGN_ENABLED)
 4407              	 .loc 1 2137 0
 4408 0034 10BD     	 pop {r4,pc}
 4409              	.L411:
 4410 0036 00BF     	 .align 2
 4411              	.L410:
 4412 0038 00000000 	 .word optiga_cmd_calc_sign_handler
 4413              	 .cfi_endproc
 4414              	.LFE44:
 4416              	 .section .text.optiga_cmd_verify_sign,"ax",%progbits
 4417              	 .align 1
 4418              	 .global optiga_cmd_verify_sign
 4419              	 .thumb
 4420              	 .thumb_func
 4422              	optiga_cmd_verify_sign:
 4423              	.LFB46:
2261:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
 4424              	 .loc 1 2261 0
 4425              	 .cfi_startproc
 4426              	 
 4427              	 
 4428              	.LVL472:
 4429 0000 10B5     	 push {r4,lr}
 4430              	.LCFI42:
 4431              	 .cfi_def_cfa_offset 8
 4432              	 .cfi_offset 4,-8
 4433              	 .cfi_offset 14,-4
 4434              	.LBB269:
 4435              	.LBB270:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4436              	 .loc 1 475 0
 4437 0002 8260     	 str r2,[r0,#8]
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4438              	 .loc 1 476 0
 4439 0004 0222     	 movs r2,#2
 4440              	.LVL473:
 4441 0006 8275     	 strb r2,[r0,#22]
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4442              	 .loc 1 477 0
 4443 0008 0622     	 movs r2,#6
 4444 000a C275     	 strb r2,[r0,#23]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4445              	 .loc 1 478 0
 4446 000c 054A     	 ldr r2,.L413
 4447 000e 4260     	 str r2,[r0,#4]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4448              	 .loc 1 479 0
 4449 0010 0024     	 movs r4,#0
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4450              	 .loc 1 481 0
 4451 0012 B222     	 movs r2,#178
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4452              	 .loc 1 479 0
 4453 0014 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4454              	 .loc 1 480 0
 4455 0016 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4456              	 .loc 1 481 0
 4457 0018 8284     	 strh r2,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4458              	 .loc 1 482 0
 4459 001a 2146     	 mov r1,r4
 4460              	.LVL474:
 4461 001c FFF7FEFF 	 bl optiga_cmd_execute_handler
 4462              	.LVL475:
 4463              	.LBE270:
 4464              	.LBE269:
2273:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_ECDSA_VERIFY_ENABLED
 4465              	 .loc 1 2273 0
 4466 0020 2046     	 mov r0,r4
 4467 0022 10BD     	 pop {r4,pc}
 4468              	.L414:
 4469              	 .align 2
 4470              	.L413:
 4471 0024 00000000 	 .word optiga_cmd_verify_sign_handler
 4472              	 .cfi_endproc
 4473              	.LFE46:
 4475              	 .section .text.optiga_cmd_gen_keypair,"ax",%progbits
 4476              	 .align 1
 4477              	 .global optiga_cmd_gen_keypair
 4478              	 .thumb
 4479              	 .thumb_func
 4481              	optiga_cmd_gen_keypair:
 4482              	.LFB48:
2417:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_gen_keypair_params_t * p_optiga_ecc_gen_keypair = (optiga_gen_keypair_params_t*)params;
 4483              	 .loc 1 2417 0
 4484              	 .cfi_startproc
 4485              	 
 4486              	 
 4487              	.LVL476:
 4488 0000 70B5     	 push {r4,r5,r6,lr}
 4489              	.LCFI43:
 4490              	 .cfi_def_cfa_offset 16
 4491              	 .cfi_offset 4,-16
 4492              	 .cfi_offset 5,-12
 4493              	 .cfi_offset 6,-8
 4494              	 .cfi_offset 14,-4
2422:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
 4495              	 .loc 1 2422 0
 4496 0002 1468     	 ldr r4,[r2]
 4497 0004 0E4D     	 ldr r5,.L419
 4498              	.LBB271:
 4499              	.LBB272:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4500              	 .loc 1 475 0
 4501 0006 8260     	 str r2,[r0,#8]
 4502 0008 0226     	 movs r6,#2
 4503              	.LBE272:
 4504              	.LBE271:
2421:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         && (FALSE == p_optiga_ecc_gen_keypair->export_private_key))
 4505              	 .loc 1 2421 0
 4506 000a 34F0FF04 	 bics r4,r4,#255
 4507              	.LBB275:
 4508              	.LBB273:
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4509              	 .loc 1 476 0
 4510 000e 8675     	 strb r6,[r0,#22]
 4511              	.LBE273:
 4512              	.LBE275:
2421:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         && (FALSE == p_optiga_ecc_gen_keypair->export_private_key))
 4513              	 .loc 1 2421 0
 4514 0010 08D1     	 bne .L416
 4515              	.LVL477:
 4516              	.LBB276:
 4517              	.LBB274:
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4518              	 .loc 1 477 0
 4519 0012 0522     	 movs r2,#5
 4520              	.LVL478:
 4521 0014 C275     	 strb r2,[r0,#23]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4522              	 .loc 1 481 0
 4523 0016 B822     	 movs r2,#184
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4524              	 .loc 1 480 0
 4525 0018 4176     	 strb r1,[r0,#25]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4526              	 .loc 1 478 0
 4527 001a 4560     	 str r5,[r0,#4]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4528              	 .loc 1 479 0
 4529 001c 0476     	 strb r4,[r0,#24]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4530              	 .loc 1 481 0
 4531 001e 8284     	 strh r2,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4532              	 .loc 1 482 0
 4533 0020 2146     	 mov r1,r4
 4534              	.LVL479:
 4535 0022 08E0     	 b .L418
 4536              	.LVL480:
 4537              	.L416:
 4538              	.LBE274:
 4539              	.LBE276:
 4540              	.LBB277:
 4541              	.LBB278:
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4542              	 .loc 1 477 0
 4543 0024 0622     	 movs r2,#6
 4544              	.LVL481:
 4545 0026 C275     	 strb r2,[r0,#23]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4546              	 .loc 1 480 0
 4547 0028 4176     	 strb r1,[r0,#25]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4548              	 .loc 1 479 0
 4549 002a 0022     	 movs r2,#0
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4550              	 .loc 1 481 0
 4551 002c B821     	 movs r1,#184
 4552              	.LVL482:
 4553 002e 8184     	 strh r1,[r0,#36]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4554              	 .loc 1 478 0
 4555 0030 4560     	 str r5,[r0,#4]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4556              	 .loc 1 479 0
 4557 0032 0276     	 strb r2,[r0,#24]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4558              	 .loc 1 482 0
 4559 0034 1146     	 mov r1,r2
 4560              	.LVL483:
 4561              	.L418:
 4562 0036 FFF7FEFF 	 bl optiga_cmd_execute_handler
 4563              	.LVL484:
 4564              	.LBE278:
 4565              	.LBE277:
2446:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED
 4566              	 .loc 1 2446 0
 4567 003a 0020     	 movs r0,#0
 4568 003c 70BD     	 pop {r4,r5,r6,pc}
 4569              	.L420:
 4570 003e 00BF     	 .align 2
 4571              	.L419:
 4572 0040 00000000 	 .word optiga_cmd_gen_keypair_handler
 4573              	 .cfi_endproc
 4574              	.LFE48:
 4576              	 .section .text.optiga_cmd_calc_hash,"ax",%progbits
 4577              	 .align 1
 4578              	 .global optiga_cmd_calc_hash
 4579              	 .thumb
 4580              	 .thumb_func
 4582              	optiga_cmd_calc_hash:
 4583              	.LFB51:
2658:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t*)params;
 4584              	 .loc 1 2658 0
 4585              	 .cfi_startproc
 4586              	 
 4587              	 
 4588              	.LVL485:
 4589 0000 10B5     	 push {r4,lr}
 4590              	.LCFI44:
 4591              	 .cfi_def_cfa_offset 8
 4592              	 .cfi_offset 4,-8
 4593              	 .cfi_offset 14,-4
2662:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
 4594              	 .loc 1 2662 0
 4595 0002 0024     	 movs r4,#0
 4596 0004 1461     	 str r4,[r2,#16]
 4597              	.LVL486:
 4598              	.LBB279:
 4599              	.LBB280:
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4600              	 .loc 1 475 0
 4601 0006 8260     	 str r2,[r0,#8]
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4602              	 .loc 1 476 0
 4603 0008 0222     	 movs r2,#2
 4604              	.LVL487:
 4605 000a 8275     	 strb r2,[r0,#22]
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4606              	 .loc 1 477 0
 4607 000c 0622     	 movs r2,#6
 4608 000e C275     	 strb r2,[r0,#23]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4609              	 .loc 1 478 0
 4610 0010 054A     	 ldr r2,.L422
 4611 0012 4260     	 str r2,[r0,#4]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4612              	 .loc 1 481 0
 4613 0014 B022     	 movs r2,#176
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4614              	 .loc 1 479 0
 4615 0016 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4616              	 .loc 1 480 0
 4617 0018 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4618              	 .loc 1 481 0
 4619 001a 8284     	 strh r2,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4620              	 .loc 1 482 0
 4621 001c 2146     	 mov r1,r4
 4622              	.LVL488:
 4623 001e FFF7FEFF 	 bl optiga_cmd_execute_handler
 4624              	.LVL489:
 4625              	.LBE280:
 4626              	.LBE279:
2674:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_HASH_ENABLED
 4627              	 .loc 1 2674 0
 4628 0022 2046     	 mov r0,r4
 4629 0024 10BD     	 pop {r4,pc}
 4630              	.L423:
 4631 0026 00BF     	 .align 2
 4632              	.L422:
 4633 0028 00000000 	 .word optiga_cmd_calc_hash_handler
 4634              	 .cfi_endproc
 4635              	.LFE51:
 4637              	 .section .text.optiga_cmd_set_object_protected,"ax",%progbits
 4638              	 .align 1
 4639              	 .global optiga_cmd_set_object_protected
 4640              	 .thumb
 4641              	 .thumb_func
 4643              	optiga_cmd_set_object_protected:
 4644              	.LFB53:
2757:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2758:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_set_object_protected(optiga_cmd_t * me, uint8_t cmd_param,
2759:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                                                     optiga_set_object_protected_params_t * params)
2760:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** {
 4645              	 .loc 1 2760 0
 4646              	 .cfi_startproc
 4647              	 
 4648              	 
 4649              	.LVL490:
 4650 0000 70B5     	 push {r4,r5,r6,lr}
 4651              	.LCFI45:
 4652              	 .cfi_def_cfa_offset 16
 4653              	 .cfi_offset 4,-16
 4654              	 .cfi_offset 5,-12
 4655              	 .cfi_offset 6,-8
 4656              	 .cfi_offset 14,-4
2761:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_state_t next_execution_state = OPTIGA_CMD_EXEC_PREPARE_COMMAND;
2762:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t next_execution_sub_state = OPTIGA_CMD_EXEC_REQUEST_STRICT_LOCK;
2763:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_LIB_SUCCESS;
2764:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2765:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2766:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     // Continue or Final API is invoked without strict lock acquired by instance
2767:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     if (((OPTIGA_SET_PROTECTED_UPDATE_FINAL == params->set_obj_protected_tag) ||
 4657              	 .loc 1 2767 0
 4658 0002 9579     	 ldrb r5,[r2,#6]
 4659 0004 6B1E     	 subs r3,r5,#1
 4660 0006 012B     	 cmp r3,#1
 4661 0008 0DD8     	 bhi .L425
 4662              	.LVL491:
 4663              	.LBB287:
 4664              	.LBB288:
 545:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
 4665              	 .loc 1 545 0
 4666 000a 847F     	 ldrb r4,[r0,#30]
 4667 000c 0368     	 ldr r3,[r0]
 4668              	.LVL492:
 4669 000e 0C26     	 movs r6,#12
 4670 0010 06FB0433 	 mla r3,r6,r4,r3
 4671              	.LVL493:
 4672 0014 03F5C764 	 add r4,r3,#1592
 4673              	.LVL494:
 4674              	.LBE288:
 4675              	.LBE287:
2768:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****        (OPTIGA_SET_PROTECTED_UPDATE_CONTINUE == params->set_obj_protected_tag)) &&
 4676              	 .loc 1 2768 0
 4677 0018 93F83836 	 ldrb r3,[r3,#1592]
 4678 001c 232B     	 cmp r3,#35
 4679 001e 1CD1     	 bne .L429
 4680              	.LVL495:
2769:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****        ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != optiga_cmd_queue_get_state_of(me, OPTIGA_CMD_QUEUE
 4681              	 .loc 1 2769 0
 4682 0020 6378     	 ldrb r3,[r4,#1]
 4683 0022 042B     	 cmp r3,#4
 4684 0024 19D1     	 bne .L429
 4685              	.LVL496:
 4686              	.L425:
2770:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****        (OPTIGA_CMD_QUEUE_PROCESSING != optiga_cmd_queue_get_state_of(me, OPTIGA_CMD_QUEUE_SLOT_STAT
2771:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2772:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2773:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         return_status = OPTIGA_CMD_ERROR_INVALID_INPUT;
2774:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2775:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     else
2776:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     {
2777:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         if (( NULL == params->p_protected_update_buffer ) &&
 4687              	 .loc 1 2777 0
 4688 0026 1368     	 ldr r3,[r2]
 4689 0028 33B9     	 cbnz r3,.L430
2778:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             (OPTIGA_SET_PROTECTED_UPDATE_FINAL == params->set_obj_protected_tag))
2779:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         {
2780:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             /// Release the strict sequence
2781:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             next_execution_state = OPTIGA_CMD_EXEC_PROCESS_RESPONSE;
2782:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****             next_execution_sub_state = OPTIGA_CMD_EXEC_RELEASE_LOCK;
 4690              	 .loc 1 2782 0 discriminator 1
 4691 002a 012D     	 cmp r5,#1
 4692 002c 15BF     	 itete ne
 4693 002e 0723     	 movne r3,#7
 4694 0030 0B23     	 moveq r3,#11
 4695 0032 0224     	 movne r4,#2
 4696 0034 0324     	 moveq r4,#3
 4697 0036 01E0     	 b .L427
 4698              	.L430:
2762:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_LIB_SUCCESS;
 4699              	 .loc 1 2762 0
 4700 0038 0723     	 movs r3,#7
2761:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t next_execution_sub_state = OPTIGA_CMD_EXEC_REQUEST_STRICT_LOCK;
 4701              	 .loc 1 2761 0
 4702 003a 0224     	 movs r4,#2
 4703              	.L427:
 4704              	.LVL497:
 4705              	.LBB289:
 4706              	.LBB290:
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 4707              	 .loc 1 477 0
 4708 003c C375     	 strb r3,[r0,#23]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4709              	 .loc 1 478 0
 4710 003e 084B     	 ldr r3,.L432
 4711              	.LVL498:
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 4712              	 .loc 1 476 0
 4713 0040 8475     	 strb r4,[r0,#22]
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 4714              	 .loc 1 478 0
 4715 0042 4360     	 str r3,[r0,#4]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4716              	 .loc 1 479 0
 4717 0044 0024     	 movs r4,#0
 4718              	.LVL499:
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4719              	 .loc 1 481 0
 4720 0046 8323     	 movs r3,#131
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 4721              	 .loc 1 475 0
 4722 0048 8260     	 str r2,[r0,#8]
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 4723              	 .loc 1 479 0
 4724 004a 0476     	 strb r4,[r0,#24]
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 4725              	 .loc 1 480 0
 4726 004c 4176     	 strb r1,[r0,#25]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 4727              	 .loc 1 481 0
 4728 004e 8384     	 strh r3,[r0,#36]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4729              	 .loc 1 482 0
 4730 0050 2146     	 mov r1,r4
 4731              	.LVL500:
 4732 0052 FFF7FEFF 	 bl optiga_cmd_execute_handler
 4733              	.LVL501:
 4734              	.LBE290:
 4735              	.LBE289:
2763:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
 4736              	 .loc 1 2763 0
 4737 0056 2046     	 mov r0,r4
 4738 0058 70BD     	 pop {r4,r5,r6,pc}
 4739              	.LVL502:
 4740              	.L429:
2773:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
 4741              	 .loc 1 2773 0
 4742 005a 40F20320 	 movw r0,#515
 4743              	.LVL503:
2783:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         }
2784:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2785:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****         optiga_cmd_execute(me,
2786:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            cmd_param,
2787:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            optiga_cmd_set_object_protected_handler,
2788:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            next_execution_state,
2789:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            next_execution_sub_state,
2790:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            params,
2791:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and 
2792:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_SET_OBJECT_PROTECTED, OPTIGA_CMD_ZER
2793:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     }
2794:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** 
2795:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c ****     return (return_status);
2796:C:/Users/Yushev/git/optiga-trust-qi/optiga/cmd\optiga_cmd.c **** }
 4744              	 .loc 1 2796 0
 4745 005e 70BD     	 pop {r4,r5,r6,pc}
 4746              	.LVL504:
 4747              	.L433:
 4748              	 .align 2
 4749              	.L432:
 4750 0060 00000000 	 .word optiga_cmd_set_object_protected_handler
 4751              	 .cfi_endproc
 4752              	.LFE53:
 4754              	 .global g_optiga_unique_application_identifier
 4755              	 .section .rodata.g_optiga_unique_application_identifier,"a",%progbits
 4756              	 .set .LANCHOR0,.+0
 4759              	g_optiga_unique_application_identifier:
 4760 0000 D2       	 .byte -46
 4761 0001 76       	 .byte 118
 4762 0002 00       	 .byte 0
 4763 0003 00       	 .byte 0
 4764 0004 04       	 .byte 4
 4765 0005 47       	 .byte 71
 4766 0006 65       	 .byte 101
 4767 0007 6E       	 .byte 110
 4768 0008 41       	 .byte 65
 4769 0009 75       	 .byte 117
 4770 000a 74       	 .byte 116
 4771 000b 68       	 .byte 104
 4772 000c 41       	 .byte 65
 4773 000d 70       	 .byte 112
 4774 000e 70       	 .byte 112
 4775 000f 6C       	 .byte 108
 4776              	 .section .bss.g_optiga,"aw",%nobits
 4777              	 .align 2
 4778              	 .set .LANCHOR1,.+0
 4781              	g_optiga:
 4782 0000 00000000 	 .space 1676
 4782      00000000 
 4782      00000000 
 4782      00000000 
 4782      00000000 
 4783              	 .text
 4784              	.Letext0:
 4785              	 .file 2 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 4786              	 .file 3 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 4787              	 .file 4 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_types.h"
 4788              	 .file 5 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_common.h"
 4789              	 .file 6 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/cmd/optiga_cmd.h"
 4790              	 .file 7 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/comms/optiga_comms.h"
 4791              	 .file 8 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_os_event.h"
 4792              	 .file 9 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal.h"
 4793              	 .file 10 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_os_memory.h"
 4794              	 .file 11 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_os_datastore.h"
 4795              	 .file 12 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_os_lock.h"
 4796              	 .file 13 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_os_timer.h"
DEFINED SYMBOLS
                            *ABS*:00000000 optiga_cmd.c
    {standard input}:20     .text.optiga_cmd_prepare_tag_header:00000000 $t
    {standard input}:24     .text.optiga_cmd_prepare_tag_header:00000000 optiga_cmd_prepare_tag_header
    {standard input}:64     .text.optiga_cmd_queue_update_slot:00000000 $t
    {standard input}:68     .text.optiga_cmd_queue_update_slot:00000000 optiga_cmd_queue_update_slot
    {standard input}:146    .text.optiga_cmd_queue_reset_slot:00000000 $t
    {standard input}:150    .text.optiga_cmd_queue_reset_slot:00000000 optiga_cmd_queue_reset_slot
    {standard input}:201    .text.optiga_cmd_queue_reset_slot:00000048 $d
    {standard input}:3226   .text.optiga_cmd_queue_scheduler:00000000 optiga_cmd_queue_scheduler
    {standard input}:206    .text.optiga_cmd_execute_handler:00000000 $t
    {standard input}:210    .text.optiga_cmd_execute_handler:00000000 optiga_cmd_execute_handler
    {standard input}:279    .text.optiga_cmd_execute_handler:00000046 $d
    {standard input}:284    .text.optiga_cmd_execute_handler:00000050 $t
    {standard input}:488    .text.optiga_cmd_execute_handler:00000156 $d
    {standard input}:492    .text.optiga_cmd_execute_handler:0000015a $t
    {standard input}:654    .text.optiga_cmd_execute_handler:00000218 $d
    {standard input}:659    .text.optiga_cmd_execute_handler:00000228 $t
    {standard input}:815    .text.optiga_cmd_execute_handler:00000304 $d
    {standard input}:1011   .text.optiga_cmd_event_trigger_execute:00000000 optiga_cmd_event_trigger_execute
    {standard input}:819    .text.optiga_cmd_execute_handler:00000308 $t
    {standard input}:1002   .text.optiga_cmd_execute_handler:000003cc $d
    {standard input}:1007   .text.optiga_cmd_event_trigger_execute:00000000 $t
    {standard input}:1027   .text.optiga_cmd_get_data_object_handler:00000000 $t
    {standard input}:1031   .text.optiga_cmd_get_data_object_handler:00000000 optiga_cmd_get_data_object_handler
    {standard input}:1275   .text.optiga_cmd_set_data_object_handler:00000000 $t
    {standard input}:1279   .text.optiga_cmd_set_data_object_handler:00000000 optiga_cmd_set_data_object_handler
    {standard input}:1457   .text.optiga_cmd_get_random_handler:00000000 $t
    {standard input}:1461   .text.optiga_cmd_get_random_handler:00000000 optiga_cmd_get_random_handler
    {standard input}:1564   .text.optiga_cmd_calc_sign_handler:00000000 $t
    {standard input}:1568   .text.optiga_cmd_calc_sign_handler:00000000 optiga_cmd_calc_sign_handler
    {standard input}:1758   .text.optiga_cmd_verify_sign_handler:00000000 $t
    {standard input}:1762   .text.optiga_cmd_verify_sign_handler:00000000 optiga_cmd_verify_sign_handler
    {standard input}:2018   .text.optiga_cmd_set_object_protected_handler:00000000 $t
    {standard input}:2022   .text.optiga_cmd_set_object_protected_handler:00000000 optiga_cmd_set_object_protected_handler
    {standard input}:2183   .text.optiga_cmd_set_object_protected_handler:000000b4 $d
    {standard input}:2188   .text.optiga_cmd_gen_keypair_handler:00000000 $t
    {standard input}:2192   .text.optiga_cmd_gen_keypair_handler:00000000 optiga_cmd_gen_keypair_handler
    {standard input}:2457   .text.optiga_cmd_calc_hash_handler:00000000 $t
    {standard input}:2461   .text.optiga_cmd_calc_hash_handler:00000000 optiga_cmd_calc_hash_handler
    {standard input}:2885   .text.optiga_cmd_close_application_handler:00000000 $t
    {standard input}:2889   .text.optiga_cmd_close_application_handler:00000000 optiga_cmd_close_application_handler
    {standard input}:3012   .text.optiga_cmd_open_application_handler:00000000 $t
    {standard input}:3016   .text.optiga_cmd_open_application_handler:00000000 optiga_cmd_open_application_handler
    {standard input}:3217   .text.optiga_cmd_open_application_handler:000000d8 $d
    {standard input}:3222   .text.optiga_cmd_queue_scheduler:00000000 $t
    {standard input}:3612   .text.optiga_cmd_queue_scheduler:000001c4 $d
    {standard input}:3620   .text.optiga_cmd_set_shielded_connection_option:00000000 $t
    {standard input}:3625   .text.optiga_cmd_set_shielded_connection_option:00000000 optiga_cmd_set_shielded_connection_option
    {standard input}:3658   .text.optiga_cmd_request_session:00000000 $t
    {standard input}:3663   .text.optiga_cmd_request_session:00000000 optiga_cmd_request_session
    {standard input}:3686   .text.optiga_cmd_release_session:00000000 $t
    {standard input}:3691   .text.optiga_cmd_release_session:00000000 optiga_cmd_release_session
    {standard input}:3730   .text.optiga_cmd_request_lock:00000000 $t
    {standard input}:3735   .text.optiga_cmd_request_lock:00000000 optiga_cmd_request_lock
    {standard input}:3757   .text.optiga_cmd_release_lock:00000000 $t
    {standard input}:3762   .text.optiga_cmd_release_lock:00000000 optiga_cmd_release_lock
    {standard input}:3784   .text.optiga_cmd_create:00000000 $t
    {standard input}:3789   .text.optiga_cmd_create:00000000 optiga_cmd_create
    {standard input}:3951   .text.optiga_cmd_create:000000a4 $d
    {standard input}:3958   .text.optiga_cmd_destroy:00000000 $t
    {standard input}:3963   .text.optiga_cmd_destroy:00000000 optiga_cmd_destroy
    {standard input}:4040   .text.optiga_cmd_open_application:00000000 $t
    {standard input}:4045   .text.optiga_cmd_open_application:00000000 optiga_cmd_open_application
    {standard input}:4092   .text.optiga_cmd_open_application:00000020 $d
    {standard input}:4097   .text.optiga_cmd_close_application:00000000 $t
    {standard input}:4102   .text.optiga_cmd_close_application:00000000 optiga_cmd_close_application
    {standard input}:4151   .text.optiga_cmd_close_application:00000024 $d
    {standard input}:4156   .text.optiga_cmd_get_data_object:00000000 $t
    {standard input}:4161   .text.optiga_cmd_get_data_object:00000000 optiga_cmd_get_data_object
    {standard input}:4210   .text.optiga_cmd_get_data_object:00000024 $d
    {standard input}:4215   .text.optiga_cmd_set_data_object:00000000 $t
    {standard input}:4220   .text.optiga_cmd_set_data_object:00000000 optiga_cmd_set_data_object
    {standard input}:4269   .text.optiga_cmd_set_data_object:00000024 $d
    {standard input}:4274   .text.optiga_cmd_get_random:00000000 $t
    {standard input}:4279   .text.optiga_cmd_get_random:00000000 optiga_cmd_get_random
    {standard input}:4328   .text.optiga_cmd_get_random:00000024 $d
    {standard input}:4333   .text.optiga_cmd_calc_sign:00000000 $t
    {standard input}:4338   .text.optiga_cmd_calc_sign:00000000 optiga_cmd_calc_sign
    {standard input}:4412   .text.optiga_cmd_calc_sign:00000038 $d
    {standard input}:4417   .text.optiga_cmd_verify_sign:00000000 $t
    {standard input}:4422   .text.optiga_cmd_verify_sign:00000000 optiga_cmd_verify_sign
    {standard input}:4471   .text.optiga_cmd_verify_sign:00000024 $d
    {standard input}:4476   .text.optiga_cmd_gen_keypair:00000000 $t
    {standard input}:4481   .text.optiga_cmd_gen_keypair:00000000 optiga_cmd_gen_keypair
    {standard input}:4572   .text.optiga_cmd_gen_keypair:00000040 $d
    {standard input}:4577   .text.optiga_cmd_calc_hash:00000000 $t
    {standard input}:4582   .text.optiga_cmd_calc_hash:00000000 optiga_cmd_calc_hash
    {standard input}:4633   .text.optiga_cmd_calc_hash:00000028 $d
    {standard input}:4638   .text.optiga_cmd_set_object_protected:00000000 $t
    {standard input}:4643   .text.optiga_cmd_set_object_protected:00000000 optiga_cmd_set_object_protected
    {standard input}:4750   .text.optiga_cmd_set_object_protected:00000060 $d
    {standard input}:4759   .rodata.g_optiga_unique_application_identifier:00000000 g_optiga_unique_application_identifier
    {standard input}:4777   .bss.g_optiga:00000000 $d
    {standard input}:4781   .bss.g_optiga:00000000 g_optiga
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
pal_os_timer_get_time_in_microseconds
pal_os_event_start
pal_os_memset
pal_os_datastore_write
pal_os_event_register_callback_oneshot
optiga_comms_set_callback_context
optiga_comms_open
optiga_comms_close
optiga_comms_transceive
optiga_common_set_uint16
pal_os_memcpy
optiga_common_get_uint16
optiga_common_get_uint32
pal_os_datastore_read
pal_os_event_stop
pal_os_lock_enter_critical_section
pal_os_calloc
pal_os_event_create
optiga_comms_create
pal_os_free
pal_os_lock_exit_critical_section
