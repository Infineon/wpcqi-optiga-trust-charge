   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,4
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "ifx_i2c_presentation_layer.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.ifx_i2c_prl_decrypt_msg,"ax",%progbits
  20              	 .align 1
  21              	 .thumb
  22              	 .thumb_func
  24              	ifx_i2c_prl_decrypt_msg:
  25              	.LFB6:
  26              	 .file 1 "C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c/ifx_i2c_presentation_layer.c"
   1:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** /**
   2:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * \copyright
   3:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * MIT License
   4:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
   5:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * Copyright (c) 2020 Infineon Technologies AG
   6:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
   7:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * Permission is hereby granted, free of charge, to any person obtaining a copy
   8:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * of this software and associated documentation files (the "Software"), to deal
   9:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * in the Software without restriction, including without limitation the rights
  10:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  11:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * copies of the Software, and to permit persons to whom the Software is
  12:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * furnished to do so, subject to the following conditions:
  13:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
  14:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * The above copyright notice and this permission notice shall be included in all
  15:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * copies or substantial portions of the Software.
  16:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
  17:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  18:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  19:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  20:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  21:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  22:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  23:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * SOFTWARE
  24:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
  25:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * \endcopyright
  26:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
  27:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * \author Infineon Technologies AG
  28:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
  29:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * \file ifx_i2c_presentation_layer.c
  30:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
  31:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * \brief   This file implements the IFX I2C Presentation Layer of the Infineon I2C Protocol Stack l
  32:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
  33:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * \ingroup  grIFXI2C
  34:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** *
  35:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** * @{
  36:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** */
  37:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  38:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #include "optiga/ifx_i2c/ifx_i2c_presentation_layer.h"
  39:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #include "optiga/ifx_i2c/ifx_i2c_transport_layer.h"
  40:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #include "optiga/pal/pal_crypt.h"
  41:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #include "optiga/common/optiga_lib_common.h"
  42:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #include "optiga/pal/pal_ifx_i2c_config.h"
  43:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** // include lower layer header
  44:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** /// @cond hidden
  45:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  46:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** // Setup debug log statements
  47:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #if IFX_I2C_LOG_PRL == 1
  48:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define LOG_PRL IFX_I2C_LOG
  49:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #else
  50:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define LOG_PRL(...)  //printf(__VA_ARGS__);
  51:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #endif
  52:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  53:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION        
  54:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  55:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** /// @cond hidden
  56:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  57:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** // Presentation Layer states
  58:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_UNINIT                     (0x00)
  59:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_IDLE                       (0x01)
  60:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_START                      (0x02)
  61:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_VERIFY                     (0x03)
  62:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_TXRX                       (0x04)
  63:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_HANDSHAKE                  (0x05)
  64:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_ALERT                      (0x06)
  65:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_ERROR                      (0x07)
  66:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_STATE_MANAGE_CONTEXT             (0x08)
  67:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  68:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Manage context state
  69:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MANAGE_CONTEXT_TX_STATE          (0x01)
  70:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MANAGE_CONTEXT_RX_STATE          (0x02)
  71:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  72:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** /// Handshake status
  73:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_HS_SEND_HELLO                    (0x11)
  74:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_HS_VERIFY_HELLO                  (0x22)
  75:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_HS_SEND_FINISHED                 (0x33)
  76:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_HS_VERIFY_FINISHED               (0x44)
  77:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_HS_ERROR                         (0x55)
  78:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  79:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** /// Handshake type
  80:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MASTER_HELLO_MSG                 (0x00)
  81:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MASTER_FINISHED_MSG              (0x08)
  82:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  83:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Protocol type
  84:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_HANDSHAKE_PROTOCOL               (0x00)
  85:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_RECORD_EXCHANGE_PROTOCOL         (0x20)
  86:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_ALERT_PROTOCOL                   (0x40)
  87:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  88:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Message type
  89:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_FATAL_ALERT_MSG                  (0x00)
  90:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_INTEGRITY_VIOLATED_ALERT_MSG     (0x04)
  91:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_INVALID_ALERT                    (0xFF)
  92:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_DEFAULT_ALERT                    (0x11)
  93:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  94:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Handshake completion state
  95:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_NEGOTIATION_NOT_DONE             (0x00)
  96:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_NEGOTIATION_DONE                 (0x01)
  97:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
  98:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Offset calculation values
  99:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MASTER_ENCRYPTION_KEY_OFFSET     (0x00)
 100:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MASTER_ENCRYPTION_NONCE_OFFSET   (0x20)
 101:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MASTER_DECRYPTION_KEY_OFFSET     (0x10)
 102:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MASTER_DECRYPTION_NONCE_OFFSET   (0x24)
 103:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_SLAVE_HELLO_SEQ_NUMBER_OFFSET    (0x22)
 104:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_PLAIN_TEST_OFFSET                (0x04)
 105:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_SCTR_OFFSET                      (0x00)
 106:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_PROTOCOL_VERSION_OFFSET          (0x01)
 107:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_RANDOM_DATAOFFSET                (0x02)
 108:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 109:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Length calculation values
 110:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_RANDOM_DATA_LENGTH               (0x20)
 111:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MASTER_NONCE_LENGTH              (0x04)
 112:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_FINISHED_DATA_LENGTH             (0x30)
 113:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_SEQ_NUMBER_LENGTH                (0x04)
 114:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_SLAVE_HELLO_LENGTH               (0x26)
 115:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_NONCE_LENGTH                     (0x08)
 116:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 117:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Manage context message type
 118:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_SAVE_CONTEXT_MSG                 (0x60)
 119:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_CONTEXT_SAVED_MSG                (0x64)
 120:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_RESTORE_CONTEXT_MSG              (0x68)
 121:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_CONTEXT_RESTORED_MSG             (0x6C)
 122:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 123:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Restore operation state
 124:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_RESTORE_NOT_DONE                 (0x00)
 125:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_RESTORE_DONE                     (0x01)
 126:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 127:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** ///Mask values
 128:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_MANAGE_CONTEXT_MASK              (0xFC)
 129:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_PROTECTION_MASK                  (0x03)
 130:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 131:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_SEQUENCE_THRESHOLD               (0xFFFFFFF0)
 132:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_TRANS_REPEAT                     (DL_TRANS_REPEAT)
 133:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 134:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define PRL_LABEL                            "Platform Binding"
 135:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 136:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define FORM_SCTR_HEADER(ctx, protocol, msg, protection){\
 137:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                          p_ctx->prl.sctr = (protocol | msg | protection);}\
 138:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 139:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define ERROR_STATE_PREPARATION(ctx, exit_machine){\
 140:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                 ctx->prl.alert_type = PRL_INVALID_ALERT;\
 141:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                 ctx->prl.state = PRL_STATE_ERROR;\
 142:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                 ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;\
 143:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                 ctx->prl.return_status = IFX_I2C_SESSION_ERROR;\
 144:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                 ctx->prl.trans_repeat_status = FALSE;\
 145:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                 exit_machine = TRUE;}\
 146:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 147:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define CLEAR_SESSION_CONTEXT(ctx){\
 148:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                               memset(ctx->prl.session_key,0,sizeof(ctx->prl.session_key));\
 149:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                               ctx->prl.master_sequence_number = 0;\
 150:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                               ctx->prl.slave_sequence_number = 0;\
 151:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                               ctx->prl.save_slave_sequence_number = 0;\
 152:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                               ctx->prl.decryption_failure_counter = 0;\
 153:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                               ctx->prl.data_retransmit_counter = 0;\
 154:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                               ctx->prl.trans_repeat_status = FALSE;\
 155:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                               ctx->prl.state = PRL_STATE_IDLE;}\
 156:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 157:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define CLEAR_SAVED_SESSION_CONTEXT(ctx){\
 158:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                     memset(ctx.session_key,0,sizeof(ctx.session_key));\
 159:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                     ctx.master_sequence_number = 0;\
 160:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                     ctx.negotiation_state = 0;\
 161:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                     ctx.save_slave_sequence_number = 0;\
 162:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                     ctx.decryption_failure_counter = 0;\
 163:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                     ctx.data_retransmit_counter = 0;\
 164:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                     ctx.stored_context_flag = FALSE;}\
 165:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 166:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define COPY_MANAGE_CONTEXT_DATA(source, destination){\
 167:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  memcpy(destination.session_key,source.session_key,sizeof(source.se
 168:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  destination.master_sequence_number = source.master_sequence_number
 169:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  destination.save_slave_sequence_number = source.save_slave_sequenc
 170:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  destination.decryption_failure_counter = source.decryption_failure
 171:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  destination.data_retransmit_counter = source.data_retransmit_count
 172:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  destination.negotiation_state = source.negotiation_state;}\
 173:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 174:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** #define DO_NEGOTIATION(ctx, exit_machine){\
 175:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                        ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;\
 176:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                        ctx->prl.state = PRL_STATE_HANDSHAKE;\
 177:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                        exit_machine = TRUE;\
 178:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                        ctx->prl.hs_state = PRL_HS_SEND_HELLO;}\
 179:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 180:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_do_handshake(ifx_i2c_context_t * p_ctx,
 181:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                        const uint8_t * p_data);
 182:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H void ifx_i2c_prl_event_handler(ifx_i2c_context_t * p_ctx,
 183:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          optiga_lib_status_t event,
 184:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          const uint8_t * p_data,
 185:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          uint16_t data_len);
 186:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_prf(ifx_i2c_context_t * p_ctx);
 187:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_send_alert(ifx_i2c_context_t * p_ctx);
 188:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** /// @endcond
 189:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 190:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** optiga_lib_status_t ifx_i2c_prl_init(ifx_i2c_context_t * p_ctx,
 191:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                      ifx_i2c_event_handler_t handler)
 192:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 193:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 194:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     LOG_PRL("[IFX-PRL]: Init\n");
 195:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 196:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     p_ctx->tl.state = PRL_STATE_UNINIT;
 197:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 198:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 199:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 200:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         // Initialize transport layer (and register event handler)
 201:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (IFX_I2C_STACK_SUCCESS != ifx_i2c_tl_init(p_ctx, ifx_i2c_prl_event_handler))
 202:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 203:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 204:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 205:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 206:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.upper_layer_event_handler = handler;
 207:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (IFX_I2C_SESSION_CONTEXT_RESTORE == p_ctx->manage_context_operation)
 208:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 209:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.restore_context_flag = PRL_RESTORE_NOT_DONE;
 210:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 211:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         else
 212:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 213:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.restore_context_flag = PRL_RESTORE_DONE;
 214:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 215:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.state = PRL_STATE_IDLE;
 216:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 217:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->protocol_version = PROTOCOL_VERSION_PRE_SHARED_SECRET;
 218:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 219:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
 220:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.hs_state = PRL_HS_SEND_HELLO;
 221:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.alert_type = PRL_DEFAULT_ALERT;
 222:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         return_status = IFX_I2C_STACK_SUCCESS;
 223:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (FALSE);
 224:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     
 225:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     return (return_status);
 226:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 227:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 228:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** optiga_lib_status_t ifx_i2c_prl_close(ifx_i2c_context_t * p_ctx, ifx_i2c_event_handler_t handler)
 229:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 230:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 231:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     LOG_PRL("[IFX-PRL]: Close\n");
 232:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 233:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 234:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         // Presentation Layer must be idle
 235:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (PRL_STATE_IDLE != p_ctx->prl.state)
 236:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 237:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 238:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 239:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.upper_layer_event_handler = handler;
 240:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (IFX_I2C_SESSION_CONTEXT_NONE == p_ctx->manage_context_operation)
 241:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 242:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.upper_layer_event_handler(p_ctx, IFX_I2C_STACK_SUCCESS, 0, 0);
 243:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_STACK_SUCCESS;
 244:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 245:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 246:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 247:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if ((PRL_NEGOTIATION_DONE == p_ctx->prl.negotiation_state) &&
 248:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (IFX_I2C_SESSION_CONTEXT_SAVE == p_ctx->manage_context_operation))
 249:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 250:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.state = PRL_STATE_MANAGE_CONTEXT;
 251:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.mc_state = PRL_MANAGE_CONTEXT_TX_STATE;
 252:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             ifx_i2c_prl_event_handler(p_ctx, IFX_I2C_STACK_SUCCESS, p_ctx->prl.prl_txrx_buffer, 1);
 253:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_STACK_SUCCESS;
 254:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 255:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 256:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (FALSE);
 257:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     return (return_status);
 258:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 259:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 260:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** optiga_lib_status_t ifx_i2c_prl_transceive(ifx_i2c_context_t * p_ctx,
 261:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                            uint8_t * p_tx_data,
 262:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                            uint16_t tx_data_len,
 263:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                            uint8_t * p_rx_data,
 264:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                            uint16_t * p_rx_data_len)
 265:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 266:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 267:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     LOG_PRL("[IFX-PRL]: Transceive txlen %d\n", tx_data_len);
 268:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 269:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 270:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 271:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         // Check function arguments and presentation Layer must be idle
 272:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if ((NULL == p_tx_data) || (0 == tx_data_len) || (PRL_STATE_IDLE != p_ctx->prl.state))
 273:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 274:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 275:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 276:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 277:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if ((IFX_I2C_SESSION_CONTEXT_RESTORE == p_ctx->manage_context_operation) && 
 278:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (PRL_RESTORE_NOT_DONE == p_ctx->prl.restore_context_flag))
 279:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 280:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.state = PRL_STATE_MANAGE_CONTEXT;
 281:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.mc_state = PRL_MANAGE_CONTEXT_TX_STATE;
 282:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 283:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         else
 284:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 285:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.state = PRL_STATE_START;
 286:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 287:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.p_actual_payload = p_tx_data;
 288:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.actual_payload_length = tx_data_len;
 289:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 290:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if ((SLAVE_PROTECTION == (p_ctx->protection_level & PRL_PROTECTION_MASK)) ||
 291:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (FULL_PROTECTION == (p_ctx->protection_level & PRL_PROTECTION_MASK)))
 292:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 293:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.p_recv_payload_buffer = p_rx_data;
 294:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 295:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         else
 296:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 297:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.p_recv_payload_buffer = &p_rx_data[PRL_PLAIN_TEST_OFFSET];
 298:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 299:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.p_recv_payload_buffer_length = p_rx_data_len;
 300:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.data_retransmit_counter = 0;
 301:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.trans_repeat_status = FALSE;
 302:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.decryption_failure_counter = 0;
 303:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
 304:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.alert_type = PRL_DEFAULT_ALERT;
 305:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 306:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         ifx_i2c_prl_event_handler(p_ctx,
 307:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                   IFX_I2C_STACK_SUCCESS,
 308:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                   p_tx_data, tx_data_len);
 309:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         return_status = IFX_I2C_STACK_SUCCESS;
 310:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 311:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (FALSE);
 312:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     return (return_status);
 313:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 314:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 315:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_prf(ifx_i2c_context_t * p_ctx)
 316:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 317:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_HANDSHAKE_ERROR;
 318:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint8_t label_input[] = PRL_LABEL;
 319:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint8_t secret_input[OPTIGA_SHARED_SECRET_MAX_LENGTH];
 320:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint16_t shared_secret_length;
 321:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 322:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 323:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         //Reading pre-shared secret from datastore
 324:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         return_status = pal_os_datastore_read(p_ctx->ifx_i2c_datastore_config->datastore_shared_sec
 325:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                               secret_input,
 326:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                               &shared_secret_length);
 327:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (PAL_STATUS_SUCCESS != return_status)
 328:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 329:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_HANDSHAKE_ERROR;
 330:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 331:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 332:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (PAL_STATUS_SUCCESS != pal_crypt_tls_prf_sha256(NULL, secret_input,
 333:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            shared_secret_length,
 334:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            label_input,
 335:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            sizeof(label_input) - 1,
 336:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            p_ctx->prl.random,
 337:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            sizeof(p_ctx->prl.random),
 338:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            p_ctx->prl.session_key,
 339:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            sizeof(p_ctx->prl.session_key)))
 340:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 341:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_HANDSHAKE_ERROR;
 342:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 343:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         memset(secret_input, 0, shared_secret_length);
 344:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 345:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (FALSE);
 346:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     return (return_status);
 347:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 348:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 349:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H void ifx_i2c_prl_form_associated_data(ifx_i2c_context_t * p_ctx,
 350:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                 uint16_t data_len,
 351:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                 uint32_t seq_number,
 352:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                 uint8_t sctr)
 353:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 354:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     p_ctx->prl.associate_data[0] = sctr;
 355:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_common_set_uint32(&p_ctx->prl.associate_data[1], seq_number);
 356:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     p_ctx->prl.associate_data[5] = p_ctx->protocol_version;
 357:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_common_set_uint16(&p_ctx->prl.associate_data[6], data_len);
 358:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 359:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 360:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_encrypt_msg(ifx_i2c_context_t * p_ctx,
 361:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint8_t * p_data,
 362:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint16_t data_len,
 363:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint32_t seq_number,
 364:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint8_t sctr)
 365:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 366:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 367:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint8_t nonce_data[PRL_NONCE_LENGTH];
 368:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 369:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 370:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         //Form associated data
 371:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         ifx_i2c_prl_form_associated_data(p_ctx, data_len,seq_number,sctr);
 372:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         //Prepare nonce data
 373:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         memcpy(nonce_data, &p_ctx->prl.session_key[PRL_MASTER_ENCRYPTION_NONCE_OFFSET], PRL_MASTER_
 374:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         optiga_common_set_uint32(&nonce_data[PRL_MASTER_NONCE_LENGTH], seq_number);
 375:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 376:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (PAL_STATUS_SUCCESS != (pal_crypt_encrypt_aes128_ccm(NULL,
 377:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_data,
 378:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 data_len,
 379:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 &p_ctx->prl.
 380:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 session_key[PRL_MASTER_ENCRYPTION_K
 381:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 nonce_data, PRL_MASTER_NONCE_LENGTH
 382:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 PRL_SEQ_NUMBER_LENGTH,
 383:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_ctx->prl.associate_data,
 384:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 sizeof(p_ctx->prl.associate_data),
 385:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 IFX_I2C_PRL_MAC_SIZE,
 386:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_data)))
 387:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 388:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 389:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 390:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         return_status = IFX_I2C_STACK_SUCCESS;
 391:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (FALSE);
 392:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     return (return_status);
 393:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 394:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 395:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_decrypt_msg(ifx_i2c_context_t * p_ctx,
 396:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       const uint8_t * p_data,
 397:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint16_t data_len,
 398:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint32_t seq_number,
 399:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint8_t * out_data,
 400:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint8_t decrypt_key_offset,
 401:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint8_t decrypt_nonce_offset,
 402:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       uint8_t sctr)
 403:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
  27              	 .loc 1 403 0
  28              	 .cfi_startproc
  29              	 
  30              	 
  31              	.LVL0:
  32 0000 F0B5     	 push {r4,r5,r6,r7,lr}
  33              	.LCFI0:
  34              	 .cfi_def_cfa_offset 20
  35              	 .cfi_offset 4,-20
  36              	 .cfi_offset 5,-16
  37              	 .cfi_offset 6,-12
  38              	 .cfi_offset 7,-8
  39              	 .cfi_offset 14,-4
  40 0002 89B0     	 sub sp,sp,#36
  41              	.LCFI1:
  42              	 .cfi_def_cfa_offset 56
  43              	 .loc 1 403 0
  44 0004 0446     	 mov r4,r0
  45 0006 1F46     	 mov r7,r3
  46              	.LBB4:
  47              	.LBB5:
 354:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_common_set_uint32(&p_ctx->prl.associate_data[1], seq_number);
  48              	 .loc 1 354 0
  49 0008 9DF84430 	 ldrb r3,[sp,#68]
  50              	.LVL1:
  51 000c 80F85832 	 strb r3,[r0,#600]
  52              	.LBE5:
  53              	.LBE4:
  54              	 .loc 1 403 0
  55 0010 0E46     	 mov r6,r1
  56              	.LBB8:
  57              	.LBB6:
 355:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     p_ctx->prl.associate_data[5] = p_ctx->protocol_version;
  58              	 .loc 1 355 0
  59 0012 00F25920 	 addw r0,r0,#601
  60              	.LVL2:
  61 0016 3946     	 mov r1,r7
  62              	.LVL3:
  63              	.LBE6:
  64              	.LBE8:
  65              	 .loc 1 403 0
  66 0018 1546     	 mov r5,r2
  67              	.LVL4:
  68              	.LBB9:
  69              	.LBB7:
 355:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     p_ctx->prl.associate_data[5] = p_ctx->protocol_version;
  70              	 .loc 1 355 0
  71 001a FFF7FEFF 	 bl optiga_common_set_uint32
  72              	.LVL5:
 356:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_common_set_uint16(&p_ctx->prl.associate_data[6], data_len);
  73              	 .loc 1 356 0
  74 001e 94F83130 	 ldrb r3,[r4,#49]
  75 0022 84F85D32 	 strb r3,[r4,#605]
 357:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
  76              	 .loc 1 357 0
  77 0026 04F25E20 	 addw r0,r4,#606
  78 002a 2946     	 mov r1,r5
  79 002c FFF7FEFF 	 bl optiga_common_set_uint16
  80              	.LVL6:
  81              	.LBE7:
  82              	.LBE9:
 404:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 405:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint8_t nonce_data[PRL_NONCE_LENGTH];
 406:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 407:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 408:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         //Form associated data
 409:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         ifx_i2c_prl_form_associated_data(p_ctx, data_len, seq_number, sctr);
 410:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         //Prepare nonce data
 411:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         memcpy(nonce_data, &p_ctx->prl.session_key[decrypt_nonce_offset], PRL_MASTER_NONCE_LENGTH);
  83              	 .loc 1 411 0
  84 0030 9DF84020 	 ldrb r2,[sp,#64]
  85 0034 2244     	 add r2,r2,r4
 412:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         optiga_common_set_uint32(&nonce_data[PRL_MASTER_NONCE_LENGTH], seq_number);
  86              	 .loc 1 412 0
  87 0036 3946     	 mov r1,r7
 411:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         optiga_common_set_uint32(&nonce_data[PRL_MASTER_NONCE_LENGTH], seq_number);
  88              	 .loc 1 411 0
  89 0038 D2F8D401 	 ldr r0,[r2,#468]
  90 003c 0690     	 str r0,[sp,#24]
  91              	 .loc 1 412 0
  92 003e 07A8     	 add r0,sp,#28
  93 0040 FFF7FEFF 	 bl optiga_common_set_uint32
  94              	.LVL7:
 413:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 414:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (PAL_STATUS_SUCCESS != (pal_crypt_decrypt_aes128_ccm(NULL,
 415:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_data,
 416:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 (data_len + IFX_I2C_PRL_MAC_SIZE),
 417:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 &p_ctx->prl.session_key[decrypt_key
  95              	 .loc 1 417 0
  96 0044 9DF83C30 	 ldrb r3,[sp,#60]
 414:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_data,
  97              	 .loc 1 414 0
  98 0048 06A9     	 add r1,sp,#24
  99 004a 0091     	 str r1,[sp]
 100 004c 0821     	 movs r1,#8
 101 004e 0191     	 str r1,[sp,#4]
 102 0050 0391     	 str r1,[sp,#12]
 103 0052 0491     	 str r1,[sp,#16]
 104 0054 05F10802 	 add r2,r5,#8
 105 0058 0E99     	 ldr r1,[sp,#56]
 106 005a 0591     	 str r1,[sp,#20]
 107              	 .loc 1 417 0
 108 005c 2344     	 add r3,r3,r4
 418:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 nonce_data,
 419:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 PRL_MASTER_NONCE_LENGTH + PRL_SEQ_N
 420:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_ctx->prl.associate_data,
 109              	 .loc 1 420 0
 110 005e 04F51674 	 add r4,r4,#600
 111              	.LVL8:
 414:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_data,
 112              	 .loc 1 414 0
 113 0062 0294     	 str r4,[sp,#8]
 114 0064 3146     	 mov r1,r6
 115 0066 92B2     	 uxth r2,r2
 116 0068 03F5EA73 	 add r3,r3,#468
 117 006c 0020     	 movs r0,#0
 118 006e FFF7FEFF 	 bl pal_crypt_decrypt_aes128_ccm
 119              	.LVL9:
 120 0072 0028     	 cmp r0,#0
 121              	.LVL10:
 421:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 sizeof(p_ctx->prl.associate_data),
 422:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 IFX_I2C_PRL_MAC_SIZE,
 423:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 out_data)))
 424:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 425:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 426:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 427:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         return_status = IFX_I2C_STACK_SUCCESS;
 428:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (FALSE);
 429:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     return (return_status);
 430:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 122              	 .loc 1 430 0
 123 0074 14BF     	 ite ne
 124 0076 4FF48170 	 movne r0,#258
 125 007a 0020     	 moveq r0,#0
 126 007c 09B0     	 add sp,sp,#36
 127              	.LCFI2:
 128              	 .cfi_def_cfa_offset 20
 129              	 
 130 007e F0BD     	 pop {r4,r5,r6,r7,pc}
 131              	 .cfi_endproc
 132              	.LFE6:
 134              	 .section .text.ifx_i2c_prl_encrypt_msg,"ax",%progbits
 135              	 .align 1
 136              	 .thumb
 137              	 .thumb_func
 139              	ifx_i2c_prl_encrypt_msg:
 140              	.LFB5:
 365:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 141              	 .loc 1 365 0
 142              	 .cfi_startproc
 143              	 
 144              	 
 145              	.LVL11:
 146 0000 F0B5     	 push {r4,r5,r6,r7,lr}
 147              	.LCFI3:
 148              	 .cfi_def_cfa_offset 20
 149              	 .cfi_offset 4,-20
 150              	 .cfi_offset 5,-16
 151              	 .cfi_offset 6,-12
 152              	 .cfi_offset 7,-8
 153              	 .cfi_offset 14,-4
 154 0002 89B0     	 sub sp,sp,#36
 155              	.LCFI4:
 156              	 .cfi_def_cfa_offset 56
 365:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 157              	 .loc 1 365 0
 158 0004 0446     	 mov r4,r0
 159 0006 1F46     	 mov r7,r3
 160              	.LBB12:
 161              	.LBB13:
 354:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_common_set_uint32(&p_ctx->prl.associate_data[1], seq_number);
 162              	 .loc 1 354 0
 163 0008 9DF83830 	 ldrb r3,[sp,#56]
 164              	.LVL12:
 165 000c 80F85832 	 strb r3,[r0,#600]
 166              	.LBE13:
 167              	.LBE12:
 365:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 168              	 .loc 1 365 0
 169 0010 0E46     	 mov r6,r1
 170              	.LBB16:
 171              	.LBB14:
 355:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     p_ctx->prl.associate_data[5] = p_ctx->protocol_version;
 172              	 .loc 1 355 0
 173 0012 00F25920 	 addw r0,r0,#601
 174              	.LVL13:
 175 0016 3946     	 mov r1,r7
 176              	.LVL14:
 177              	.LBE14:
 178              	.LBE16:
 365:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 179              	 .loc 1 365 0
 180 0018 1546     	 mov r5,r2
 181              	.LVL15:
 182              	.LBB17:
 183              	.LBB15:
 355:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     p_ctx->prl.associate_data[5] = p_ctx->protocol_version;
 184              	 .loc 1 355 0
 185 001a FFF7FEFF 	 bl optiga_common_set_uint32
 186              	.LVL16:
 356:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_common_set_uint16(&p_ctx->prl.associate_data[6], data_len);
 187              	 .loc 1 356 0
 188 001e 94F83130 	 ldrb r3,[r4,#49]
 189 0022 84F85D32 	 strb r3,[r4,#605]
 357:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 190              	 .loc 1 357 0
 191 0026 04F25E20 	 addw r0,r4,#606
 192 002a 2946     	 mov r1,r5
 193 002c FFF7FEFF 	 bl optiga_common_set_uint16
 194              	.LVL17:
 195              	.LBE15:
 196              	.LBE17:
 373:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         optiga_common_set_uint32(&nonce_data[PRL_MASTER_NONCE_LENGTH], seq_number);
 197              	 .loc 1 373 0
 198 0030 D4F8F401 	 ldr r0,[r4,#500]
 199 0034 0690     	 str r0,[sp,#24]
 374:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 200              	 .loc 1 374 0
 201 0036 3946     	 mov r1,r7
 202 0038 07A8     	 add r0,sp,#28
 203 003a FFF7FEFF 	 bl optiga_common_set_uint32
 204              	.LVL18:
 376:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_data,
 205              	 .loc 1 376 0
 206 003e 06AB     	 add r3,sp,#24
 207 0040 0093     	 str r3,[sp]
 383:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 sizeof(p_ctx->prl.associate_data),
 208              	 .loc 1 383 0
 209 0042 04F51672 	 add r2,r4,#600
 376:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_data,
 210              	 .loc 1 376 0
 211 0046 0823     	 movs r3,#8
 212 0048 0193     	 str r3,[sp,#4]
 213 004a 0292     	 str r2,[sp,#8]
 214 004c 0393     	 str r3,[sp,#12]
 215 004e 0493     	 str r3,[sp,#16]
 216 0050 0596     	 str r6,[sp,#20]
 217 0052 3146     	 mov r1,r6
 218 0054 2A46     	 mov r2,r5
 219 0056 04F5EA73 	 add r3,r4,#468
 220 005a 0020     	 movs r0,#0
 221 005c FFF7FEFF 	 bl pal_crypt_encrypt_aes128_ccm
 222              	.LVL19:
 223 0060 0028     	 cmp r0,#0
 224              	.LVL20:
 393:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 225              	 .loc 1 393 0
 226 0062 14BF     	 ite ne
 227 0064 4FF48170 	 movne r0,#258
 228 0068 0020     	 moveq r0,#0
 229 006a 09B0     	 add sp,sp,#36
 230              	.LCFI5:
 231              	 .cfi_def_cfa_offset 20
 232              	 
 233 006c F0BD     	 pop {r4,r5,r6,r7,pc}
 234              	 .cfi_endproc
 235              	.LFE5:
 237              	 .section .text.ifx_i2c_prl_event_handler,"ax",%progbits
 238              	 .align 1
 239              	 .thumb
 240              	 .thumb_func
 242              	ifx_i2c_prl_event_handler:
 243              	.LFB10:
 431:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 432:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_send_alert(ifx_i2c_context_t * p_ctx)
 433:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 434:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_SUCCESS;
 435:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 436:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 437:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.state = PRL_STATE_IDLE;
 438:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (PRL_INTEGRITY_VIOLATED_ALERT_MSG == p_ctx->prl.alert_type)
 439:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.decryption_failure_counter++;
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.state = PRL_STATE_VERIFY;
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             //lint --e{835} suppress "Protection bits in SCTR is set to 0 for alert message"
 444:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             FORM_SCTR_HEADER(p_ctx, PRL_ALERT_PROTOCOL, p_ctx->prl.alert_type, 0);
 445:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.prl_txrx_buffer[0] = p_ctx->prl.sctr;
 446:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = ifx_i2c_tl_transceive(p_ctx,
 447:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   p_ctx->prl.prl_txrx_buffer,
 448:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   1,
 449:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   p_ctx->prl.p_recv_payload_buffer,
 450:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   &p_ctx->prl.prl_receive_length);
 451:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             *p_ctx->prl.p_recv_payload_buffer_length = p_ctx->prl.prl_receive_length;
 452:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 453:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         else
 454:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 455:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.return_status = IFX_I2C_SESSION_ERROR;
 456:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 457:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 458:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 459:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 460:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 461:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (FALSE);
 462:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     return (return_status);
 463:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 464:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 465:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_do_handshake(ifx_i2c_context_t * p_ctx, const uint8_t * p
 466:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 467:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint8_t sseq[4];
 468:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 469:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint32_t exit_machine = FALSE;
 470:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     LOG_PRL("[IFX-PRL]: Do Handshake \n");
 471:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 472:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 473:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 474:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         switch (p_ctx->prl.hs_state)
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_HS_SEND_HELLO:
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Preparing hello message
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //lint --e{835} suppress "Protection bits in SCTR is set to 0 for hello message"
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 FORM_SCTR_HEADER(p_ctx,PRL_HANDSHAKE_PROTOCOL, PRL_MASTER_HELLO_MSG, 0);
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_buffer[PRL_SCTR_OFFSET] = p_ctx->prl.sctr;
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_buffer[PRL_PROTOCOL_VERSION_OFFSET] = p_ctx->protocol_version;
 483:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = PRL_SLAVE_HELLO_LENGTH;
 484:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Sending hello message
 485:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_tl_transceive(p_ctx,
 486:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       p_ctx->prl.prl_txrx_buffer,
 487:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       2,
 488:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       p_ctx->prl.prl_txrx_buffer,
 489:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       &p_ctx->prl.prl_receive_length);
 490:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (IFX_I2C_STACK_ERROR == return_status)
 491:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 492:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 493:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 494:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 495:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 496:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.hs_state = PRL_HS_VERIFY_HELLO;
 497:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 498:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 499:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_HS_VERIFY_HELLO:
 500:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 501:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = TRUE;
 502:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                  //lint --e{835} suppress "Macros are defined as 0x00 and is kept for future enhanc
 503:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if ((((p_data[PRL_SCTR_OFFSET] & (PRL_ALERT_PROTOCOL | PRL_FATAL_ALERT_MSG)) ||
 504:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (p_data[PRL_SCTR_OFFSET] & (PRL_ALERT_PROTOCOL | PRL_INTEGRITY_VIOLATED_ALERT_M
 505:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (1 == p_ctx->prl.prl_receive_length)))
 506:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 507:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = IFX_I2C_HANDSHAKE_ERROR;
 508:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 509:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = FALSE;
 510:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 511:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 512:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Check valid message type and protocol version
 513:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if ((PRL_SLAVE_HELLO_LENGTH != p_ctx->prl.prl_receive_length) || (0 != p_data[PRL_S
 514:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (PROTOCOL_VERSION_PRE_SHARED_SECRET != p_data[PRL_PROTOCOL_VERSION_OFFSET]))
 515:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 516:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 517:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 518:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 519:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Store slave sequence number and random number
 520:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.slave_sequence_number = optiga_common_get_uint32(&p_data[PRL_SLAVE_HELLO
 521:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.save_slave_sequence_number = p_ctx->prl.slave_sequence_number;
 522:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 memcpy(p_ctx->prl.random, &p_data[PRL_RANDOM_DATAOFFSET], PRL_RANDOM_DATA_LENGTH);
 523:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 524:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Generating session key
 525:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_prl_prf(p_ctx);
 526:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (IFX_I2C_HANDSHAKE_ERROR == return_status)
 527:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 528:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 529:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 530:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 531:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.hs_state = PRL_HS_SEND_FINISHED;
 532:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 533:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 534:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 535:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_HS_SEND_FINISHED:
 536:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 537:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //lint --e{835} suppress "Protection bits in SCTR is set to 0 for hello finished me
 538:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 FORM_SCTR_HEADER(p_ctx, PRL_HANDSHAKE_PROTOCOL, PRL_MASTER_FINISHED_MSG,0);
 539:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = FALSE;
 540:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Creating payload for encryption
 541:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 memcpy(&p_ctx->prl.prl_txrx_buffer[IFX_I2C_PRL_HEADER_SIZE] ,p_ctx->prl.random, PRL
 542:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 optiga_common_set_uint32(&p_ctx->prl.prl_txrx_buffer[PRL_RANDOM_DATA_LENGTH + IFX_I
 543:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          p_ctx->prl.slave_sequence_number);
 544:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 545:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Preparing encryption data
 546:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_prl_encrypt_msg(p_ctx,
 547:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         &p_ctx->prl.prl_txrx_buffer[IFX_I2C_PRL_HEA
 548:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         PRL_RANDOM_DATA_LENGTH + PRL_SEQ_NUMBER_LEN
 549:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         p_ctx->prl.slave_sequence_number,
 550:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         p_ctx->prl.sctr);
 551:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (IFX_I2C_STACK_ERROR == return_status)
 552:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 553:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 554:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 555:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 556:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 557:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 558:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Append presentation layer header
 559:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_buffer[PRL_SCTR_OFFSET] = p_ctx->prl.sctr;
 560:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 optiga_common_set_uint32(&p_ctx->prl.prl_txrx_buffer[1], p_ctx->prl.slave_sequence_
 561:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 562:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = PRL_FINISHED_DATA_LENGTH + 1;
 563:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_tl_transceive(p_ctx,
 564:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       p_ctx->prl.prl_txrx_buffer,
 565:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       PRL_FINISHED_DATA_LENGTH + 1,
 566:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       p_ctx->prl.prl_txrx_buffer,
 567:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       &p_ctx->prl.prl_receive_length);
 568:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (IFX_I2C_STACK_SUCCESS != return_status)
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 570:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 571:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 572:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 573:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 574:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.hs_state = PRL_HS_VERIFY_FINISHED;
 575:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 576:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 577:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_HS_VERIFY_FINISHED:
 578:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 579:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if ((PRL_MASTER_FINISHED_MSG != p_data[PRL_SCTR_OFFSET]) ||
 580:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ((PRL_FINISHED_DATA_LENGTH + 1) != p_ctx->prl.prl_receive_length))
 581:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 582:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 583:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 584:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 585:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.master_sequence_number = optiga_common_get_uint32(&p_data[1]);
 587:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_prl_decrypt_msg(p_ctx,
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         &p_data[IFX_I2C_PRL_HEADER_SIZE],
 589:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         PRL_RANDOM_DATA_LENGTH + PRL_SEQ_NUMBER_LEN
 590:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         p_ctx->prl.master_sequence_number,
 591:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         p_ctx->prl.prl_txrx_buffer,
 592:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         PRL_MASTER_DECRYPTION_KEY_OFFSET,
 593:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         PRL_MASTER_DECRYPTION_NONCE_OFFSET,
 594:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         p_ctx->prl.sctr);
 595:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (IFX_I2C_STACK_ERROR == return_status)
 596:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 597:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 598:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 599:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 600:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 601:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 optiga_common_set_uint32(sseq, p_ctx->prl.master_sequence_number);
 602:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Validating decrpt data
 603:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (0 != (memcmp(p_ctx->prl.random, p_ctx->prl.prl_txrx_buffer, PRL_RANDOM_DATA_LEN
 604:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 605:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = IFX_I2C_HANDSHAKE_ERROR;
 606:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 607:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 608:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 609:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 610:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Validating sequence number
 611:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (0 != (memcmp(sseq, &p_ctx->prl.prl_txrx_buffer[PRL_RANDOM_DATA_LENGTH], PRL_SEQ
 612:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 613:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = IFX_I2C_HANDSHAKE_ERROR;
 614:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_ERROR;
 615:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 616:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 617:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 618:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.negotiation_state = PRL_NEGOTIATION_DONE;
 619:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 620:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 621:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_HS_ERROR:
 622:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 623:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = IFX_I2C_HANDSHAKE_ERROR;
 624:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 625:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = FALSE;
 626:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 627:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 628:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             default:
 629:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 630:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 631:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 632:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (TRUE == exit_machine);
 633:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 634:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     return (return_status);
 635:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 636:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 637:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H optiga_lib_status_t ifx_i2c_prl_do_manage_context(ifx_i2c_context_t * p_ctx,
 638:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             const uint8_t * p_data,
 639:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             uint16_t data_len,
 640:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             uint8_t * exit_machine)
 641:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 642:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     ifx_i2c_prl_manage_context_t prl_saved_ctx;
 643:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 644:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint8_t sctr;
 645:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 646:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     switch (p_ctx->prl.mc_state)
 647:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 648:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         case PRL_MANAGE_CONTEXT_TX_STATE:
 649:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 650:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             LOG_PRL("[IFX-PRL]: PRL_STATE_MANAGE_CONTEXT \n");
 651:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             if (0 != (p_ctx->protection_level & RE_ESTABLISH))
 652:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 653:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_START;
 654:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = IFX_I2C_STACK_SUCCESS;
 655:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 break;
 656:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 657:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 658:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             if (IFX_I2C_SESSION_CONTEXT_SAVE == p_ctx->manage_context_operation)
 659:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 660:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_buffer[0] = PRL_SAVE_CONTEXT_MSG;
 661:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = 1;
 662:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_receive_length = 1;
 663:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 664:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             else if (IFX_I2C_SESSION_CONTEXT_RESTORE == p_ctx->manage_context_operation)
 665:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 666:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 /// Restoring saved context from data store
 667:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != p_ctx->ifx_i2c_datastore_config->da
 668:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 669:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.prl_receive_length = sizeof(p_ctx->prl.prl_saved_ctx);
 670:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = pal_os_datastore_read(p_ctx->ifx_i2c_datastore_config->datastor
 671:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           (uint8_t * )&p_ctx->prl.prl_saved_ctx,
 672:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           &p_ctx->prl.prl_receive_length);
 673:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (PAL_STATUS_FAILURE == return_status)
 674:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 675:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 676:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 677:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.negotiation_state = p_ctx->prl.prl_saved_ctx.negotiation_state;
 678:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (p_ctx->prl.prl_saved_ctx.stored_context_flag == FALSE)
 679:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 680:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.state = PRL_STATE_START;
 681:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 682:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.restore_context_flag = PRL_RESTORE_DONE;
 683:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         *exit_machine = TRUE;
 684:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         return_status = IFX_I2C_STACK_SUCCESS;
 685:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 686:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 687:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 688:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else
 689:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 690:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (p_ctx->prl.prl_saved_ctx.stored_context_flag == FALSE)
 691:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 692:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.state = PRL_STATE_START;
 693:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 694:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.restore_context_flag = PRL_RESTORE_DONE;
 695:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         *exit_machine = TRUE;
 696:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         return_status = IFX_I2C_STACK_SUCCESS;
 697:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 698:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 699:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     else
 700:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 701:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.negotiation_state = p_ctx->prl.prl_saved_ctx.negotiation_state;
 702:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 703:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 704:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Prepare restore message
 705:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_buffer[PRL_SCTR_OFFSET] = PRL_RESTORE_CONTEXT_MSG;
 706:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 optiga_common_set_uint32(&p_ctx->prl.prl_txrx_buffer[1], 
 707:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          p_ctx->prl.prl_saved_ctx.save_slave_sequence_number);
 708:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_receive_length = 5;
 709:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 prl_saved_ctx.stored_context_flag = FALSE;
 710:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = 5;
 711:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_saved_ctx.stored_context_flag = FALSE;
 712:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Clearing the saved context in data store
 713:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != p_ctx->ifx_i2c_datastore_config->da
 714:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 715:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     memset((uint8_t * )&prl_saved_ctx,0,sizeof(prl_saved_ctx));
 716:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = pal_os_datastore_write(p_ctx->ifx_i2c_datastore_config->datasto
 717:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            (uint8_t * )&prl_saved_ctx,
 718:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            sizeof(prl_saved_ctx));
 719:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (PAL_STATUS_FAILURE == return_status)
 720:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 721:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 722:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 723:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 724:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 725:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             else
 726:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 727:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 /// Message type invalid
 728:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 729:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_ERROR;
 730:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.return_status = IFX_I2C_STACK_ERROR;
 731:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 break;
 732:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 733:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = ifx_i2c_tl_transceive(p_ctx,
 734:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   p_ctx->prl.prl_txrx_buffer,
 735:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   p_ctx->prl.prl_txrx_receive_length,
 736:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   p_ctx->prl.prl_txrx_buffer,
 737:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   &p_ctx->prl.prl_receive_length);
 738:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             if (IFX_I2C_STACK_SUCCESS != return_status)
 739:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 740:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 break;
 741:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 742:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.mc_state = PRL_MANAGE_CONTEXT_RX_STATE;
 743:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_STACK_SUCCESS;
 744:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             *exit_machine = FALSE;
 745:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 746:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         break;
 747:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         case PRL_MANAGE_CONTEXT_RX_STATE:
 748:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 749:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             *exit_machine = TRUE;
 750:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             sctr = p_data[PRL_SCTR_OFFSET] & PRL_MANAGE_CONTEXT_MASK;
 751:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             if ((PRL_CONTEXT_RESTORED_MSG == sctr) &&
 752:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 (IFX_I2C_SESSION_CONTEXT_RESTORE == p_ctx->manage_context_operation) && (5 == data_
 753:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 754:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Restore the saved context to active context structure
 755:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 COPY_MANAGE_CONTEXT_DATA(p_ctx->prl.prl_saved_ctx,p_ctx->prl);
 756:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.restore_context_flag = PRL_RESTORE_DONE;
 757:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_TXRX;
 758:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 759:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             else if ((PRL_CONTEXT_SAVED_MSG == sctr) &&
 760:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                      (IFX_I2C_SESSION_CONTEXT_SAVE == p_ctx->manage_context_operation) && (1 == dat
 761:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 762:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_saved_ctx.stored_context_flag = TRUE;
 763:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 COPY_MANAGE_CONTEXT_DATA(p_ctx->prl, p_ctx->prl.prl_saved_ctx);
 764:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 
 765:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != p_ctx->ifx_i2c_datastore_config->da
 766:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 767:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ///Store active session to data store
 768:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.prl_receive_length = sizeof(p_ctx->prl.prl_saved_ctx);
 769:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = pal_os_datastore_write(p_ctx->ifx_i2c_datastore_config->datasto
 770:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            (uint8_t * )&p_ctx->prl.prl_saved_ctx,
 771:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            p_ctx->prl.prl_receive_length);
 772:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (PAL_STATUS_SUCCESS != return_status)
 773:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 774:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         ERROR_STATE_PREPARATION(p_ctx,*exit_machine);
 775:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 776:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 777:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 778:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Clearing the active session
 779:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 CLEAR_SESSION_CONTEXT(p_ctx);
 780:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_IDLE;
 781:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 782:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             else
 783:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 784:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 memset((uint8_t * )&p_ctx->prl.prl_saved_ctx,0,sizeof(p_ctx->prl.prl_saved_ctx));
 785:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != p_ctx->ifx_i2c_datastore_config->da
 786:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 787:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = pal_os_datastore_write(p_ctx->ifx_i2c_datastore_config->datasto
 788:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            (uint8_t * )&p_ctx->prl.prl_saved_ctx,
 789:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            sizeof(p_ctx->prl.prl_saved_ctx));
 790:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 791:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //lint --e{838} suppress "return_status is ignored for pal_os_datastore_write as it
 792:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = IFX_I2C_STACK_ERROR;
 793:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 break;
 794:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 795:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
 796:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_STACK_SUCCESS;
 797:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 798:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         break;
 799:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         default:
 800:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 801:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             ERROR_STATE_PREPARATION(p_ctx,*exit_machine);
 802:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 803:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         break;
 804:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     }
 805:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****   return (return_status);
 806:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 807:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 808:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** _STATIC_H void ifx_i2c_prl_event_handler(ifx_i2c_context_t * p_ctx,
 809:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          optiga_lib_status_t event,
 810:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          const uint8_t * p_data,
 811:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          uint16_t data_len)
 812:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** {
 244              	 .loc 1 812 0
 245              	 .cfi_startproc
 246              	 
 247              	 
 248              	.LVL21:
 249 0000 2DE9F043 	 push {r4,r5,r6,r7,r8,r9,lr}
 250              	.LCFI6:
 251              	 .cfi_def_cfa_offset 28
 252              	 .cfi_offset 4,-28
 253              	 .cfi_offset 5,-24
 254              	 .cfi_offset 6,-20
 255              	 .cfi_offset 7,-16
 256              	 .cfi_offset 8,-12
 257              	 .cfi_offset 9,-8
 258              	 .cfi_offset 14,-4
 813:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     //if handshake
 814:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint8_t exit_machine = TRUE;
 815:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     ifx_i2c_prl_manage_context_t prl_saved_ctx;
 816:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 817:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 818:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     LOG_PRL("[IFX-PRL]: ifx_i2c_prl_event_handler %d\n", data_len);
 819:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     if ((0 != (event & IFX_I2C_STACK_MEM_ERROR)) || (0 != (event & IFX_I2C_STACK_ERROR)))
 259              	 .loc 1 819 0
 260 0004 11F4837F 	 tst r1,#262
 812:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     //if handshake
 261              	 .loc 1 812 0
 262 0008 ABB0     	 sub sp,sp,#172
 263              	.LCFI7:
 264              	 .cfi_def_cfa_offset 200
 812:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     //if handshake
 265              	 .loc 1 812 0
 266 000a 0446     	 mov r4,r0
 267 000c 1646     	 mov r6,r2
 268 000e 1F46     	 mov r7,r3
 269              	 .loc 1 819 0
 270 0010 1FD0     	 beq .L12
 820:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 821:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 271              	 .loc 1 821 0
 272 0012 FF23     	 movs r3,#255
 273              	.LVL22:
 274 0014 80F8D231 	 strb r3,[r0,#466]
 822:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (PRL_STATE_HANDSHAKE == p_ctx->prl.state)
 275              	 .loc 1 822 0
 276 0018 90F8B031 	 ldrb r3,[r0,#432]
 277 001c 052B     	 cmp r3,#5
 278 001e 04D1     	 bne .L9
 823:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 824:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.return_status = IFX_I2C_HANDSHAKE_ERROR;
 279              	 .loc 1 824 0
 280 0020 40F20713 	 movw r3,#263
 281 0024 A0F86432 	 strh r3,[r0,#612]
 282 0028 10E0     	 b .L10
 283              	.L9:
 825:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 826:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         else if ((PRL_NEGOTIATION_DONE == p_ctx->prl.negotiation_state) && (IFX_I2C_STACK_MEM_ERROR
 284              	 .loc 1 826 0
 285 002a 90F8B231 	 ldrb r3,[r0,#434]
 286 002e 012B     	 cmp r3,#1
 287 0030 0AD1     	 bne .L11
 288              	 .loc 1 826 0 is_stmt 0 discriminator 1
 289 0032 B1F5827F 	 cmp r1,#260
 290 0036 07D0     	 beq .L11
 827:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 828:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.return_status = IFX_I2C_SESSION_ERROR;
 291              	 .loc 1 828 0 is_stmt 1
 292 0038 4FF48473 	 mov r3,#264
 293 003c A0F86432 	 strh r3,[r0,#612]
 829:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 294              	 .loc 1 829 0
 295 0040 0023     	 movs r3,#0
 296 0042 80F8B231 	 strb r3,[r0,#434]
 297 0046 01E0     	 b .L10
 298              	.L11:
 830:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 831:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         else
 832:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 833:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.return_status = event;
 299              	 .loc 1 833 0
 300 0048 A4F86412 	 strh r1,[r4,#612]
 301              	.LVL23:
 302              	.L10:
 834:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 835:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.state = PRL_STATE_ERROR;
 303              	 .loc 1 835 0
 304 004c 0723     	 movs r3,#7
 305              	.L183:
 306 004e 84F8B031 	 strb r3,[r4,#432]
 307              	.LVL24:
 308              	.L12:
 836:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     }
 837:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 838:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     do
 839:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 840:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         //exit_machine = FALSE;
 841:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         switch (p_ctx->prl.state)
 309              	 .loc 1 841 0
 310 0052 94F8B031 	 ldrb r3,[r4,#432]
 311 0056 013B     	 subs r3,r3,#1
 312 0058 072B     	 cmp r3,#7
 313 005a 00F27684 	 bhi .L13
 314 005e DFE813F0 	 tbh [pc,r3,lsl#1]
 315              	.L15:
 316 0062 0800     	 .2byte (.L14-.L15)/2
 317 0064 4C01     	 .2byte (.L16-.L15)/2
 318 0066 7903     	 .2byte (.L17-.L15)/2
 319 0068 C802     	 .2byte (.L18-.L15)/2
 320 006a 6501     	 .2byte (.L19-.L15)/2
 321 006c 1004     	 .2byte (.L20-.L15)/2
 322 006e 3F04     	 .2byte (.L21-.L15)/2
 323 0070 0F00     	 .2byte (.L22-.L15)/2
 324              	 .p2align 1
 325              	.L14:
 842:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 843:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_STATE_IDLE:
 844:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 845:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 LOG_PRL("[IFX-PRL]: PRL_STATE_IDLE %d\n", p_ctx->prl.return_status);
 846:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.upper_layer_event_handler(p_ctx, p_ctx->prl.return_status, 0, 0);
 326              	 .loc 1 846 0
 327 0072 D4F89C52 	 ldr r5,[r4,#668]
 328 0076 B4F86412 	 ldrh r1,[r4,#612]
 329 007a 2046     	 mov r0,r4
 330 007c 00F06DBC 	 b .L190
 331              	.L22:
 332              	.LVL25:
 333              	.LBB26:
 334              	.LBB27:
 646:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     {
 335              	 .loc 1 646 0
 336 0080 94F8B331 	 ldrb r3,[r4,#435]
 337 0084 012B     	 cmp r3,#1
 338 0086 02D0     	 beq .L25
 339 0088 022B     	 cmp r3,#2
 340 008a 7BD0     	 beq .L26
 341 008c 12E1     	 b .L193
 342              	.L25:
 651:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 343              	 .loc 1 651 0
 344 008e 94F93020 	 ldrsb r2,[r4,#48]
 345 0092 002A     	 cmp r2,#0
 346 0094 01DA     	 bge .L27
 653:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = IFX_I2C_STACK_SUCCESS;
 347              	 .loc 1 653 0
 348 0096 0223     	 movs r3,#2
 349 0098 D9E7     	 b .L183
 350              	.L27:
 658:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 351              	 .loc 1 658 0
 352 009a 94F83220 	 ldrb r2,[r4,#50]
 353 009e 222A     	 cmp r2,#34
 354 00a0 07D1     	 bne .L29
 660:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = 1;
 355              	 .loc 1 660 0
 356 00a2 6022     	 movs r2,#96
 357 00a4 84F81C22 	 strb r2,[r4,#540]
 661:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_receive_length = 1;
 358              	 .loc 1 661 0
 359 00a8 A4F86032 	 strh r3,[r4,#608]
 662:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 360              	 .loc 1 662 0
 361 00ac A4F85632 	 strh r3,[r4,#598]
 362 00b0 56E0     	 b .L30
 363              	.L29:
 664:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 364              	 .loc 1 664 0
 365 00b2 112A     	 cmp r2,#17
 366 00b4 49D1     	 bne .L31
 667:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 367              	 .loc 1 667 0
 368 00b6 6369     	 ldr r3,[r4,#20]
 369 00b8 9888     	 ldrh r0,[r3,#4]
 370 00ba E0B1     	 cbz r0,.L32
 669:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = pal_os_datastore_read(p_ctx->ifx_i2c_datastore_config->datastor
 371              	 .loc 1 669 0
 372 00bc 3423     	 movs r3,#52
 373 00be A4F86032 	 strh r3,[r4,#608]
 670:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           (uint8_t * )&p_ctx->prl.prl_saved_ctx,
 374              	 .loc 1 670 0
 375 00c2 04F51A71 	 add r1,r4,#616
 376 00c6 04F51872 	 add r2,r4,#608
 377 00ca FFF7FEFF 	 bl pal_os_datastore_read
 378              	.LVL26:
 673:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 379              	 .loc 1 673 0
 380 00ce 0128     	 cmp r0,#1
 381 00d0 00F00381 	 beq .L82
 677:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (p_ctx->prl.prl_saved_ctx.stored_context_flag == FALSE)
 382              	 .loc 1 677 0
 383 00d4 94F89232 	 ldrb r3,[r4,#658]
 384 00d8 84F8B231 	 strb r3,[r4,#434]
 678:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 385              	 .loc 1 678 0
 386 00dc 94F89332 	 ldrb r3,[r4,#659]
 387 00e0 8BB9     	 cbnz r3,.L34
 388              	.LVL27:
 389              	.L35:
 680:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 390              	 .loc 1 680 0
 391 00e2 0223     	 movs r3,#2
 392 00e4 84F8B031 	 strb r3,[r4,#432]
 681:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.restore_context_flag = PRL_RESTORE_DONE;
 393              	 .loc 1 681 0
 394 00e8 0023     	 movs r3,#0
 395 00ea 84F8B231 	 strb r3,[r4,#434]
 682:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         *exit_machine = TRUE;
 396              	 .loc 1 682 0
 397 00ee 0123     	 movs r3,#1
 398 00f0 84F86632 	 strb r3,[r4,#614]
 399              	.LVL28:
 400 00f4 ADE7     	 b .L12
 401              	.LVL29:
 402              	.L32:
 690:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 403              	 .loc 1 690 0
 404 00f6 94F89332 	 ldrb r3,[r4,#659]
 405 00fa 002B     	 cmp r3,#0
 406 00fc F1D0     	 beq .L35
 701:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 407              	 .loc 1 701 0
 408 00fe 94F89232 	 ldrb r3,[r4,#658]
 409 0102 84F8B231 	 strb r3,[r4,#434]
 410              	.LVL30:
 411              	.L34:
 705:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 optiga_common_set_uint32(&p_ctx->prl.prl_txrx_buffer[1], 
 412              	 .loc 1 705 0
 413 0106 6823     	 movs r3,#104
 414 0108 84F81C32 	 strb r3,[r4,#540]
 706:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          p_ctx->prl.prl_saved_ctx.save_slave_sequence_number);
 415              	 .loc 1 706 0
 416 010c D4F89812 	 ldr r1,[r4,#664]
 417 0110 04F21D20 	 addw r0,r4,#541
 418 0114 FFF7FEFF 	 bl optiga_common_set_uint32
 419              	.LVL31:
 709:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = 5;
 420              	 .loc 1 709 0
 421 0118 0021     	 movs r1,#0
 713:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 422              	 .loc 1 713 0
 423 011a 6569     	 ldr r5,[r4,#20]
 709:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = 5;
 424              	 .loc 1 709 0
 425 011c 8DF89310 	 strb r1,[sp,#147]
 708:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 prl_saved_ctx.stored_context_flag = FALSE;
 426              	 .loc 1 708 0
 427 0120 0523     	 movs r3,#5
 711:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Clearing the saved context in data store
 428              	 .loc 1 711 0
 429 0122 84F89312 	 strb r1,[r4,#659]
 708:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 prl_saved_ctx.stored_context_flag = FALSE;
 430              	 .loc 1 708 0
 431 0126 A4F85632 	 strh r3,[r4,#598]
 710:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_saved_ctx.stored_context_flag = FALSE;
 432              	 .loc 1 710 0
 433 012a A4F86032 	 strh r3,[r4,#608]
 713:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 434              	 .loc 1 713 0
 435 012e AB88     	 ldrh r3,[r5,#4]
 436 0130 B3B1     	 cbz r3,.L30
 715:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = pal_os_datastore_write(p_ctx->ifx_i2c_datastore_config->datasto
 437              	 .loc 1 715 0
 438 0132 3422     	 movs r2,#52
 439 0134 1AA8     	 add r0,sp,#104
 440 0136 FFF7FEFF 	 bl memset
 441              	.LVL32:
 716:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            (uint8_t * )&prl_saved_ctx,
 442              	 .loc 1 716 0
 443 013a A888     	 ldrh r0,[r5,#4]
 444 013c 1AA9     	 add r1,sp,#104
 445 013e 3422     	 movs r2,#52
 446 0140 FFF7FEFF 	 bl pal_os_datastore_write
 447              	.LVL33:
 719:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 448              	 .loc 1 719 0
 449 0144 0128     	 cmp r0,#1
 450 0146 0BD1     	 bne .L30
 451 0148 C7E0     	 b .L82
 452              	.LVL34:
 453              	.L31:
 728:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_ERROR;
 454              	 .loc 1 728 0
 455 014a FF23     	 movs r3,#255
 456 014c 84F8D231 	 strb r3,[r4,#466]
 729:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.return_status = IFX_I2C_STACK_ERROR;
 457              	 .loc 1 729 0
 458 0150 0723     	 movs r3,#7
 459 0152 84F8B031 	 strb r3,[r4,#432]
 730:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 break;
 460              	 .loc 1 730 0
 461 0156 4FF48173 	 mov r3,#258
 462 015a A4F86432 	 strh r3,[r4,#612]
 463 015e BCE0     	 b .L82
 464              	.LVL35:
 465              	.L30:
 733:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   p_ctx->prl.prl_txrx_buffer,
 466              	 .loc 1 733 0
 467 0160 04F51873 	 add r3,r4,#608
 736:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   &p_ctx->prl.prl_receive_length);
 468              	 .loc 1 736 0
 469 0164 04F50771 	 add r1,r4,#540
 733:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   p_ctx->prl.prl_txrx_buffer,
 470              	 .loc 1 733 0
 471 0168 0093     	 str r3,[sp]
 472 016a B4F85622 	 ldrh r2,[r4,#598]
 473 016e 2046     	 mov r0,r4
 474 0170 0B46     	 mov r3,r1
 475 0172 FFF7FEFF 	 bl ifx_i2c_tl_transceive
 476              	.LVL36:
 738:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 477              	 .loc 1 738 0
 478 0176 0028     	 cmp r0,#0
 479 0178 40F0AC80 	 bne .L28
 742:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_STACK_SUCCESS;
 480              	 .loc 1 742 0
 481 017c 0223     	 movs r3,#2
 482 017e 84F8B331 	 strb r3,[r4,#435]
 483              	.LVL37:
 484 0182 EDE3     	 b .L7
 485              	.LVL38:
 486              	.L26:
 750:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             if ((PRL_CONTEXT_RESTORED_MSG == sctr) &&
 487              	 .loc 1 750 0
 488 0184 3378     	 ldrb r3,[r6]
 489 0186 03F0FC03 	 and r3,r3,#252
 490              	.LVL39:
 751:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 (IFX_I2C_SESSION_CONTEXT_RESTORE == p_ctx->manage_context_operation) && (5 == data_
 491              	 .loc 1 751 0
 492 018a 6C2B     	 cmp r3,#108
 493 018c 04F51A75 	 add r5,r4,#616
 494 0190 28D1     	 bne .L38
 495 0192 94F83230 	 ldrb r3,[r4,#50]
 496              	.LVL40:
 497 0196 112B     	 cmp r3,#17
 498 0198 7FD1     	 bne .L39
 752:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 499              	 .loc 1 752 0
 500 019a 052F     	 cmp r7,#5
 501 019c 7DD1     	 bne .L39
 755:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.restore_context_flag = PRL_RESTORE_DONE;
 502              	 .loc 1 755 0
 503 019e 04F5EA73 	 add r3,r4,#468
 504 01a2 04F52472 	 add r2,r4,#656
 505              	.LVL41:
 506              	.L40:
 507 01a6 55F8041B 	 ldr r1,[r5],#4
 508 01aa 43F8041B 	 str r1,[r3],#4
 509 01ae 9542     	 cmp r5,r2
 510 01b0 F9D1     	 bne .L40
 511 01b2 D4F89432 	 ldr r3,[r4,#660]
 512 01b6 C4F8B431 	 str r3,[r4,#436]
 513 01ba D4F89832 	 ldr r3,[r4,#664]
 514 01be C4F8BC31 	 str r3,[r4,#444]
 515 01c2 94F89032 	 ldrb r3,[r4,#656]
 516 01c6 84F86232 	 strb r3,[r4,#610]
 517 01ca 94F89132 	 ldrb r3,[r4,#657]
 518 01ce 84F86332 	 strb r3,[r4,#611]
 519 01d2 94F89232 	 ldrb r3,[r4,#658]
 520 01d6 84F8B231 	 strb r3,[r4,#434]
 756:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_TXRX;
 521              	 .loc 1 756 0
 522 01da 0123     	 movs r3,#1
 523 01dc 84F86632 	 strb r3,[r4,#614]
 757:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 524              	 .loc 1 757 0
 525 01e0 0423     	 movs r3,#4
 526 01e2 56E0     	 b .L186
 527              	.LVL42:
 528              	.L38:
 759:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                      (IFX_I2C_SESSION_CONTEXT_SAVE == p_ctx->manage_context_operation) && (1 == dat
 529              	 .loc 1 759 0
 530 01e4 642B     	 cmp r3,#100
 531 01e6 58D1     	 bne .L39
 532 01e8 94F83230 	 ldrb r3,[r4,#50]
 533              	.LVL43:
 534 01ec 222B     	 cmp r3,#34
 535 01ee 54D1     	 bne .L39
 760:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 536              	 .loc 1 760 0
 537 01f0 012F     	 cmp r7,#1
 538 01f2 52D1     	 bne .L39
 763:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 
 539              	 .loc 1 763 0
 540 01f4 04F5EA78 	 add r8,r4,#468
 762:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 COPY_MANAGE_CONTEXT_DATA(p_ctx->prl, p_ctx->prl.prl_saved_ctx);
 541              	 .loc 1 762 0
 542 01f8 84F89372 	 strb r7,[r4,#659]
 543              	.LVL44:
 763:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 
 544              	 .loc 1 763 0
 545 01fc 4346     	 mov r3,r8
 546 01fe 2A46     	 mov r2,r5
 547 0200 04F5FE71 	 add r1,r4,#508
 548              	.L42:
 549 0204 53F8040B 	 ldr r0,[r3],#4
 550 0208 42F8040B 	 str r0,[r2],#4
 551 020c 8B42     	 cmp r3,r1
 552 020e F9D1     	 bne .L42
 553 0210 D4F8B431 	 ldr r3,[r4,#436]
 554 0214 C4F89432 	 str r3,[r4,#660]
 555 0218 D4F8BC31 	 ldr r3,[r4,#444]
 556 021c C4F89832 	 str r3,[r4,#664]
 557 0220 94F86232 	 ldrb r3,[r4,#610]
 558 0224 84F89032 	 strb r3,[r4,#656]
 559 0228 94F86332 	 ldrb r3,[r4,#611]
 560 022c 84F89132 	 strb r3,[r4,#657]
 561 0230 94F8B231 	 ldrb r3,[r4,#434]
 562 0234 84F89232 	 strb r3,[r4,#658]
 765:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 563              	 .loc 1 765 0
 564 0238 6369     	 ldr r3,[r4,#20]
 565 023a 9888     	 ldrh r0,[r3,#4]
 566 023c B0B1     	 cbz r0,.L43
 768:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = pal_os_datastore_write(p_ctx->ifx_i2c_datastore_config->datasto
 567              	 .loc 1 768 0
 568 023e 3422     	 movs r2,#52
 569 0240 A4F86022 	 strh r2,[r4,#608]
 769:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            (uint8_t * )&p_ctx->prl.prl_saved_ctx,
 570              	 .loc 1 769 0
 571 0244 2946     	 mov r1,r5
 572 0246 FFF7FEFF 	 bl pal_os_datastore_write
 573              	.LVL45:
 772:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 574              	 .loc 1 772 0
 575 024a 78B1     	 cbz r0,.L43
 774:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 576              	 .loc 1 774 0
 577 024c FF23     	 movs r3,#255
 578 024e 84F8D231 	 strb r3,[r4,#466]
 579 0252 0723     	 movs r3,#7
 580 0254 84F8B031 	 strb r3,[r4,#432]
 581 0258 4FF48472 	 mov r2,#264
 582 025c 0023     	 movs r3,#0
 583 025e 84F8B231 	 strb r3,[r4,#434]
 584 0262 A4F86422 	 strh r2,[r4,#612]
 585 0266 84F8A032 	 strb r3,[r4,#672]
 586 026a 33E0     	 b .L28
 587              	.LVL46:
 588              	.L43:
 779:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_IDLE;
 589              	 .loc 1 779 0
 590 026c 4046     	 mov r0,r8
 591 026e 0021     	 movs r1,#0
 592 0270 2822     	 movs r2,#40
 593 0272 FFF7FEFF 	 bl memset
 594              	.LVL47:
 595 0276 0023     	 movs r3,#0
 596 0278 C4F8B431 	 str r3,[r4,#436]
 597 027c C4F8B831 	 str r3,[r4,#440]
 598 0280 C4F8BC31 	 str r3,[r4,#444]
 599 0284 84F86232 	 strb r3,[r4,#610]
 600 0288 84F86332 	 strb r3,[r4,#611]
 601 028c 84F8A032 	 strb r3,[r4,#672]
 602 0290 0123     	 movs r3,#1
 603              	.L186:
 604 0292 84F8B031 	 strb r3,[r4,#432]
 795:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_STACK_SUCCESS;
 605              	 .loc 1 795 0
 606 0296 0023     	 movs r3,#0
 607 0298 DDE2     	 b .L184
 608              	.LVL48:
 609              	.L39:
 784:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != p_ctx->ifx_i2c_datastore_config->da
 610              	 .loc 1 784 0
 611 029a 2846     	 mov r0,r5
 612 029c 0021     	 movs r1,#0
 613 029e 3422     	 movs r2,#52
 614 02a0 FFF7FEFF 	 bl memset
 615              	.LVL49:
 785:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 616              	 .loc 1 785 0
 617 02a4 6369     	 ldr r3,[r4,#20]
 618 02a6 9888     	 ldrh r0,[r3,#4]
 619 02a8 B8B1     	 cbz r0,.L82
 787:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            (uint8_t * )&p_ctx->prl.prl_saved_ctx,
 620              	 .loc 1 787 0
 621 02aa 2946     	 mov r1,r5
 622 02ac 3422     	 movs r2,#52
 623 02ae FFF7FEFF 	 bl pal_os_datastore_write
 624              	.LVL50:
 625 02b2 12E0     	 b .L82
 626              	.LVL51:
 627              	.L193:
 801:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 628              	 .loc 1 801 0
 629 02b4 FF23     	 movs r3,#255
 630 02b6 84F8D231 	 strb r3,[r4,#466]
 631 02ba 0723     	 movs r3,#7
 632 02bc 84F8B031 	 strb r3,[r4,#432]
 633 02c0 4FF48472 	 mov r2,#264
 634 02c4 0023     	 movs r3,#0
 635 02c6 84F8B231 	 strb r3,[r4,#434]
 636 02ca A4F86422 	 strh r2,[r4,#612]
 637 02ce 84F8A032 	 strb r3,[r4,#672]
 638 02d2 02E0     	 b .L82
 639              	.LVL52:
 640              	.L28:
 641              	.LBE27:
 642              	.LBE26:
 847:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = FALSE;
 848:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 849:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 850:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_STATE_MANAGE_CONTEXT:
 851:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 852:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 LOG_PRL("[IFX-PRL]: PRL_STATE_MANAGE_CONTEXT \n");
 853:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_prl_do_manage_context(p_ctx, p_data,data_len,&exit_machine)
 854:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (IFX_I2C_STACK_SUCCESS != return_status)
 643              	 .loc 1 854 0
 644 02d4 0028     	 cmp r0,#0
 645 02d6 3FF4BCAE 	 beq .L12
 646              	.LVL53:
 647              	.L82:
 855:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 856:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                   ERROR_STATE_PREPARATION(p_ctx,exit_machine);
 648              	 .loc 1 856 0
 649 02da FF23     	 movs r3,#255
 650 02dc 84F8D231 	 strb r3,[r4,#466]
 651 02e0 0723     	 movs r3,#7
 652 02e2 84F8B031 	 strb r3,[r4,#432]
 653 02e6 4FF48472 	 mov r2,#264
 654 02ea 0023     	 movs r3,#0
 655 02ec 84F8B231 	 strb r3,[r4,#434]
 656 02f0 A4F86422 	 strh r2,[r4,#612]
 657 02f4 84F8A032 	 strb r3,[r4,#672]
 658              	.LVL54:
 659 02f8 ABE6     	 b .L12
 660              	.L16:
 857:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 858:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 859:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 860:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_STATE_START:
 861:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 862:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (((p_ctx->protection_level & RE_ESTABLISH) ||
 661              	 .loc 1 862 0
 662 02fa 94F83030 	 ldrb r3,[r4,#48]
 663 02fe 1A06     	 lsls r2,r3,#24
 664 0300 03D4     	 bmi .L46
 665              	 .loc 1 862 0 is_stmt 0 discriminator 1
 666 0302 8BB1     	 cbz r3,.L47
 863:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ((p_ctx->protection_level != NO_PROTECTION ) &&
 667              	 .loc 1 863 0 is_stmt 1
 668 0304 94F8B231 	 ldrb r3,[r4,#434]
 669 0308 73B9     	 cbnz r3,.L47
 670              	.L46:
 864:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (PRL_NEGOTIATION_NOT_DONE == p_ctx->prl.negotiation_state))))
 865:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 866:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state =  PRL_STATE_HANDSHAKE;
 671              	 .loc 1 866 0
 672 030a 0523     	 movs r3,#5
 673 030c 84F8B031 	 strb r3,[r4,#432]
 867:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.hs_state = PRL_HS_SEND_HELLO;
 674              	 .loc 1 867 0
 675 0310 1123     	 movs r3,#17
 676 0312 84F8B131 	 strb r3,[r4,#433]
 868:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 677              	 .loc 1 868 0
 678 0316 0023     	 movs r3,#0
 679 0318 84F8B231 	 strb r3,[r4,#434]
 680 031c 99E6     	 b .L12
 681              	.L75:
 869:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 870:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else
 871:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 872:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state =  PRL_STATE_TXRX;
 873:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 874:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 875:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 876:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_STATE_HANDSHAKE:
 877:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 878:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Clearing the saved context in data store
 879:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 CLEAR_SAVED_SESSION_CONTEXT(p_ctx->prl.prl_saved_ctx);
 880:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 memset((uint8_t * )&prl_saved_ctx,0,sizeof(prl_saved_ctx));
 881:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != p_ctx->ifx_i2c_datastore_config->da
 882:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 883:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = pal_os_datastore_write(p_ctx->ifx_i2c_datastore_config->datasto
 884:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            (uint8_t * )&prl_saved_ctx,
 885:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            sizeof(prl_saved_ctx));
 886:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (PAL_STATUS_SUCCESS != return_status)
 887:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 888:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         ERROR_STATE_PREPARATION(p_ctx,exit_machine);
 889:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.return_status = IFX_I2C_HANDSHAKE_ERROR;
 890:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 891:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 892:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 893:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_prl_do_handshake(p_ctx,p_data);
 894:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (IFX_I2C_HANDSHAKE_ERROR == return_status)
 895:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 896:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.return_status = return_status;
 897:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state = PRL_STATE_ERROR;
 898:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 899:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 900:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 901:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (PRL_NEGOTIATION_DONE == p_ctx->prl.negotiation_state)
 682              	 .loc 1 901 0
 683 031e 94F8B231 	 ldrb r3,[r4,#434]
 684 0322 012B     	 cmp r3,#1
 685 0324 40F01C83 	 bne .L7
 686              	.L47:
 872:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 687              	 .loc 1 872 0
 688 0328 0423     	 movs r3,#4
 689 032a 90E6     	 b .L183
 690              	.L19:
 879:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 memset((uint8_t * )&prl_saved_ctx,0,sizeof(prl_saved_ctx));
 691              	 .loc 1 879 0
 692 032c 0025     	 movs r5,#0
 693 032e 0021     	 movs r1,#0
 694 0330 2822     	 movs r2,#40
 695 0332 04F51A70 	 add r0,r4,#616
 696 0336 FFF7FEFF 	 bl memset
 697              	.LVL55:
 698 033a C4F89452 	 str r5,[r4,#660]
 699 033e 84F89252 	 strb r5,[r4,#658]
 700 0342 C4F89852 	 str r5,[r4,#664]
 701 0346 84F89052 	 strb r5,[r4,#656]
 702 034a 84F89152 	 strb r5,[r4,#657]
 703 034e 84F89352 	 strb r5,[r4,#659]
 880:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != p_ctx->ifx_i2c_datastore_config->da
 704              	 .loc 1 880 0
 705 0352 0DA8     	 add r0,sp,#52
 706 0354 2946     	 mov r1,r5
 707 0356 3422     	 movs r2,#52
 708 0358 FFF7FEFF 	 bl memset
 709              	.LVL56:
 881:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 710              	 .loc 1 881 0
 711 035c 6369     	 ldr r3,[r4,#20]
 712 035e 9888     	 ldrh r0,[r3,#4]
 713 0360 88B1     	 cbz r0,.L48
 883:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            (uint8_t * )&prl_saved_ctx,
 714              	 .loc 1 883 0
 715 0362 0DA9     	 add r1,sp,#52
 716 0364 3422     	 movs r2,#52
 717 0366 FFF7FEFF 	 bl pal_os_datastore_write
 718              	.LVL57:
 886:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 719              	 .loc 1 886 0
 720 036a 60B1     	 cbz r0,.L48
 888:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.return_status = IFX_I2C_HANDSHAKE_ERROR;
 721              	 .loc 1 888 0
 722 036c FF23     	 movs r3,#255
 723 036e 84F8D231 	 strb r3,[r4,#466]
 724 0372 0723     	 movs r3,#7
 725 0374 84F8B031 	 strb r3,[r4,#432]
 726 0378 84F8B251 	 strb r5,[r4,#434]
 727 037c 84F8A052 	 strb r5,[r4,#672]
 889:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 728              	 .loc 1 889 0
 729 0380 40F20713 	 movw r3,#263
 730 0384 67E2     	 b .L184
 731              	.LVL58:
 732              	.L48:
 733              	.LBB29:
 734              	.LBB28:
 792:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 break;
 735              	 .loc 1 792 0
 736 0386 4FF00008 	 mov r8,#0
 737 038a 4FF48175 	 mov r5,#258
 738              	.L49:
 739              	.LVL59:
 740              	.LBE28:
 741              	.LBE29:
 742              	.LBB30:
 743              	.LBB31:
 474:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 744              	 .loc 1 474 0
 745 038e 94F8B131 	 ldrb r3,[r4,#433]
 746 0392 332B     	 cmp r3,#51
 747 0394 00F09D80 	 beq .L51
 748 0398 04D8     	 bhi .L52
 749 039a 112B     	 cmp r3,#17
 750 039c 09D0     	 beq .L53
 751 039e 222B     	 cmp r3,#34
 752 03a0 2DD0     	 beq .L54
 753 03a2 1AE1     	 b .L50
 754              	.L52:
 755 03a4 442B     	 cmp r3,#68
 756 03a6 00F0D380 	 beq .L55
 757 03aa 552B     	 cmp r3,#85
 758 03ac 00F00F81 	 beq .L56
 759 03b0 13E1     	 b .L50
 760              	.L53:
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_buffer[PRL_SCTR_OFFSET] = p_ctx->prl.sctr;
 761              	 .loc 1 480 0
 762 03b2 0023     	 movs r3,#0
 763 03b4 84F8D031 	 strb r3,[r4,#464]
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_txrx_buffer[PRL_PROTOCOL_VERSION_OFFSET] = p_ctx->protocol_version;
 764              	 .loc 1 481 0
 765 03b8 84F81C32 	 strb r3,[r4,#540]
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = PRL_SLAVE_HELLO_LENGTH;
 766              	 .loc 1 482 0
 767 03bc 94F83130 	 ldrb r3,[r4,#49]
 768 03c0 84F81D32 	 strb r3,[r4,#541]
 483:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //Sending hello message
 769              	 .loc 1 483 0
 770 03c4 2623     	 movs r3,#38
 771 03c6 A4F86032 	 strh r3,[r4,#608]
 488:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       &p_ctx->prl.prl_receive_length);
 772              	 .loc 1 488 0
 773 03ca 04F50771 	 add r1,r4,#540
 485:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       p_ctx->prl.prl_txrx_buffer,
 774              	 .loc 1 485 0
 775 03ce 04F51873 	 add r3,r4,#608
 776 03d2 0093     	 str r3,[sp]
 777 03d4 2046     	 mov r0,r4
 778 03d6 0222     	 movs r2,#2
 779 03d8 0B46     	 mov r3,r1
 780 03da FFF7FEFF 	 bl ifx_i2c_tl_transceive
 781              	.LVL60:
 490:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 782              	 .loc 1 490 0
 783 03de B0F5817F 	 cmp r0,#258
 485:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       p_ctx->prl.prl_txrx_buffer,
 784              	 .loc 1 485 0
 785 03e2 0546     	 mov r5,r0
 786              	.LVL61:
 490:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 787              	 .loc 1 490 0
 788 03e4 07D1     	 bne .L57
 789              	.LVL62:
 790              	.L69:
 492:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 791              	 .loc 1 492 0
 792 03e6 5523     	 movs r3,#85
 793 03e8 84F8B131 	 strb r3,[r4,#433]
 794              	.LVL63:
 795 03ec 4FF48175 	 mov r5,#258
 796              	.LVL64:
 797              	.L74:
 798 03f0 4FF00108 	 mov r8,#1
 799 03f4 CBE7     	 b .L49
 800              	.LVL65:
 801              	.L57:
 496:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 802              	 .loc 1 496 0
 803 03f6 2223     	 movs r3,#34
 804 03f8 84F8B131 	 strb r3,[r4,#433]
 805 03fc EDE0     	 b .L50
 806              	.LVL66:
 807              	.L54:
 503:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (p_data[PRL_SCTR_OFFSET] & (PRL_ALERT_PROTOCOL | PRL_INTEGRITY_VIOLATED_ALERT_M
 808              	 .loc 1 503 0
 809 03fe 3378     	 ldrb r3,[r6]
 810 0400 B4F86022 	 ldrh r2,[r4,#608]
 811 0404 13F0440F 	 tst r3,#68
 812 0408 02D0     	 beq .L59
 504:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (1 == p_ctx->prl.prl_receive_length)))
 813              	 .loc 1 504 0
 814 040a 012A     	 cmp r2,#1
 815 040c 00F0DF80 	 beq .L56
 816              	.L59:
 513:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (PROTOCOL_VERSION_PRE_SHARED_SECRET != p_data[PRL_PROTOCOL_VERSION_OFFSET]))
 817              	 .loc 1 513 0
 818 0410 262A     	 cmp r2,#38
 819 0412 40F0A480 	 bne .L71
 820 0416 002B     	 cmp r3,#0
 821 0418 40F0A180 	 bne .L71
 822 041c 7378     	 ldrb r3,[r6,#1]
 823 041e 012B     	 cmp r3,#1
 824 0420 40F09D80 	 bne .L71
 520:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.save_slave_sequence_number = p_ctx->prl.slave_sequence_number;
 825              	 .loc 1 520 0
 826 0424 06F12205 	 add r5,r6,#34
 827 0428 2846     	 mov r0,r5
 828 042a FFF7FEFF 	 bl optiga_common_get_uint32
 829              	.LVL67:
 522:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 830              	 .loc 1 522 0
 831 042e 04F5FE78 	 add r8,r4,#508
 520:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.save_slave_sequence_number = p_ctx->prl.slave_sequence_number;
 832              	 .loc 1 520 0
 833 0432 C4F8B801 	 str r0,[r4,#440]
 521:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 memcpy(p_ctx->prl.random, &p_data[PRL_RANDOM_DATAOFFSET], PRL_RANDOM_DATA_LENGTH);
 834              	 .loc 1 521 0
 835 0436 C4F8BC01 	 str r0,[r4,#444]
 522:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 836              	 .loc 1 522 0
 837 043a B31C     	 adds r3,r6,#2
 838 043c 4246     	 mov r2,r8
 839              	.L63:
 840 043e 53F8041B 	 ldr r1,[r3],#4
 841 0442 42F8041B 	 str r1,[r2],#4
 842 0446 AB42     	 cmp r3,r5
 843 0448 F9D1     	 bne .L63
 844              	.LVL68:
 845              	.LBB32:
 846              	.LBB33:
 318:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     uint8_t secret_input[OPTIGA_SHARED_SECRET_MAX_LENGTH];
 847              	 .loc 1 318 0
 848 044a C14A     	 ldr r2,.L194
 849 044c 08AD     	 add r5,sp,#32
 850 044e 02F11003 	 add r3,r2,#16
 851 0452 A946     	 mov r9,r5
 852              	.L64:
 853 0454 1068     	 ldr r0,[r2]
 854 0456 5168     	 ldr r1,[r2,#4]
 855 0458 AE46     	 mov lr,r5
 856 045a AEE80300 	 stmia lr!,{r0,r1}
 857 045e 0832     	 adds r2,r2,#8
 858 0460 9A42     	 cmp r2,r3
 859 0462 7546     	 mov r5,lr
 860 0464 F6D1     	 bne .L64
 861 0466 1378     	 ldrb r3,[r2]
 862 0468 8EF80030 	 strb r3,[lr]
 324:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                               secret_input,
 863              	 .loc 1 324 0
 864 046c 6369     	 ldr r3,[r4,#20]
 865 046e 1AA9     	 add r1,sp,#104
 866 0470 5888     	 ldrh r0,[r3,#2]
 867 0472 0DF11A02 	 add r2,sp,#26
 868 0476 FFF7FEFF 	 bl pal_os_datastore_read
 869              	.LVL69:
 327:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 870              	 .loc 1 327 0
 871 047a 0546     	 mov r5,r0
 872 047c D8B9     	 cbnz r0,.L107
 332:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            shared_secret_length,
 873              	 .loc 1 332 0
 874 047e 1023     	 movs r3,#16
 875 0480 8DE80801 	 stmia sp,{r3,r8}
 876 0484 2023     	 movs r3,#32
 877 0486 0293     	 str r3,[sp,#8]
 338:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            sizeof(p_ctx->prl.session_key)))
 878              	 .loc 1 338 0
 879 0488 04F5EA73 	 add r3,r4,#468
 332:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                            shared_secret_length,
 880              	 .loc 1 332 0
 881 048c 0393     	 str r3,[sp,#12]
 882 048e 2823     	 movs r3,#40
 883 0490 BDF81A20 	 ldrh r2,[sp,#26]
 884 0494 0493     	 str r3,[sp,#16]
 885 0496 1AA9     	 add r1,sp,#104
 886 0498 4B46     	 mov r3,r9
 887 049a FFF7FEFF 	 bl pal_crypt_tls_prf_sha256
 888              	.LVL70:
 341:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 889              	 .loc 1 341 0
 890 049e 40F20713 	 movw r3,#263
 891 04a2 0028     	 cmp r0,#0
 892 04a4 18BF     	 it ne
 893 04a6 1D46     	 movne r5,r3
 894              	.LVL71:
 343:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 895              	 .loc 1 343 0
 896 04a8 0021     	 movs r1,#0
 897 04aa 1AA8     	 add r0,sp,#104
 898 04ac BDF81A20 	 ldrh r2,[sp,#26]
 899 04b0 FFF7FEFF 	 bl memset
 900              	.LVL72:
 901 04b4 01E0     	 b .L65
 902              	.LVL73:
 903              	.L107:
 329:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 904              	 .loc 1 329 0
 905 04b6 40F20715 	 movw r5,#263
 906              	.LVL74:
 907              	.L65:
 908              	.LBE33:
 909              	.LBE32:
 526:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 910              	 .loc 1 526 0
 911 04ba 40F20713 	 movw r3,#263
 912 04be 9D42     	 cmp r5,r3
 913 04c0 05D1     	 bne .L67
 914              	.LVL75:
 915              	.L73:
 528:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 916              	 .loc 1 528 0
 917 04c2 5523     	 movs r3,#85
 918 04c4 84F8B131 	 strb r3,[r4,#433]
 919 04c8 40F20715 	 movw r5,#263
 920 04cc 90E7     	 b .L74
 921              	.LVL76:
 922              	.L67:
 531:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 923              	 .loc 1 531 0
 924 04ce 3323     	 movs r3,#51
 925 04d0 46E0     	 b .L187
 926              	.LVL77:
 927              	.L51:
 538:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = FALSE;
 928              	 .loc 1 538 0
 929 04d2 0823     	 movs r3,#8
 541:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 optiga_common_set_uint32(&p_ctx->prl.prl_txrx_buffer[PRL_RANDOM_DATA_LENGTH + IFX_I
 930              	 .loc 1 541 0
 931 04d4 04F22128 	 addw r8,r4,#545
 932              	.LVL78:
 538:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = FALSE;
 933              	 .loc 1 538 0
 934 04d8 84F8D031 	 strb r3,[r4,#464]
 935              	.LVL79:
 541:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 optiga_common_set_uint32(&p_ctx->prl.prl_txrx_buffer[PRL_RANDOM_DATA_LENGTH + IFX_I
 936              	 .loc 1 541 0
 937 04dc 04F5FE75 	 add r5,r4,#508
 938 04e0 4346     	 mov r3,r8
 939 04e2 04F50772 	 add r2,r4,#540
 940              	.L68:
 941 04e6 55F8041B 	 ldr r1,[r5],#4
 942 04ea 43F8041B 	 str r1,[r3],#4
 943 04ee 9542     	 cmp r5,r2
 944 04f0 F9D1     	 bne .L68
 542:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                          p_ctx->prl.slave_sequence_number);
 945              	 .loc 1 542 0
 946 04f2 04F24120 	 addw r0,r4,#577
 947 04f6 D4F8B811 	 ldr r1,[r4,#440]
 948 04fa FFF7FEFF 	 bl optiga_common_set_uint32
 949              	.LVL80:
 546:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         &p_ctx->prl.prl_txrx_buffer[IFX_I2C_PRL_HEA
 950              	 .loc 1 546 0
 951 04fe 94F8D031 	 ldrb r3,[r4,#464]
 952 0502 0093     	 str r3,[sp]
 953 0504 2046     	 mov r0,r4
 954 0506 4146     	 mov r1,r8
 955 0508 2422     	 movs r2,#36
 956 050a D4F8B831 	 ldr r3,[r4,#440]
 957 050e FFF7FEFF 	 bl ifx_i2c_prl_encrypt_msg
 958              	.LVL81:
 551:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 959              	 .loc 1 551 0
 960 0512 B0F5817F 	 cmp r0,#258
 961 0516 3FF466AF 	 beq .L69
 559:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 optiga_common_set_uint32(&p_ctx->prl.prl_txrx_buffer[1], p_ctx->prl.slave_sequence_
 962              	 .loc 1 559 0
 963 051a 94F8D031 	 ldrb r3,[r4,#464]
 964 051e 84F81C32 	 strb r3,[r4,#540]
 560:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 965              	 .loc 1 560 0
 966 0522 04F21D20 	 addw r0,r4,#541
 967              	.LVL82:
 968 0526 D4F8B811 	 ldr r1,[r4,#440]
 969 052a FFF7FEFF 	 bl optiga_common_set_uint32
 970              	.LVL83:
 562:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_tl_transceive(p_ctx,
 971              	 .loc 1 562 0
 972 052e 3122     	 movs r2,#49
 563:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       p_ctx->prl.prl_txrx_buffer,
 973              	 .loc 1 563 0
 974 0530 04F51873 	 add r3,r4,#608
 975 0534 0093     	 str r3,[sp]
 976 0536 2946     	 mov r1,r5
 977 0538 2B46     	 mov r3,r5
 562:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_tl_transceive(p_ctx,
 978              	 .loc 1 562 0
 979 053a A4F86022 	 strh r2,[r4,#608]
 563:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                       p_ctx->prl.prl_txrx_buffer,
 980              	 .loc 1 563 0
 981 053e 2046     	 mov r0,r4
 982 0540 FFF7FEFF 	 bl ifx_i2c_tl_transceive
 983              	.LVL84:
 568:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 984              	 .loc 1 568 0
 985 0544 0546     	 mov r5,r0
 986 0546 50B9     	 cbnz r0,.L71
 574:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 987              	 .loc 1 574 0
 988 0548 4423     	 movs r3,#68
 989 054a 84F8B131 	 strb r3,[r4,#433]
 990 054e 48E0     	 b .L103
 991              	.LVL85:
 992              	.L55:
 579:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ((PRL_FINISHED_DATA_LENGTH + 1) != p_ctx->prl.prl_receive_length))
 993              	 .loc 1 579 0
 994 0550 3378     	 ldrb r3,[r6]
 995 0552 082B     	 cmp r3,#8
 996 0554 03D1     	 bne .L71
 997 0556 B4F86032 	 ldrh r3,[r4,#608]
 998 055a 312B     	 cmp r3,#49
 999 055c 03D0     	 beq .L72
 1000              	.LVL86:
 1001              	.L71:
 582:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = TRUE;
 1002              	 .loc 1 582 0
 1003 055e 5523     	 movs r3,#85
 1004              	.L187:
 1005 0560 84F8B131 	 strb r3,[r4,#433]
 1006              	.LVL87:
 1007 0564 44E7     	 b .L74
 1008              	.LVL88:
 1009              	.L72:
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_prl_decrypt_msg(p_ctx,
 1010              	 .loc 1 586 0
 1011 0566 701C     	 adds r0,r6,#1
 1012 0568 FFF7FEFF 	 bl optiga_common_get_uint32
 1013              	.LVL89:
 587:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         &p_data[IFX_I2C_PRL_HEADER_SIZE],
 1014              	 .loc 1 587 0
 1015 056c 1022     	 movs r2,#16
 1016 056e 94F8D011 	 ldrb r1,[r4,#464]
 1017 0572 0192     	 str r2,[sp,#4]
 591:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         PRL_MASTER_DECRYPTION_KEY_OFFSET,
 1018              	 .loc 1 591 0
 1019 0574 04F50779 	 add r9,r4,#540
 587:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         &p_data[IFX_I2C_PRL_HEADER_SIZE],
 1020              	 .loc 1 587 0
 1021 0578 2422     	 movs r2,#36
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 return_status = ifx_i2c_prl_decrypt_msg(p_ctx,
 1022              	 .loc 1 586 0
 1023 057a 0346     	 mov r3,r0
 1024 057c C4F8B401 	 str r0,[r4,#436]
 587:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         &p_data[IFX_I2C_PRL_HEADER_SIZE],
 1025              	 .loc 1 587 0
 1026 0580 0391     	 str r1,[sp,#12]
 1027 0582 CDF80090 	 str r9,[sp]
 1028 0586 0292     	 str r2,[sp,#8]
 1029 0588 2046     	 mov r0,r4
 1030 058a 711D     	 adds r1,r6,#5
 1031 058c FFF7FEFF 	 bl ifx_i2c_prl_decrypt_msg
 1032              	.LVL90:
 595:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 1033              	 .loc 1 595 0
 1034 0590 B0F5817F 	 cmp r0,#258
 587:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                         &p_data[IFX_I2C_PRL_HEADER_SIZE],
 1035              	 .loc 1 587 0
 1036 0594 0546     	 mov r5,r0
 1037              	.LVL91:
 595:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 1038              	 .loc 1 595 0
 1039 0596 3FF426AF 	 beq .L69
 601:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Validating decrpt data
 1040              	 .loc 1 601 0
 1041 059a 07A8     	 add r0,sp,#28
 1042              	.LVL92:
 1043 059c D4F8B411 	 ldr r1,[r4,#436]
 1044 05a0 FFF7FEFF 	 bl optiga_common_set_uint32
 1045              	.LVL93:
 603:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 1046              	 .loc 1 603 0
 1047 05a4 04F5FE70 	 add r0,r4,#508
 1048 05a8 4946     	 mov r1,r9
 1049 05aa 2022     	 movs r2,#32
 1050 05ac FFF7FEFF 	 bl memcmp
 1051              	.LVL94:
 1052 05b0 0028     	 cmp r0,#0
 1053 05b2 86D1     	 bne .L73
 611:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 1054              	 .loc 1 611 0
 1055 05b4 07A8     	 add r0,sp,#28
 1056 05b6 04F50F71 	 add r1,r4,#572
 1057 05ba 0422     	 movs r2,#4
 1058 05bc FFF7FEFF 	 bl memcmp
 1059              	.LVL95:
 1060 05c0 0028     	 cmp r0,#0
 1061 05c2 7FF47EAF 	 bne .L73
 618:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 1062              	 .loc 1 618 0
 1063 05c6 0123     	 movs r3,#1
 1064 05c8 84F8B231 	 strb r3,[r4,#434]
 1065 05cc 05E0     	 b .L50
 1066              	.LVL96:
 1067              	.L56:
 624:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = FALSE;
 1068              	 .loc 1 624 0
 1069 05ce FF23     	 movs r3,#255
 1070 05d0 84F8D231 	 strb r3,[r4,#466]
 1071              	.LVL97:
 623:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 1072              	 .loc 1 623 0
 1073 05d4 40F20715 	 movw r5,#263
 1074 05d8 03E0     	 b .L103
 1075              	.LVL98:
 1076              	.L50:
 632:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1077              	 .loc 1 632 0
 1078 05da B8F1000F 	 cmp r8,#0
 1079 05de 7FF407AF 	 bne .L74
 1080              	.LVL99:
 1081              	.L103:
 1082              	.LBE31:
 1083              	.LBE30:
 894:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 1084              	 .loc 1 894 0
 1085 05e2 40F20713 	 movw r3,#263
 1086 05e6 9D42     	 cmp r5,r3
 1087 05e8 7FF499AE 	 bne .L75
 896:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state = PRL_STATE_ERROR;
 1088              	 .loc 1 896 0
 1089 05ec A4F86452 	 strh r5,[r4,#612]
 1090 05f0 2CE5     	 b .L10
 1091              	.L18:
 902:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 903:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state = PRL_STATE_TXRX;
 904:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 905:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else
 906:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 907:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = FALSE;
 908:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 909:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
 910:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 911:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_STATE_TXRX:
 912:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
 913:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 //lint --e{835} suppress "Message bits in SCTR is set to 0 for record transaction"
 914:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 FORM_SCTR_HEADER(p_ctx,
 1092              	 .loc 1 914 0
 1093 05f2 94F83030 	 ldrb r3,[r4,#48]
 1094 05f6 03F00303 	 and r3,r3,#3
 1095 05fa 43F02002 	 orr r2,r3,#32
 915:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  PRL_RECORD_EXCHANGE_PROTOCOL,
 916:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  0,
 917:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  (p_ctx->protection_level & PRL_PROTECTION_MASK));
 918:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Preparing receive length based on the protection level
 919:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if ((SLAVE_PROTECTION == (p_ctx->protection_level & PRL_PROTECTION_MASK)) ||
 1096              	 .loc 1 919 0
 1097 05fe 023B     	 subs r3,r3,#2
 1098 0600 012B     	 cmp r3,#1
 914:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                  PRL_RECORD_EXCHANGE_PROTOCOL,
 1099              	 .loc 1 914 0
 1100 0602 84F8D021 	 strb r2,[r4,#464]
 1101              	 .loc 1 919 0
 1102 0606 16D8     	 bhi .L76
 920:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (FULL_PROTECTION == (p_ctx->protection_level & PRL_PROTECTION_MASK)))
 921:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 922:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if ((PRL_SEQUENCE_THRESHOLD < (p_ctx->prl.save_slave_sequence_number + 1)) &&
 1103              	 .loc 1 922 0
 1104 0608 D4F8BC31 	 ldr r3,[r4,#444]
 1105 060c 0133     	 adds r3,r3,#1
 1106 060e 1033     	 adds r3,r3,#16
 1107 0610 0CD9     	 bls .L77
 1108              	 .loc 1 922 0 is_stmt 0 discriminator 1
 1109 0612 94F8A032 	 ldrb r3,[r4,#672]
 1110 0616 4BB9     	 cbnz r3,.L77
 1111              	.L80:
 923:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         (FALSE == p_ctx->prl.trans_repeat_status))
 924:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 925:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         DO_NEGOTIATION(p_ctx,exit_machine);
 1112              	 .loc 1 925 0 is_stmt 1
 1113 0618 0023     	 movs r3,#0
 1114 061a 84F8B231 	 strb r3,[r4,#434]
 1115 061e 0523     	 movs r3,#5
 1116 0620 84F8B031 	 strb r3,[r4,#432]
 1117 0624 1123     	 movs r3,#17
 1118 0626 84F8B131 	 strb r3,[r4,#433]
 926:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 1119              	 .loc 1 926 0
 1120 062a 12E5     	 b .L12
 1121              	.L77:
 927:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 928:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     *p_ctx->prl.p_recv_payload_buffer_length += (IFX_I2C_PRL_MAC_SIZE + IFX_I2C_PRL
 1122              	 .loc 1 928 0
 1123 062c D4F8CC21 	 ldr r2,[r4,#460]
 1124 0630 1388     	 ldrh r3,[r2]
 1125 0632 0D33     	 adds r3,r3,#13
 1126 0634 1380     	 strh r3,[r2]
 1127              	.L76:
 929:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 930:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.saved_sctr = p_ctx->prl.sctr;
 931:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 932:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if ((MASTER_PROTECTION == (p_ctx->protection_level & PRL_PROTECTION_MASK)) ||
 1128              	 .loc 1 932 0
 1129 0636 94F83030 	 ldrb r3,[r4,#48]
 930:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1130              	 .loc 1 930 0
 1131 063a 94F8D001 	 ldrb r0,[r4,#464]
 1132 063e 84F8D101 	 strb r0,[r4,#465]
 1133              	 .loc 1 932 0
 1134 0642 DB07     	 lsls r3,r3,#31
 1135 0644 53D5     	 bpl .L78
 933:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     (FULL_PROTECTION == (p_ctx->protection_level & PRL_PROTECTION_MASK)))
 934:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 935:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if ((PRL_SEQUENCE_THRESHOLD < (p_ctx->prl.master_sequence_number + 1)) &&
 1136              	 .loc 1 935 0
 1137 0646 D4F8B431 	 ldr r3,[r4,#436]
 1138 064a 5A1C     	 adds r2,r3,#1
 1139 064c 1032     	 adds r2,r2,#16
 1140 064e 03D9     	 bls .L79
 1141              	 .loc 1 935 0 is_stmt 0 discriminator 1
 1142 0650 94F8A022 	 ldrb r2,[r4,#672]
 1143 0654 002A     	 cmp r2,#0
 1144 0656 DFD0     	 beq .L80
 1145              	.L79:
 936:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         (FALSE == p_ctx->prl.trans_repeat_status))
 937:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 938:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         DO_NEGOTIATION(p_ctx,exit_machine);
 939:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 940:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 941:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ///Decrypt messag to use for retansmit
 942:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (PRL_INTEGRITY_VIOLATED_ALERT_MSG == p_ctx->prl.alert_type)
 1146              	 .loc 1 942 0 is_stmt 1
 1147 0658 94F8D221 	 ldrb r2,[r4,#466]
 1148 065c 042A     	 cmp r2,#4
 1149 065e 16D1     	 bne .L81
 943:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 944:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         return_status = ifx_i2c_prl_decrypt_msg(p_ctx,
 1150              	 .loc 1 944 0
 1151 0660 D4F8C011 	 ldr r1,[r4,#448]
 1152 0664 0390     	 str r0,[sp,#12]
 1153 0666 0025     	 movs r5,#0
 1154 0668 0531     	 adds r1,r1,#5
 1155 066a 0195     	 str r5,[sp,#4]
 1156 066c 2025     	 movs r5,#32
 1157 066e B4F8C421 	 ldrh r2,[r4,#452]
 1158 0672 0091     	 str r1,[sp]
 1159 0674 0295     	 str r5,[sp,#8]
 1160 0676 2046     	 mov r0,r4
 1161 0678 FFF7FEFF 	 bl ifx_i2c_prl_decrypt_msg
 1162              	.LVL100:
 945:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 &p_ctx->prl.p_actual_payload[IFX_I2
 946:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_ctx->prl.actual_payload_length,
 947:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_ctx->prl.master_sequence_number,
 948:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 &p_ctx->prl.p_actual_payload[IFX_I2
 949:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 PRL_MASTER_ENCRYPTION_KEY_OFFSET,
 950:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 PRL_MASTER_ENCRYPTION_NONCE_OFFSET,
 951:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                 p_ctx->prl.saved_sctr);
 952:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         if (IFX_I2C_STACK_ERROR == return_status)
 1163              	 .loc 1 952 0
 1164 067c B0F5817F 	 cmp r0,#258
 1165 0680 3FF42BAE 	 beq .L82
 953:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         {
 954:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                             ERROR_STATE_PREPARATION(p_ctx,exit_machine);
 955:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                             break;
 956:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         }
 957:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         *p_ctx->prl.p_recv_payload_buffer_length = p_ctx->prl.prl_receive_length;
 1166              	 .loc 1 957 0
 1167 0684 D4F8CC31 	 ldr r3,[r4,#460]
 1168 0688 B4F86022 	 ldrh r2,[r4,#608]
 1169 068c 1A80     	 strh r2,[r3]
 1170              	.LVL101:
 1171              	.L81:
 958:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 959:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 960:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.master_sequence_number += 1;
 1172              	 .loc 1 960 0
 1173 068e D4F8B411 	 ldr r1,[r4,#436]
 961:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.prl_header_offset = IFX_I2C_PRL_HEADER_SIZE;
 962:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     optiga_common_set_uint32(&p_ctx->prl.p_actual_payload[1], p_ctx->prl.master_seq
 1174              	 .loc 1 962 0
 1175 0692 D4F8C001 	 ldr r0,[r4,#448]
 960:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.prl_header_offset = IFX_I2C_PRL_HEADER_SIZE;
 1176              	 .loc 1 960 0
 1177 0696 0131     	 adds r1,r1,#1
 961:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.prl_header_offset = IFX_I2C_PRL_HEADER_SIZE;
 1178              	 .loc 1 961 0
 1179 0698 0523     	 movs r3,#5
 960:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.prl_header_offset = IFX_I2C_PRL_HEADER_SIZE;
 1180              	 .loc 1 960 0
 1181 069a C4F8B411 	 str r1,[r4,#436]
 961:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.prl_header_offset = IFX_I2C_PRL_HEADER_SIZE;
 1182              	 .loc 1 961 0
 1183 069e 84F8D331 	 strb r3,[r4,#467]
 1184              	 .loc 1 962 0
 1185 06a2 0130     	 adds r0,r0,#1
 1186 06a4 FFF7FEFF 	 bl optiga_common_set_uint32
 1187              	.LVL102:
 963:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     //Preparing encription data
 964:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = ifx_i2c_prl_encrypt_msg(p_ctx,
 1188              	 .loc 1 964 0
 1189 06a8 D4F8C011 	 ldr r1,[r4,#448]
 1190 06ac 94F8D131 	 ldrb r3,[r4,#465]
 1191 06b0 0093     	 str r3,[sp]
 1192 06b2 B4F8C421 	 ldrh r2,[r4,#452]
 1193 06b6 D4F8B431 	 ldr r3,[r4,#436]
 1194 06ba 2046     	 mov r0,r4
 1195 06bc 0531     	 adds r1,r1,#5
 1196 06be FFF7FEFF 	 bl ifx_i2c_prl_encrypt_msg
 1197              	.LVL103:
 965:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             &p_ctx->prl.p_actual_payload[IFX_I2C_PR
 966:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             p_ctx->prl.actual_payload_length,
 967:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             p_ctx->prl.master_sequence_number,
 968:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             p_ctx->prl.saved_sctr);
 969:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (IFX_I2C_STACK_ERROR == return_status)
 1198              	 .loc 1 969 0
 1199 06c2 B0F5817F 	 cmp r0,#258
 1200 06c6 3FF408AE 	 beq .L82
 970:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
 971:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         ERROR_STATE_PREPARATION(p_ctx,exit_machine);
 972:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 973:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
 974:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.p_actual_payload[PRL_SCTR_OFFSET] = p_ctx->prl.sctr;
 1201              	 .loc 1 974 0
 1202 06ca D4F8C031 	 ldr r3,[r4,#448]
 1203 06ce 94F8D021 	 ldrb r2,[r4,#464]
 1204 06d2 1A70     	 strb r2,[r3]
 1205 06d4 B4F8C421 	 ldrh r2,[r4,#452]
 975:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = ifx_i2c_tl_transceive(p_ctx,
 1206              	 .loc 1 975 0
 1207 06d8 94F8D331 	 ldrb r3,[r4,#467]
 1208 06dc D4F8C011 	 ldr r1,[r4,#448]
 1209 06e0 0832     	 adds r2,r2,#8
 1210 06e2 1A44     	 add r2,r2,r3
 1211 06e4 D4F8CC31 	 ldr r3,[r4,#460]
 1212 06e8 0093     	 str r3,[sp]
 1213 06ea 2046     	 mov r0,r4
 1214              	.LVL104:
 1215 06ec 11E0     	 b .L188
 1216              	.L78:
 976:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.p_actual_payload,
 977:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.actual_payload_length + 
 978:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.prl_header_offset + IFX_I2C_PR
 979:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.p_recv_payload_buffer,
 980:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.p_recv_payload_buffer_length);
 981:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 982:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else
 983:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 984:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ///Sending plan data
 985:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.prl_header_offset = 1;
 1217              	 .loc 1 985 0
 1218 06ee 0123     	 movs r3,#1
 1219 06f0 84F8D331 	 strb r3,[r4,#467]
 986:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.p_actual_payload[4] = p_ctx->prl.sctr;
 1220              	 .loc 1 986 0
 1221 06f4 D4F8C031 	 ldr r3,[r4,#448]
 1222 06f8 1871     	 strb r0,[r3,#4]
 987:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = ifx_i2c_tl_transceive(p_ctx,
 1223              	 .loc 1 987 0
 1224 06fa B4F8C431 	 ldrh r3,[r4,#452]
 1225 06fe 94F8D321 	 ldrb r2,[r4,#467]
 1226 0702 D4F8C011 	 ldr r1,[r4,#448]
 1227 0706 1A44     	 add r2,r2,r3
 1228 0708 D4F8CC31 	 ldr r3,[r4,#460]
 1229 070c 0093     	 str r3,[sp]
 1230 070e 2046     	 mov r0,r4
 1231 0710 0431     	 adds r1,r1,#4
 1232              	.LVL105:
 1233              	.L188:
 1234 0712 92B2     	 uxth r2,r2
 1235 0714 D4F8C831 	 ldr r3,[r4,#456]
 1236 0718 FFF7FEFF 	 bl ifx_i2c_tl_transceive
 1237              	.LVL106:
 988:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           &p_ctx->prl.p_actual_payload[4],
 989:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.actual_payload_length + 
 990:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.prl_header_offset,
 991:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.p_recv_payload_buffer,
 992:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                           p_ctx->prl.p_recv_payload_buffer_length);
 993:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
 994:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (IFX_I2C_STACK_ERROR == return_status)
 1238              	 .loc 1 994 0
 1239 071c B0F5817F 	 cmp r0,#258
 1240 0720 0DD1     	 bne .L84
 995:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
 996:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ERROR_STATE_PREPARATION(p_ctx,  exit_machine);
 1241              	 .loc 1 996 0
 1242 0722 FF23     	 movs r3,#255
 1243 0724 84F8D231 	 strb r3,[r4,#466]
 1244 0728 0723     	 movs r3,#7
 1245 072a 84F8B031 	 strb r3,[r4,#432]
 1246 072e 0023     	 movs r3,#0
 1247 0730 84F8B231 	 strb r3,[r4,#434]
 1248 0734 84F8A032 	 strb r3,[r4,#672]
 997:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.return_status = IFX_I2C_STACK_ERROR;
 1249              	 .loc 1 997 0
 1250 0738 A4F86402 	 strh r0,[r4,#612]
 998:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
 1251              	 .loc 1 998 0
 1252 073c 89E4     	 b .L12
 1253              	.L84:
 999:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1000:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.prl_receive_length = *p_ctx->prl.p_recv_payload_buffer_length;
 1254              	 .loc 1 1000 0
 1255 073e D4F8CC31 	 ldr r3,[r4,#460]
 1256 0742 1B88     	 ldrh r3,[r3]
 1257 0744 A4F86032 	 strh r3,[r4,#608]
1001:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_VERIFY;
 1258              	 .loc 1 1001 0
 1259 0748 0323     	 movs r3,#3
 1260 074a 84F8B031 	 strb r3,[r4,#432]
 1261              	.LVL107:
1002:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = FALSE;
1003:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
1004:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 1262              	 .loc 1 1004 0
 1263 074e 07E1     	 b .L7
 1264              	.L195:
 1265              	 .align 2
 1266              	.L194:
 1267 0750 00000000 	 .word .LC0
 1268              	.LVL108:
 1269              	.L17:
1005:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_STATE_VERIFY:
1006:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
1007:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.slave_sequence_number = optiga_common_get_uint32(&p_ctx->prl.p_recv_payl
 1270              	 .loc 1 1007 0
 1271 0754 D4F8C801 	 ldr r0,[r4,#456]
 1272 0758 0130     	 adds r0,r0,#1
 1273 075a FFF7FEFF 	 bl optiga_common_get_uint32
 1274              	.LVL109:
 1275 075e 0346     	 mov r3,r0
 1276 0760 C4F8B801 	 str r0,[r4,#440]
1008:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (0 == data_len)
 1277              	 .loc 1 1008 0
 1278 0764 002F     	 cmp r7,#0
 1279 0766 3FF4B8AD 	 beq .L82
1009:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1010:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ERROR_STATE_PREPARATION(p_ctx,exit_machine);
1011:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
1012:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1013:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else if (0 != (p_data[PRL_SCTR_OFFSET] & PRL_ALERT_PROTOCOL))
 1280              	 .loc 1 1013 0
 1281 076a 3178     	 ldrb r1,[r6]
 1282 076c 01F04002 	 and r2,r1,#64
 1283 0770 02F0FF05 	 and r5,r2,#255
 1284 0774 62B3     	 cbz r2,.L85
1014:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1015:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     //Check invalid message
1016:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     //lint --e{835} suppress "Macros are defined as 0x00 and is kept for future enh
1017:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (((p_data[PRL_SCTR_OFFSET] != (PRL_ALERT_PROTOCOL | PRL_FATAL_ALERT_MSG)) &&
 1285              	 .loc 1 1017 0
 1286 0776 01F0FB01 	 and r1,r1,#251
 1287 077a 4029     	 cmp r1,#64
 1288 077c 09D1     	 bne .L86
1018:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         (p_data[PRL_SCTR_OFFSET] != (PRL_ALERT_PROTOCOL | PRL_INTEGRITY_VIOLATED_AL
 1289              	 .loc 1 1018 0
 1290 077e 012F     	 cmp r7,#1
 1291 0780 03D0     	 beq .L87
1019:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         ((1 != data_len) && (PRL_NEGOTIATION_DONE == p_ctx->prl.negotiation_state))
 1292              	 .loc 1 1019 0
 1293 0782 94F8B231 	 ldrb r3,[r4,#434]
 1294 0786 012B     	 cmp r3,#1
 1295 0788 03D0     	 beq .L86
 1296              	.L87:
 1297              	 .loc 1 1019 0 is_stmt 0 discriminator 1
 1298 078a 94F86332 	 ldrb r3,[r4,#611]
 1299 078e 032B     	 cmp r3,#3
 1300 0790 07D1     	 bne .L88
 1301              	.L86:
1020:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         (PRL_TRANS_REPEAT == p_ctx->prl.data_retransmit_counter))
1021:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1022:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.return_status = IFX_I2C_SESSION_ERROR;
 1302              	 .loc 1 1022 0 is_stmt 1
 1303 0792 4FF48473 	 mov r3,#264
 1304 0796 A4F86432 	 strh r3,[r4,#612]
1023:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 1305              	 .loc 1 1023 0
 1306 079a 0023     	 movs r3,#0
 1307 079c 84F8B231 	 strb r3,[r4,#434]
 1308 07a0 11E0     	 b .L89
 1309              	.L88:
1024:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1025:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     //After restore operation if invalid message received
1026:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     else if ((PRL_RESTORE_DONE == p_ctx->prl.restore_context_flag) &&
 1310              	 .loc 1 1026 0
 1311 07a2 94F86632 	 ldrb r3,[r4,#614]
 1312 07a6 012B     	 cmp r3,#1
 1313 07a8 09D1     	 bne .L90
 1314              	 .loc 1 1026 0 is_stmt 0 discriminator 1
 1315 07aa 94F83230 	 ldrb r3,[r4,#50]
 1316 07ae 112B     	 cmp r3,#17
 1317 07b0 05D1     	 bne .L90
1027:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                              (IFX_I2C_SESSION_CONTEXT_RESTORE == p_ctx->manage_context_operation))
1028:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1029:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 1318              	 .loc 1 1029 0 is_stmt 1
 1319 07b2 0023     	 movs r3,#0
 1320 07b4 84F8B231 	 strb r3,[r4,#434]
1030:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.return_status = IFX_I2C_SESSION_ERROR;
 1321              	 .loc 1 1030 0
 1322 07b8 4FF48473 	 mov r3,#264
 1323 07bc 01E0     	 b .L189
 1324              	.L90:
1031:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1032:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     else
1033:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1034:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.return_status = IFX_I2C_STACK_ERROR;
 1325              	 .loc 1 1034 0
 1326 07be 4FF48173 	 mov r3,#258
 1327              	.L189:
 1328 07c2 A4F86432 	 strh r3,[r4,#612]
 1329              	.L89:
1035:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1036:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state = PRL_STATE_ALERT;
 1330              	 .loc 1 1036 0
 1331 07c6 0623     	 movs r3,#6
 1332 07c8 84F8B031 	 strb r3,[r4,#432]
1037:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 1333              	 .loc 1 1037 0
 1334 07cc FF23     	 movs r3,#255
 1335 07ce 32E0     	 b .L185
 1336              	.L85:
1038:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1039:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///Sctr value mismatch
1040:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else if (p_data[PRL_SCTR_OFFSET] != p_ctx->prl.saved_sctr)
 1337              	 .loc 1 1040 0
 1338 07d0 94F8D121 	 ldrb r2,[r4,#465]
 1339 07d4 8A42     	 cmp r2,r1
 1340 07d6 7FF480AD 	 bne .L82
1041:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1042:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     ERROR_STATE_PREPARATION(p_ctx, exit_machine);
1043:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     break;
1044:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1045:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 ///For slave encrypted message
1046:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else if (((uint8_t)SLAVE_PROTECTION == (p_data[PRL_SCTR_OFFSET] & PRL_PROTECTION_MA
 1341              	 .loc 1 1046 0
 1342 07da 02F00302 	 and r2,r2,#3
 1343 07de 023A     	 subs r2,r2,#2
 1344 07e0 012A     	 cmp r2,#1
 1345 07e2 2BD8     	 bhi .L91
1047:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                          ((uint8_t)FULL_PROTECTION == (p_data[PRL_SCTR_OFFSET] & PRL_PROTECTION_MAS
1048:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1049:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (data_len <= (IFX_I2C_PRL_HEADER_SIZE + IFX_I2C_PRL_MAC_SIZE))
 1346              	 .loc 1 1049 0
 1347 07e4 0D2F     	 cmp r7,#13
 1348 07e6 7FF678AD 	 bls .L82
1050:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1051:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         ERROR_STATE_PREPARATION(p_ctx, exit_machine);
1052:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
1053:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1054:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     //Check invalid sequence number
1055:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     else if ((p_ctx->prl.slave_sequence_number > (p_ctx->prl.save_slave_sequence_nu
 1349              	 .loc 1 1055 0
 1350 07ea D4F8BC21 	 ldr r2,[r4,#444]
 1351 07ee D11C     	 adds r1,r2,#3
 1352 07f0 8842     	 cmp r0,r1
 1353 07f2 3FF672AD 	 bhi .L82
1056:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                              || (p_ctx->prl.slave_sequence_number <= p_ctx->prl.save_slave_sequence
 1354              	 .loc 1 1056 0
 1355 07f6 9042     	 cmp r0,r2
 1356 07f8 7FF66FAD 	 bls .L82
1057:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1058:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         ERROR_STATE_PREPARATION(p_ctx,exit_machine);
1059:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
1060:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1061:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
1062:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.save_slave_sequence_number = p_ctx->prl.slave_sequence_number;
1063:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     *p_ctx->prl.p_recv_payload_buffer_length = *p_ctx->prl.p_recv_payload_buffer_le
 1357              	 .loc 1 1063 0
 1358 07fc D4F8CC11 	 ldr r1,[r4,#460]
1062:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     *p_ctx->prl.p_recv_payload_buffer_length = *p_ctx->prl.p_recv_payload_buffer_le
 1359              	 .loc 1 1062 0
 1360 0800 C4F8BC01 	 str r0,[r4,#444]
 1361              	 .loc 1 1063 0
 1362 0804 0A88     	 ldrh r2,[r1]
 1363 0806 0D3A     	 subs r2,r2,#13
 1364 0808 92B2     	 uxth r2,r2
 1365 080a 0A80     	 strh r2,[r1]
1064:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                                (IFX_I2C_PRL_MAC_SIZE + IFX_I2C_PRL_
1065:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = ifx_i2c_prl_decrypt_msg(p_ctx,
 1366              	 .loc 1 1065 0
 1367 080c 1020     	 movs r0,#16
 1368 080e D4F8C811 	 ldr r1,[r4,#456]
 1369 0812 0190     	 str r0,[sp,#4]
 1370 0814 2420     	 movs r0,#36
 1371 0816 0531     	 adds r1,r1,#5
 1372 0818 0290     	 str r0,[sp,#8]
 1373 081a 94F8D101 	 ldrb r0,[r4,#465]
 1374 081e 0390     	 str r0,[sp,#12]
 1375 0820 0091     	 str r1,[sp]
 1376 0822 2046     	 mov r0,r4
 1377 0824 FFF7FEFF 	 bl ifx_i2c_prl_decrypt_msg
 1378              	.LVL110:
1066:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             &p_ctx->prl.p_recv_payload_buffer[IFX_I
1067:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             (*p_ctx->prl.p_recv_payload_buffer_leng
1068:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             p_ctx->prl.slave_sequence_number,
1069:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             &p_ctx->prl.p_recv_payload_buffer[IFX_I
1070:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             PRL_MASTER_DECRYPTION_KEY_OFFSET,
1071:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             PRL_MASTER_DECRYPTION_NONCE_OFFSET,
1072:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                             p_ctx->prl.saved_sctr);
1073:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (IFX_I2C_STACK_ERROR == return_status)
 1379              	 .loc 1 1073 0
 1380 0828 B0F5817F 	 cmp r0,#258
 1381 082c 24D1     	 bne .L191
1074:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1075:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.state = PRL_STATE_ALERT;
 1382              	 .loc 1 1075 0
 1383 082e 0623     	 movs r3,#6
 1384 0830 84F8B031 	 strb r3,[r4,#432]
1076:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.alert_type = PRL_INTEGRITY_VIOLATED_ALERT_MSG;
 1385              	 .loc 1 1076 0
 1386 0834 0423     	 movs r3,#4
 1387              	.LVL111:
 1388              	.L185:
 1389 0836 84F8D231 	 strb r3,[r4,#466]
1077:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
 1390              	 .loc 1 1077 0
 1391 083a 0AE4     	 b .L12
 1392              	.L91:
1078:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1079:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     else
1080:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1081:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
1082:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.state = PRL_STATE_IDLE;
1083:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1084:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1085:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else if (data_len <= 1)
 1393              	 .loc 1 1085 0
 1394 083c 012F     	 cmp r7,#1
 1395 083e 16D8     	 bhi .L95
1086:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1087:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state = PRL_STATE_ERROR;
 1396              	 .loc 1 1087 0
 1397 0840 0723     	 movs r3,#7
 1398 0842 84F8B031 	 strb r3,[r4,#432]
1088:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 1399              	 .loc 1 1088 0
 1400 0846 FF23     	 movs r3,#255
 1401 0848 84F8D231 	 strb r3,[r4,#466]
1089:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (PRL_NEGOTIATION_NOT_DONE == p_ctx->prl.negotiation_state)
 1402              	 .loc 1 1089 0
 1403 084c 94F8B231 	 ldrb r3,[r4,#434]
 1404 0850 2BB9     	 cbnz r3,.L96
1090:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1091:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.return_status = IFX_I2C_STACK_ERROR;
 1405              	 .loc 1 1091 0
 1406 0852 4FF48173 	 mov r3,#258
 1407              	.L184:
 1408 0856 A4F86432 	 strh r3,[r4,#612]
 1409 085a FFF7FABB 	 b .L12
 1410              	.L96:
1092:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1093:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     else
1094:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1095:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.return_status = IFX_I2C_SESSION_ERROR;
 1411              	 .loc 1 1095 0
 1412 085e 4FF48473 	 mov r3,#264
 1413 0862 A4F86432 	 strh r3,[r4,#612]
1096:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 1414              	 .loc 1 1096 0
 1415 0866 84F8B251 	 strb r5,[r4,#434]
 1416 086a FFF7F2BB 	 b .L12
 1417              	.L95:
1097:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1098:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1099:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else
1100:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1101:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     *p_ctx->prl.p_recv_payload_buffer_length -= 1;
 1418              	 .loc 1 1101 0
 1419 086e D4F8CC21 	 ldr r2,[r4,#460]
 1420 0872 1388     	 ldrh r3,[r2]
 1421 0874 013B     	 subs r3,r3,#1
 1422 0876 1380     	 strh r3,[r2]
 1423              	.L191:
1102:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
 1424              	 .loc 1 1102 0
 1425 0878 A4F86452 	 strh r5,[r4,#612]
1103:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state = PRL_STATE_IDLE;
 1426              	 .loc 1 1103 0
 1427 087c 0123     	 movs r3,#1
 1428 087e FFF7E6BB 	 b .L183
 1429              	.L20:
1104:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1105:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
1106:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
1107:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_STATE_ALERT:
1108:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
1109:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if ((PRL_INTEGRITY_VIOLATED_ALERT_MSG | PRL_ALERT_PROTOCOL) == p_data[PRL_SCTR_OFFS
 1430              	 .loc 1 1109 0
 1431 0882 3378     	 ldrb r3,[r6]
 1432 0884 442B     	 cmp r3,#68
 1433 0886 18D1     	 bne .L97
1110:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1111:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if ((1 !=  data_len) || (p_ctx->prl.data_retransmit_counter >= PRL_TRANS_REPEAT
 1434              	 .loc 1 1111 0
 1435 0888 012F     	 cmp r7,#1
 1436 088a 7FF426AD 	 bne .L82
 1437              	 .loc 1 1111 0 is_stmt 0 discriminator 1
 1438 088e 94F86332 	 ldrb r3,[r4,#611]
 1439 0892 022B     	 cmp r3,#2
 1440 0894 3FF621AD 	 bhi .L82
1112:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1113:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         ERROR_STATE_PREPARATION(p_ctx,exit_machine);
1114:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         break;
1115:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1116:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     else if ((MASTER_PROTECTION == p_ctx->protection_level) ||
 1441              	 .loc 1 1116 0 is_stmt 1
 1442 0898 94F83020 	 ldrb r2,[r4,#48]
 1443 089c 02F0FD02 	 and r2,r2,#253
 1444 08a0 012A     	 cmp r2,#1
 1445 08a2 7FF4D3AB 	 bne .L10
1117:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                              (FULL_PROTECTION == p_ctx->protection_level))
1118:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1119:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.data_retransmit_counter++;
 1446              	 .loc 1 1119 0
 1447 08a6 0133     	 adds r3,r3,#1
 1448 08a8 84F86332 	 strb r3,[r4,#611]
1120:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.trans_repeat_status = TRUE;
1121:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         if (p_ctx->prl.data_retransmit_counter > PRL_TRANS_REPEAT)
1122:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         {
1123:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                             ERROR_STATE_PREPARATION(p_ctx, exit_machine);
1124:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                             p_ctx->prl.state = PRL_STATE_IDLE;
1125:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                             break;
1126:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         }
1127:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.alert_type = PRL_INTEGRITY_VIOLATED_ALERT_MSG;
 1449              	 .loc 1 1127 0
 1450 08ac 0423     	 movs r3,#4
1120:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.trans_repeat_status = TRUE;
 1451              	 .loc 1 1120 0
 1452 08ae 84F8A072 	 strb r7,[r4,#672]
 1453              	 .loc 1 1127 0
 1454 08b2 84F8D231 	 strb r3,[r4,#466]
 1455 08b6 FFF7CABB 	 b .L183
 1456              	.L97:
1128:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                         p_ctx->prl.state = PRL_STATE_TXRX;
1129:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1130:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     else
1131:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1132:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                       p_ctx->prl.state = PRL_STATE_ERROR;
1133:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1134:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1135:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else
1136:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1137:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     if (PRL_TRANS_REPEAT == p_ctx->prl.decryption_failure_counter)
 1457              	 .loc 1 1137 0
 1458 08ba 94F86232 	 ldrb r3,[r4,#610]
 1459 08be 032B     	 cmp r3,#3
 1460 08c0 7FF4C4AB 	 bne .L10
1138:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     {
1139:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                       ERROR_STATE_PREPARATION(p_ctx, exit_machine);
 1461              	 .loc 1 1139 0
 1462 08c4 FF23     	 movs r3,#255
 1463 08c6 84F8D231 	 strb r3,[r4,#466]
 1464 08ca 4FF48472 	 mov r2,#264
 1465 08ce 0023     	 movs r3,#0
 1466 08d0 84F8B231 	 strb r3,[r4,#434]
 1467 08d4 A4F86422 	 strh r2,[r4,#612]
 1468 08d8 84F8A032 	 strb r3,[r4,#672]
 1469 08dc FFF7B6BB 	 b .L10
 1470              	.L21:
1140:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     }
1141:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state = PRL_STATE_ERROR;
1142:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1143:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
1144:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
1145:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             case PRL_STATE_ERROR:
1146:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
1147:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 if (PRL_INVALID_ALERT != p_ctx->prl.alert_type)
 1471              	 .loc 1 1147 0
 1472 08e0 94F8D231 	 ldrb r3,[r4,#466]
 1473 08e4 0122     	 movs r2,#1
 1474 08e6 FF2B     	 cmp r3,#255
 1475              	.LBB34:
 1476              	.LBB35:
 437:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (PRL_INTEGRITY_VIOLATED_ALERT_MSG == p_ctx->prl.alert_type)
 1477              	 .loc 1 437 0
 1478 08e8 84F8B021 	 strb r2,[r4,#432]
 1479              	.LBE35:
 1480              	.LBE34:
 1481              	 .loc 1 1147 0
 1482 08ec 3FF4B1AB 	 beq .L12
 1483              	.LVL112:
 1484              	.LBB37:
 1485              	.LBB36:
 438:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1486              	 .loc 1 438 0
 1487 08f0 042B     	 cmp r3,#4
 1488 08f2 1FD1     	 bne .L100
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.state = PRL_STATE_VERIFY;
 1489              	 .loc 1 440 0
 1490 08f4 94F86232 	 ldrb r3,[r4,#610]
 1491 08f8 1344     	 add r3,r3,r2
 1492 08fa 84F86232 	 strb r3,[r4,#610]
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
 1493              	 .loc 1 441 0
 1494 08fe 0323     	 movs r3,#3
 1495 0900 84F8B031 	 strb r3,[r4,#432]
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             //lint --e{835} suppress "Protection bits in SCTR is set to 0 for alert message"
 1496              	 .loc 1 442 0
 1497 0904 0023     	 movs r3,#0
 1498 0906 A4F86432 	 strh r3,[r4,#612]
 444:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.prl_txrx_buffer[0] = p_ctx->prl.sctr;
 1499              	 .loc 1 444 0
 1500 090a 4423     	 movs r3,#68
 1501 090c 84F8D031 	 strb r3,[r4,#464]
 445:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = ifx_i2c_tl_transceive(p_ctx,
 1502              	 .loc 1 445 0
 1503 0910 84F81C32 	 strb r3,[r4,#540]
 446:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                                   p_ctx->prl.prl_txrx_buffer,
 1504              	 .loc 1 446 0
 1505 0914 04F51873 	 add r3,r4,#608
 1506 0918 0093     	 str r3,[sp]
 1507 091a 2046     	 mov r0,r4
 1508 091c D4F8C831 	 ldr r3,[r4,#456]
 1509 0920 04F50771 	 add r1,r4,#540
 1510 0924 FFF7FEFF 	 bl ifx_i2c_tl_transceive
 1511              	.LVL113:
 451:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 1512              	 .loc 1 451 0
 1513 0928 D4F8CC31 	 ldr r3,[r4,#460]
 1514 092c B4F86022 	 ldrh r2,[r4,#608]
 1515 0930 1A80     	 strh r2,[r3]
 1516 0932 06E0     	 b .L101
 1517              	.LVL114:
 1518              	.L100:
 455:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 1519              	 .loc 1 455 0
 1520 0934 4FF48473 	 mov r3,#264
 1521 0938 A4F86432 	 strh r3,[r4,#612]
 456:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.alert_type = PRL_INVALID_ALERT;
 1522              	 .loc 1 456 0
 1523 093c 0023     	 movs r3,#0
 1524 093e 84F8B231 	 strb r3,[r4,#434]
 1525              	.LVL115:
 1526              	.L101:
 1527              	.LBE36:
 1528              	.LBE37:
1148:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1149:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     return_status = ifx_i2c_prl_send_alert(p_ctx);
1150:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.alert_type = (uint8_t)PRL_INVALID_ALERT;
 1529              	 .loc 1 1150 0
 1530 0942 FF23     	 movs r3,#255
 1531 0944 84F8D231 	 strb r3,[r4,#466]
 1532              	.LVL116:
 1533 0948 0AE0     	 b .L7
 1534              	.LVL117:
 1535              	.L13:
1151:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     exit_machine = FALSE;
1152:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1153:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 else
1154:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 {
1155:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                     p_ctx->prl.state = PRL_STATE_IDLE;
1156:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 }
1157:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
1158:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
1159:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             default:
1160:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             {
1161:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.state = PRL_STATE_IDLE;
 1536              	 .loc 1 1161 0
 1537 094a 0123     	 movs r3,#1
1162:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.upper_layer_event_handler(p_ctx, IFX_I2C_STACK_ERROR, 0, 0);
 1538              	 .loc 1 1162 0
 1539 094c D4F89C52 	 ldr r5,[r4,#668]
1161:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 p_ctx->prl.upper_layer_event_handler(p_ctx, IFX_I2C_STACK_ERROR, 0, 0);
 1540              	 .loc 1 1161 0
 1541 0950 84F8B031 	 strb r3,[r4,#432]
 1542              	 .loc 1 1162 0
 1543 0954 2046     	 mov r0,r4
 1544 0956 4FF48171 	 mov r1,#258
 1545              	.LVL118:
 1546              	.L190:
 1547 095a 0022     	 movs r2,#0
 1548 095c 1346     	 mov r3,r2
 1549 095e A847     	 blx r5
 1550              	.LVL119:
 1551              	.L7:
1163:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                 exit_machine = FALSE;
1164:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             }
1165:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
1166:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
1167:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     } while (TRUE == exit_machine);
1168:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** }
 1552              	 .loc 1 1168 0
 1553 0960 2BB0     	 add sp,sp,#172
 1554              	.LCFI8:
 1555              	 .cfi_def_cfa_offset 28
 1556              	 
 1557 0962 BDE8F083 	 pop {r4,r5,r6,r7,r8,r9,pc}
 1558              	 .cfi_endproc
 1559              	.LFE10:
 1561 0966 00BF     	 .section .text.ifx_i2c_prl_init,"ax",%progbits
 1562              	 .align 1
 1563              	 .global ifx_i2c_prl_init
 1564              	 .thumb
 1565              	 .thumb_func
 1567              	ifx_i2c_prl_init:
 1568              	.LFB0:
 192:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 1569              	 .loc 1 192 0
 1570              	 .cfi_startproc
 1571              	 
 1572              	 
 1573              	.LVL120:
 1574 0000 38B5     	 push {r3,r4,r5,lr}
 1575              	.LCFI9:
 1576              	 .cfi_def_cfa_offset 16
 1577              	 .cfi_offset 3,-16
 1578              	 .cfi_offset 4,-12
 1579              	 .cfi_offset 5,-8
 1580              	 .cfi_offset 14,-4
 196:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1581              	 .loc 1 196 0
 1582 0002 0023     	 movs r3,#0
 192:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 1583              	 .loc 1 192 0
 1584 0004 0D46     	 mov r5,r1
 196:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1585              	 .loc 1 196 0
 1586 0006 80F83430 	 strb r3,[r0,#52]
 201:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1587              	 .loc 1 201 0
 1588 000a 1049     	 ldr r1,.L201
 1589              	.LVL121:
 192:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 1590              	 .loc 1 192 0
 1591 000c 0446     	 mov r4,r0
 201:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1592              	 .loc 1 201 0
 1593 000e FFF7FEFF 	 bl ifx_i2c_tl_init
 1594              	.LVL122:
 1595 0012 B8B9     	 cbnz r0,.L200
 207:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1596              	 .loc 1 207 0
 1597 0014 94F83230 	 ldrb r3,[r4,#50]
 218:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
 1598              	 .loc 1 218 0
 1599 0018 84F8B201 	 strb r0,[r4,#434]
 209:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 1600              	 .loc 1 209 0
 1601 001c 113B     	 subs r3,r3,#17
 1602 001e 18BF     	 it ne
 1603 0020 0123     	 movne r3,#1
 1604 0022 0122     	 movs r2,#1
 1605 0024 84F86632 	 strb r3,[r4,#614]
 220:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.alert_type = PRL_DEFAULT_ALERT;
 1606              	 .loc 1 220 0
 1607 0028 1123     	 movs r3,#17
 215:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1608              	 .loc 1 215 0
 1609 002a 84F8B021 	 strb r2,[r4,#432]
 217:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.negotiation_state = PRL_NEGOTIATION_NOT_DONE;
 1610              	 .loc 1 217 0
 1611 002e 84F83120 	 strb r2,[r4,#49]
 220:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.alert_type = PRL_DEFAULT_ALERT;
 1612              	 .loc 1 220 0
 1613 0032 84F8B131 	 strb r3,[r4,#433]
 221:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         return_status = IFX_I2C_STACK_SUCCESS;
 1614              	 .loc 1 221 0
 1615 0036 84F8D231 	 strb r3,[r4,#466]
 1616              	.LVL123:
 206:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (IFX_I2C_SESSION_CONTEXT_RESTORE == p_ctx->manage_context_operation)
 1617              	 .loc 1 206 0
 1618 003a C4F89C52 	 str r5,[r4,#668]
 219:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.hs_state = PRL_HS_SEND_HELLO;
 1619              	 .loc 1 219 0
 1620 003e A4F86402 	 strh r0,[r4,#612]
 1621 0042 38BD     	 pop {r3,r4,r5,pc}
 1622              	.LVL124:
 1623              	.L200:
 193:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     LOG_PRL("[IFX-PRL]: Init\n");
 1624              	 .loc 1 193 0
 1625 0044 4FF48170 	 mov r0,#258
 1626              	.LVL125:
 226:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1627              	 .loc 1 226 0
 1628 0048 38BD     	 pop {r3,r4,r5,pc}
 1629              	.LVL126:
 1630              	.L202:
 1631 004a 00BF     	 .align 2
 1632              	.L201:
 1633 004c 00000000 	 .word ifx_i2c_prl_event_handler
 1634              	 .cfi_endproc
 1635              	.LFE0:
 1637              	 .section .text.ifx_i2c_prl_close,"ax",%progbits
 1638              	 .align 1
 1639              	 .global ifx_i2c_prl_close
 1640              	 .thumb
 1641              	 .thumb_func
 1643              	ifx_i2c_prl_close:
 1644              	.LFB1:
 229:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 1645              	 .loc 1 229 0
 1646              	 .cfi_startproc
 1647              	 
 1648              	 
 1649              	.LVL127:
 1650 0000 10B5     	 push {r4,lr}
 1651              	.LCFI10:
 1652              	 .cfi_def_cfa_offset 8
 1653              	 .cfi_offset 4,-8
 1654              	 .cfi_offset 14,-4
 235:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1655              	 .loc 1 235 0
 1656 0002 90F8B031 	 ldrb r3,[r0,#432]
 1657 0006 012B     	 cmp r3,#1
 229:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 1658              	 .loc 1 229 0
 1659 0008 0246     	 mov r2,r0
 1660 000a 0C46     	 mov r4,r1
 235:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1661              	 .loc 1 235 0
 1662 000c 02D0     	 beq .L204
 1663              	.LVL128:
 1664              	.L207:
 230:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     LOG_PRL("[IFX-PRL]: Close\n");
 1665              	 .loc 1 230 0
 1666 000e 4FF48170 	 mov r0,#258
 1667              	.LVL129:
 1668 0012 10BD     	 pop {r4,pc}
 1669              	.LVL130:
 1670              	.L204:
 239:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         if (IFX_I2C_SESSION_CONTEXT_NONE == p_ctx->manage_context_operation)
 1671              	 .loc 1 239 0
 1672 0014 C2F89C12 	 str r1,[r2,#668]
 240:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1673              	 .loc 1 240 0
 1674 0018 90F83210 	 ldrb r1,[r0,#50]
 1675              	.LVL131:
 1676 001c 3329     	 cmp r1,#51
 1677 001e 04D1     	 bne .L206
 242:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_STACK_SUCCESS;
 1678              	 .loc 1 242 0
 1679 0020 0021     	 movs r1,#0
 1680 0022 0A46     	 mov r2,r1
 1681 0024 0B46     	 mov r3,r1
 1682 0026 A047     	 blx r4
 1683              	.LVL132:
 1684 0028 0FE0     	 b .L208
 1685              	.LVL133:
 1686              	.L206:
 247:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (IFX_I2C_SESSION_CONTEXT_SAVE == p_ctx->manage_context_operation))
 1687              	 .loc 1 247 0
 1688 002a 90F8B231 	 ldrb r3,[r0,#434]
 1689 002e 012B     	 cmp r3,#1
 1690 0030 EDD1     	 bne .L207
 247:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (IFX_I2C_SESSION_CONTEXT_SAVE == p_ctx->manage_context_operation))
 1691              	 .loc 1 247 0 is_stmt 0 discriminator 1
 1692 0032 2229     	 cmp r1,#34
 1693 0034 EBD1     	 bne .L207
 250:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.mc_state = PRL_MANAGE_CONTEXT_TX_STATE;
 1694              	 .loc 1 250 0 is_stmt 1
 1695 0036 0821     	 movs r1,#8
 1696 0038 80F8B011 	 strb r1,[r0,#432]
 251:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             ifx_i2c_prl_event_handler(p_ctx, IFX_I2C_STACK_SUCCESS, p_ctx->prl.prl_txrx_buffer, 1);
 1697              	 .loc 1 251 0
 1698 003c 80F8B331 	 strb r3,[r0,#435]
 252:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             return_status = IFX_I2C_STACK_SUCCESS;
 1699              	 .loc 1 252 0
 1700 0040 0021     	 movs r1,#0
 1701 0042 00F50772 	 add r2,r0,#540
 1702 0046 FFF7FEFF 	 bl ifx_i2c_prl_event_handler
 1703              	.LVL134:
 1704              	.L208:
 253:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             break;
 1705              	 .loc 1 253 0
 1706 004a 0020     	 movs r0,#0
 1707              	.LVL135:
 258:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1708              	 .loc 1 258 0
 1709 004c 10BD     	 pop {r4,pc}
 1710              	 .cfi_endproc
 1711              	.LFE1:
 1713              	 .section .text.ifx_i2c_prl_transceive,"ax",%progbits
 1714              	 .align 1
 1715              	 .global ifx_i2c_prl_transceive
 1716              	 .thumb
 1717              	 .thumb_func
 1719              	ifx_i2c_prl_transceive:
 1720              	.LFB2:
 265:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 1721              	 .loc 1 265 0
 1722              	 .cfi_startproc
 1723              	 
 1724              	 
 1725              	.LVL136:
 1726 0000 38B5     	 push {r3,r4,r5,lr}
 1727              	.LCFI11:
 1728              	 .cfi_def_cfa_offset 16
 1729              	 .cfi_offset 3,-16
 1730              	 .cfi_offset 4,-12
 1731              	 .cfi_offset 5,-8
 1732              	 .cfi_offset 14,-4
 265:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     optiga_lib_status_t return_status = IFX_I2C_STACK_ERROR;
 1733              	 .loc 1 265 0
 1734 0002 1546     	 mov r5,r2
 272:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1735              	 .loc 1 272 0
 1736 0004 0A46     	 mov r2,r1
 1737              	.LVL137:
 1738 0006 B9B3     	 cbz r1,.L217
 272:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1739              	 .loc 1 272 0 is_stmt 0 discriminator 1
 1740 0008 B5B3     	 cbz r5,.L217
 272:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         {
 1741              	 .loc 1 272 0 discriminator 2
 1742 000a 90F8B011 	 ldrb r1,[r0,#432]
 1743              	.LVL138:
 1744 000e 0129     	 cmp r1,#1
 1745 0010 32D1     	 bne .L217
 277:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (PRL_RESTORE_NOT_DONE == p_ctx->prl.restore_context_flag))
 1746              	 .loc 1 277 0 is_stmt 1
 1747 0012 90F83240 	 ldrb r4,[r0,#50]
 1748 0016 112C     	 cmp r4,#17
 1749 0018 08D1     	 bne .L211
 277:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (PRL_RESTORE_NOT_DONE == p_ctx->prl.restore_context_flag))
 1750              	 .loc 1 277 0 is_stmt 0 discriminator 1
 1751 001a 90F86642 	 ldrb r4,[r0,#614]
 1752 001e 2CB9     	 cbnz r4,.L211
 280:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             p_ctx->prl.mc_state = PRL_MANAGE_CONTEXT_TX_STATE;
 1753              	 .loc 1 280 0 is_stmt 1
 1754 0020 0824     	 movs r4,#8
 1755 0022 80F8B041 	 strb r4,[r0,#432]
 281:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 1756              	 .loc 1 281 0
 1757 0026 80F8B311 	 strb r1,[r0,#435]
 1758 002a 02E0     	 b .L212
 1759              	.L211:
 285:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 1760              	 .loc 1 285 0
 1761 002c 0221     	 movs r1,#2
 1762 002e 80F8B011 	 strb r1,[r0,#432]
 1763              	.L212:
 290:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (FULL_PROTECTION == (p_ctx->protection_level & PRL_PROTECTION_MASK)))
 1764              	 .loc 1 290 0
 1765 0032 90F83010 	 ldrb r1,[r0,#48]
 287:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.actual_payload_length = tx_data_len;
 1766              	 .loc 1 287 0
 1767 0036 C0F8C021 	 str r2,[r0,#448]
 290:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****             (FULL_PROTECTION == (p_ctx->protection_level & PRL_PROTECTION_MASK)))
 1768              	 .loc 1 290 0
 1769 003a 01F00301 	 and r1,r1,#3
 1770 003e 0239     	 subs r1,r1,#2
 1771 0040 0129     	 cmp r1,#1
 297:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         }
 1772              	 .loc 1 297 0
 1773 0042 88BF     	 it hi
 1774 0044 0433     	 addhi r3,r3,#4
 1775              	.LVL139:
 1776 0046 C0F8C831 	 str r3,[r0,#456]
 299:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.data_retransmit_counter = 0;
 1777              	 .loc 1 299 0
 1778 004a 049B     	 ldr r3,[sp,#16]
 1779 004c C0F8CC31 	 str r3,[r0,#460]
 300:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.trans_repeat_status = FALSE;
 1780              	 .loc 1 300 0
 1781 0050 0024     	 movs r4,#0
 304:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1782              	 .loc 1 304 0
 1783 0052 1123     	 movs r3,#17
 288:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1784              	 .loc 1 288 0
 1785 0054 A0F8C451 	 strh r5,[r0,#452]
 300:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.trans_repeat_status = FALSE;
 1786              	 .loc 1 300 0
 1787 0058 80F86342 	 strb r4,[r0,#611]
 301:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.decryption_failure_counter = 0;
 1788              	 .loc 1 301 0
 1789 005c 80F8A042 	 strb r4,[r0,#672]
 302:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.return_status = IFX_I2C_STACK_SUCCESS;
 1790              	 .loc 1 302 0
 1791 0060 80F86242 	 strb r4,[r0,#610]
 303:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****         p_ctx->prl.alert_type = PRL_DEFAULT_ALERT;
 1792              	 .loc 1 303 0
 1793 0064 A0F86442 	 strh r4,[r0,#612]
 304:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1794              	 .loc 1 304 0
 1795 0068 80F8D231 	 strb r3,[r0,#466]
 306:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****                                   IFX_I2C_STACK_SUCCESS,
 1796              	 .loc 1 306 0
 1797 006c 2146     	 mov r1,r4
 1798 006e 2B46     	 mov r3,r5
 1799 0070 FFF7FEFF 	 bl ifx_i2c_prl_event_handler
 1800              	.LVL140:
 309:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1801              	 .loc 1 309 0
 1802 0074 2046     	 mov r0,r4
 1803 0076 38BD     	 pop {r3,r4,r5,pc}
 1804              	.LVL141:
 1805              	.L217:
 266:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c ****     LOG_PRL("[IFX-PRL]: Transceive txlen %d\n", tx_data_len);
 1806              	 .loc 1 266 0
 1807 0078 4FF48170 	 mov r0,#258
 1808              	.LVL142:
 313:C:/Users/Yushev/git/optiga-trust-qi/optiga/comms/ifx_i2c\ifx_i2c_presentation_layer.c **** 
 1809              	 .loc 1 313 0
 1810 007c 38BD     	 pop {r3,r4,r5,pc}
 1811              	 .cfi_endproc
 1812              	.LFE2:
 1814              	 .section .rodata.str1.1,"aMS",%progbits,1
 1815              	.LC0:
 1816 0000 506C6174 	 .ascii "Platform Binding\000"
 1816      666F726D 
 1816      2042696E 
 1816      64696E67 
 1816      00
 1817              	 .text
 1818              	.Letext0:
 1819              	 .file 2 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 1820              	 .file 3 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\lib\\gcc\\arm-none-eabi\\4.9.3\\include\\stddef.h"
 1821              	 .file 4 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 1822              	 .file 5 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_types.h"
 1823              	 .file 6 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal.h"
 1824              	 .file 7 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_i2c.h"
 1825              	 .file 8 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_gpio.h"
 1826              	 .file 9 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/ifx_i2c/ifx_i2c_config.h"
 1827              	 .file 10 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_crypt.h"
 1828              	 .file 11 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_common.h"
 1829              	 .file 12 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_os_datastore.h"
 1830              	 .file 13 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/ifx_i2c/ifx_i2c_transport_layer.h"
 1831              	 .file 14 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\string.h"
DEFINED SYMBOLS
                            *ABS*:00000000 ifx_i2c_presentation_layer.c
    {standard input}:20     .text.ifx_i2c_prl_decrypt_msg:00000000 $t
    {standard input}:24     .text.ifx_i2c_prl_decrypt_msg:00000000 ifx_i2c_prl_decrypt_msg
    {standard input}:135    .text.ifx_i2c_prl_encrypt_msg:00000000 $t
    {standard input}:139    .text.ifx_i2c_prl_encrypt_msg:00000000 ifx_i2c_prl_encrypt_msg
    {standard input}:238    .text.ifx_i2c_prl_event_handler:00000000 $t
    {standard input}:242    .text.ifx_i2c_prl_event_handler:00000000 ifx_i2c_prl_event_handler
    {standard input}:316    .text.ifx_i2c_prl_event_handler:00000062 $d
    {standard input}:324    .text.ifx_i2c_prl_event_handler:00000072 $t
    {standard input}:1267   .text.ifx_i2c_prl_event_handler:00000750 $d
    {standard input}:1271   .text.ifx_i2c_prl_event_handler:00000754 $t
    {standard input}:1562   .text.ifx_i2c_prl_init:00000000 $t
    {standard input}:1567   .text.ifx_i2c_prl_init:00000000 ifx_i2c_prl_init
    {standard input}:1633   .text.ifx_i2c_prl_init:0000004c $d
    {standard input}:1638   .text.ifx_i2c_prl_close:00000000 $t
    {standard input}:1643   .text.ifx_i2c_prl_close:00000000 ifx_i2c_prl_close
    {standard input}:1714   .text.ifx_i2c_prl_transceive:00000000 $t
    {standard input}:1719   .text.ifx_i2c_prl_transceive:00000000 ifx_i2c_prl_transceive
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
optiga_common_set_uint32
optiga_common_set_uint16
pal_crypt_decrypt_aes128_ccm
pal_crypt_encrypt_aes128_ccm
pal_os_datastore_read
memset
pal_os_datastore_write
ifx_i2c_tl_transceive
optiga_common_get_uint32
pal_crypt_tls_prf_sha256
memcmp
ifx_i2c_tl_init
