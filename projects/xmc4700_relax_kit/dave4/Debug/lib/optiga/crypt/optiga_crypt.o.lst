   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,4
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "optiga_crypt.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.optiga_crypt_generic_event_handler,"ax",%progbits
  20              	 .align 1
  21              	 .thumb
  22              	 .thumb_func
  24              	optiga_crypt_generic_event_handler:
  25              	.LFB0:
  26              	 .file 1 "C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt/optiga_crypt.c"
   1:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** /**
   2:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * \copyright
   3:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * MIT License
   4:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
   5:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * Copyright (c) 2020 Infineon Technologies AG
   6:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
   7:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * Permission is hereby granted, free of charge, to any person obtaining a copy
   8:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * of this software and associated documentation files (the "Software"), to deal
   9:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * in the Software without restriction, including without limitation the rights
  10:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  11:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * copies of the Software, and to permit persons to whom the Software is
  12:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * furnished to do so, subject to the following conditions:
  13:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
  14:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * The above copyright notice and this permission notice shall be included in all
  15:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * copies or substantial portions of the Software.
  16:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
  17:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  18:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  19:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  20:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  21:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  22:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  23:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * SOFTWARE
  24:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
  25:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * \endcopyright
  26:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
  27:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * \author Infineon Technologies AG
  28:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
  29:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * \file optiga_crypt.c
  30:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
  31:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * \brief   This file implements the OPTIGA Crypt module.
  32:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
  33:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * \ingroup  grOptigaCrypt
  34:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** *
  35:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** * @{
  36:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** */
  37:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  38:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  39:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #include "optiga/optiga_crypt.h"
  40:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #include "optiga/common/optiga_lib_logger.h"
  41:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #include "optiga/common/optiga_lib_common_internal.h"
  42:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #include "optiga/pal/pal_os_memory.h"
  43:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  44:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** /// ECDSA FIPS 186-3 without hash
  45:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #define OPTIGA_CRYPT_ECDSA_FIPS_186_3_WITHOUT_HASH                  (0x11)
  46:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  47:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  48:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #if defined (OPTIGA_LIB_ENABLE_LOGGING) && defined (OPTIGA_LIB_ENABLE_CRYPT_LOGGING)
  49:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  50:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** // Logs the message provided from Crypt layer
  51:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #define OPTIGA_CRYPT_LOG_MESSAGE(msg) \
  52:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {\
  53:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_print_message(msg,OPTIGA_CRYPT_SERVICE,OPTIGA_CRYPT_SERVICE_COLOR);\
  54:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
  55:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  56:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** // Logs the byte array buffer provided from Crypt layer in hexadecimal format
  57:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** //lint --e{750} suppress "The unused OPTIGA_CRYPT_LOG_HEX_DATA macro is kept for future enhancement
  58:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #define OPTIGA_CRYPT_LOG_HEX_DATA(array,array_len) \
  59:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {\
  60:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_print_array_hex_format(array,array_len,OPTIGA_UNPROTECTED_DATA_COLOR);\
  61:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
  62:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  63:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** //Logs the status info provided from Crypt layer
  64:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** //lint --e{750} suppress "The unused OPTIGA_CRYPT_LOG_STATUS macro is kept for future enhancements"
  65:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #define OPTIGA_CRYPT_LOG_STATUS(return_value) \
  66:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** { \
  67:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     if (OPTIGA_LIB_SUCCESS != return_value) \
  68:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     { \
  69:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         optiga_lib_print_status(OPTIGA_CRYPT_SERVICE,OPTIGA_ERROR_COLOR,return_value); \
  70:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } \
  71:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     else\
  72:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     { \
  73:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         optiga_lib_print_status(OPTIGA_CRYPT_SERVICE,OPTIGA_CRYPT_SERVICE_COLOR,return_value); \
  74:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } \
  75:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
  76:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #else
  77:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  78:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #define OPTIGA_CRYPT_LOG_MESSAGE(msg) {}
  79:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** //lint --e{750} suppress "The unused OPTIGA_CRYPT_LOG_HEX_DATA macro is kept for future enhancement
  80:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #define OPTIGA_CRYPT_LOG_HEX_DATA(array, array_len) {}
  81:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** //lint --e{750} suppress "The unused OPTIGA_CRYPT_LOG_STATUS macro is kept for future enhancements"
  82:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #define OPTIGA_CRYPT_LOG_STATUS(return_value) {}
  83:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  84:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
  85:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  86:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** _STATIC_H void optiga_crypt_generic_event_handler(void * p_ctx,
  87:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   optiga_lib_status_t event)
  88:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
  27              	 .loc 1 88 0
  28              	 .cfi_startproc
  29              	 
  30              	 
  31              	 
  32              	.LVL0:
  89:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_crypt_t * me = (optiga_crypt_t *)p_ctx;
  90:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  91:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     me->instance_state = OPTIGA_LIB_INSTANCE_FREE;
  33              	 .loc 1 91 0
  34 0000 0023     	 movs r3,#0
  35 0002 8385     	 strh r3,[r0,#44]
  92:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     me->handler(me->caller_context, event);
  36              	 .loc 1 92 0
  37 0004 836A     	 ldr r3,[r0,#40]
  38 0006 406A     	 ldr r0,[r0,#36]
  39              	.LVL1:
  40 0008 1847     	 bx r3
  41              	.LVL2:
  42              	 .cfi_endproc
  43              	.LFE0:
  45              	 .section .text.optiga_crypt_hash_generic,"ax",%progbits
  46              	 .align 1
  47              	 .thumb
  48              	 .thumb_func
  50              	optiga_crypt_hash_generic:
  51              	.LFB6:
  93:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
  94:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
  95:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** _STATIC_H void optiga_crypt_reset_protection_level(optiga_crypt_t * me)
  96:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
  97:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
  98:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     if (NULL != me)
  99:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 100:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 101:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL(me, OPTIGA_COMMS_DEFAULT_PROTECTION_LEVEL);
 102:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     }
 103:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 104:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 105:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** extern void optiga_cmd_set_shielded_connection_option(optiga_cmd_t * me,
 106:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint8_t value,
 107:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint8_t shielded_connection_option);
 108:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 109:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED
 110:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** _STATIC_H optiga_lib_status_t optiga_crypt_generate_keypair(optiga_crypt_t * me,
 111:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                             uint8_t cmd_param,
 112:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                             uint8_t key_usage,
 113:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                             bool_t export_private_key,
 114:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                             void * p_private_key,
 115:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                             uint8_t * p_public_key,
 116:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                             uint16_t * p_public_key_length)
 117:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 118:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 119:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_gen_keypair_params_t * p_params;
 120:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 121:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 122:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 123:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 124:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((NULL == me) || (NULL == me->my_cmd) ||
 125:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             (NULL == p_public_key) || (NULL == p_private_key) || (NULL == p_public_key_length))
 126:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 127:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 128:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 129:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 130:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 131:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_INSTANCE_BUSY == me->instance_state)
 132:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 133:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE;
 134:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 135:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 136:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 137:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->instance_state = OPTIGA_LIB_INSTANCE_BUSY;
 138:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_gen_keypair_params_t *)&(me->params.optiga_gen_keypair_params);
 139:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         pal_os_memset(&me->params,0x00,sizeof(optiga_crypt_params_t));
 140:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 141:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->key_usage = key_usage;
 142:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->export_private_key = export_private_key;
 143:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->public_key_length = p_public_key_length;
 144:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_ENABLE(me->my_cmd, me);
 145:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 146:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 147:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (export_private_key)
 148:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 149:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             p_params->private_key = (uint8_t *)p_private_key;
 150:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 151:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         else
 152:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 153:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             p_params->private_key_oid = (optiga_key_id_t)(* ((uint16_t* )p_private_key));
 154:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 155:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 156:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->public_key = p_public_key;
 157:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->public_key_length = p_public_key_length;
 158:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 159:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_cmd_gen_keypair(me->my_cmd,
 160:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               (uint8_t )cmd_param,
 161:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               (optiga_gen_keypair_params_t *)p_params);
 162:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 163:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_crypt_reset_protection_level(me);
 164:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 165:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 166:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 167:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif // (OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED)
 168:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 169:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_ECDSA_SIGN_ENABLED
 170:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** //lint --e{715} suppress "The salt_length argument is kept for future use"
 171:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** _STATIC_H optiga_lib_status_t optiga_crypt_sign(optiga_crypt_t * me,
 172:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                 uint8_t signature_scheme,
 173:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                 const uint8_t * p_digest,
 174:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                 uint8_t digest_length,
 175:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                 optiga_key_id_t private_key,
 176:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                 uint8_t * p_signature,
 177:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                 uint16_t * p_signature_length,
 178:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                 uint16_t salt_length)
 179:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 180:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 181:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_calc_sign_params_t * p_params;
 182:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 183:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 184:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 185:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 186:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((NULL == me) || (NULL == me->my_cmd) || (NULL == p_digest) ||
 187:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             (NULL == p_signature) || (NULL == p_signature_length))
 188:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 189:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 190:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 191:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 192:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 193:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 194:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_INSTANCE_BUSY == me->instance_state)
 195:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 196:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE;
 197:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 198:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 199:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 200:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->instance_state = OPTIGA_LIB_INSTANCE_BUSY;
 201:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 202:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_calc_sign_params_t *)&(me->params.optiga_calc_sign_params);
 203:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         pal_os_memset(&me->params,0x00,sizeof(optiga_crypt_params_t));
 204:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 205:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_digest = p_digest;
 206:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->digest_length = digest_length;
 207:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->private_key_oid = private_key;
 208:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_signature = p_signature;
 209:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_signature_length = p_signature_length;
 210:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_ENABLE(me->my_cmd, me);
 211:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 212:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 213:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_cmd_calc_sign(me->my_cmd,
 214:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             signature_scheme,
 215:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             (optiga_calc_sign_params_t *)p_params);
 216:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_SUCCESS != return_value)
 217:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 218:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             me->instance_state = OPTIGA_LIB_INSTANCE_FREE;
 219:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 220:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 221:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_crypt_reset_protection_level(me);
 222:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 223:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 224:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 225:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif // (OPTIGA_CRYPT_ECDSA_SIGN_ENABLED)
 226:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 227:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_ECDSA_VERIFY_ENABLED
 228:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** //lint --e{715} suppress "The salt_length argument is kept for future use"
 229:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** _STATIC_H optiga_lib_status_t optiga_crypt_verify(optiga_crypt_t * me,
 230:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   uint8_t cmd_param,
 231:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   const uint8_t * p_digest,
 232:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   uint8_t digest_length,
 233:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   const uint8_t * p_signature,
 234:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   uint16_t signature_length,
 235:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   uint8_t public_key_source_type,
 236:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   const void * p_public_key,
 237:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                   uint16_t salt_length)
 238:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 239:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_verify_sign_params_t * p_params;
 240:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 241:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 242:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 243:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 244:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 245:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((NULL == me) || (NULL == me->my_cmd) ||
 246:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             (NULL == p_digest) || (NULL == p_signature) || (NULL == p_public_key))
 247:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 248:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 249:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 250:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 251:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 252:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 253:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_INSTANCE_BUSY == me->instance_state)
 254:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 255:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE;
 256:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 257:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 258:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 259:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->instance_state = OPTIGA_LIB_INSTANCE_BUSY;
 260:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_verify_sign_params_t *)&(me->params.optiga_verify_sign_params);
 261:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         pal_os_memset(&me->params,0x00,sizeof(optiga_crypt_params_t));
 262:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 263:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_ENABLE(me->my_cmd, me);
 264:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 265:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_digest = p_digest;
 266:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->digest_length = digest_length;
 267:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_signature = p_signature;
 268:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->signature_length = signature_length;
 269:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->public_key_source_type = public_key_source_type;
 270:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 271:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_CRYPT_OID_DATA == public_key_source_type)
 272:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 273:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             p_params->certificate_oid = *((uint16_t *)p_public_key);
 274:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 275:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         else
 276:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 277:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             p_params->public_key = (public_key_from_host_t *)p_public_key;
 278:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 279:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 280:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_cmd_verify_sign(me->my_cmd,
 281:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              (uint8_t)cmd_param,
 282:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              (optiga_verify_sign_params_t *)p_params);
 283:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_SUCCESS != return_value)
 284:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 285:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             me->instance_state = OPTIGA_LIB_INSTANCE_FREE;
 286:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 287:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 288:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_crypt_reset_protection_level(me);
 289:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 290:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 291:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 292:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif //(OPTIGA_CRYPT_ECDSA_VERIFY_ENABLED)
 293:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 294:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_RANDOM_ENABLED
 295:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** _STATIC_H optiga_lib_status_t optiga_crypt_get_random(optiga_crypt_t * me,
 296:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint8_t cmd_param,
 297:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint8_t * p_random_data,
 298:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint16_t random_data_length,
 299:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       const uint8_t * p_optional_data,
 300:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint16_t optional_data_length)
 301:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 302:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 303:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_get_random_params_t * p_params;
 304:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 305:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 306:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_INSTANCE_BUSY == me->instance_state)
 307:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 308:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE;
 309:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 310:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 311:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 312:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->instance_state = OPTIGA_LIB_INSTANCE_BUSY;
 313:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_get_random_params_t *)&(me->params.optiga_get_random_params);
 314:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         pal_os_memset(&me->params,0x00,sizeof(optiga_crypt_params_t));
 315:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 316:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->optional_data = p_optional_data;
 317:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->optional_data_length = optional_data_length;
 318:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->random_data = p_random_data;
 319:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->random_data_length = random_data_length;
 320:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_ENABLE(me->my_cmd, me);
 321:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 322:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 323:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_cmd_get_random(me->my_cmd,
 324:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              cmd_param,
 325:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              (optiga_get_random_params_t *)p_params);
 326:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_SUCCESS != return_value)
 327:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 328:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             me->instance_state = OPTIGA_LIB_INSTANCE_FREE;
 329:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 330:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 331:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_crypt_reset_protection_level(me);
 332:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 333:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 334:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 335:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif //(OPTIGA_CRYPT_RANDOM_ENABLED)
 336:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 337:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_HASH_ENABLED
 338:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** _STATIC_H optiga_lib_status_t optiga_crypt_hash_generic(optiga_crypt_t * me,
 339:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                         uint8_t hash_algorithm,
 340:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                         uint8_t hash_sequence,
 341:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                         uint8_t source_of_data_to_hash,
 342:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                         optiga_hash_context_t * hash_ctx,
 343:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                         uint32_t context_length,                   
 344:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                         const void * data_to_hash,
 345:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                         bool_t export_intermediate_ctx,
 346:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                         uint8_t * hash_output)
 347:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
  52              	 .loc 1 347 0
  53              	 .cfi_startproc
  54              	 
  55              	 
  56              	.LVL3:
  57 0000 2DE9F843 	 push {r3,r4,r5,r6,r7,r8,r9,lr}
  58              	.LCFI0:
  59              	 .cfi_def_cfa_offset 32
  60              	 .cfi_offset 3,-32
  61              	 .cfi_offset 4,-28
  62              	 .cfi_offset 5,-24
  63              	 .cfi_offset 6,-20
  64              	 .cfi_offset 7,-16
  65              	 .cfi_offset 8,-12
  66              	 .cfi_offset 9,-8
  67              	 .cfi_offset 14,-4
  68              	 .loc 1 347 0
  69 0004 9946     	 mov r9,r3
 348:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 349:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_calc_hash_params_t * p_params;
 350:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 351:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 352:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_INSTANCE_BUSY == me->instance_state)
  70              	 .loc 1 352 0
  71 0006 838D     	 ldrh r3,[r0,#44]
  72              	.LVL4:
 347:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
  73              	 .loc 1 347 0
  74 0008 0A9E     	 ldr r6,[sp,#40]
  75              	 .loc 1 352 0
  76 000a 012B     	 cmp r3,#1
 347:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
  77              	 .loc 1 347 0
  78 000c 0446     	 mov r4,r0
  79 000e 8846     	 mov r8,r1
  80 0010 1546     	 mov r5,r2
  81              	 .loc 1 352 0
  82 0012 33D0     	 beq .L6
 353:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 354:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE;
 355:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 356:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 357:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 358:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->instance_state = OPTIGA_LIB_INSTANCE_BUSY;
  83              	 .loc 1 358 0
  84 0014 0127     	 movs r7,#1
  85 0016 8785     	 strh r7,[r0,#44]
  86              	.LVL5:
 359:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_calc_hash_params_t *)&(me->params.optiga_calc_hash_params);
 360:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         pal_os_memset(&me->params,0x00,sizeof(optiga_crypt_params_t));
  87              	 .loc 1 360 0
  88 0018 0021     	 movs r1,#0
  89              	.LVL6:
  90 001a 2022     	 movs r2,#32
  91              	.LVL7:
  92 001c FFF7FEFF 	 bl pal_os_memset
  93              	.LVL8:
 361:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 362:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_ENABLE(me->my_cmd, me);
  94              	 .loc 1 362 0
  95 0020 206A     	 ldr r0,[r4,#32]
  96 0022 94F82E10 	 ldrb r1,[r4,#46]
  97 0026 0022     	 movs r2,#0
  98 0028 FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
  99              	.LVL9:
 363:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 100              	 .loc 1 363 0
 101 002c 3A46     	 mov r2,r7
 102 002e 206A     	 ldr r0,[r4,#32]
 103 0030 94F82F10 	 ldrb r1,[r4,#47]
 104 0034 FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 105              	.LVL10:
 364:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->hash_sequence = hash_sequence;
 365:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_hash_context = hash_ctx;
 106              	 .loc 1 365 0
 107 0038 089B     	 ldr r3,[sp,#32]
 108 003a A360     	 str r3,[r4,#8]
 366:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->apparent_context_size = context_length;
 109              	 .loc 1 366 0
 110 003c 099B     	 ldr r3,[sp,#36]
 111 003e E361     	 str r3,[r4,#28]
 367:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_hash_data = NULL;
 368:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_hash_oid = NULL;
 369:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_out_digest = hash_output;
 112              	 .loc 1 369 0
 113 0040 0C9B     	 ldr r3,[sp,#48]
 114 0042 6361     	 str r3,[r4,#20]
 370:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->export_hash_ctx = export_intermediate_ctx;
 115              	 .loc 1 370 0
 116 0044 9DF82C30 	 ldrb r3,[sp,#44]
 117 0048 2376     	 strb r3,[r4,#24]
 371:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         
 372:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((OPTIGA_CRYPT_HASH_CONTINUE == hash_sequence) || (OPTIGA_CRYPT_HASH_START_FINAL == hash
 118              	 .loc 1 372 0
 119 004a 6B1E     	 subs r3,r5,#1
 367:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_hash_oid = NULL;
 120              	 .loc 1 367 0
 121 004c 0022     	 movs r2,#0
 122              	 .loc 1 372 0
 123 004e BB42     	 cmp r3,r7
 364:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_hash_context = hash_ctx;
 124              	 .loc 1 364 0
 125 0050 2573     	 strb r5,[r4,#12]
 367:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_hash_oid = NULL;
 126              	 .loc 1 367 0
 127 0052 6260     	 str r2,[r4,#4]
 368:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_out_digest = hash_output;
 128              	 .loc 1 368 0
 129 0054 2260     	 str r2,[r4]
 130              	 .loc 1 372 0
 131 0056 08D8     	 bhi .L4
 373:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 374:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             if (source_of_data_to_hash)
 132              	 .loc 1 374 0
 133 0058 B9F1000F 	 cmp r9,#0
 134 005c 01D0     	 beq .L5
 375:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             {
 376:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                 p_params->p_hash_data = (hash_data_from_host_t *)data_to_hash;
 135              	 .loc 1 376 0
 136 005e 6660     	 str r6,[r4,#4]
 137 0060 03E0     	 b .L4
 138              	.L5:
 377:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             }
 378:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             else
 379:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             {
 380:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                 p_params->hash_sequence |= OPTIGA_CRYPT_HASH_FOR_OID;
 139              	 .loc 1 380 0
 140 0062 45F01005 	 orr r5,r5,#16
 141 0066 2573     	 strb r5,[r4,#12]
 381:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                 p_params->p_hash_oid = (hash_data_in_optiga_t *)data_to_hash;
 142              	 .loc 1 381 0
 143 0068 2660     	 str r6,[r4]
 144              	.L4:
 382:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             }
 383:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 384:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 385:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_cmd_calc_hash(me->my_cmd,
 145              	 .loc 1 385 0
 146 006a 206A     	 ldr r0,[r4,#32]
 147 006c 4146     	 mov r1,r8
 148 006e 2246     	 mov r2,r4
 149 0070 FFF7FEFF 	 bl optiga_cmd_calc_hash
 150              	.LVL11:
 386:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             hash_algorithm,
 387:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             (optiga_calc_hash_params_t *)p_params);
 388:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_SUCCESS != return_value)
 151              	 .loc 1 388 0
 152 0074 20B1     	 cbz r0,.L3
 389:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 390:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             me->instance_state = OPTIGA_LIB_INSTANCE_FREE;
 153              	 .loc 1 390 0
 154 0076 0023     	 movs r3,#0
 155 0078 A385     	 strh r3,[r4,#44]
 156 007a 01E0     	 b .L3
 157              	.LVL12:
 158              	.L6:
 354:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 159              	 .loc 1 354 0
 160 007c 40F20540 	 movw r0,#1029
 161              	.LVL13:
 162              	.L3:
 163              	.LBB6:
 164              	.LBB7:
 165              	.LBB8:
 391:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 392:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 393:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_crypt_reset_protection_level(me);
 394:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 395:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 396:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 397:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif //(OPTIGA_CRYPT_HASH_ENABLED)
 398:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 399:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 400:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** void optiga_crypt_set_comms_params(optiga_crypt_t * me,
 401:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                    uint8_t parameter_type,
 402:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                    uint8_t value)
 403:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 404:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     switch (parameter_type)
 405:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 406:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         case OPTIGA_COMMS_PROTECTION_LEVEL:
 407:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 408:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             me->protection_level = value;
 166              	 .loc 1 408 0
 167 0080 0023     	 movs r3,#0
 168 0082 84F82E30 	 strb r3,[r4,#46]
 169              	.LBE8:
 170              	.LBE7:
 171              	.LBE6:
 396:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif //(OPTIGA_CRYPT_HASH_ENABLED)
 172              	 .loc 1 396 0
 173 0086 BDE8F883 	 pop {r3,r4,r5,r6,r7,r8,r9,pc}
 174              	 .cfi_endproc
 175              	.LFE6:
 177              	 .section .text.optiga_crypt_set_comms_params,"ax",%progbits
 178              	 .align 1
 179              	 .global optiga_crypt_set_comms_params
 180              	 .thumb
 181              	 .thumb_func
 183              	optiga_crypt_set_comms_params:
 184              	.LFB7:
 403:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     switch (parameter_type)
 185              	 .loc 1 403 0
 186              	 .cfi_startproc
 187              	 
 188              	 
 189              	 
 190              	.LVL14:
 404:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 191              	 .loc 1 404 0
 192 0000 0129     	 cmp r1,#1
 193 0002 02D0     	 beq .L13
 194 0004 0229     	 cmp r1,#2
 195 0006 03D0     	 beq .L14
 196 0008 7047     	 bx lr
 197              	.L13:
 198              	 .loc 1 408 0
 199 000a 80F82E20 	 strb r2,[r0,#46]
 409:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 200              	 .loc 1 409 0
 201 000e 7047     	 bx lr
 202              	.L14:
 410:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 411:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         case OPTIGA_COMMS_PROTOCOL_VERSION:
 412:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 413:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             me->protocol_version = value;
 203              	 .loc 1 413 0
 204 0010 80F82F20 	 strb r2,[r0,#47]
 205 0014 7047     	 bx lr
 206              	 .cfi_endproc
 207              	.LFE7:
 209              	 .section .text.optiga_crypt_create,"ax",%progbits
 210              	 .align 1
 211              	 .global optiga_crypt_create
 212              	 .thumb
 213              	 .thumb_func
 215              	optiga_crypt_create:
 216              	.LFB8:
 414:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 415:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 416:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         default:
 417:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 418:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 419:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 420:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     }
 421:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 422:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 423:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 424:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_crypt_t * optiga_crypt_create(uint8_t optiga_instance_id,
 425:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                      callback_handler_t handler,
 426:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                      void * caller_context)
 427:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 217              	 .loc 1 427 0
 218              	 .cfi_startproc
 219              	 
 220              	 
 221              	.LVL15:
 222 0000 F8B5     	 push {r3,r4,r5,r6,r7,lr}
 223              	.LCFI1:
 224              	 .cfi_def_cfa_offset 24
 225              	 .cfi_offset 3,-24
 226              	 .cfi_offset 4,-20
 227              	 .cfi_offset 5,-16
 228              	 .cfi_offset 6,-12
 229              	 .cfi_offset 7,-8
 230              	 .cfi_offset 14,-4
 231              	 .loc 1 427 0
 232 0002 0646     	 mov r6,r0
 233 0004 1746     	 mov r7,r2
 428:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_crypt_t * me = NULL;
 429:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 430:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 431:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 432:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 433:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (NULL == handler)
 234              	 .loc 1 433 0
 235 0006 0D46     	 mov r5,r1
 236 0008 09B9     	 cbnz r1,.L16
 237              	.LVL16:
 238              	.L18:
 428:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_crypt_t * me = NULL;
 239              	 .loc 1 428 0
 240 000a 0024     	 movs r4,#0
 241 000c 1BE0     	 b .L17
 242              	.LVL17:
 243              	.L16:
 434:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 435:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 436:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 437:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 438:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me = (optiga_crypt_t *)pal_os_calloc(1, sizeof(optiga_crypt_t));
 244              	 .loc 1 438 0
 245 000e 0120     	 movs r0,#1
 246              	.LVL18:
 247 0010 3021     	 movs r1,#48
 248              	.LVL19:
 249 0012 FFF7FEFF 	 bl pal_os_calloc
 250              	.LVL20:
 439:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (NULL == me)
 251              	 .loc 1 439 0
 252 0016 0446     	 mov r4,r0
 253 0018 0028     	 cmp r0,#0
 254 001a F6D0     	 beq .L18
 440:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 441:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 442:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 443:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 444:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->handler = handler;
 445:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->caller_context = caller_context;
 446:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->instance_state = OPTIGA_LIB_SUCCESS;
 255              	 .loc 1 446 0
 256 001c 0023     	 movs r3,#0
 447:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 448:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->protocol_version = OPTIGA_COMMS_PROTOCOL_VERSION_PRE_SHARED_SECRET;
 257              	 .loc 1 448 0
 258 001e 0122     	 movs r2,#1
 444:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->caller_context = caller_context;
 259              	 .loc 1 444 0
 260 0020 8562     	 str r5,[r0,#40]
 261              	 .loc 1 448 0
 262 0022 80F82F20 	 strb r2,[r0,#47]
 445:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->instance_state = OPTIGA_LIB_SUCCESS;
 263              	 .loc 1 445 0
 264 0026 4762     	 str r7,[r0,#36]
 446:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 265              	 .loc 1 446 0
 266 0028 8385     	 strh r3,[r0,#44]
 449:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->protection_level = OPTIGA_COMMS_DEFAULT_PROTECTION_LEVEL;
 267              	 .loc 1 449 0
 268 002a 80F82E30 	 strb r3,[r0,#46]
 450:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 451:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         me->my_cmd = optiga_cmd_create(optiga_instance_id,
 269              	 .loc 1 451 0
 270 002e 0749     	 ldr r1,.L22
 271 0030 3046     	 mov r0,r6
 272              	.LVL21:
 273 0032 2246     	 mov r2,r4
 274 0034 FFF7FEFF 	 bl optiga_cmd_create
 275              	.LVL22:
 276 0038 0546     	 mov r5,r0
 277              	.LVL23:
 278 003a 2062     	 str r0,[r4,#32]
 452:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                        optiga_crypt_generic_event_handler,
 453:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                        me);
 454:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (NULL == me->my_cmd)
 279              	 .loc 1 454 0
 280 003c 18B9     	 cbnz r0,.L17
 455:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 456:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             pal_os_free(me);
 281              	 .loc 1 456 0
 282 003e 2046     	 mov r0,r4
 283 0040 FFF7FEFF 	 bl pal_os_free
 284              	.LVL24:
 457:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             me = NULL;
 285              	 .loc 1 457 0
 286 0044 2C46     	 mov r4,r5
 287              	.LVL25:
 288              	.L17:
 458:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 459:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 460:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 461:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 462:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (me);
 463:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 289              	 .loc 1 463 0
 290 0046 2046     	 mov r0,r4
 291 0048 F8BD     	 pop {r3,r4,r5,r6,r7,pc}
 292              	.LVL26:
 293              	.L23:
 294 004a 00BF     	 .align 2
 295              	.L22:
 296 004c 00000000 	 .word optiga_crypt_generic_event_handler
 297              	 .cfi_endproc
 298              	.LFE8:
 300              	 .section .text.optiga_crypt_destroy,"ax",%progbits
 301              	 .align 1
 302              	 .global optiga_crypt_destroy
 303              	 .thumb
 304              	 .thumb_func
 306              	optiga_crypt_destroy:
 307              	.LFB9:
 464:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 465:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_destroy(optiga_crypt_t * me)
 466:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 308              	 .loc 1 466 0
 309              	 .cfi_startproc
 310              	 
 311              	 
 312              	.LVL27:
 313 0000 38B5     	 push {r3,r4,r5,lr}
 314              	.LCFI2:
 315              	 .cfi_def_cfa_offset 16
 316              	 .cfi_offset 3,-16
 317              	 .cfi_offset 4,-12
 318              	 .cfi_offset 5,-8
 319              	 .cfi_offset 14,-4
 467:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value;
 468:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 469:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 470:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 471:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 472:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (NULL == me)
 320              	 .loc 1 472 0
 321 0002 0446     	 mov r4,r0
 322 0004 50B1     	 cbz r0,.L26
 473:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 474:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 475:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 476:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 477:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 478:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if (OPTIGA_LIB_INSTANCE_BUSY == me->instance_state)
 323              	 .loc 1 478 0
 324 0006 838D     	 ldrh r3,[r0,#44]
 325 0008 012B     	 cmp r3,#1
 326 000a 0AD0     	 beq .L27
 479:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INSTANCE_IN_USE;
 481:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 482:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 483:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_cmd_destroy(me->my_cmd);
 327              	 .loc 1 483 0
 328 000c 006A     	 ldr r0,[r0,#32]
 329              	.LVL28:
 330 000e FFF7FEFF 	 bl optiga_cmd_destroy
 331              	.LVL29:
 332 0012 0546     	 mov r5,r0
 333              	.LVL30:
 484:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         pal_os_free(me);
 334              	 .loc 1 484 0
 335 0014 2046     	 mov r0,r4
 336 0016 FFF7FEFF 	 bl pal_os_free
 337              	.LVL31:
 338 001a 04E0     	 b .L25
 339              	.LVL32:
 340              	.L26:
 474:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 341              	 .loc 1 474 0
 342 001c 40F20345 	 movw r5,#1027
 343 0020 01E0     	 b .L25
 344              	.L27:
 480:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 345              	 .loc 1 480 0
 346 0022 40F20545 	 movw r5,#1029
 347              	.LVL33:
 348              	.L25:
 485:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 486:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 487:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 488:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 349              	 .loc 1 488 0
 350 0026 2846     	 mov r0,r5
 351 0028 38BD     	 pop {r3,r4,r5,pc}
 352              	 .cfi_endproc
 353              	.LFE9:
 355              	 .section .text.optiga_crypt_random,"ax",%progbits
 356              	 .align 1
 357              	 .global optiga_crypt_random
 358              	 .thumb
 359              	 .thumb_func
 361              	optiga_crypt_random:
 362              	.LFB10:
 489:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 490:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_RANDOM_ENABLED
 491:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_random(optiga_crypt_t * me,
 492:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                         optiga_rng_type_t rng_type,
 493:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                         uint8_t * random_data,
 494:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                         uint16_t random_data_length)
 495:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 363              	 .loc 1 495 0
 364              	 .cfi_startproc
 365              	 
 366              	 
 367              	.LVL34:
 368 0000 2DE9F843 	 push {r3,r4,r5,r6,r7,r8,r9,lr}
 369              	.LCFI3:
 370              	 .cfi_def_cfa_offset 32
 371              	 .cfi_offset 3,-32
 372              	 .cfi_offset 4,-28
 373              	 .cfi_offset 5,-24
 374              	 .cfi_offset 6,-20
 375              	 .cfi_offset 7,-16
 376              	 .cfi_offset 8,-12
 377              	 .cfi_offset 9,-8
 378              	 .cfi_offset 14,-4
 379              	 .loc 1 495 0
 380 0004 8846     	 mov r8,r1
 381 0006 1746     	 mov r7,r2
 382 0008 9946     	 mov r9,r3
 496:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 497:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     OPTIGA_CRYPT_LOG_MESSAGE(__FUNCTION__);
 498:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 499:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 500:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 501:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((NULL == me) || (NULL == me->my_cmd) || (NULL == random_data))
 383              	 .loc 1 501 0
 384 000a 0446     	 mov r4,r0
 385 000c 60B3     	 cbz r0,.L33
 386              	 .loc 1 501 0 is_stmt 0 discriminator 1
 387 000e 036A     	 ldr r3,[r0,#32]
 388              	.LVL35:
 389 0010 53B3     	 cbz r3,.L33
 390              	 .loc 1 501 0 discriminator 2
 391 0012 4AB3     	 cbz r2,.L33
 392              	.LVL36:
 393              	.LBB15:
 394              	.LBB16:
 306:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 395              	 .loc 1 306 0 is_stmt 1
 396 0014 838D     	 ldrh r3,[r0,#44]
 397 0016 012B     	 cmp r3,#1
 398 0018 1FD0     	 beq .L34
 312:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_get_random_params_t *)&(me->params.optiga_get_random_params);
 399              	 .loc 1 312 0
 400 001a 0126     	 movs r6,#1
 316:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->optional_data_length = optional_data_length;
 401              	 .loc 1 316 0
 402 001c 0025     	 movs r5,#0
 312:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_get_random_params_t *)&(me->params.optiga_get_random_params);
 403              	 .loc 1 312 0
 404 001e 8685     	 strh r6,[r0,#44]
 405              	.LVL37:
 314:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 406              	 .loc 1 314 0
 407 0020 0021     	 movs r1,#0
 408              	.LVL38:
 409 0022 2022     	 movs r2,#32
 410              	.LVL39:
 411 0024 FFF7FEFF 	 bl pal_os_memset
 412              	.LVL40:
 320:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 413              	 .loc 1 320 0
 414 0028 206A     	 ldr r0,[r4,#32]
 415 002a 94F82E10 	 ldrb r1,[r4,#46]
 316:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->optional_data_length = optional_data_length;
 416              	 .loc 1 316 0
 417 002e A560     	 str r5,[r4,#8]
 320:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 418              	 .loc 1 320 0
 419 0030 2A46     	 mov r2,r5
 317:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->random_data = p_random_data;
 420              	 .loc 1 317 0
 421 0032 6580     	 strh r5,[r4,#2]
 318:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->random_data_length = random_data_length;
 422              	 .loc 1 318 0
 423 0034 6760     	 str r7,[r4,#4]
 319:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_ENABLE(me->my_cmd, me);
 424              	 .loc 1 319 0
 425 0036 A4F80090 	 strh r9,[r4]
 320:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 426              	 .loc 1 320 0
 427 003a FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 428              	.LVL41:
 321:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 429              	 .loc 1 321 0
 430 003e 206A     	 ldr r0,[r4,#32]
 431 0040 94F82F10 	 ldrb r1,[r4,#47]
 432 0044 3246     	 mov r2,r6
 433 0046 FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 434              	.LVL42:
 323:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              cmd_param,
 435              	 .loc 1 323 0
 436 004a 206A     	 ldr r0,[r4,#32]
 437 004c 4146     	 mov r1,r8
 438 004e 2246     	 mov r2,r4
 439 0050 FFF7FEFF 	 bl optiga_cmd_get_random
 440              	.LVL43:
 326:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 441              	 .loc 1 326 0
 442 0054 18B1     	 cbz r0,.L30
 328:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 443              	 .loc 1 328 0
 444 0056 A585     	 strh r5,[r4,#44]
 445 0058 01E0     	 b .L30
 446              	.LVL44:
 447              	.L34:
 308:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 448              	 .loc 1 308 0
 449 005a 40F20540 	 movw r0,#1029
 450              	.LVL45:
 451              	.L30:
 452              	.LBB17:
 453              	.LBB18:
 454              	.LBB19:
 408:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 455              	 .loc 1 408 0
 456 005e 0023     	 movs r3,#0
 457 0060 84F82E30 	 strb r3,[r4,#46]
 458 0064 BDE8F883 	 pop {r3,r4,r5,r6,r7,r8,r9,pc}
 459              	.LVL46:
 460              	.L33:
 461              	.LBE19:
 462              	.LBE18:
 463              	.LBE17:
 464              	.LBE16:
 465              	.LBE15:
 502:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 503:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 466              	 .loc 1 503 0
 467 0068 40F20340 	 movw r0,#1027
 468              	.LVL47:
 504:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 505:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 506:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 507:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_crypt_get_random(me,
 508:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                (uint8_t)rng_type,
 509:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                random_data,
 510:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                random_data_length,
 511:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                NULL,
 512:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                0x00);
 513:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 514:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 515:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 516:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 469              	 .loc 1 516 0
 470 006c BDE8F883 	 pop {r3,r4,r5,r6,r7,r8,r9,pc}
 471              	 .cfi_endproc
 472              	.LFE10:
 474              	 .section .text.optiga_crypt_hash_start,"ax",%progbits
 475              	 .align 1
 476              	 .global optiga_crypt_hash_start
 477              	 .thumb
 478              	 .thumb_func
 480              	optiga_crypt_hash_start:
 481              	.LFB11:
 517:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif //OPTIGA_CRYPT_RANDOM_ENABLED
 518:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 519:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_HASH_ENABLED
 520:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_hash_start(optiga_crypt_t * me,
 521:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             optiga_hash_context_t * hash_ctx)
 522:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 482              	 .loc 1 522 0
 483              	 .cfi_startproc
 484              	 
 485              	 
 486              	.LVL48:
 487 0000 7FB5     	 push {r0,r1,r2,r3,r4,r5,r6,lr}
 488              	.LCFI4:
 489              	 .cfi_def_cfa_offset 32
 490              	 .cfi_offset 14,-4
 491              	 .loc 1 522 0
 492 0002 0B46     	 mov r3,r1
 523:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 524:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     OPTIGA_CRYPT_LOG_MESSAGE(__FUNCTION__);
 525:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do  
 526:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 527:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 528:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((NULL == me) || (NULL == me->my_cmd) || (NULL == hash_ctx))
 493              	 .loc 1 528 0
 494 0004 70B1     	 cbz r0,.L42
 495              	 .loc 1 528 0 is_stmt 0 discriminator 1
 496 0006 026A     	 ldr r2,[r0,#32]
 497 0008 62B1     	 cbz r2,.L42
 498              	 .loc 1 528 0 discriminator 2
 499 000a 59B1     	 cbz r1,.L42
 529:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 530:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 531:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 532:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 533:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 534:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_crypt_hash_generic(me,
 500              	 .loc 1 534 0 is_stmt 1
 501 000c 097A     	 ldrb r1,[r1,#8]
 502              	.LVL49:
 503 000e 0093     	 str r3,[sp]
 504 0010 0022     	 movs r2,#0
 505 0012 0123     	 movs r3,#1
 506              	.LVL50:
 507 0014 0393     	 str r3,[sp,#12]
 508 0016 0192     	 str r2,[sp,#4]
 509 0018 0292     	 str r2,[sp,#8]
 510 001a 0492     	 str r2,[sp,#16]
 511 001c 1346     	 mov r3,r2
 512 001e FFF7FEFF 	 bl optiga_crypt_hash_generic
 513              	.LVL51:
 514 0022 01E0     	 b .L39
 515              	.LVL52:
 516              	.L42:
 530:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 517              	 .loc 1 530 0
 518 0024 40F20340 	 movw r0,#1027
 519              	.LVL53:
 520              	.L39:
 535:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_ctx->hash_algo,
 536:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  OPTIGA_CRYPT_HASH_START,
 537:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  0,
 538:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_ctx,
 539:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  0,
 540:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  NULL,
 541:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  TRUE,
 542:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  NULL);
 543:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 544:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 545:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 546:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 521              	 .loc 1 546 0
 522 0028 07B0     	 add sp,sp,#28
 523              	.LCFI5:
 524              	 .cfi_def_cfa_offset 4
 525              	 
 526 002a 5DF804FB 	 ldr pc,[sp],#4
 527              	 .cfi_endproc
 528              	.LFE11:
 530              	 .section .text.optiga_crypt_hash_update,"ax",%progbits
 531              	 .align 1
 532              	 .global optiga_crypt_hash_update
 533              	 .thumb
 534              	 .thumb_func
 536              	optiga_crypt_hash_update:
 537              	.LFB12:
 547:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 548:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_hash_update(optiga_crypt_t * me,
 549:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              optiga_hash_context_t * hash_ctx,
 550:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              uint8_t source_of_data_to_hash,
 551:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              const void * data_to_hash)
 552:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 538              	 .loc 1 552 0
 539              	 .cfi_startproc
 540              	 
 541              	 
 542              	.LVL54:
 543 0000 10B5     	 push {r4,lr}
 544              	.LCFI6:
 545              	 .cfi_def_cfa_offset 8
 546              	 .cfi_offset 4,-8
 547              	 .cfi_offset 14,-4
 548 0002 1446     	 mov r4,r2
 549 0004 86B0     	 sub sp,sp,#24
 550              	.LCFI7:
 551              	 .cfi_def_cfa_offset 32
 553:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 554:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     OPTIGA_CRYPT_LOG_MESSAGE(__FUNCTION__);
 555:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 556:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 557:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 558:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((NULL == me) || (NULL == me->my_cmd) ||
 552              	 .loc 1 558 0
 553 0006 90B1     	 cbz r0,.L48
 554              	 .loc 1 558 0 is_stmt 0 discriminator 1
 555 0008 026A     	 ldr r2,[r0,#32]
 556              	.LVL55:
 557 000a 82B1     	 cbz r2,.L48
 558              	 .loc 1 558 0 discriminator 2
 559 000c 79B1     	 cbz r1,.L48
 559:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             (NULL == hash_ctx) || (NULL == data_to_hash))
 560              	 .loc 1 559 0 is_stmt 1
 561 000e 73B1     	 cbz r3,.L48
 560:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 561:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 562:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 563:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 564:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 565:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_crypt_hash_generic(me,
 562              	 .loc 1 565 0
 563 0010 0A7A     	 ldrb r2,[r1,#8]
 564 0012 0091     	 str r1,[sp]
 565 0014 4968     	 ldr r1,[r1,#4]
 566              	.LVL56:
 567 0016 0293     	 str r3,[sp,#8]
 568 0018 0123     	 movs r3,#1
 569              	.LVL57:
 570 001a 0393     	 str r3,[sp,#12]
 571 001c 0023     	 movs r3,#0
 572 001e 0191     	 str r1,[sp,#4]
 573 0020 0493     	 str r3,[sp,#16]
 574 0022 1146     	 mov r1,r2
 575 0024 2346     	 mov r3,r4
 576 0026 0222     	 movs r2,#2
 577 0028 FFF7FEFF 	 bl optiga_crypt_hash_generic
 578              	.LVL58:
 579 002c 01E0     	 b .L44
 580              	.LVL59:
 581              	.L48:
 561:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 582              	 .loc 1 561 0
 583 002e 40F20340 	 movw r0,#1027
 584              	.LVL60:
 585              	.L44:
 566:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_ctx->hash_algo,
 567:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  OPTIGA_CRYPT_HASH_CONTINUE,
 568:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  source_of_data_to_hash,
 569:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_ctx,
 570:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_ctx->context_buffer_length,
 571:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  data_to_hash,
 572:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  TRUE,
 573:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  NULL);
 574:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 575:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 576:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 577:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 586              	 .loc 1 577 0
 587 0032 06B0     	 add sp,sp,#24
 588              	.LCFI8:
 589              	 .cfi_def_cfa_offset 8
 590              	 
 591 0034 10BD     	 pop {r4,pc}
 592              	 .cfi_endproc
 593              	.LFE12:
 595              	 .section .text.optiga_crypt_hash_finalize,"ax",%progbits
 596              	 .align 1
 597              	 .global optiga_crypt_hash_finalize
 598              	 .thumb
 599              	 .thumb_func
 601              	optiga_crypt_hash_finalize:
 602              	.LFB13:
 578:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 579:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_hash_finalize(optiga_crypt_t * me,
 580:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                optiga_hash_context_t * hash_ctx,
 581:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                uint8_t * hash_output)
 582:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 603              	 .loc 1 582 0
 604              	 .cfi_startproc
 605              	 
 606              	 
 607              	.LVL61:
 608 0000 7FB5     	 push {r0,r1,r2,r3,r4,r5,r6,lr}
 609              	.LCFI9:
 610              	 .cfi_def_cfa_offset 32
 611              	 .cfi_offset 14,-4
 612              	 .loc 1 582 0
 613 0002 0B46     	 mov r3,r1
 583:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 584:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     OPTIGA_CRYPT_LOG_MESSAGE(__FUNCTION__);
 585:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 586:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 587:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 588:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((NULL == me) || (NULL == me->my_cmd) ||
 614              	 .loc 1 588 0
 615 0004 78B1     	 cbz r0,.L54
 616              	 .loc 1 588 0 is_stmt 0 discriminator 1
 617 0006 016A     	 ldr r1,[r0,#32]
 618              	.LVL62:
 619 0008 69B1     	 cbz r1,.L54
 620              	 .loc 1 588 0 discriminator 2
 621 000a 63B1     	 cbz r3,.L54
 589:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             (NULL == hash_ctx) || (NULL == hash_output))
 622              	 .loc 1 589 0 is_stmt 1
 623 000c 5AB1     	 cbz r2,.L54
 590:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 591:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 592:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 593:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 594:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 595:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_crypt_hash_generic(me,
 624              	 .loc 1 595 0
 625 000e 197A     	 ldrb r1,[r3,#8]
 626 0010 0093     	 str r3,[sp]
 627 0012 5B68     	 ldr r3,[r3,#4]
 628              	.LVL63:
 629 0014 0193     	 str r3,[sp,#4]
 630 0016 0023     	 movs r3,#0
 631 0018 0492     	 str r2,[sp,#16]
 632 001a 0293     	 str r3,[sp,#8]
 633 001c 0393     	 str r3,[sp,#12]
 634 001e 0322     	 movs r2,#3
 635              	.LVL64:
 636 0020 FFF7FEFF 	 bl optiga_crypt_hash_generic
 637              	.LVL65:
 638 0024 01E0     	 b .L50
 639              	.LVL66:
 640              	.L54:
 591:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 641              	 .loc 1 591 0
 642 0026 40F20340 	 movw r0,#1027
 643              	.LVL67:
 644              	.L50:
 596:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_ctx->hash_algo,
 597:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  OPTIGA_CRYPT_HASH_FINAL,
 598:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  0,
 599:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_ctx,
 600:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_ctx->context_buffer_length,
 601:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  NULL,
 602:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  FALSE,
 603:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_output);
 604:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 605:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 606:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 607:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 645              	 .loc 1 607 0
 646 002a 07B0     	 add sp,sp,#28
 647              	.LCFI10:
 648              	 .cfi_def_cfa_offset 4
 649              	 
 650 002c 5DF804FB 	 ldr pc,[sp],#4
 651              	 .cfi_endproc
 652              	.LFE13:
 654              	 .section .text.optiga_crypt_hash,"ax",%progbits
 655              	 .align 1
 656              	 .global optiga_crypt_hash
 657              	 .thumb
 658              	 .thumb_func
 660              	optiga_crypt_hash:
 661              	.LFB14:
 608:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 609:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_hash(optiga_crypt_t * me,
 610:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                       optiga_hash_type_t hash_algorithm,
 611:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                       uint8_t source_of_data_to_hash,
 612:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                       const void * data_to_hash, 
 613:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                       uint8_t * hash_output)
 614:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 662              	 .loc 1 614 0
 663              	 .cfi_startproc
 664              	 
 665              	 
 666              	.LVL68:
 667 0000 30B5     	 push {r4,r5,lr}
 668              	.LCFI11:
 669              	 .cfi_def_cfa_offset 12
 670              	 .cfi_offset 4,-12
 671              	 .cfi_offset 5,-8
 672              	 .cfi_offset 14,-4
 673 0002 87B0     	 sub sp,sp,#28
 674              	.LCFI12:
 675              	 .cfi_def_cfa_offset 40
 676              	 .loc 1 614 0
 677 0004 1546     	 mov r5,r2
 678 0006 0A9C     	 ldr r4,[sp,#40]
 615:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     optiga_lib_status_t return_value = OPTIGA_CRYPT_ERROR;
 616:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     OPTIGA_CRYPT_LOG_MESSAGE(__FUNCTION__);
 617:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     do
 618:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     {
 619:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 620:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         if ((NULL == me) || (NULL == me->my_cmd) || (NULL == data_to_hash) || (NULL == hash_output)
 679              	 .loc 1 620 0
 680 0008 70B1     	 cbz r0,.L60
 681              	 .loc 1 620 0 is_stmt 0 discriminator 1
 682 000a 026A     	 ldr r2,[r0,#32]
 683              	.LVL69:
 684 000c 62B1     	 cbz r2,.L60
 685              	 .loc 1 620 0 discriminator 2
 686 000e 5BB1     	 cbz r3,.L60
 687              	 .loc 1 620 0 discriminator 3
 688 0010 54B1     	 cbz r4,.L60
 621:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 622:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             return_value = OPTIGA_CRYPT_ERROR_INVALID_INPUT;
 623:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 624:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 625:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif
 626:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         return_value = optiga_crypt_hash_generic(me,
 689              	 .loc 1 626 0 is_stmt 1
 690 0012 0022     	 movs r2,#0
 691 0014 0092     	 str r2,[sp]
 692 0016 0192     	 str r2,[sp,#4]
 693 0018 0293     	 str r3,[sp,#8]
 694 001a 0392     	 str r2,[sp,#12]
 695 001c 0494     	 str r4,[sp,#16]
 696 001e 0122     	 movs r2,#1
 697 0020 2B46     	 mov r3,r5
 698              	.LVL70:
 699 0022 FFF7FEFF 	 bl optiga_crypt_hash_generic
 700              	.LVL71:
 701 0026 01E0     	 b .L56
 702              	.LVL72:
 703              	.L60:
 622:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 704              	 .loc 1 622 0
 705 0028 40F20340 	 movw r0,#1027
 706              	.LVL73:
 707              	.L56:
 627:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  (uint8_t)hash_algorithm,
 628:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  OPTIGA_CRYPT_HASH_START_FINAL,
 629:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  source_of_data_to_hash,
 630:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  NULL,
 631:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  0,
 632:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  data_to_hash,
 633:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  FALSE,
 634:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                  hash_output);
 635:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     } while (FALSE);
 636:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 637:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (return_value);
 638:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 708              	 .loc 1 638 0
 709 002c 07B0     	 add sp,sp,#28
 710              	.LCFI13:
 711              	 .cfi_def_cfa_offset 12
 712              	 
 713 002e 30BD     	 pop {r4,r5,pc}
 714              	 .cfi_endproc
 715              	.LFE14:
 717              	 .section .text.optiga_crypt_ecc_generate_keypair,"ax",%progbits
 718              	 .align 1
 719              	 .global optiga_crypt_ecc_generate_keypair
 720              	 .thumb
 721              	 .thumb_func
 723              	optiga_crypt_ecc_generate_keypair:
 724              	.LFB15:
 639:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif //OPTIGA_CRYPT_HASH_ENABLED
 640:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 641:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED
 642:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_ecc_generate_keypair(optiga_crypt_t * me,
 643:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       optiga_ecc_curve_t curve_id,
 644:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint8_t key_usage,
 645:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       bool_t export_private_key,
 646:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       void * private_key,
 647:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint8_t * public_key,
 648:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                                       uint16_t * public_key_length)
 649:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 725              	 .loc 1 649 0
 726              	 .cfi_startproc
 727              	 
 728              	 
 729              	.LVL74:
 730 0000 2DE9F84F 	 push {r3,r4,r5,r6,r7,r8,r9,r10,fp,lr}
 731              	.LCFI14:
 732              	 .cfi_def_cfa_offset 40
 733              	 .cfi_offset 3,-40
 734              	 .cfi_offset 4,-36
 735              	 .cfi_offset 5,-32
 736              	 .cfi_offset 6,-28
 737              	 .cfi_offset 7,-24
 738              	 .cfi_offset 8,-20
 739              	 .cfi_offset 9,-16
 740              	 .cfi_offset 10,-12
 741              	 .cfi_offset 11,-8
 742              	 .cfi_offset 14,-4
 743              	 .loc 1 649 0
 744 0004 0A9E     	 ldr r6,[sp,#40]
 745 0006 0B9F     	 ldr r7,[sp,#44]
 746 0008 0C9D     	 ldr r5,[sp,#48]
 747 000a 8A46     	 mov r10,r1
 748              	.LVL75:
 749 000c 9346     	 mov fp,r2
 750              	.LVL76:
 751 000e 9846     	 mov r8,r3
 752              	.LVL77:
 753              	.LBB26:
 754              	.LBB27:
 124:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             (NULL == p_public_key) || (NULL == p_private_key) || (NULL == p_public_key_length))
 755              	 .loc 1 124 0
 756 0010 0446     	 mov r4,r0
 757 0012 78B3     	 cbz r0,.L66
 758 0014 036A     	 ldr r3,[r0,#32]
 759              	.LVL78:
 760 0016 8BB3     	 cbz r3,.L70
 761 0018 87B3     	 cbz r7,.L70
 125:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 762              	 .loc 1 125 0
 763 001a 7EB3     	 cbz r6,.L70
 764 001c 75B3     	 cbz r5,.L70
 131:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 765              	 .loc 1 131 0
 766 001e 838D     	 ldrh r3,[r0,#44]
 767 0020 012B     	 cmp r3,#1
 768 0022 2ED0     	 beq .L71
 137:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_gen_keypair_params_t *)&(me->params.optiga_gen_keypair_params);
 769              	 .loc 1 137 0
 770 0024 4FF00109 	 mov r9,#1
 771 0028 A0F82C90 	 strh r9,[r0,#44]
 772              	.LVL79:
 139:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 773              	 .loc 1 139 0
 774 002c 0021     	 movs r1,#0
 775              	.LVL80:
 776 002e 2022     	 movs r2,#32
 777              	.LVL81:
 778 0030 FFF7FEFF 	 bl pal_os_memset
 779              	.LVL82:
 144:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 780              	 .loc 1 144 0
 781 0034 206A     	 ldr r0,[r4,#32]
 782 0036 94F82E10 	 ldrb r1,[r4,#46]
 141:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->export_private_key = export_private_key;
 783              	 .loc 1 141 0
 784 003a 84F800B0 	 strb fp,[r4]
 144:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 785              	 .loc 1 144 0
 786 003e 0022     	 movs r2,#0
 142:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->public_key_length = p_public_key_length;
 787              	 .loc 1 142 0
 788 0040 84F80180 	 strb r8,[r4,#1]
 143:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_ENABLE(me->my_cmd, me);
 789              	 .loc 1 143 0
 790 0044 2561     	 str r5,[r4,#16]
 144:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 791              	 .loc 1 144 0
 792 0046 FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 793              	.LVL83:
 145:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 794              	 .loc 1 145 0
 795 004a 206A     	 ldr r0,[r4,#32]
 796 004c 94F82F10 	 ldrb r1,[r4,#47]
 797 0050 4A46     	 mov r2,r9
 798 0052 FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 799              	.LVL84:
 147:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 800              	 .loc 1 147 0
 801 0056 B8F1000F 	 cmp r8,#0
 802 005a 01D0     	 beq .L64
 149:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 803              	 .loc 1 149 0
 804 005c 6660     	 str r6,[r4,#4]
 805 005e 01E0     	 b .L65
 806              	.L64:
 153:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 807              	 .loc 1 153 0
 808 0060 3388     	 ldrh r3,[r6]
 809 0062 6380     	 strh r3,[r4,#2]
 810              	.L65:
 156:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->public_key_length = p_public_key_length;
 811              	 .loc 1 156 0
 812 0064 E760     	 str r7,[r4,#12]
 157:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 813              	 .loc 1 157 0
 814 0066 2561     	 str r5,[r4,#16]
 159:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               (uint8_t )cmd_param,
 815              	 .loc 1 159 0
 816 0068 206A     	 ldr r0,[r4,#32]
 817 006a 5146     	 mov r1,r10
 818 006c 2246     	 mov r2,r4
 819 006e FFF7FEFF 	 bl optiga_cmd_gen_keypair
 820              	.LVL85:
 821 0072 08E0     	 b .L63
 822              	.LVL86:
 823              	.L66:
 127:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 824              	 .loc 1 127 0
 825 0074 40F20340 	 movw r0,#1027
 826              	.LVL87:
 827 0078 BDE8F88F 	 pop {r3,r4,r5,r6,r7,r8,r9,r10,fp,pc}
 828              	.LVL88:
 829              	.L70:
 830 007c 40F20340 	 movw r0,#1027
 831              	.LVL89:
 832 0080 01E0     	 b .L63
 833              	.LVL90:
 834              	.L71:
 133:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 835              	 .loc 1 133 0
 836 0082 40F20540 	 movw r0,#1029
 837              	.LVL91:
 838              	.L63:
 839              	.LBB28:
 840              	.LBB29:
 841              	.LBB30:
 408:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 842              	 .loc 1 408 0
 843 0086 0023     	 movs r3,#0
 844 0088 84F82E30 	 strb r3,[r4,#46]
 845              	.LBE30:
 846              	.LBE29:
 847              	.LBE28:
 848              	.LBE27:
 849              	.LBE26:
 650:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     OPTIGA_CRYPT_LOG_MESSAGE(__FUNCTION__);
 651:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (optiga_crypt_generate_keypair(me,
 652:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                          (uint8_t)curve_id,
 653:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                          key_usage,
 654:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                          export_private_key,
 655:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                          private_key,
 656:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                          public_key,
 657:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                          public_key_length));
 658:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 850              	 .loc 1 658 0
 851 008c BDE8F88F 	 pop {r3,r4,r5,r6,r7,r8,r9,r10,fp,pc}
 852              	 .cfi_endproc
 853              	.LFE15:
 855              	 .section .text.optiga_crypt_ecdsa_sign,"ax",%progbits
 856              	 .align 1
 857              	 .global optiga_crypt_ecdsa_sign
 858              	 .thumb
 859              	 .thumb_func
 861              	optiga_crypt_ecdsa_sign:
 862              	.LFB16:
 659:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif //OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED
 660:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 661:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_ECDSA_SIGN_ENABLED
 662:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_ecdsa_sign(optiga_crypt_t * me,
 663:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             const uint8_t * digest,
 664:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             uint8_t digest_length,
 665:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             optiga_key_id_t private_key,
 666:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             uint8_t * signature,
 667:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             uint16_t * signature_length)
 668:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 863              	 .loc 1 668 0
 864              	 .cfi_startproc
 865              	 
 866              	 
 867              	.LVL92:
 868 0000 2DE9F047 	 push {r4,r5,r6,r7,r8,r9,r10,lr}
 869              	.LCFI15:
 870              	 .cfi_def_cfa_offset 32
 871              	 .cfi_offset 4,-32
 872              	 .cfi_offset 5,-28
 873              	 .cfi_offset 6,-24
 874              	 .cfi_offset 7,-20
 875              	 .cfi_offset 8,-16
 876              	 .cfi_offset 9,-12
 877              	 .cfi_offset 10,-8
 878              	 .cfi_offset 14,-4
 879              	 .loc 1 668 0
 880 0004 089F     	 ldr r7,[sp,#32]
 881 0006 099E     	 ldr r6,[sp,#36]
 882 0008 8846     	 mov r8,r1
 883 000a 9246     	 mov r10,r2
 884              	.LVL93:
 885 000c 9946     	 mov r9,r3
 886              	.LVL94:
 887              	.LBB37:
 888              	.LBB38:
 186:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             (NULL == p_signature) || (NULL == p_signature_length))
 889              	 .loc 1 186 0
 890 000e 0446     	 mov r4,r0
 891 0010 50B3     	 cbz r0,.L76
 892 0012 036A     	 ldr r3,[r0,#32]
 893              	.LVL95:
 894 0014 63B3     	 cbz r3,.L80
 895 0016 59B3     	 cbz r1,.L80
 896 0018 57B3     	 cbz r7,.L80
 187:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 897              	 .loc 1 187 0
 898 001a 4EB3     	 cbz r6,.L80
 194:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 899              	 .loc 1 194 0
 900 001c 838D     	 ldrh r3,[r0,#44]
 901 001e 012B     	 cmp r3,#1
 902 0020 29D0     	 beq .L81
 200:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 903              	 .loc 1 200 0
 904 0022 0125     	 movs r5,#1
 905 0024 8585     	 strh r5,[r0,#44]
 906              	.LVL96:
 203:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 907              	 .loc 1 203 0
 908 0026 0021     	 movs r1,#0
 909              	.LVL97:
 910 0028 2022     	 movs r2,#32
 911              	.LVL98:
 912 002a FFF7FEFF 	 bl pal_os_memset
 913              	.LVL99:
 210:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 914              	 .loc 1 210 0
 915 002e 206A     	 ldr r0,[r4,#32]
 916 0030 94F82E10 	 ldrb r1,[r4,#46]
 205:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->digest_length = digest_length;
 917              	 .loc 1 205 0
 918 0034 C4F80080 	 str r8,[r4]
 210:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 919              	 .loc 1 210 0
 920 0038 0022     	 movs r2,#0
 206:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->private_key_oid = private_key;
 921              	 .loc 1 206 0
 922 003a 84F80EA0 	 strb r10,[r4,#14]
 207:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_signature = p_signature;
 923              	 .loc 1 207 0
 924 003e A4F80C90 	 strh r9,[r4,#12]
 208:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_signature_length = p_signature_length;
 925              	 .loc 1 208 0
 926 0042 6760     	 str r7,[r4,#4]
 209:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_ENABLE(me->my_cmd, me);
 927              	 .loc 1 209 0
 928 0044 A660     	 str r6,[r4,#8]
 210:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 929              	 .loc 1 210 0
 930 0046 FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 931              	.LVL100:
 211:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 932              	 .loc 1 211 0
 933 004a 206A     	 ldr r0,[r4,#32]
 934 004c 94F82F10 	 ldrb r1,[r4,#47]
 935 0050 2A46     	 mov r2,r5
 936 0052 FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 937              	.LVL101:
 213:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                             signature_scheme,
 938              	 .loc 1 213 0
 939 0056 206A     	 ldr r0,[r4,#32]
 940 0058 1121     	 movs r1,#17
 941 005a 2246     	 mov r2,r4
 942 005c FFF7FEFF 	 bl optiga_cmd_calc_sign
 943              	.LVL102:
 216:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 944              	 .loc 1 216 0
 945 0060 58B1     	 cbz r0,.L75
 218:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 946              	 .loc 1 218 0
 947 0062 0023     	 movs r3,#0
 948 0064 A385     	 strh r3,[r4,#44]
 949 0066 08E0     	 b .L75
 950              	.LVL103:
 951              	.L76:
 189:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 952              	 .loc 1 189 0
 953 0068 40F20340 	 movw r0,#1027
 954              	.LVL104:
 955 006c BDE8F087 	 pop {r4,r5,r6,r7,r8,r9,r10,pc}
 956              	.LVL105:
 957              	.L80:
 958 0070 40F20340 	 movw r0,#1027
 959              	.LVL106:
 960 0074 01E0     	 b .L75
 961              	.LVL107:
 962              	.L81:
 196:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 963              	 .loc 1 196 0
 964 0076 40F20540 	 movw r0,#1029
 965              	.LVL108:
 966              	.L75:
 967              	.LBB39:
 968              	.LBB40:
 969              	.LBB41:
 408:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 970              	 .loc 1 408 0
 971 007a 0023     	 movs r3,#0
 972 007c 84F82E30 	 strb r3,[r4,#46]
 973              	.LBE41:
 974              	.LBE40:
 975              	.LBE39:
 976              	.LBE38:
 977              	.LBE37:
 669:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     OPTIGA_CRYPT_LOG_MESSAGE(__FUNCTION__);
 670:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (optiga_crypt_sign(me,
 671:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                               OPTIGA_CRYPT_ECDSA_FIPS_186_3_WITHOUT_HASH,
 672:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                               digest,
 673:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                               digest_length,
 674:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                               private_key,
 675:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                               signature,
 676:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                               signature_length,
 677:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                               0x0000));
 678:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 978              	 .loc 1 678 0
 979 0080 BDE8F087 	 pop {r4,r5,r6,r7,r8,r9,r10,pc}
 980              	 .cfi_endproc
 981              	.LFE16:
 983              	 .section .text.optiga_crypt_ecdsa_verify,"ax",%progbits
 984              	 .align 1
 985              	 .global optiga_crypt_ecdsa_verify
 986              	 .thumb
 987              	 .thumb_func
 989              	optiga_crypt_ecdsa_verify:
 990              	.LFB17:
 679:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #endif //OPTIGA_CRYPT_ECDSA_SIGN_ENABLED
 680:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 681:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** #ifdef OPTIGA_CRYPT_ECDSA_VERIFY_ENABLED
 682:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** optiga_lib_status_t optiga_crypt_ecdsa_verify(optiga_crypt_t * me,
 683:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               const uint8_t * digest,
 684:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               uint8_t digest_length,
 685:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               const uint8_t * signature,
 686:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               uint16_t signature_length,
 687:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               uint8_t public_key_source_type,
 688:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                               const void * public_key)
 689:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** {
 991              	 .loc 1 689 0
 992              	 .cfi_startproc
 993              	 
 994              	 
 995              	.LVL109:
 996 0000 2DE9F047 	 push {r4,r5,r6,r7,r8,r9,r10,lr}
 997              	.LCFI16:
 998              	 .cfi_def_cfa_offset 32
 999              	 .cfi_offset 4,-32
 1000              	 .cfi_offset 5,-28
 1001              	 .cfi_offset 6,-24
 1002              	 .cfi_offset 7,-20
 1003              	 .cfi_offset 8,-16
 1004              	 .cfi_offset 9,-12
 1005              	 .cfi_offset 10,-8
 1006              	 .cfi_offset 14,-4
 1007              	 .loc 1 689 0
 1008 0004 0A9D     	 ldr r5,[sp,#40]
 1009 0006 9DF82460 	 ldrb r6,[sp,#36]
 1010 000a 8846     	 mov r8,r1
 1011 000c 9246     	 mov r10,r2
 1012              	.LVL110:
 1013 000e 1F46     	 mov r7,r3
 1014              	.LVL111:
 1015              	.LBB48:
 1016              	.LBB49:
 245:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             (NULL == p_digest) || (NULL == p_signature) || (NULL == p_public_key))
 1017              	 .loc 1 245 0
 1018 0010 0446     	 mov r4,r0
 1019 0012 90B3     	 cbz r0,.L91
 1020 0014 036A     	 ldr r3,[r0,#32]
 1021              	.LVL112:
 1022 0016 A3B3     	 cbz r3,.L95
 1023 0018 99B3     	 cbz r1,.L95
 246:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 1024              	 .loc 1 246 0
 1025 001a 97B3     	 cbz r7,.L95
 1026 001c 8DB3     	 cbz r5,.L95
 253:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 1027              	 .loc 1 253 0
 1028 001e 838D     	 ldrh r3,[r0,#44]
 1029 0020 012B     	 cmp r3,#1
 1030 0022 31D0     	 beq .L96
 259:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params = (optiga_verify_sign_params_t *)&(me->params.optiga_verify_sign_params);
 1031              	 .loc 1 259 0
 1032 0024 4FF00109 	 mov r9,#1
 1033 0028 A0F82C90 	 strh r9,[r0,#44]
 1034              	.LVL113:
 261:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 1035              	 .loc 1 261 0
 1036 002c 0021     	 movs r1,#0
 1037              	.LVL114:
 1038 002e 2022     	 movs r2,#32
 1039              	.LVL115:
 1040 0030 FFF7FEFF 	 bl pal_os_memset
 1041              	.LVL116:
 263:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         OPTIGA_PROTECTION_SET_VERSION(me->my_cmd, me);
 1042              	 .loc 1 263 0
 1043 0034 206A     	 ldr r0,[r4,#32]
 1044 0036 94F82E10 	 ldrb r1,[r4,#46]
 1045 003a 0022     	 movs r2,#0
 1046 003c FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 1047              	.LVL117:
 264:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_digest = p_digest;
 1048              	 .loc 1 264 0
 1049 0040 206A     	 ldr r0,[r4,#32]
 1050 0042 94F82F10 	 ldrb r1,[r4,#47]
 1051 0046 4A46     	 mov r2,r9
 1052 0048 FFF7FEFF 	 bl optiga_cmd_set_shielded_connection_option
 1053              	.LVL118:
 268:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->public_key_source_type = public_key_source_type;
 1054              	 .loc 1 268 0
 1055 004c BDF82030 	 ldrh r3,[sp,#32]
 265:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->digest_length = digest_length;
 1056              	 .loc 1 265 0
 1057 0050 C4F80080 	 str r8,[r4]
 266:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->p_signature = p_signature;
 1058              	 .loc 1 266 0
 1059 0054 84F804A0 	 strb r10,[r4,#4]
 267:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->signature_length = signature_length;
 1060              	 .loc 1 267 0
 1061 0058 A760     	 str r7,[r4,#8]
 268:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         p_params->public_key_source_type = public_key_source_type;
 1062              	 .loc 1 268 0
 1063 005a A381     	 strh r3,[r4,#12]
 269:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** 
 1064              	 .loc 1 269 0
 1065 005c A673     	 strb r6,[r4,#14]
 271:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 1066              	 .loc 1 271 0
 1067 005e 16B9     	 cbnz r6,.L89
 273:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 1068              	 .loc 1 273 0
 1069 0060 2B88     	 ldrh r3,[r5]
 1070 0062 A382     	 strh r3,[r4,#20]
 1071 0064 00E0     	 b .L90
 1072              	.L89:
 277:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 1073              	 .loc 1 277 0
 1074 0066 2561     	 str r5,[r4,#16]
 1075              	.L90:
 280:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                              (uint8_t)cmd_param,
 1076              	 .loc 1 280 0
 1077 0068 206A     	 ldr r0,[r4,#32]
 1078 006a 1121     	 movs r1,#17
 1079 006c 2246     	 mov r2,r4
 1080 006e FFF7FEFF 	 bl optiga_cmd_verify_sign
 1081              	.LVL119:
 283:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         {
 1082              	 .loc 1 283 0
 1083 0072 58B1     	 cbz r0,.L88
 285:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****         }
 1084              	 .loc 1 285 0
 1085 0074 0023     	 movs r3,#0
 1086 0076 A385     	 strh r3,[r4,#44]
 1087 0078 08E0     	 b .L88
 1088              	.LVL120:
 1089              	.L91:
 248:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 1090              	 .loc 1 248 0
 1091 007a 40F20340 	 movw r0,#1027
 1092              	.LVL121:
 1093 007e BDE8F087 	 pop {r4,r5,r6,r7,r8,r9,r10,pc}
 1094              	.LVL122:
 1095              	.L95:
 1096 0082 40F20340 	 movw r0,#1027
 1097              	.LVL123:
 1098 0086 01E0     	 b .L88
 1099              	.LVL124:
 1100              	.L96:
 255:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 1101              	 .loc 1 255 0
 1102 0088 40F20540 	 movw r0,#1029
 1103              	.LVL125:
 1104              	.L88:
 1105              	.LBB50:
 1106              	.LBB51:
 1107              	.LBB52:
 408:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****             break;
 1108              	 .loc 1 408 0
 1109 008c 0023     	 movs r3,#0
 1110 008e 84F82E30 	 strb r3,[r4,#46]
 1111              	.LBE52:
 1112              	.LBE51:
 1113              	.LBE50:
 1114              	.LBE49:
 1115              	.LBE48:
 690:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     OPTIGA_CRYPT_LOG_MESSAGE(__FUNCTION__);
 691:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****     return (optiga_crypt_verify(me,
 692:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                 OPTIGA_CRYPT_ECDSA_FIPS_186_3_WITHOUT_HASH,
 693:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                 digest,
 694:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                 digest_length,
 695:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                 signature,
 696:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                 signature_length,
 697:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                 public_key_source_type,
 698:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                 public_key,
 699:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c ****                                 0x0000));
 700:C:/Users/Yushev/git/optiga-trust-qi/optiga/crypt\optiga_crypt.c **** }
 1116              	 .loc 1 700 0
 1117 0092 BDE8F087 	 pop {r4,r5,r6,r7,r8,r9,r10,pc}
 1118              	 .cfi_endproc
 1119              	.LFE17:
 1121              	 .text
 1122              	.Letext0:
 1123              	 .file 2 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 1124              	 .file 3 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 1125              	 .file 4 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_types.h"
 1126              	 .file 5 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_common.h"
 1127              	 .file 6 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/cmd/optiga_cmd.h"
 1128              	 .file 7 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/optiga_crypt.h"
 1129              	 .file 8 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_os_memory.h"
DEFINED SYMBOLS
                            *ABS*:00000000 optiga_crypt.c
    {standard input}:20     .text.optiga_crypt_generic_event_handler:00000000 $t
    {standard input}:24     .text.optiga_crypt_generic_event_handler:00000000 optiga_crypt_generic_event_handler
    {standard input}:46     .text.optiga_crypt_hash_generic:00000000 $t
    {standard input}:50     .text.optiga_crypt_hash_generic:00000000 optiga_crypt_hash_generic
    {standard input}:178    .text.optiga_crypt_set_comms_params:00000000 $t
    {standard input}:183    .text.optiga_crypt_set_comms_params:00000000 optiga_crypt_set_comms_params
    {standard input}:210    .text.optiga_crypt_create:00000000 $t
    {standard input}:215    .text.optiga_crypt_create:00000000 optiga_crypt_create
    {standard input}:296    .text.optiga_crypt_create:0000004c $d
    {standard input}:301    .text.optiga_crypt_destroy:00000000 $t
    {standard input}:306    .text.optiga_crypt_destroy:00000000 optiga_crypt_destroy
    {standard input}:356    .text.optiga_crypt_random:00000000 $t
    {standard input}:361    .text.optiga_crypt_random:00000000 optiga_crypt_random
    {standard input}:475    .text.optiga_crypt_hash_start:00000000 $t
    {standard input}:480    .text.optiga_crypt_hash_start:00000000 optiga_crypt_hash_start
    {standard input}:531    .text.optiga_crypt_hash_update:00000000 $t
    {standard input}:536    .text.optiga_crypt_hash_update:00000000 optiga_crypt_hash_update
    {standard input}:596    .text.optiga_crypt_hash_finalize:00000000 $t
    {standard input}:601    .text.optiga_crypt_hash_finalize:00000000 optiga_crypt_hash_finalize
    {standard input}:655    .text.optiga_crypt_hash:00000000 $t
    {standard input}:660    .text.optiga_crypt_hash:00000000 optiga_crypt_hash
    {standard input}:718    .text.optiga_crypt_ecc_generate_keypair:00000000 $t
    {standard input}:723    .text.optiga_crypt_ecc_generate_keypair:00000000 optiga_crypt_ecc_generate_keypair
    {standard input}:856    .text.optiga_crypt_ecdsa_sign:00000000 $t
    {standard input}:861    .text.optiga_crypt_ecdsa_sign:00000000 optiga_crypt_ecdsa_sign
    {standard input}:984    .text.optiga_crypt_ecdsa_verify:00000000 $t
    {standard input}:989    .text.optiga_crypt_ecdsa_verify:00000000 optiga_crypt_ecdsa_verify
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
pal_os_memset
optiga_cmd_set_shielded_connection_option
optiga_cmd_calc_hash
pal_os_calloc
optiga_cmd_create
pal_os_free
optiga_cmd_destroy
optiga_cmd_get_random
optiga_cmd_gen_keypair
optiga_cmd_calc_sign
optiga_cmd_verify_sign
