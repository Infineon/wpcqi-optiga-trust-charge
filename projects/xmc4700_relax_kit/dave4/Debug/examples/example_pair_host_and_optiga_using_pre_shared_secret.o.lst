   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,4
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "example_pair_host_and_optiga_using_pre_shared_secret.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.optiga_lib_callback,"ax",%progbits
  20              	 .align 1
  21              	 .thumb
  22              	 .thumb_func
  24              	optiga_lib_callback:
  25              	.LFB0:
  26              	 .file 1 "C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases/example_pair_host_and_optiga_using_pre_shared_secret.c"
   1:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** /**
   2:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * \copyright
   3:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * MIT License
   4:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
   5:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * Copyright (c) 2020 Infineon Technologies AG
   6:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
   7:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * Permission is hereby granted, free of charge, to any person obtaining a copy
   8:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * of this software and associated documentation files (the "Software"), to deal
   9:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * in the Software without restriction, including without limitation the rights
  10:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  11:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * copies of the Software, and to permit persons to whom the Software is
  12:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * furnished to do so, subject to the following conditions:
  13:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
  14:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * The above copyright notice and this permission notice shall be included in all
  15:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * copies or substantial portions of the Software.
  16:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
  17:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  18:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  19:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  20:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  21:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  22:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  23:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * SOFTWARE
  24:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
  25:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * \endcopyright
  26:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
  27:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * \author Infineon Technologies AG
  28:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
  29:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * \file example_pair_host_and_optiga_using_pre_shared_secret.c
  30:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
  31:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * \brief   This file provides an example for pairing the Host and OPTIGA using a preshared secret.
  32:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
  33:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * \ingroup grUseCases
  34:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** *
  35:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** * @{
  36:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** */
  37:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
  38:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** #include "optiga/optiga_util.h"
  39:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** #include "optiga/optiga_crypt.h"
  40:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
  41:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** #include "optiga/pal/pal_os_datastore.h"
  42:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** #include "optiga_example.h"
  43:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
  44:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** // Value of Operational state
  45:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** #define LCSO_STATE_CREATION       (0x01)
  46:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** // Value of Operational state
  47:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** #define LCSO_STATE_OPERATIONAL    (0x07)
  48:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
  49:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** //Currently set to Creation state(defualt value). At the real time/customer side this needs to be L
  50:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** #define FINAL_LCSO_STATE          (LCSO_STATE_CREATION)
  51:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
  52:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** /* Platform Binding Shared Secret (0xE140) Metadata to be updated */
  53:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
  54:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** const uint8_t platform_binding_shared_secret_metadata_final [] = {
  55:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     //Metadata to be updated
  56:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     0x20, 0x17,
  57:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         // LcsO
  58:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         0xC0, 0x01,
  59:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     FINAL_LCSO_STATE,       // Refer Macro to see the value or some more notes
  60:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         // Change/Write Access tag
  61:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         0xD0, 0x07,
  62:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     // This allows updating the binding secret during the runtime using shielded co
  63:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     // If not required to update the secret over the runtime, set this to NEV and
  64:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     // update Metadata length accordingly
  65:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     0xE1, 0xFC, LCSO_STATE_OPERATIONAL,   // LcsO < Operational state
  66:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     0xFE,
  67:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     0x20, 0xE1, 0x40,
  68:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         // Read Access tag
  69:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         0xD1, 0x03,
  70:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     0xE1, 0xFC, LCSO_STATE_OPERATIONAL,   // LcsO < Operational state
  71:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         // Execute Access tag
  72:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         0xD3, 0x01,
  73:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     0x00,   // Always
  74:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         // Data object Type
  75:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         0xE8, 0x01,
  76:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                     0x22,   // Platform binding secret type
  77:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** };
  78:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
  79:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** /**
  80:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  * Callback when optiga_util_xxxx/optiga_crypt_xxxx operation is completed asynchronously
  81:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  */
  82:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** static volatile optiga_lib_status_t optiga_lib_status;
  83:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** //lint --e{818} suppress "argument "context" is not used in the sample provided"
  84:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** static void optiga_lib_callback(void * context, optiga_lib_status_t return_status)
  85:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** {
  27              	 .loc 1 85 0
  28              	 .cfi_startproc
  29              	 
  30              	 
  31              	 
  32              	.LVL0:
  86:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     optiga_lib_status = return_status;
  33              	 .loc 1 86 0
  34 0000 014B     	 ldr r3,.L2
  35 0002 1980     	 strh r1,[r3]
  36 0004 7047     	 bx lr
  37              	.L3:
  38 0006 00BF     	 .align 2
  39              	.L2:
  40 0008 00000000 	 .word .LANCHOR0
  41              	 .cfi_endproc
  42              	.LFE0:
  44              	 .section .text.example_pair_host_and_optiga_using_pre_shared_secret,"ax",%progbits
  45              	 .align 1
  46              	 .global example_pair_host_and_optiga_using_pre_shared_secret
  47              	 .thumb
  48              	 .thumb_func
  50              	example_pair_host_and_optiga_using_pre_shared_secret:
  51              	.LFB1:
  87:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     if (NULL != context)
  88:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     {
  89:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         // callback to upper layer here
  90:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     }
  91:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** }
  92:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
  93:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** /**
  94:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  * The below example demonstrates pairing the Host and OPTIGA using a preshared secret for the firs
  95:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *
  96:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  * Note:
  97:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *   1) If the below example is executed once, the LcsO of Platform Binding shared secret is set to
  98:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *      The LcsO can't be reverted to previous states.
  99:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *
 100:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *      Please ensure the access conditions and other required settings in the metadata must be acc
 101:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *      before setting the LcsO to Initialization state.
 102:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *
 103:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *   2) The metadata gets written in this example is just an example. The user must update this to 
 104:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *      needs including LcsO state and access conditions
 105:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *
 106:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  * Preconditions: The optiga_util_open_application must be executed before invoking the below examp
 107:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  *
 108:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****  */
 109:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** void example_pair_host_and_optiga_using_pre_shared_secret(void)
 110:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** {
  52              	 .loc 1 110 0
  53              	 .cfi_startproc
  54              	 
  55              	 
  56              	.LVL1:
  57 0000 2DE9F041 	 push {r4,r5,r6,r7,r8,lr}
  58              	.LCFI0:
  59              	 .cfi_def_cfa_offset 24
  60              	 .cfi_offset 4,-24
  61              	 .cfi_offset 5,-20
  62              	 .cfi_offset 6,-16
  63              	 .cfi_offset 7,-12
  64              	 .cfi_offset 8,-8
  65              	 .cfi_offset 14,-4
 111:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     uint16_t bytes_to_read;
 112:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     uint8_t platform_binding_secret[64];
 113:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     uint8_t platform_binding_secret_metadata[44];
 114:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     optiga_lib_status_t return_status = !OPTIGA_LIB_SUCCESS;
 115:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     pal_status_t pal_return_status;
 116:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     optiga_util_t * me_util = NULL;
 117:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     optiga_crypt_t * me_crypt = NULL;
 118:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 119:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     OPTIGA_EXAMPLE_LOG_MESSAGE(__FUNCTION__);
  66              	 .loc 1 119 0
  67 0004 6048     	 ldr r0,.L54
  68 0006 6149     	 ldr r1,.L54+4
  69 0008 614A     	 ldr r2,.L54+8
 110:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     uint16_t bytes_to_read;
  70              	 .loc 1 110 0
  71 000a 9EB0     	 sub sp,sp,#120
  72              	.LCFI1:
  73              	 .cfi_def_cfa_offset 144
  74              	 .loc 1 119 0
  75 000c FFF7FEFF 	 bl optiga_lib_print_message
  76              	.LVL2:
 120:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 121:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     do
 122:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     {
 123:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 124:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 1. Create OPTIGA Util and Crypt Instances
 125:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 126:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         me_util = optiga_util_create(0, optiga_lib_callback, NULL);
  77              	 .loc 1 126 0
  78 0010 0020     	 movs r0,#0
  79 0012 6049     	 ldr r1,.L54+12
  80 0014 0246     	 mov r2,r0
  81 0016 FFF7FEFF 	 bl optiga_util_create
  82              	.LVL3:
 127:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         if (NULL == me_util)
  83              	 .loc 1 127 0
  84 001a 0446     	 mov r4,r0
  85 001c 0028     	 cmp r0,#0
  86 001e 00F0AD80 	 beq .L5
 128:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         {
 129:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             break;
 130:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         }
 131:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 132:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         me_crypt = optiga_crypt_create(0, optiga_lib_callback, NULL);
  87              	 .loc 1 132 0
  88 0022 0020     	 movs r0,#0
  89              	.LVL4:
  90 0024 5B49     	 ldr r1,.L54+12
  91 0026 0246     	 mov r2,r0
  92 0028 FFF7FEFF 	 bl optiga_crypt_create
  93              	.LVL5:
 133:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         if (NULL == me_crypt)
  94              	 .loc 1 133 0
  95 002c 0546     	 mov r5,r0
  96 002e 0028     	 cmp r0,#0
  97 0030 00F0A480 	 beq .L5
 134:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         {
 135:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             break;
 136:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         }
 137:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 138:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 139:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 2. Initialize the protection level and protocol version for the instances
 140:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 141:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         OPTIGA_UTIL_SET_COMMS_PROTECTION_LEVEL(me_util,OPTIGA_COMMS_NO_PROTECTION);
  98              	 .loc 1 141 0
  99 0034 2046     	 mov r0,r4
 100              	.LVL6:
 101 0036 0121     	 movs r1,#1
 102 0038 0022     	 movs r2,#0
 103 003a FFF7FEFF 	 bl optiga_util_set_comms_params
 104              	.LVL7:
 142:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         OPTIGA_UTIL_SET_COMMS_PROTOCOL_VERSION(me_util,OPTIGA_COMMS_PROTOCOL_VERSION_PRE_SHARED_SEC
 105              	 .loc 1 142 0
 106 003e 2046     	 mov r0,r4
 107 0040 0221     	 movs r1,#2
 108 0042 0122     	 movs r2,#1
 109 0044 FFF7FEFF 	 bl optiga_util_set_comms_params
 110              	.LVL8:
 143:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 144:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         OPTIGA_CRYPT_SET_COMMS_PROTECTION_LEVEL(me_crypt,OPTIGA_COMMS_NO_PROTECTION);
 111              	 .loc 1 144 0
 112 0048 2846     	 mov r0,r5
 113 004a 0121     	 movs r1,#1
 114 004c 0022     	 movs r2,#0
 115 004e FFF7FEFF 	 bl optiga_crypt_set_comms_params
 116              	.LVL9:
 145:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         OPTIGA_CRYPT_SET_COMMS_PROTOCOL_VERSION(me_crypt,OPTIGA_COMMS_PROTOCOL_VERSION_PRE_SHARED_S
 117              	 .loc 1 145 0
 118 0052 2846     	 mov r0,r5
 119 0054 0221     	 movs r1,#2
 120 0056 0122     	 movs r2,#1
 121 0058 FFF7FEFF 	 bl optiga_crypt_set_comms_params
 122              	.LVL10:
 146:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 147:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 148:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 3. Read Platform Binding Shared secret (0xE140) data object metadata from OPTIGA
 149:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *    using optiga_util_read_metadata.
 150:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 151:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         bytes_to_read = sizeof(platform_binding_secret_metadata);
 152:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         optiga_lib_status = OPTIGA_LIB_BUSY;
 123              	 .loc 1 152 0
 124 005c 4E4E     	 ldr r6,.L54+16
 151:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         optiga_lib_status = OPTIGA_LIB_BUSY;
 125              	 .loc 1 151 0
 126 005e 2C23     	 movs r3,#44
 127 0060 ADF80A30 	 strh r3,[sp,#10]
 128              	 .loc 1 152 0
 129 0064 0123     	 movs r3,#1
 130 0066 3380     	 strh r3,[r6]
 153:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         return_status = optiga_util_read_metadata(me_util,
 131              	 .loc 1 153 0
 132 0068 03AA     	 add r2,sp,#12
 133 006a 2046     	 mov r0,r4
 134 006c 4EF24011 	 movw r1,#57664
 135 0070 0DF10A03 	 add r3,sp,#10
 136 0074 FFF7FEFF 	 bl optiga_util_read_metadata
 137              	.LVL11:
 154:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                   0xE140,
 155:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                   platform_binding_secret_metadata,
 156:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                   &bytes_to_read);
 157:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 158:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         WAIT_AND_CHECK_STATUS(return_status, optiga_lib_status);
 138              	 .loc 1 158 0
 139 0078 0246     	 mov r2,r0
 140 007a 0028     	 cmp r0,#0
 141 007c 5FD1     	 bne .L24
 142              	.L7:
 143              	 .loc 1 158 0 is_stmt 0 discriminator 1
 144 007e 3288     	 ldrh r2,[r6]
 145 0080 454B     	 ldr r3,.L54+16
 146 0082 92B2     	 uxth r2,r2
 147 0084 012A     	 cmp r2,#1
 148 0086 FAD0     	 beq .L7
 149              	 .loc 1 158 0 discriminator 2
 150 0088 1988     	 ldrh r1,[r3]
 151 008a 89B2     	 uxth r1,r1
 152 008c B9B9     	 cbnz r1,.L52
 159:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 160:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 161:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 4. Validate LcsO in the metadata.
 162:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *    Skip the rest of the procedure if LcsO is greater than or equal to operational state(
 163:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 164:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         if (platform_binding_secret_metadata[4] >= LCSO_STATE_OPERATIONAL)
 153              	 .loc 1 164 0 is_stmt 1
 154 008e 9DF81020 	 ldrb r2,[sp,#16]
 155 0092 062A     	 cmp r2,#6
 156 0094 59D8     	 bhi .L18
 165:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         {
 166:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             // The LcsO is already greater than or equal to operational state
 167:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             break;
 168:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         }
 169:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 170:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 171:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 5. Generate Random using optiga_crypt_random
 172:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *       - Specify the Random type as TRNG
 173:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *    a. The maximum supported size of secret is 64 bytes.
 174:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *       The minimum recommended is 32 bytes.
 175:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *    b. If the host platform doesn't support random generation,
 176:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *       use OPTIGA to generate the maximum size chosen.
 177:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *       else choose the appropriate length of random to be generated by OPTIGA
 178:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *
 179:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 180:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         optiga_lib_status = OPTIGA_LIB_BUSY;
 157              	 .loc 1 180 0
 158 0096 0122     	 movs r2,#1
 181:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         return_status = optiga_crypt_random(me_crypt,
 159              	 .loc 1 181 0
 160 0098 0DF13808 	 add r8,sp,#56
 180:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         return_status = optiga_crypt_random(me_crypt,
 161              	 .loc 1 180 0
 162 009c 1A80     	 strh r2,[r3]
 163              	 .loc 1 181 0
 164 009e 2846     	 mov r0,r5
 165              	.LVL12:
 166 00a0 4246     	 mov r2,r8
 167 00a2 4023     	 movs r3,#64
 168 00a4 FFF7FEFF 	 bl optiga_crypt_random
 169              	.LVL13:
 182:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                             OPTIGA_RNG_TYPE_TRNG,
 183:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                             platform_binding_secret,
 184:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                             sizeof(platform_binding_secret));
 185:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         WAIT_AND_CHECK_STATUS(return_status, optiga_lib_status);
 170              	 .loc 1 185 0
 171 00a8 0246     	 mov r2,r0
 172 00aa 0028     	 cmp r0,#0
 173 00ac 47D1     	 bne .L24
 174              	.L11:
 175              	 .loc 1 185 0 is_stmt 0 discriminator 1
 176 00ae 3288     	 ldrh r2,[r6]
 177 00b0 394B     	 ldr r3,.L54+16
 178 00b2 92B2     	 uxth r2,r2
 179 00b4 012A     	 cmp r2,#1
 180 00b6 FAD0     	 beq .L11
 181              	 .loc 1 185 0 discriminator 2
 182 00b8 1F88     	 ldrh r7,[r3]
 183 00ba BFB2     	 uxth r7,r7
 184 00bc 0FB1     	 cbz r7,.L12
 185              	.L52:
 186              	 .loc 1 185 0 discriminator 3
 187 00be 1A88     	 ldrh r2,[r3]
 188 00c0 3BE0     	 b .L51
 189              	.L12:
 186:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 187:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 188:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 6. Generate random on Host
 189:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *    If the host platform doesn't support, skip this step
 190:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 191:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 192:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 193:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 194:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 7. Write random(secret) to OPTIGA platform Binding shared secret data object (0xE140)
 195:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 196:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         optiga_lib_status = OPTIGA_LIB_BUSY;
 190              	 .loc 1 196 0 is_stmt 1
 191 00c2 0121     	 movs r1,#1
 197:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         OPTIGA_UTIL_SET_COMMS_PROTECTION_LEVEL(me_util,OPTIGA_COMMS_NO_PROTECTION);
 192              	 .loc 1 197 0
 193 00c4 2046     	 mov r0,r4
 194              	.LVL14:
 195 00c6 3A46     	 mov r2,r7
 196:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         OPTIGA_UTIL_SET_COMMS_PROTECTION_LEVEL(me_util,OPTIGA_COMMS_NO_PROTECTION);
 196              	 .loc 1 196 0
 197 00c8 1980     	 strh r1,[r3]
 198              	 .loc 1 197 0
 199 00ca FFF7FEFF 	 bl optiga_util_set_comms_params
 200              	.LVL15:
 198:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         return_status = optiga_util_write_data(me_util,
 201              	 .loc 1 198 0
 202 00ce 4022     	 movs r2,#64
 203 00d0 0192     	 str r2,[sp,#4]
 204 00d2 CDF80080 	 str r8,[sp]
 205 00d6 2046     	 mov r0,r4
 206 00d8 4EF24011 	 movw r1,#57664
 207 00dc 3B46     	 mov r3,r7
 208 00de FFF7FEFF 	 bl optiga_util_write_data
 209              	.LVL16:
 199:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                0xE140,
 200:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                OPTIGA_UTIL_ERASE_AND_WRITE,
 201:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                0,
 202:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                platform_binding_secret,
 203:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                sizeof(platform_binding_secret));
 204:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         WAIT_AND_CHECK_STATUS(return_status, optiga_lib_status);
 210              	 .loc 1 204 0
 211 00e2 0246     	 mov r2,r0
 212 00e4 58BB     	 cbnz r0,.L24
 213              	.L13:
 214              	 .loc 1 204 0 is_stmt 0 discriminator 1
 215 00e6 3388     	 ldrh r3,[r6]
 216 00e8 2B4F     	 ldr r7,.L54+16
 217 00ea 9BB2     	 uxth r3,r3
 218 00ec 012B     	 cmp r3,#1
 219 00ee FAD0     	 beq .L13
 220              	 .loc 1 204 0 discriminator 2
 221 00f0 3B88     	 ldrh r3,[r7]
 222 00f2 9BB2     	 uxth r3,r3
 223 00f4 0BB1     	 cbz r3,.L14
 224              	 .loc 1 204 0 discriminator 3
 225 00f6 3A88     	 ldrh r2,[r7]
 226 00f8 1FE0     	 b .L51
 227              	.L14:
 205:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 206:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 207:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 8. Write/store the random(secret) on the Host platform
 208:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          *
 209:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 210:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         pal_return_status = pal_os_datastore_write(OPTIGA_PLATFORM_BINDING_SHARED_SECRET_ID,
 228              	 .loc 1 210 0 is_stmt 1
 229 00fa 4022     	 movs r2,#64
 230 00fc 1120     	 movs r0,#17
 231              	.LVL17:
 232 00fe 4146     	 mov r1,r8
 233 0100 FFF7FEFF 	 bl pal_os_datastore_write
 234              	.LVL18:
 211:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                    platform_binding_secret,
 212:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                    sizeof(platform_binding_secret));
 213:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 214:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         if (PAL_STATUS_SUCCESS != pal_return_status)
 235              	 .loc 1 214 0
 236 0104 0246     	 mov r2,r0
 237 0106 08B1     	 cbz r0,.L15
 215:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         {
 216:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             //Storing of Pre-shared secret on Host failed.
 217:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             optiga_lib_status = pal_return_status;
 238              	 .loc 1 217 0
 239 0108 3880     	 strh r0,[r7]
 218:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             break;
 240              	 .loc 1 218 0
 241 010a 1EE0     	 b .L18
 242              	.L15:
 219:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         }
 220:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 221:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 222:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 223:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         /**
 224:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          * 9. Update metadata of OPTIGA Platform Binding shared secret data object (0xE140)
 225:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****          */
 226:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         optiga_lib_status = OPTIGA_LIB_BUSY;
 243              	 .loc 1 226 0
 244 010c 0121     	 movs r1,#1
 227:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         OPTIGA_UTIL_SET_COMMS_PROTECTION_LEVEL(me_util,OPTIGA_COMMS_NO_PROTECTION);
 245              	 .loc 1 227 0
 246 010e 2046     	 mov r0,r4
 247              	.LVL19:
 226:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         OPTIGA_UTIL_SET_COMMS_PROTECTION_LEVEL(me_util,OPTIGA_COMMS_NO_PROTECTION);
 248              	 .loc 1 226 0
 249 0110 3980     	 strh r1,[r7]
 250              	 .loc 1 227 0
 251 0112 FFF7FEFF 	 bl optiga_util_set_comms_params
 252              	.LVL20:
 228:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         return_status = optiga_util_write_metadata(me_util,
 253              	 .loc 1 228 0
 254 0116 214A     	 ldr r2,.L54+20
 255 0118 2046     	 mov r0,r4
 256 011a 4EF24011 	 movw r1,#57664
 257 011e 1923     	 movs r3,#25
 258 0120 FFF7FEFF 	 bl optiga_util_write_metadata
 259              	.LVL21:
 229:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                    0xE140,
 230:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                    platform_binding_shared_secret_metadata_final,
 231:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****                                                    sizeof(platform_binding_shared_secret_metadata_f
 232:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 233:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         WAIT_AND_CHECK_STATUS(return_status, optiga_lib_status);
 260              	 .loc 1 233 0
 261 0124 0246     	 mov r2,r0
 262 0126 50B9     	 cbnz r0,.L24
 263              	.L17:
 264              	 .loc 1 233 0 is_stmt 0 discriminator 1
 265 0128 3388     	 ldrh r3,[r6]
 266 012a 1B4A     	 ldr r2,.L54+16
 267 012c 9BB2     	 uxth r3,r3
 268 012e 012B     	 cmp r3,#1
 269 0130 FAD0     	 beq .L17
 270              	 .loc 1 233 0 discriminator 2
 271 0132 1388     	 ldrh r3,[r2]
 272 0134 9BB2     	 uxth r3,r3
 273 0136 43B1     	 cbz r3,.L18
 274              	 .loc 1 233 0 discriminator 3
 275 0138 1288     	 ldrh r2,[r2]
 276              	.L51:
 277 013a 92B2     	 uxth r2,r2
 278              	.LVL22:
 234:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 235:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         return_status = OPTIGA_LIB_SUCCESS;
 236:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 237:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     } while(FALSE);
 238:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     OPTIGA_EXAMPLE_LOG_STATUS(return_status);
 279              	 .loc 1 238 0 is_stmt 1 discriminator 3
 280 013c 2AB1     	 cbz r2,.L18
 281              	.LVL23:
 282              	.L24:
 283              	 .loc 1 238 0 is_stmt 0 discriminator 1
 284 013e 1348     	 ldr r0,.L54+4
 285 0140 1749     	 ldr r1,.L54+24
 286 0142 FFF7FEFF 	 bl optiga_lib_print_status
 287              	.LVL24:
 239:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     
 240:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     if(me_util)
 288              	 .loc 1 240 0 is_stmt 1 discriminator 1
 289 0146 74B1     	 cbz r4,.L20
 290 0148 04E0     	 b .L19
 291              	.L18:
 238:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     
 292              	 .loc 1 238 0 discriminator 2
 293 014a 1048     	 ldr r0,.L54+4
 294 014c 1049     	 ldr r1,.L54+8
 295 014e 0022     	 movs r2,#0
 296 0150 FFF7FEFF 	 bl optiga_lib_print_status
 297              	.LVL25:
 298              	.L19:
 241:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     {
 242:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         //Destroy the instance after the completion of usecase if not required.
 243:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         return_status = optiga_util_destroy(me_util);
 299              	 .loc 1 243 0
 300 0154 2046     	 mov r0,r4
 301 0156 FFF7FEFF 	 bl optiga_util_destroy
 302              	.LVL26:
 244:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         if(OPTIGA_LIB_SUCCESS != return_status)
 303              	 .loc 1 244 0
 304 015a 0246     	 mov r2,r0
 305 015c 18B1     	 cbz r0,.L20
 245:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         {
 246:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             //lint --e{774} suppress This is a generic macro
 247:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             OPTIGA_EXAMPLE_LOG_STATUS(return_status);
 306              	 .loc 1 247 0 discriminator 1
 307 015e 0B48     	 ldr r0,.L54+4
 308              	.LVL27:
 309 0160 0F49     	 ldr r1,.L54+24
 310 0162 FFF7FEFF 	 bl optiga_lib_print_status
 311              	.LVL28:
 312              	.L20:
 248:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         }
 249:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     }
 250:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     if(me_crypt)
 313              	 .loc 1 250 0
 314 0166 65B1     	 cbz r5,.L4
 251:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     {
 252:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         //Destroy the instance after the completion of usecase if not required.
 253:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         return_status = optiga_crypt_destroy(me_crypt);
 315              	 .loc 1 253 0
 316 0168 2846     	 mov r0,r5
 317 016a FFF7FEFF 	 bl optiga_crypt_destroy
 318              	.LVL29:
 254:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         if(OPTIGA_LIB_SUCCESS != return_status)
 319              	 .loc 1 254 0
 320 016e 0246     	 mov r2,r0
 321 0170 38B1     	 cbz r0,.L4
 255:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         {
 256:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             //lint --e{774} suppress This is a generic macro
 257:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****             OPTIGA_EXAMPLE_LOG_STATUS(return_status);
 322              	 .loc 1 257 0 discriminator 1
 323 0172 0648     	 ldr r0,.L54+4
 324              	.LVL30:
 325 0174 0A49     	 ldr r1,.L54+24
 326 0176 FFF7FEFF 	 bl optiga_lib_print_status
 327              	.LVL31:
 328 017a 02E0     	 b .L4
 329              	.LVL32:
 330              	.L5:
 117:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** 
 331              	 .loc 1 117 0
 332 017c 0025     	 movs r5,#0
 114:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     pal_status_t pal_return_status;
 333              	 .loc 1 114 0
 334 017e 0122     	 movs r2,#1
 335              	.LVL33:
 336 0180 DDE7     	 b .L24
 337              	.LVL34:
 338              	.L4:
 258:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****         }
 259:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     }
 260:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c ****     
 261:C:/Users/Yushev/git/optiga-trust-qi/examples/optiga/usecases\example_pair_host_and_optiga_using_pre_shared_secret.c **** }
 339              	 .loc 1 261 0
 340 0182 1EB0     	 add sp,sp,#120
 341              	.LCFI2:
 342              	 .cfi_def_cfa_offset 24
 343              	 
 344 0184 BDE8F081 	 pop {r4,r5,r6,r7,r8,pc}
 345              	.LVL35:
 346              	.L55:
 347              	 .align 2
 348              	.L54:
 349 0188 00000000 	 .word .LANCHOR1
 350 018c 00000000 	 .word .LC0
 351 0190 15000000 	 .word .LC1
 352 0194 00000000 	 .word optiga_lib_callback
 353 0198 00000000 	 .word .LANCHOR0
 354 019c 00000000 	 .word .LANCHOR2
 355 01a0 1A000000 	 .word .LC2
 356              	 .cfi_endproc
 357              	.LFE1:
 359              	 .global platform_binding_shared_secret_metadata_final
 360              	 .section .rodata.platform_binding_shared_secret_metadata_final,"a",%progbits
 361              	 .set .LANCHOR2,.+0
 364              	platform_binding_shared_secret_metadata_final:
 365 0000 20       	 .byte 32
 366 0001 17       	 .byte 23
 367 0002 C0       	 .byte -64
 368 0003 01       	 .byte 1
 369 0004 01       	 .byte 1
 370 0005 D0       	 .byte -48
 371 0006 07       	 .byte 7
 372 0007 E1       	 .byte -31
 373 0008 FC       	 .byte -4
 374 0009 07       	 .byte 7
 375 000a FE       	 .byte -2
 376 000b 20       	 .byte 32
 377 000c E1       	 .byte -31
 378 000d 40       	 .byte 64
 379 000e D1       	 .byte -47
 380 000f 03       	 .byte 3
 381 0010 E1       	 .byte -31
 382 0011 FC       	 .byte -4
 383 0012 07       	 .byte 7
 384 0013 D3       	 .byte -45
 385 0014 01       	 .byte 1
 386 0015 00       	 .byte 0
 387 0016 E8       	 .byte -24
 388 0017 01       	 .byte 1
 389 0018 22       	 .byte 34
 390              	 .section .rodata.str1.1,"aMS",%progbits,1
 391              	.LC0:
 392 0000 5B6F7074 	 .ascii "[optiga example]  : \000"
 392      69676120 
 392      6578616D 
 392      706C655D 
 392      20203A20 
 393              	.LC1:
 394 0015 1B5B306D 	 .ascii "\033[0m\000"
 394      00
 395              	.LC2:
 396 001a 1B5B3331 	 .ascii "\033[31m\000"
 396      6D00
 397              	 .section .rodata.__FUNCTION__.5952,"a",%progbits
 398              	 .set .LANCHOR1,.+0
 401              	__FUNCTION__.5952:
 402 0000 6578616D 	 .ascii "example_pair_host_and_optiga_using_pre_shared_secre"
 402      706C655F 
 402      70616972 
 402      5F686F73 
 402      745F616E 
 403 0033 7400     	 .ascii "t\000"
 404              	 .section .bss.optiga_lib_status,"aw",%nobits
 405              	 .align 1
 406              	 .set .LANCHOR0,.+0
 409              	optiga_lib_status:
 410 0000 0000     	 .space 2
 411              	 .text
 412              	.Letext0:
 413              	 .file 2 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 414              	 .file 3 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 415              	 .file 4 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_types.h"
 416              	 .file 5 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_common.h"
 417              	 .file 6 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/cmd/optiga_cmd.h"
 418              	 .file 7 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/optiga_util.h"
 419              	 .file 8 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/optiga_crypt.h"
 420              	 .file 9 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal.h"
 421              	 .file 10 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/common/optiga_lib_logger.h"
 422              	 .file 11 "C:/Users/Yushev/git/optiga-trust-qi/optiga/include/optiga/pal/pal_os_datastore.h"
DEFINED SYMBOLS
                            *ABS*:00000000 example_pair_host_and_optiga_using_pre_shared_secret.c
    {standard input}:20     .text.optiga_lib_callback:00000000 $t
    {standard input}:24     .text.optiga_lib_callback:00000000 optiga_lib_callback
    {standard input}:40     .text.optiga_lib_callback:00000008 $d
    {standard input}:45     .text.example_pair_host_and_optiga_using_pre_shared_secret:00000000 $t
    {standard input}:50     .text.example_pair_host_and_optiga_using_pre_shared_secret:00000000 example_pair_host_and_optiga_using_pre_shared_secret
    {standard input}:349    .text.example_pair_host_and_optiga_using_pre_shared_secret:00000188 $d
    {standard input}:364    .rodata.platform_binding_shared_secret_metadata_final:00000000 platform_binding_shared_secret_metadata_final
    {standard input}:401    .rodata.__FUNCTION__.5952:00000000 __FUNCTION__.5952
    {standard input}:405    .bss.optiga_lib_status:00000000 $d
    {standard input}:409    .bss.optiga_lib_status:00000000 optiga_lib_status
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
optiga_lib_print_message
optiga_util_create
optiga_crypt_create
optiga_util_set_comms_params
optiga_crypt_set_comms_params
optiga_util_read_metadata
optiga_crypt_random
optiga_util_write_data
pal_os_datastore_write
optiga_util_write_metadata
optiga_lib_print_status
optiga_util_destroy
optiga_crypt_destroy
