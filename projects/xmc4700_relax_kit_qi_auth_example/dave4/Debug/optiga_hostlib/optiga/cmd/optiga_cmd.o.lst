   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,6
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "optiga_cmd.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .bss.g_optiga,"aw",%nobits
  20              	 .align 2
  23              	g_optiga:
  24 0000 00000000 	 .space 1660
  24      00000000 
  24      00000000 
  24      00000000 
  24      00000000 
  25              	 .section .data.g_optiga_list,"aw",%progbits
  26              	 .align 2
  29              	g_optiga_list:
  30 0000 00000000 	 .word g_optiga
  31              	 .section .data.g_hibernate_datastore_id_list,"aw",%progbits
  32              	 .align 2
  35              	g_hibernate_datastore_id_list:
  36 0000 3300     	 .short 51
  37              	 .global g_optiga_unique_application_identifier
  38 0002 0000     	 .section .rodata.g_optiga_unique_application_identifier,"a",%progbits
  39              	 .align 2
  42              	g_optiga_unique_application_identifier:
  43 0000 D2       	 .byte -46
  44 0001 76       	 .byte 118
  45 0002 00       	 .byte 0
  46 0003 00       	 .byte 0
  47 0004 04       	 .byte 4
  48 0005 47       	 .byte 71
  49 0006 65       	 .byte 101
  50 0007 6E       	 .byte 110
  51 0008 41       	 .byte 65
  52 0009 75       	 .byte 117
  53 000a 74       	 .byte 116
  54 000b 68       	 .byte 104
  55 000c 41       	 .byte 65
  56 000d 70       	 .byte 112
  57 000e 70       	 .byte 112
  58 000f 6C       	 .byte 108
  59              	 .section .text.optiga_cmd_prepare_apdu_header,"ax",%progbits
  60              	 .align 2
  61              	 .thumb
  62              	 .thumb_func
  64              	optiga_cmd_prepare_apdu_header:
  65              	.LFB0:
  66              	 .file 1 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd/optiga_cmd.c"
   1:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /**
   2:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * \copyright
   3:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * MIT License
   4:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
   5:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Copyright (c) 2020 Infineon Technologies AG
   6:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
   7:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Permission is hereby granted, free of charge, to any person obtaining a copy
   8:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * of this software and associated documentation files (the "Software"), to deal
   9:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * in the Software without restriction, including without limitation the rights
  10:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  11:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * copies of the Software, and to permit persons to whom the Software is
  12:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * furnished to do so, subject to the following conditions:
  13:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
  14:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * The above copyright notice and this permission notice shall be included in all
  15:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * copies or substantial portions of the Software.
  16:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
  17:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  18:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  19:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  20:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  21:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  22:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  23:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * SOFTWARE
  24:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
  25:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * \endcopyright
  26:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
  27:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * \author Infineon Technologies AG
  28:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
  29:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * \file optiga_cmd.c
  30:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
  31:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * \brief   This file implements cmd modules which covers OPTIGA command formation, locking mechanis
  32:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *          acquisition and asynchronous data handling
  33:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
  34:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * \ingroup  grOptigaCmd
  35:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *
  36:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * @{
  37:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
  38:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  39:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  40:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/cmd/optiga_cmd.h"
  41:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/common/optiga_lib_common_internal.h"
  42:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/common/optiga_lib_logger.h"
  43:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/comms/optiga_comms.h"
  44:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_os_event.h"
  45:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_os_lock.h"
  46:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_os_timer.h"
  47:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_os_memory.h"
  48:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #include "optiga/pal/pal_ifx_i2c_config.h"
  49:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  50:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for clearing last error code
  51:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_CLEAR_LAST_ERROR                      (0x80)
  52:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for OpenApplication command
  53:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OPEN_APPLICATION                      (0x70 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  54:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for CloseApplication command
  55:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_CLOSE_APPLICATION                     (0x71 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  56:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for GetDataObject command
  57:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_DATA_OBJECT                       (0x01 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  58:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for SetDataObject command
  59:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SET_DATA_OBJECT                       (0x02 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  60:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for GetRandom command
  61:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_RANDOM                            (0x0C | OPTIGA_CMD_CLEAR_LAST_ERROR)
  62:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for CalcHash command
  63:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_CALC_HASH                             (0x30 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  64:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for CalcSign command
  65:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_CALC_SIGN                             (0x31 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  66:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for VerifySign command
  67:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN                           (0x32 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  68:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for GenKeyPair command
  69:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEYPAIR                           (0x38 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  70:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //cmd byte for SetObjectProtected command
  71:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SET_OBJECT_PROTECTED                  (0x03 | OPTIGA_CMD_CLEAR_LAST_ERROR)
  72:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  73:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  74:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_MAX_NUMBER_OF_SESSIONS                (0x04)
  75:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_START_SESSION_OID                     (0xE100)
  76:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  77:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Considering the size w.r.t maximum APDU size + shielded connection if enabled.
  78:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_TOTAL_COMMS_BUFFER_SIZE               (OPTIGA_MAX_COMMS_BUFFER_SIZE + OPTIGA_COM
  79:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  80:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_APDU_HEADER_SIZE                      (0x04)
  81:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  82:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LAST_ERROR_CODE                       (0xF1C2)
  83:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  84:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_APDU_INDATA_OFFSET                    (OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_COMM
  85:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Hash header size(hash_input_header_size + context_header_size)
  86:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_HASH_HEADER_SIZE                      (0x06)
  87:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Intermediate context header size
  88:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_INTERMEDIATE_CONTEXT_HEADER           (0x03)
  89:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Zero length or value
  90:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ZERO_LENGTH_OR_VALUE                  (0x0000)
  91:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // One length or value
  92:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ONE_LENGTH_OR_VALUE                   (0x0001)
  93:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // OID data length
  94:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OID_DATA_LENGTH                       (0x0006)
  95:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Number of bits in a byte
  96:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_NO_OF_BITS_IN_BYTE                    (0x0008)
  97:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
  98:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //Number of bytes in tag
  99:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_NO_OF_BYTES_IN_TAG                    (0x01)
 100:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 101:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //Number of bytes in OFFSET
 102:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_UINT16_SIZE_IN_BYTES                  (0x02)
 103:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 104:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_APDU_SUCCESS                          (0x00)
 105:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_APDU_FAILURE                          (0xFF)
 106:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 107:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_WRITE_ONLY                                   (0x00)
 108:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_READ_DATA                                    (0x00)
 109:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_DATA_OBJECT_NO_ERROR_CLEAR               (0x01)
 110:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 111:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //Calc sign tag values
 112:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SIGN_DIGEST_TAG                              (0x01)
 113:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SIGN_OID_TAG                                 (0x03)
 114:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SIGN_OID_LEN                                 (0x0002)
 115:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 116:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //Verify sign tag values
 117:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN_DIGEST_TAG                       (0x01)
 118:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN_SIGNATURE_TAG                    (0x02)
 119:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_TAG             (0x04)
 120:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_LENGTH          (0x0002)
 121:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_ALGO_ID_TAG                           (0x05)
 122:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_ALGO_ID_LENGTH                        (0x0001)
 123:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_VERIFY_PUBLIC_KEY_TAG                        (0x06)
 124:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 125:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //Generate key pair tag and length value
 126:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_TAG             (0x01)
 127:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_LENGTH          (0x0002)
 128:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_TAG                   (0x02)
 129:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_LENGTH                (0x0001)
 130:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_TAG                  (0x07)
 131:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_LENGTH               (0x0000)
 132:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_PUBLIC_KEY_TAG                  (0x02)
 133:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_TAG                 (0x01)
 134:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 135:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_PROTECTION_LEVEL_MASK                            (0x03)
 136:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         
 137:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ERROR_CODE_PREPARE                           (0x01)
 138:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ERROR_CODE_TX                                (0x02)
 139:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ERROR_CODE_RX                                (0x03)
 140:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ERROR_CODE_STATE_MASK                        (0x03)
 141:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ENTER_HANDLER_CALL_MASK                      (0x80)
 142:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_ENTER_HANDLER_CALL                           (0x80)
 143:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_EXIT_HANDLER_CALL                            (0x00)
 144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OUT_OF_BOUNDARY_ERROR                        (0x08)
 145:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 146:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /// Set object protected tag
 147:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SET_OBJECT_PROTECTED_TAG                     (0x30)
 148:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 149:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_TAG_LENGTH_SIZE                              (0x03)
 150:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT                 (0x00)
 151:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 152:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Function to set given bits
 153:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define SET_DEV_ERROR_HANDLER_STATE(state){\
 154:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                    (me->device_error_status) &= ~OPTIGA_CMD_ERROR_CODE_STATE_MASK;\
 155:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                    (me->device_error_status) |= state & OPTIGA_CMD_ERROR_CODE_STATE
 156:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 157:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define SET_DEV_ERROR_NOTIFICATION(bits_value){\
 158:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   (me->device_error_status) &= ~OPTIGA_CMD_ENTER_HANDLER_CALL_MASK;
 159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   (me->device_error_status) |= bits_value & OPTIGA_CMD_ENTER_HANDLE
 160:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 161:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 162:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define EXIT_STATE_WITH_ERROR(ctx, exit_machine){\
 163:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   ctx->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;\
 164:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   ctx->exit_status = OPTIGA_CMD_ERROR;\
 165:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   exit_machine = FALSE;}
 166:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 167:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #if defined (OPTIGA_LIB_ENABLE_LOGGING) && defined (OPTIGA_LIB_ENABLE_CMD_LOGGING)
 168:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 169:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Logs the message provided from Command layer
 170:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_MESSAGE(msg) \
 171:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {\
 172:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_print_message(msg,OPTIGA_COMMAND_LAYER,OPTIGA_COMMAND_LAYER_COLOR);\
 173:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 174:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 175:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Logs the byte array buffer provided from Command layer in hexadecimal format
 176:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //lint --e{750} suppress "The unused OPTIGA_CMD_LOG_HEX_DATA macro is kept for future enhancements"
 177:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_HEX_DATA(array,array_len) \
 178:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {\
 179:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_print_array_hex_format(array,array_len,OPTIGA_UNPROTECTED_DATA_COLOR);\
 180:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 181:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 182:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Logs the status info provided from Command layer
 183:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //lint --e{750} suppress "The unused OPTIGA_CMD_LOG_STATUS macro is kept for future enhancements"
 184:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_STATUS(return_value) \
 185:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** { \
 186:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if (OPTIGA_LIB_SUCCESS != return_value) \
 187:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     { \
 188:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_lib_print_status(OPTIGA_COMMAND_LAYER,OPTIGA_ERROR_COLOR,return_value); \
 189:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } \
 190:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     else\
 191:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     { \
 192:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_lib_print_status(OPTIGA_COMMAND_LAYER,OPTIGA_COMMAND_LAYER_COLOR,return_value); \
 193:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } \
 194:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 195:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #else
 196:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 197:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_MESSAGE(msg) {}
 198:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //lint --e{750} suppress "The unused OPTIGA_CMD_LOG_HEX_DATA macro is kept for future enhancements"
 199:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_HEX_DATA(array, array_len) {}
 200:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //lint --e{750} suppress "The unused OPTIGA_CMD_LOG_STATUS macro is kept for future enhancements"
 201:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_LOG_STATUS(return_value) {}
 202:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 203:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif // (OPTIGA_LIB_ENABLE_LOGGING) && (OPTIGA_LIB_ENABLE_CMD_LOGGING)
 204:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 205:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Set data for apdu_data
 206:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_SET_APDU_DATA(apdu_cmd, apdu_info) ((apdu_info << OPTIGA_CMD_NO_OF_BITS_IN_BYTE)
 207:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 208:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Get APDU cmd value from apdu_data
 209:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_APDU_CMD(apdu_data)  ((uint8_t)apdu_data)
 210:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 211:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Get APDU info value from apdu_data
 212:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_APDU_INFO(apdu_data) ((uint8_t)(apdu_data >> OPTIGA_CMD_NO_OF_BITS_IN_BYTE))
 213:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 214:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Scheduler definitions
 215:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 216:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Optiga execution slot states
 217:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_NOT_ASSIGNED           (0x00)
 218:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_ASSIGNED               (0x01)
 219:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_REQUEST                (0x02)
 220:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_PROCESSING             (0x04)
 221:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_RESUME                 (0x08)
 222:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 223:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Optiga session state
 224:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_SESSION_NOT_ASSIGNED         (0x00)
 225:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_SESSION_ASSIGNED             (0x10)
 226:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //Session not assigned to optiga cmd instance
 227:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_NO_SESSION_OID               (0x0000)
 228:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_ALL_SESSION_ASSIGNED         (0x10101010)
 229:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 230:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Optiga slot request types
 231:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_REQUEST_LOCK           (0x21)
 232:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK    (0x23)
 233:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_REQUEST_SESSION        (0x22)
 234:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_NO_REQUEST             (0x00)
 235:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 236:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Type of slot, Do not change the values
 237:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_SLOT_STATE             (0x09)
 238:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Type of lock, Do not change the values
 239:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE         (0x08)
 240:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Frequency of scheduler polling when no asynchronous requests are pending
 241:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS     (1000U)
 242:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Frequency of scheduler polling when asynchronous requests is being processed
 243:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define     OPTIGA_CMD_SCHEDULER_RUNNING_TIME_MS    (50U)
 244:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 245:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /** \brief The enum represents diffrent main state of command handler */
 246:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** typedef enum optiga_cmd_state
 247:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 248:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_OPEN = 0,
 249:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_CLOSE,
 250:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_PREPARE_COMMAND,
 251:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_PROCESS_RESPONSE,
 252:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_ERROR_HANDLER
 253:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** } optiga_cmd_state_t;
 254:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 255:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /** \brief The enum represents diffrent sub state of command handler */
 256:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** typedef enum optiga_cmd_sub_state
 257:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 258:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_OPEN_ACQUIRE_LOCK = 0,
 259:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_OPEN_START,
 260:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_OPEN_DONE,
 261:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 262:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_CLOSE_START,
 263:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE,
 264:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 265:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_REQUEST_SESSION,
 266:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_REQUEST_LOCK,
 267:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_REQUEST_STRICT_LOCK,
 268:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_PREPARE_APDU,
 269:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 270:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE,
 271:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_GET_DEVICE_ERROR,
 272:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_EXEC_RELEASE_LOCK,
 273:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_STATE_EXIT
 274:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 275:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** } optiga_cmd_sub_state_t;
 276:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 277:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** typedef optiga_lib_status_t (*optiga_cmd_handler_t)(optiga_cmd_t * me);
 278:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 279:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /** \brief The structure represents the slot in the execution queue */
 280:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** typedef struct optiga_cmd_queue_slot
 281:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 282:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Registered context
 283:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     void * registered_ctx;
 284:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Arrival time of the optiga cmd instance in the execution queue
 285:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint32_t arrival_time;
 286:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Request for command lock or session
 287:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t request_type;
 288:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// state of the slot
 289:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t state_of_entry;
 290:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }optiga_cmd_queue_slot_t;
 291:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 292:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 293:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /**
 294:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * \brief OPTIGA Context which holds the communication buffer, comms instance and other required.
 295:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *   This would be maintained and consumed by OPTIGA Cmd.
 296:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 297:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** struct optiga_context
 298:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Context of OPTIGA Communication.
 300:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_comms_t * p_optiga_comms;
 301:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// comms tx size
 302:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t comms_tx_size;
 303:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// comms rx size
 304:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t comms_rx_size;
 305:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Structure which maintains the session and contexts of requesters to acquire session.
 306:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t sessions[OPTIGA_CMD_MAX_NUMBER_OF_SESSIONS];
 307:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Indicates if instance is initialized
 308:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t instance_init_state;
 309:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Communication buffer to send/receive APDUs.
 310:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t optiga_comms_buffer[OPTIGA_CMD_TOTAL_COMMS_BUFFER_SIZE];
 311:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// optiga execution queue
 312:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_slot_t optiga_cmd_execution_queue[OPTIGA_CMD_MAX_REGISTRATIONS];
 313:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// pal os event instance/context
 314:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     pal_os_event_t * p_pal_os_event_ctx;
 315:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Last processed cmd time stamp
 316:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint32_t last_time_stamp;
 317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// optiga context handle buffer
 318:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t optiga_context_handle_buffer[APP_CONTEXT_SIZE];
 319:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 320:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Protection level status flag
 321:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t protection_level_state;
 322:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 323:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** };
 324:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 325:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // static instance of optiga
 326:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_context_t g_optiga = {0};
 327:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 328:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // List of optiga instances
 329:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //lint --e{843} suppress "Not changing to const as this gets assigned to another context variable w
 330:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_context_t * g_optiga_list[] = {&g_optiga};
 331:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 332:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // hibernate data store for each instance of optiga
 333:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //lint --e{843} suppress "Not changing to const as this is used for unit testing as well"
 334:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H uint16_t g_hibernate_datastore_id_list[] = {OPTIGA_HIBERNATE_CONTEXT_ID};
 335:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 336:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** const uint8_t g_optiga_unique_application_identifier[] =
 337:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 338:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     0xD2, 0x76, 0x00, 0x00, 0x04, 0x47, 0x65, 0x6E, 0x41, 0x75, 0x74, 0x68, 0x41, 0x70, 0x70, 0x6C,
 339:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** };
 340:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 341:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /**
 342:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * \brief Command context
 343:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 344:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** struct optiga_cmd
 345:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 346:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Pointer to OPTIGA context which holds the communication buffer, comms instance and other re
 347:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_context_t * p_optiga;
 348:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Internal handlers for prepare and process
 349:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_handler_t cmd_hdlrs;
 350:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Command execution input parameters
 351:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     void * p_input;
 352:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 353:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Caller context
 354:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     void* caller_context;
 355:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Callback handler
 356:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     callback_handler_t handler;
 357:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Holds a Session OID allotted to this instance.
 358:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t session_oid;
 359:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// State of the command next execution state
 360:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_state_t cmd_next_execution_state;
 361:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// State of the command next execution state
 362:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t cmd_sub_execution_state;
 363:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Chaining flag
 364:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t chaining_ongoing;
 365:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Param value for the respective command to be processed
 366:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t cmd_param;
 367:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 368:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// To provide the encryption and decryption need for command and response
 369:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t protection_level;
 370:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// To provide the presentation layer protocol version to be used
 371:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t protocol_version;
 372:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// To provide the manage context options
 373:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t manage_context_operation;
 374:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 375:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// To provide error state
 376:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t device_error_status;
 377:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Assigned slot from execution queue
 378:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t queue_id;
 379:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Exit status value
 380:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t exit_status;
 381:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// Datastore ID for optiga context
 382:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t optiga_context_datastore_id;
 383:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /// To Store APDU command information which is last processed
 384:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t apdu_data;
 385:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** };
 386:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 387:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_get_error_code_handler(optiga_cmd_t * me);
 388:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 389:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 390:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //lint --e{714} suppress "This function is defined here but referred from other modules"
 391:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** void optiga_cmd_set_shielded_connection_option(optiga_cmd_t * me,
 392:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                uint8_t value,
 393:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                uint8_t shielded_connection_option)
 394:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 395:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch (shielded_connection_option)
 396:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 397:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // Protection Level
 398:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_SET_PROTECTION_LEVEL:
 399:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 400:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->protection_level = value;
 401:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 402:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
 403:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // Protocol Version
 404:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_SET_PROTECTION_VERSION:
 405:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 406:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->protocol_version = value;
 407:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 408:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
 409:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // Manage Context
 410:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_SET_MANAGE_CONTEXT:
 411:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 412:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->manage_context_operation = value;
 413:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 414:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
 415:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 416:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
 417:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 418:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 419:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 420:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif // OPTIGA_COMMS_SHIELDED_CONNECTION
 421:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 422:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Cmd execute handler
 423:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute(optiga_cmd_t * me,
 424:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   uint8_t cmd_param,
 425:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_handler_t cmd_hdlrs,
 426:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_state_t start_state,
 427:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_sub_state_t sub_state,
 428:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   void * input,
 429:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   uint16_t apdu_data);
 430:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 431:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** // Cmd State machine handler
 432:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_handler(void * p_ctx,
 433:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           optiga_lib_status_t event);
 434:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 435:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** //
 436:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_prepare_apdu_header(uint8_t cmd, uint8_t param,
 437:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               uint16_t in_data_length,
 438:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               uint8_t * p_apdu_buffer)
 439:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
  67              	 .loc 1 439 0
  68              	 .cfi_startproc
  69              	 
  70              	 
  71              	 
  72 0000 80B4     	 push {r7}
  73              	.LCFI0:
  74              	 .cfi_def_cfa_offset 4
  75              	 .cfi_offset 7,-4
  76 0002 83B0     	 sub sp,sp,#12
  77              	.LCFI1:
  78              	 .cfi_def_cfa_offset 16
  79 0004 00AF     	 add r7,sp,#0
  80              	.LCFI2:
  81              	 .cfi_def_cfa_register 7
  82 0006 3B60     	 str r3,[r7]
  83 0008 0346     	 mov r3,r0
  84 000a FB71     	 strb r3,[r7,#7]
  85 000c 0B46     	 mov r3,r1
  86 000e BB71     	 strb r3,[r7,#6]
  87 0010 1346     	 mov r3,r2
  88 0012 BB80     	 strh r3,[r7,#4]
 440:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [0] = cmd;
  89              	 .loc 1 440 0
  90 0014 3B68     	 ldr r3,[r7]
  91 0016 FA79     	 ldrb r2,[r7,#7]
  92 0018 1A70     	 strb r2,[r3]
 441:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [1] = param;
  93              	 .loc 1 441 0
  94 001a 3B68     	 ldr r3,[r7]
  95 001c 0133     	 adds r3,r3,#1
  96 001e BA79     	 ldrb r2,[r7,#6]
  97 0020 1A70     	 strb r2,[r3]
 442:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [2] = (uint8_t)((in_data_length & 0xFF00) >> 8);
  98              	 .loc 1 442 0
  99 0022 3B68     	 ldr r3,[r7]
 100 0024 0233     	 adds r3,r3,#2
 101 0026 BA88     	 ldrh r2,[r7,#4]
 102 0028 120A     	 lsrs r2,r2,#8
 103 002a 92B2     	 uxth r2,r2
 104 002c D2B2     	 uxtb r2,r2
 105 002e 1A70     	 strb r2,[r3]
 443:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     p_apdu_buffer [3] = (uint8_t)(in_data_length & 0x00FF);
 106              	 .loc 1 443 0
 107 0030 3B68     	 ldr r3,[r7]
 108 0032 0333     	 adds r3,r3,#3
 109 0034 BA88     	 ldrh r2,[r7,#4]
 110 0036 D2B2     	 uxtb r2,r2
 111 0038 1A70     	 strb r2,[r3]
 444:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 112              	 .loc 1 444 0
 113 003a 0C37     	 adds r7,r7,#12
 114              	.LCFI3:
 115              	 .cfi_def_cfa_offset 4
 116 003c BD46     	 mov sp,r7
 117              	.LCFI4:
 118              	 .cfi_def_cfa_register 13
 119              	 
 120 003e 5DF8047B 	 ldr r7,[sp],#4
 121              	.LCFI5:
 122              	 .cfi_restore 7
 123              	 .cfi_def_cfa_offset 0
 124 0042 7047     	 bx lr
 125              	 .cfi_endproc
 126              	.LFE0:
 128              	 .section .text.optiga_cmd_prepare_tag_header,"ax",%progbits
 129              	 .align 2
 130              	 .thumb
 131              	 .thumb_func
 133              	optiga_cmd_prepare_tag_header:
 134              	.LFB1:
 445:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 446:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 447:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_prepare_tag_header(uint8_t tag,
 448:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                              uint16_t tag_length,
 449:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                              uint8_t * buffer,
 450:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                              uint16_t * position)
 451:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 135              	 .loc 1 451 0
 136              	 .cfi_startproc
 137              	 
 138              	 
 139              	 
 140 0000 80B4     	 push {r7}
 141              	.LCFI6:
 142              	 .cfi_def_cfa_offset 4
 143              	 .cfi_offset 7,-4
 144 0002 87B0     	 sub sp,sp,#28
 145              	.LCFI7:
 146              	 .cfi_def_cfa_offset 32
 147 0004 00AF     	 add r7,sp,#0
 148              	.LCFI8:
 149              	 .cfi_def_cfa_register 7
 150 0006 BA60     	 str r2,[r7,#8]
 151 0008 7B60     	 str r3,[r7,#4]
 152 000a 0346     	 mov r3,r0
 153 000c FB73     	 strb r3,[r7,#15]
 154 000e 0B46     	 mov r3,r1
 155 0010 BB81     	 strh r3,[r7,#12]
 452:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t start_position = *position;
 156              	 .loc 1 452 0
 157 0012 7B68     	 ldr r3,[r7,#4]
 158 0014 1B88     	 ldrh r3,[r3]
 159 0016 FB82     	 strh r3,[r7,#22]
 453:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 454:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     buffer[start_position++] = tag;
 160              	 .loc 1 454 0
 161 0018 FB8A     	 ldrh r3,[r7,#22]
 162 001a 5A1C     	 adds r2,r3,#1
 163 001c FA82     	 strh r2,[r7,#22]
 164 001e 1A46     	 mov r2,r3
 165 0020 BB68     	 ldr r3,[r7,#8]
 166 0022 1344     	 add r3,r3,r2
 167 0024 FA7B     	 ldrb r2,[r7,#15]
 168 0026 1A70     	 strb r2,[r3]
 455:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     buffer[start_position++] = (uint8_t )(tag_length >> 8);
 169              	 .loc 1 455 0
 170 0028 FB8A     	 ldrh r3,[r7,#22]
 171 002a 5A1C     	 adds r2,r3,#1
 172 002c FA82     	 strh r2,[r7,#22]
 173 002e 1A46     	 mov r2,r3
 174 0030 BB68     	 ldr r3,[r7,#8]
 175 0032 1344     	 add r3,r3,r2
 176 0034 BA89     	 ldrh r2,[r7,#12]
 177 0036 120A     	 lsrs r2,r2,#8
 178 0038 92B2     	 uxth r2,r2
 179 003a D2B2     	 uxtb r2,r2
 180 003c 1A70     	 strb r2,[r3]
 456:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     buffer[start_position++] = (uint8_t )(tag_length);
 181              	 .loc 1 456 0
 182 003e FB8A     	 ldrh r3,[r7,#22]
 183 0040 5A1C     	 adds r2,r3,#1
 184 0042 FA82     	 strh r2,[r7,#22]
 185 0044 1A46     	 mov r2,r3
 186 0046 BB68     	 ldr r3,[r7,#8]
 187 0048 1344     	 add r3,r3,r2
 188 004a BA89     	 ldrh r2,[r7,#12]
 189 004c D2B2     	 uxtb r2,r2
 190 004e 1A70     	 strb r2,[r3]
 457:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 458:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     *position = start_position;
 191              	 .loc 1 458 0
 192 0050 7B68     	 ldr r3,[r7,#4]
 193 0052 FA8A     	 ldrh r2,[r7,#22]
 194 0054 1A80     	 strh r2,[r3]
 459:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 195              	 .loc 1 459 0
 196 0056 1C37     	 adds r7,r7,#28
 197              	.LCFI9:
 198              	 .cfi_def_cfa_offset 4
 199 0058 BD46     	 mov sp,r7
 200              	.LCFI10:
 201              	 .cfi_def_cfa_register 13
 202              	 
 203 005a 5DF8047B 	 ldr r7,[sp],#4
 204              	.LCFI11:
 205              	 .cfi_restore 7
 206              	 .cfi_def_cfa_offset 0
 207 005e 7047     	 bx lr
 208              	 .cfi_endproc
 209              	.LFE1:
 211              	 .section .text.optiga_cmd_event_trigger_execute,"ax",%progbits
 212              	 .align 2
 213              	 .thumb
 214              	 .thumb_func
 216              	optiga_cmd_event_trigger_execute:
 217              	.LFB2:
 460:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 461:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 462:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_event_trigger_execute(void * p_ctx)
 463:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 218              	 .loc 1 463 0
 219              	 .cfi_startproc
 220              	 
 221              	 
 222 0000 80B5     	 push {r7,lr}
 223              	.LCFI12:
 224              	 .cfi_def_cfa_offset 8
 225              	 .cfi_offset 7,-8
 226              	 .cfi_offset 14,-4
 227 0002 82B0     	 sub sp,sp,#8
 228              	.LCFI13:
 229              	 .cfi_def_cfa_offset 16
 230 0004 00AF     	 add r7,sp,#0
 231              	.LCFI14:
 232              	 .cfi_def_cfa_register 7
 233 0006 7860     	 str r0,[r7,#4]
 464:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(p_ctx, OPTIGA_LIB_SUCCESS);
 234              	 .loc 1 464 0
 235 0008 7868     	 ldr r0,[r7,#4]
 236 000a 0021     	 movs r1,#0
 237 000c FFF7FEFF 	 bl optiga_cmd_execute_handler
 465:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 238              	 .loc 1 465 0
 239 0010 0837     	 adds r7,r7,#8
 240              	.LCFI15:
 241              	 .cfi_def_cfa_offset 8
 242 0012 BD46     	 mov sp,r7
 243              	.LCFI16:
 244              	 .cfi_def_cfa_register 13
 245              	 
 246 0014 80BD     	 pop {r7,pc}
 247              	 .cfi_endproc
 248              	.LFE2:
 250 0016 00BF     	 .section .text.optiga_cmd_execute,"ax",%progbits
 251              	 .align 2
 252              	 .thumb
 253              	 .thumb_func
 255              	optiga_cmd_execute:
 256              	.LFB3:
 466:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 467:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute(optiga_cmd_t * me,
 468:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   uint8_t cmd_param,
 469:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_handler_t cmd_hdlrs,
 470:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_state_t start_state,
 471:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   optiga_cmd_sub_state_t sub_state,
 472:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   void * input,
 473:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   uint16_t apdu_data)
 474:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 257              	 .loc 1 474 0
 258              	 .cfi_startproc
 259              	 
 260              	 
 261 0000 80B5     	 push {r7,lr}
 262              	.LCFI17:
 263              	 .cfi_def_cfa_offset 8
 264              	 .cfi_offset 7,-8
 265              	 .cfi_offset 14,-4
 266 0002 84B0     	 sub sp,sp,#16
 267              	.LCFI18:
 268              	 .cfi_def_cfa_offset 24
 269 0004 00AF     	 add r7,sp,#0
 270              	.LCFI19:
 271              	 .cfi_def_cfa_register 7
 272 0006 F860     	 str r0,[r7,#12]
 273 0008 7A60     	 str r2,[r7,#4]
 274 000a 1A46     	 mov r2,r3
 275 000c 0B46     	 mov r3,r1
 276 000e FB72     	 strb r3,[r7,#11]
 277 0010 1346     	 mov r3,r2
 278 0012 BB72     	 strb r3,[r7,#10]
 475:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_input = input;
 279              	 .loc 1 475 0
 280 0014 FB68     	 ldr r3,[r7,#12]
 281 0016 FA69     	 ldr r2,[r7,#28]
 282 0018 9A60     	 str r2,[r3,#8]
 476:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->cmd_next_execution_state = start_state;
 283              	 .loc 1 476 0
 284 001a FB68     	 ldr r3,[r7,#12]
 285 001c BA7A     	 ldrb r2,[r7,#10]
 286 001e 9A75     	 strb r2,[r3,#22]
 477:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->cmd_sub_execution_state = sub_state;
 287              	 .loc 1 477 0
 288 0020 FB68     	 ldr r3,[r7,#12]
 289 0022 3A7E     	 ldrb r2,[r7,#24]
 290 0024 DA75     	 strb r2,[r3,#23]
 478:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->cmd_hdlrs = cmd_hdlrs;
 291              	 .loc 1 478 0
 292 0026 FB68     	 ldr r3,[r7,#12]
 293 0028 7A68     	 ldr r2,[r7,#4]
 294 002a 5A60     	 str r2,[r3,#4]
 479:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->chaining_ongoing = FALSE;
 295              	 .loc 1 479 0
 296 002c FB68     	 ldr r3,[r7,#12]
 297 002e 0022     	 movs r2,#0
 298 0030 1A76     	 strb r2,[r3,#24]
 480:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->cmd_param = cmd_param;
 299              	 .loc 1 480 0
 300 0032 FB68     	 ldr r3,[r7,#12]
 301 0034 FA7A     	 ldrb r2,[r7,#11]
 302 0036 5A76     	 strb r2,[r3,#25]
 481:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->apdu_data = apdu_data;
 303              	 .loc 1 481 0
 304 0038 FB68     	 ldr r3,[r7,#12]
 305 003a 3A8C     	 ldrh r2,[r7,#32]
 306 003c 1A84     	 strh r2,[r3,#32]
 482:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute_handler(me, OPTIGA_LIB_SUCCESS);
 307              	 .loc 1 482 0
 308 003e F868     	 ldr r0,[r7,#12]
 309 0040 0021     	 movs r1,#0
 310 0042 FFF7FEFF 	 bl optiga_cmd_execute_handler
 483:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 311              	 .loc 1 483 0
 312 0046 1037     	 adds r7,r7,#16
 313              	.LCFI20:
 314              	 .cfi_def_cfa_offset 8
 315 0048 BD46     	 mov sp,r7
 316              	.LCFI21:
 317              	 .cfi_def_cfa_register 13
 318              	 
 319 004a 80BD     	 pop {r7,pc}
 320              	 .cfi_endproc
 321              	.LFE3:
 323              	 .section .text.optiga_cmd_session_available,"ax",%progbits
 324              	 .align 2
 325              	 .thumb
 326              	 .thumb_func
 328              	optiga_cmd_session_available:
 329              	.LFB4:
 484:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 485:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 486:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Checks if optiga session is available or not
 487:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Returns TRUE, if slot is available
 488:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Returns FALSE, if slot is not available
 489:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 490:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H bool_t optiga_cmd_session_available(const optiga_context_t * p_optiga)
 491:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 330              	 .loc 1 491 0
 331              	 .cfi_startproc
 332              	 
 333              	 
 334 0000 80B5     	 push {r7,lr}
 335              	.LCFI22:
 336              	 .cfi_def_cfa_offset 8
 337              	 .cfi_offset 7,-8
 338              	 .cfi_offset 14,-4
 339 0002 84B0     	 sub sp,sp,#16
 340              	.LCFI23:
 341              	 .cfi_def_cfa_offset 24
 342 0004 00AF     	 add r7,sp,#0
 343              	.LCFI24:
 344              	 .cfi_def_cfa_register 7
 345 0006 7860     	 str r0,[r7,#4]
 492:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint32_t status_check;
 493:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // Consider the array as uin32_t value and check against 0x10101010
 494:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // where 0x10 is value of OPTIGA_CMD_SESSION_ASSIGNED
 495:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     status_check = optiga_common_get_uint32(p_optiga->sessions);
 346              	 .loc 1 495 0
 347 0008 7B68     	 ldr r3,[r7,#4]
 348 000a 0833     	 adds r3,r3,#8
 349 000c 1846     	 mov r0,r3
 350 000e FFF7FEFF 	 bl optiga_common_get_uint32
 351 0012 F860     	 str r0,[r7,#12]
 496:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return ((status_check < OPTIGA_CMD_ALL_SESSION_ASSIGNED)? (TRUE):(FALSE));
 352              	 .loc 1 496 0
 353 0014 FB68     	 ldr r3,[r7,#12]
 354 0016 B3F1103F 	 cmp r3,#269488144
 355 001a 01D2     	 bcs .L6
 356              	 .loc 1 496 0 is_stmt 0 discriminator 1
 357 001c 0123     	 movs r3,#1
 358 001e 00E0     	 b .L7
 359              	.L6:
 360              	 .loc 1 496 0 discriminator 2
 361 0020 0023     	 movs r3,#0
 362              	.L7:
 497:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 363              	 .loc 1 497 0 is_stmt 1 discriminator 4
 364 0022 1846     	 mov r0,r3
 365 0024 1037     	 adds r7,r7,#16
 366              	.LCFI25:
 367              	 .cfi_def_cfa_offset 8
 368 0026 BD46     	 mov sp,r7
 369              	.LCFI26:
 370              	 .cfi_def_cfa_register 13
 371              	 
 372 0028 80BD     	 pop {r7,pc}
 373              	 .cfi_endproc
 374              	.LFE4:
 376 002a 00BF     	 .section .text.optiga_cmd_session_assign,"ax",%progbits
 377              	 .align 2
 378              	 .thumb
 379              	 .thumb_func
 381              	optiga_cmd_session_assign:
 382              	.LFB5:
 498:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 499:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 500:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * 1. If a optiga cmd instance does not have session, assigns an available session
 501:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 502:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_session_assign(optiga_cmd_t * me)
 503:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 383              	 .loc 1 503 0
 384              	 .cfi_startproc
 385              	 
 386              	 
 387              	 
 388 0000 80B4     	 push {r7}
 389              	.LCFI27:
 390              	 .cfi_def_cfa_offset 4
 391              	 .cfi_offset 7,-4
 392 0002 85B0     	 sub sp,sp,#20
 393              	.LCFI28:
 394              	 .cfi_def_cfa_offset 24
 395 0004 00AF     	 add r7,sp,#0
 396              	.LCFI29:
 397              	 .cfi_def_cfa_register 7
 398 0006 7860     	 str r0,[r7,#4]
 504:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t * p_optiga_sessions = me->p_optiga->sessions;
 399              	 .loc 1 504 0
 400 0008 7B68     	 ldr r3,[r7,#4]
 401 000a 1B68     	 ldr r3,[r3]
 402 000c 0833     	 adds r3,r3,#8
 403 000e BB60     	 str r3,[r7,#8]
 505:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t count;
 506:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if (OPTIGA_CMD_NO_SESSION_OID == me->session_oid)
 404              	 .loc 1 506 0
 405 0010 7B68     	 ldr r3,[r7,#4]
 406 0012 9B8A     	 ldrh r3,[r3,#20]
 407 0014 002B     	 cmp r3,#0
 408 0016 1BD1     	 bne .L9
 507:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 508:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         for (count = 0; count < OPTIGA_CMD_MAX_NUMBER_OF_SESSIONS; count++)
 409              	 .loc 1 508 0
 410 0018 0023     	 movs r3,#0
 411 001a FB73     	 strb r3,[r7,#15]
 412 001c 15E0     	 b .L11
 413              	.L13:
 509:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 510:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_SESSION_ASSIGNED != p_optiga_sessions[count])
 414              	 .loc 1 510 0
 415 001e FB7B     	 ldrb r3,[r7,#15]
 416 0020 BA68     	 ldr r2,[r7,#8]
 417 0022 1344     	 add r3,r3,r2
 418 0024 1B78     	 ldrb r3,[r3]
 419 0026 102B     	 cmp r3,#16
 420 0028 0CD0     	 beq .L12
 511:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 512:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->session_oid = (OPTIGA_CMD_START_SESSION_OID | count);
 421              	 .loc 1 512 0
 422 002a FB7B     	 ldrb r3,[r7,#15]
 423 002c 9AB2     	 uxth r2,r3
 424 002e 0B4B     	 ldr r3,.L14
 425 0030 1343     	 orrs r3,r3,r2
 426 0032 9AB2     	 uxth r2,r3
 427 0034 7B68     	 ldr r3,[r7,#4]
 428 0036 9A82     	 strh r2,[r3,#20]
 513:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_sessions[count] = OPTIGA_CMD_SESSION_ASSIGNED;
 429              	 .loc 1 513 0
 430 0038 FB7B     	 ldrb r3,[r7,#15]
 431 003a BA68     	 ldr r2,[r7,#8]
 432 003c 1344     	 add r3,r3,r2
 433 003e 1022     	 movs r2,#16
 434 0040 1A70     	 strb r2,[r3]
 514:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 435              	 .loc 1 514 0
 436 0042 05E0     	 b .L9
 437              	.L12:
 508:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 438              	 .loc 1 508 0 discriminator 2
 439 0044 FB7B     	 ldrb r3,[r7,#15]
 440 0046 0133     	 adds r3,r3,#1
 441 0048 FB73     	 strb r3,[r7,#15]
 442              	.L11:
 508:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 443              	 .loc 1 508 0 is_stmt 0 discriminator 1
 444 004a FB7B     	 ldrb r3,[r7,#15]
 445 004c 032B     	 cmp r3,#3
 446 004e E6D9     	 bls .L13
 447              	.L9:
 515:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 516:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 517:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 518:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 448              	 .loc 1 518 0 is_stmt 1
 449 0050 1437     	 adds r7,r7,#20
 450              	.LCFI30:
 451              	 .cfi_def_cfa_offset 4
 452 0052 BD46     	 mov sp,r7
 453              	.LCFI31:
 454              	 .cfi_def_cfa_register 13
 455              	 
 456 0054 5DF8047B 	 ldr r7,[sp],#4
 457              	.LCFI32:
 458              	 .cfi_restore 7
 459              	 .cfi_def_cfa_offset 0
 460 0058 7047     	 bx lr
 461              	.L15:
 462 005a 00BF     	 .align 2
 463              	.L14:
 464 005c 00E1FFFF 	 .word -7936
 465              	 .cfi_endproc
 466              	.LFE5:
 468              	 .section .text.optiga_cmd_session_free,"ax",%progbits
 469              	 .align 2
 470              	 .thumb
 471              	 .thumb_func
 473              	optiga_cmd_session_free:
 474              	.LFB6:
 519:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 520:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 521:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Frees a session
 522:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 523:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_session_free(optiga_cmd_t * me)
 524:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 475              	 .loc 1 524 0
 476              	 .cfi_startproc
 477              	 
 478              	 
 479              	 
 480 0000 80B4     	 push {r7}
 481              	.LCFI33:
 482              	 .cfi_def_cfa_offset 4
 483              	 .cfi_offset 7,-4
 484 0002 85B0     	 sub sp,sp,#20
 485              	.LCFI34:
 486              	 .cfi_def_cfa_offset 24
 487 0004 00AF     	 add r7,sp,#0
 488              	.LCFI35:
 489              	 .cfi_def_cfa_register 7
 490 0006 7860     	 str r0,[r7,#4]
 525:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t * p_optiga_sessions = me->p_optiga->sessions;
 491              	 .loc 1 525 0
 492 0008 7B68     	 ldr r3,[r7,#4]
 493 000a 1B68     	 ldr r3,[r3]
 494 000c 0833     	 adds r3,r3,#8
 495 000e FB60     	 str r3,[r7,#12]
 526:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t count;
 527:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if (OPTIGA_CMD_NO_SESSION_OID != me->session_oid)
 496              	 .loc 1 527 0
 497 0010 7B68     	 ldr r3,[r7,#4]
 498 0012 9B8A     	 ldrh r3,[r3,#20]
 499 0014 002B     	 cmp r3,#0
 500 0016 0DD0     	 beq .L16
 528:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 529:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         count = me->session_oid & 0x0F;
 501              	 .loc 1 529 0
 502 0018 7B68     	 ldr r3,[r7,#4]
 503 001a 9B8A     	 ldrh r3,[r3,#20]
 504 001c DBB2     	 uxtb r3,r3
 505 001e 03F00F03 	 and r3,r3,#15
 506 0022 FB72     	 strb r3,[r7,#11]
 530:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->session_oid = OPTIGA_CMD_NO_SESSION_OID;
 507              	 .loc 1 530 0
 508 0024 7B68     	 ldr r3,[r7,#4]
 509 0026 0022     	 movs r2,#0
 510 0028 9A82     	 strh r2,[r3,#20]
 531:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         p_optiga_sessions[count] = OPTIGA_CMD_SESSION_NOT_ASSIGNED;
 511              	 .loc 1 531 0
 512 002a FB7A     	 ldrb r3,[r7,#11]
 513 002c FA68     	 ldr r2,[r7,#12]
 514 002e 1344     	 add r3,r3,r2
 515 0030 0022     	 movs r2,#0
 516 0032 1A70     	 strb r2,[r3]
 517              	.L16:
 532:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 533:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 518              	 .loc 1 533 0
 519 0034 1437     	 adds r7,r7,#20
 520              	.LCFI36:
 521              	 .cfi_def_cfa_offset 4
 522 0036 BD46     	 mov sp,r7
 523              	.LCFI37:
 524              	 .cfi_def_cfa_register 13
 525              	 
 526 0038 5DF8047B 	 ldr r7,[sp],#4
 527              	.LCFI38:
 528              	 .cfi_restore 7
 529              	 .cfi_def_cfa_offset 0
 530 003c 7047     	 bx lr
 531              	 .cfi_endproc
 532              	.LFE6:
 534 003e 00BF     	 .section .text.optiga_cmd_queue_get_state_of,"ax",%progbits
 535              	 .align 2
 536              	 .thumb
 537              	 .thumb_func
 539              	optiga_cmd_queue_get_state_of:
 540              	.LFB7:
 534:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 535:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 536:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *  Returns the requested info in the queue slot input cmd instance
 537:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 538:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H  uint8_t optiga_cmd_queue_get_state_of(const optiga_cmd_t * me, uint8_t slot_member)
 539:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 541              	 .loc 1 539 0
 542              	 .cfi_startproc
 543              	 
 544              	 
 545              	 
 546 0000 80B4     	 push {r7}
 547              	.LCFI39:
 548              	 .cfi_def_cfa_offset 4
 549              	 .cfi_offset 7,-4
 550 0002 85B0     	 sub sp,sp,#20
 551              	.LCFI40:
 552              	 .cfi_def_cfa_offset 24
 553 0004 00AF     	 add r7,sp,#0
 554              	.LCFI41:
 555              	 .cfi_def_cfa_register 7
 556 0006 7860     	 str r0,[r7,#4]
 557 0008 0B46     	 mov r3,r1
 558 000a FB70     	 strb r3,[r7,#3]
 540:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t state = 0;
 559              	 .loc 1 540 0
 560 000c 0023     	 movs r3,#0
 561 000e FB73     	 strb r3,[r7,#15]
 541:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch (slot_member)
 562              	 .loc 1 541 0
 563 0010 FB78     	 ldrb r3,[r7,#3]
 564 0012 082B     	 cmp r3,#8
 565 0014 02D0     	 beq .L20
 566 0016 092B     	 cmp r3,#9
 567 0018 0FD0     	 beq .L21
 542:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 543:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE:
 544:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 545:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             state = me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type;
 546:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 547:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
 548:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_QUEUE_SLOT_STATE:
 549:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 550:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             state = me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry;
 551:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 552:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
 553:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 554:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 568              	 .loc 1 554 0
 569 001a 1DE0     	 b .L22
 570              	.L20:
 545:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 571              	 .loc 1 545 0
 572 001c 7B68     	 ldr r3,[r7,#4]
 573 001e 1A68     	 ldr r2,[r3]
 574 0020 7B68     	 ldr r3,[r7,#4]
 575 0022 DB7E     	 ldrb r3,[r3,#27]
 576 0024 1946     	 mov r1,r3
 577 0026 0B46     	 mov r3,r1
 578 0028 5B00     	 lsls r3,r3,#1
 579 002a 0B44     	 add r3,r3,r1
 580 002c 9B00     	 lsls r3,r3,#2
 581 002e 1344     	 add r3,r3,r2
 582 0030 03F5C563 	 add r3,r3,#1576
 583 0034 1B79     	 ldrb r3,[r3,#4]
 584 0036 FB73     	 strb r3,[r7,#15]
 547:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_QUEUE_SLOT_STATE:
 585              	 .loc 1 547 0
 586 0038 0EE0     	 b .L22
 587              	.L21:
 550:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 588              	 .loc 1 550 0
 589 003a 7B68     	 ldr r3,[r7,#4]
 590 003c 1A68     	 ldr r2,[r3]
 591 003e 7B68     	 ldr r3,[r7,#4]
 592 0040 DB7E     	 ldrb r3,[r3,#27]
 593 0042 1946     	 mov r1,r3
 594 0044 0B46     	 mov r3,r1
 595 0046 5B00     	 lsls r3,r3,#1
 596 0048 0B44     	 add r3,r3,r1
 597 004a 9B00     	 lsls r3,r3,#2
 598 004c 1344     	 add r3,r3,r2
 599 004e 03F5C563 	 add r3,r3,#1576
 600 0052 5B79     	 ldrb r3,[r3,#5]
 601 0054 FB73     	 strb r3,[r7,#15]
 552:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 602              	 .loc 1 552 0
 603 0056 00BF     	 nop
 604              	.L22:
 555:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 556:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (state);
 605              	 .loc 1 556 0
 606 0058 FB7B     	 ldrb r3,[r7,#15]
 557:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 607              	 .loc 1 557 0
 608 005a 1846     	 mov r0,r3
 609 005c 1437     	 adds r7,r7,#20
 610              	.LCFI42:
 611              	 .cfi_def_cfa_offset 4
 612 005e BD46     	 mov sp,r7
 613              	.LCFI43:
 614              	 .cfi_def_cfa_register 13
 615              	 
 616 0060 5DF8047B 	 ldr r7,[sp],#4
 617              	.LCFI44:
 618              	 .cfi_restore 7
 619              	 .cfi_def_cfa_offset 0
 620 0064 7047     	 bx lr
 621              	 .cfi_endproc
 622              	.LFE7:
 624 0066 00BF     	 .section .text.optiga_cmd_queue_get_count_of,"ax",%progbits
 625              	 .align 2
 626              	 .thumb
 627              	 .thumb_func
 629              	optiga_cmd_queue_get_count_of:
 630              	.LFB8:
 558:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 559:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 560:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Returns the count of number of slots with requested state
 561:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 562:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H  uint8_t optiga_cmd_queue_get_count_of(const optiga_context_t * p_optiga,
 563:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                  uint8_t slot_member,
 564:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                  uint8_t state_to_check)
 565:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 631              	 .loc 1 565 0
 632              	 .cfi_startproc
 633              	 
 634              	 
 635              	 
 636 0000 80B4     	 push {r7}
 637              	.LCFI45:
 638              	 .cfi_def_cfa_offset 4
 639              	 .cfi_offset 7,-4
 640 0002 85B0     	 sub sp,sp,#20
 641              	.LCFI46:
 642              	 .cfi_def_cfa_offset 24
 643 0004 00AF     	 add r7,sp,#0
 644              	.LCFI47:
 645              	 .cfi_def_cfa_register 7
 646 0006 7860     	 str r0,[r7,#4]
 647 0008 0B46     	 mov r3,r1
 648 000a FB70     	 strb r3,[r7,#3]
 649 000c 1346     	 mov r3,r2
 650 000e BB70     	 strb r3,[r7,#2]
 566:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t index;
 567:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t count = 0;
 651              	 .loc 1 567 0
 652 0010 0023     	 movs r3,#0
 653 0012 BB73     	 strb r3,[r7,#14]
 568:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t slot_value = 0;
 654              	 .loc 1 568 0
 655 0014 0023     	 movs r3,#0
 656 0016 7B73     	 strb r3,[r7,#13]
 569:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     for (index = 0; index < OPTIGA_CMD_MAX_REGISTRATIONS ; index++)
 657              	 .loc 1 569 0
 658 0018 0023     	 movs r3,#0
 659 001a FB73     	 strb r3,[r7,#15]
 660 001c 27E0     	 b .L25
 661              	.L31:
 570:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 571:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         switch (slot_member)
 662              	 .loc 1 571 0
 663 001e FB78     	 ldrb r3,[r7,#3]
 664 0020 082B     	 cmp r3,#8
 665 0022 02D0     	 beq .L27
 666 0024 092B     	 cmp r3,#9
 667 0026 0CD0     	 beq .L28
 572:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 573:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE:
 574:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 575:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 slot_value = p_optiga->optiga_cmd_execution_queue[index].request_type;
 576:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 577:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 578:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_QUEUE_SLOT_STATE:
 579:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 580:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 slot_value = p_optiga->optiga_cmd_execution_queue[index].state_of_entry;
 581:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 582:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 583:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             default:
 584:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 668              	 .loc 1 584 0
 669 0028 17E0     	 b .L29
 670              	.L27:
 575:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 671              	 .loc 1 575 0
 672 002a FA7B     	 ldrb r2,[r7,#15]
 673 002c 7968     	 ldr r1,[r7,#4]
 674 002e 1346     	 mov r3,r2
 675 0030 5B00     	 lsls r3,r3,#1
 676 0032 1344     	 add r3,r3,r2
 677 0034 9B00     	 lsls r3,r3,#2
 678 0036 0B44     	 add r3,r3,r1
 679 0038 03F5C563 	 add r3,r3,#1576
 680 003c 1B79     	 ldrb r3,[r3,#4]
 681 003e 7B73     	 strb r3,[r7,#13]
 577:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_QUEUE_SLOT_STATE:
 682              	 .loc 1 577 0
 683 0040 0BE0     	 b .L29
 684              	.L28:
 580:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 685              	 .loc 1 580 0
 686 0042 FA7B     	 ldrb r2,[r7,#15]
 687 0044 7968     	 ldr r1,[r7,#4]
 688 0046 1346     	 mov r3,r2
 689 0048 5B00     	 lsls r3,r3,#1
 690 004a 1344     	 add r3,r3,r2
 691 004c 9B00     	 lsls r3,r3,#2
 692 004e 0B44     	 add r3,r3,r1
 693 0050 03F5C563 	 add r3,r3,#1576
 694 0054 5B79     	 ldrb r3,[r3,#5]
 695 0056 7B73     	 strb r3,[r7,#13]
 582:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             default:
 696              	 .loc 1 582 0
 697 0058 00BF     	 nop
 698              	.L29:
 585:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 586:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (state_to_check == slot_value)
 699              	 .loc 1 586 0
 700 005a BA78     	 ldrb r2,[r7,#2]
 701 005c 7B7B     	 ldrb r3,[r7,#13]
 702 005e 9A42     	 cmp r2,r3
 703 0060 02D1     	 bne .L30
 587:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 588:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             count++;
 704              	 .loc 1 588 0
 705 0062 BB7B     	 ldrb r3,[r7,#14]
 706 0064 0133     	 adds r3,r3,#1
 707 0066 BB73     	 strb r3,[r7,#14]
 708              	.L30:
 569:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 709              	 .loc 1 569 0 discriminator 2
 710 0068 FB7B     	 ldrb r3,[r7,#15]
 711 006a 0133     	 adds r3,r3,#1
 712 006c FB73     	 strb r3,[r7,#15]
 713              	.L25:
 569:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 714              	 .loc 1 569 0 is_stmt 0 discriminator 1
 715 006e FB7B     	 ldrb r3,[r7,#15]
 716 0070 052B     	 cmp r3,#5
 717 0072 D4D9     	 bls .L31
 589:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 590:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 591:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (count);
 718              	 .loc 1 591 0 is_stmt 1
 719 0074 BB7B     	 ldrb r3,[r7,#14]
 592:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 720              	 .loc 1 592 0
 721 0076 1846     	 mov r0,r3
 722 0078 1437     	 adds r7,r7,#20
 723              	.LCFI48:
 724              	 .cfi_def_cfa_offset 4
 725 007a BD46     	 mov sp,r7
 726              	.LCFI49:
 727              	 .cfi_def_cfa_register 13
 728              	 
 729 007c 5DF8047B 	 ldr r7,[sp],#4
 730              	.LCFI50:
 731              	 .cfi_restore 7
 732              	 .cfi_def_cfa_offset 0
 733 0080 7047     	 bx lr
 734              	 .cfi_endproc
 735              	.LFE8:
 737 0082 00BF     	 .section .text.optiga_cmd_queue_assign_slot,"ax",%progbits
 738              	 .align 2
 739              	 .thumb
 740              	 .thumb_func
 742              	optiga_cmd_queue_assign_slot:
 743              	.LFB9:
 593:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 594:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 595:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Assigns an available slot to a optiga cmd instance and marks the slot as not available for anothe
 596:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 597:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_assign_slot(const optiga_cmd_t * me, uint8_t * queue_index_store)
 598:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 744              	 .loc 1 598 0
 745              	 .cfi_startproc
 746              	 
 747              	 
 748              	 
 749 0000 80B4     	 push {r7}
 750              	.LCFI51:
 751              	 .cfi_def_cfa_offset 4
 752              	 .cfi_offset 7,-4
 753 0002 85B0     	 sub sp,sp,#20
 754              	.LCFI52:
 755              	 .cfi_def_cfa_offset 24
 756 0004 00AF     	 add r7,sp,#0
 757              	.LCFI53:
 758              	 .cfi_def_cfa_register 7
 759 0006 7860     	 str r0,[r7,#4]
 760 0008 3960     	 str r1,[r7]
 599:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t index;
 600:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     for (index = 0; index < OPTIGA_CMD_MAX_REGISTRATIONS ; index++)
 761              	 .loc 1 600 0
 762 000a 0023     	 movs r3,#0
 763 000c FB73     	 strb r3,[r7,#15]
 764 000e 1FE0     	 b .L34
 765              	.L37:
 601:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 602:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_CMD_QUEUE_NOT_ASSIGNED == me->p_optiga->optiga_cmd_execution_queue[index].state_
 766              	 .loc 1 602 0
 767 0010 7B68     	 ldr r3,[r7,#4]
 768 0012 1968     	 ldr r1,[r3]
 769 0014 FA7B     	 ldrb r2,[r7,#15]
 770 0016 1346     	 mov r3,r2
 771 0018 5B00     	 lsls r3,r3,#1
 772 001a 1344     	 add r3,r3,r2
 773 001c 9B00     	 lsls r3,r3,#2
 774 001e 0B44     	 add r3,r3,r1
 775 0020 03F5C563 	 add r3,r3,#1576
 776 0024 5B79     	 ldrb r3,[r3,#5]
 777 0026 002B     	 cmp r3,#0
 778 0028 0FD1     	 bne .L35
 603:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 604:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             * queue_index_store =  index;
 779              	 .loc 1 604 0
 780 002a 3B68     	 ldr r3,[r7]
 781 002c FA7B     	 ldrb r2,[r7,#15]
 782 002e 1A70     	 strb r2,[r3]
 605:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->optiga_cmd_execution_queue[index].state_of_entry = OPTIGA_CMD_QUEUE_ASSIG
 783              	 .loc 1 605 0
 784 0030 7B68     	 ldr r3,[r7,#4]
 785 0032 1968     	 ldr r1,[r3]
 786 0034 FA7B     	 ldrb r2,[r7,#15]
 787 0036 1346     	 mov r3,r2
 788 0038 5B00     	 lsls r3,r3,#1
 789 003a 1344     	 add r3,r3,r2
 790 003c 9B00     	 lsls r3,r3,#2
 791 003e 0B44     	 add r3,r3,r1
 792 0040 03F5C563 	 add r3,r3,#1576
 793 0044 0122     	 movs r2,#1
 794 0046 5A71     	 strb r2,[r3,#5]
 606:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****            break;
 795              	 .loc 1 606 0
 796 0048 05E0     	 b .L33
 797              	.L35:
 600:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 798              	 .loc 1 600 0 discriminator 2
 799 004a FB7B     	 ldrb r3,[r7,#15]
 800 004c 0133     	 adds r3,r3,#1
 801 004e FB73     	 strb r3,[r7,#15]
 802              	.L34:
 600:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 803              	 .loc 1 600 0 is_stmt 0 discriminator 1
 804 0050 FB7B     	 ldrb r3,[r7,#15]
 805 0052 052B     	 cmp r3,#5
 806 0054 DCD9     	 bls .L37
 807              	.L33:
 607:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 608:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 609:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 808              	 .loc 1 609 0 is_stmt 1
 809 0056 1437     	 adds r7,r7,#20
 810              	.LCFI54:
 811              	 .cfi_def_cfa_offset 4
 812 0058 BD46     	 mov sp,r7
 813              	.LCFI55:
 814              	 .cfi_def_cfa_register 13
 815              	 
 816 005a 5DF8047B 	 ldr r7,[sp],#4
 817              	.LCFI56:
 818              	 .cfi_restore 7
 819              	 .cfi_def_cfa_offset 0
 820 005e 7047     	 bx lr
 821              	 .cfi_endproc
 822              	.LFE9:
 824              	 .section .text.optiga_cmd_queue_deassign_slot,"ax",%progbits
 825              	 .align 2
 826              	 .thumb
 827              	 .thumb_func
 829              	optiga_cmd_queue_deassign_slot:
 830              	.LFB10:
 610:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 611:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 612:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * De-assigns a slot from a optiga cmd instance and makes the slot available for next optiga cmd ins
 613:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 614:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_deassign_slot(optiga_cmd_t * me)
 615:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 831              	 .loc 1 615 0
 832              	 .cfi_startproc
 833              	 
 834              	 
 835              	 
 836 0000 80B4     	 push {r7}
 837              	.LCFI57:
 838              	 .cfi_def_cfa_offset 4
 839              	 .cfi_offset 7,-4
 840 0002 83B0     	 sub sp,sp,#12
 841              	.LCFI58:
 842              	 .cfi_def_cfa_offset 16
 843 0004 00AF     	 add r7,sp,#0
 844              	.LCFI59:
 845              	 .cfi_def_cfa_register 7
 846 0006 7860     	 str r0,[r7,#4]
 616:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry = OPTIGA_CMD_QUEUE_NOT_AS
 847              	 .loc 1 616 0
 848 0008 7B68     	 ldr r3,[r7,#4]
 849 000a 1A68     	 ldr r2,[r3]
 850 000c 7B68     	 ldr r3,[r7,#4]
 851 000e DB7E     	 ldrb r3,[r3,#27]
 852 0010 1946     	 mov r1,r3
 853 0012 0B46     	 mov r3,r1
 854 0014 5B00     	 lsls r3,r3,#1
 855 0016 0B44     	 add r3,r3,r1
 856 0018 9B00     	 lsls r3,r3,#2
 857 001a 1344     	 add r3,r3,r2
 858 001c 03F5C563 	 add r3,r3,#1576
 859 0020 0022     	 movs r2,#0
 860 0022 5A71     	 strb r2,[r3,#5]
 617:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type = OPTIGA_CMD_QUEUE_NO_REQUE
 861              	 .loc 1 617 0
 862 0024 7B68     	 ldr r3,[r7,#4]
 863 0026 1A68     	 ldr r2,[r3]
 864 0028 7B68     	 ldr r3,[r7,#4]
 865 002a DB7E     	 ldrb r3,[r3,#27]
 866 002c 1946     	 mov r1,r3
 867 002e 0B46     	 mov r3,r1
 868 0030 5B00     	 lsls r3,r3,#1
 869 0032 0B44     	 add r3,r3,r1
 870 0034 9B00     	 lsls r3,r3,#2
 871 0036 1344     	 add r3,r3,r2
 872 0038 03F5C563 	 add r3,r3,#1576
 873 003c 0022     	 movs r2,#0
 874 003e 1A71     	 strb r2,[r3,#4]
 618:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->queue_id = 0;
 875              	 .loc 1 618 0
 876 0040 7B68     	 ldr r3,[r7,#4]
 877 0042 0022     	 movs r2,#0
 878 0044 DA76     	 strb r2,[r3,#27]
 619:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 879              	 .loc 1 619 0
 880 0046 0C37     	 adds r7,r7,#12
 881              	.LCFI60:
 882              	 .cfi_def_cfa_offset 4
 883 0048 BD46     	 mov sp,r7
 884              	.LCFI61:
 885              	 .cfi_def_cfa_register 13
 886              	 
 887 004a 5DF8047B 	 ldr r7,[sp],#4
 888              	.LCFI62:
 889              	 .cfi_restore 7
 890              	 .cfi_def_cfa_offset 0
 891 004e 7047     	 bx lr
 892              	 .cfi_endproc
 893              	.LFE10:
 895              	 .section .text.optiga_cmd_queue_scheduler,"ax",%progbits
 896              	 .align 2
 897              	 .thumb
 898              	 .thumb_func
 900              	optiga_cmd_queue_scheduler:
 901              	.LFB11:
 620:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 621:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 622:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Select next optiga cmd instance from the execution queue based on a rule
 623:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * 1. A slot with OPTIGA_CMD_QUEUE_RESUME state should exist
 624:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * 2. Pick the slot which has acquired the strict slot
 625:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * 3. If no slot with OPTIGA_CMD_QUEUE_RESUME exists, slot must be in OPTIGA_CMD_QUEUE_REQUEST state
 626:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * 4. The arrival time must be the earliest provided
 627:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *     a. The request type is lock
 628:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** *     b. If request type is session, either session is already assigned or atleast session is avail
 629:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 630:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_scheduler(void * p_optiga)
 631:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 902              	 .loc 1 631 0
 903              	 .cfi_startproc
 904              	 
 905              	 
 906 0000 80B5     	 push {r7,lr}
 907              	.LCFI63:
 908              	 .cfi_def_cfa_offset 8
 909              	 .cfi_offset 7,-8
 910              	 .cfi_offset 14,-4
 911 0002 88B0     	 sub sp,sp,#32
 912              	.LCFI64:
 913              	 .cfi_def_cfa_offset 40
 914 0004 00AF     	 add r7,sp,#0
 915              	.LCFI65:
 916              	 .cfi_def_cfa_register 7
 917 0006 7860     	 str r0,[r7,#4]
 632:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint32_t reference_time_stamp = 0xFFFFFFFF;
 918              	 .loc 1 632 0
 919 0008 4FF0FF33 	 mov r3,#-1
 920 000c FB61     	 str r3,[r7,#28]
 633:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_slot_t * p_queue_entry;
 634:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t index;
 635:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t prefered_index = 0xFF;
 921              	 .loc 1 635 0
 922 000e FF23     	 movs r3,#255
 923 0010 BB76     	 strb r3,[r7,#26]
 636:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t overflow_detected = FALSE;
 924              	 .loc 1 636 0
 925 0012 0023     	 movs r3,#0
 926 0014 7B76     	 strb r3,[r7,#25]
 637:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 638:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_context_t * p_optiga_ctx = (optiga_context_t * )p_optiga;
 927              	 .loc 1 638 0
 928 0016 7B68     	 ldr r3,[r7,#4]
 929 0018 7B61     	 str r3,[r7,#20]
 639:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 640:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     pal_os_event_t * my_os_event = p_optiga_ctx->p_pal_os_event_ctx;
 930              	 .loc 1 640 0
 931 001a 7B69     	 ldr r3,[r7,#20]
 932 001c D3F86C36 	 ldr r3,[r3,#1644]
 933 0020 3B61     	 str r3,[r7,#16]
 641:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 642:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 643:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if (((0 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE, OPTIGA_CMD_
 934              	 .loc 1 643 0
 935 0022 7869     	 ldr r0,[r7,#20]
 936 0024 0921     	 movs r1,#9
 937 0026 0222     	 movs r2,#2
 938 0028 FFF7FEFF 	 bl optiga_cmd_queue_get_count_of
 939 002c 0346     	 mov r3,r0
 940 002e 002B     	 cmp r3,#0
 941 0030 07D1     	 bne .L40
 644:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****          (0 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE, OPTIGA_CMD_
 942              	 .loc 1 644 0 discriminator 1
 943 0032 7869     	 ldr r0,[r7,#20]
 944 0034 0921     	 movs r1,#9
 945 0036 0822     	 movs r2,#8
 946 0038 FFF7FEFF 	 bl optiga_cmd_queue_get_count_of
 947 003c 0346     	 mov r3,r0
 643:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****          (0 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE, OPTIGA_CMD_
 948              	 .loc 1 643 0 discriminator 1
 949 003e 002B     	 cmp r3,#0
 950 0040 0FD0     	 beq .L41
 951              	.L40:
 645:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****          ((1 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE , OPTIGA_CM
 952              	 .loc 1 645 0
 953 0042 7869     	 ldr r0,[r7,#20]
 954 0044 0921     	 movs r1,#9
 955 0046 0422     	 movs r2,#4
 956 0048 FFF7FEFF 	 bl optiga_cmd_queue_get_count_of
 957 004c 0346     	 mov r3,r0
 644:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****          (0 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE, OPTIGA_CMD_
 958              	 .loc 1 644 0
 959 004e 012B     	 cmp r3,#1
 960 0050 0FD1     	 bne .L42
 646:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****          (0 < optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_LOCK_TYPE, OPTIGA_C
 961              	 .loc 1 646 0
 962 0052 7869     	 ldr r0,[r7,#20]
 963 0054 0821     	 movs r1,#8
 964 0056 2322     	 movs r2,#35
 965 0058 FFF7FEFF 	 bl optiga_cmd_queue_get_count_of
 966 005c 0346     	 mov r3,r0
 645:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****          ((1 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE , OPTIGA_CM
 967              	 .loc 1 645 0
 968 005e 002B     	 cmp r3,#0
 969 0060 07D0     	 beq .L42
 970              	.L41:
 647:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 648:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // call self
 649:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         pal_os_event_register_callback_oneshot(my_os_event, optiga_cmd_queue_scheduler,
 971              	 .loc 1 649 0
 972 0062 3869     	 ldr r0,[r7,#16]
 973 0064 6F49     	 ldr r1,.L58
 974 0066 7A69     	 ldr r2,[r7,#20]
 975 0068 4FF47A73 	 mov r3,#1000
 976 006c FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 977 0070 D5E0     	 b .L39
 978              	.L42:
 650:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                p_optiga_ctx,OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
 651:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 652:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     else
 653:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 654:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         pal_os_event_stop(my_os_event);
 979              	 .loc 1 654 0
 980 0072 3869     	 ldr r0,[r7,#16]
 981 0074 FFF7FEFF 	 bl pal_os_event_stop
 982              	.L55:
 655:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // continue checking if no context selected and overflow detected
 656:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         do
 657:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 658:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //reset overflow detected flag and the last_time stamp
 659:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if(overflow_detected == TRUE)
 983              	 .loc 1 659 0
 984 0078 7B7E     	 ldrb r3,[r7,#25]
 985 007a 012B     	 cmp r3,#1
 986 007c 05D1     	 bne .L44
 660:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 661:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_ctx->last_time_stamp = 0;
 987              	 .loc 1 661 0
 988 007e 7B69     	 ldr r3,[r7,#20]
 989 0080 0022     	 movs r2,#0
 990 0082 C3F87026 	 str r2,[r3,#1648]
 662:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 overflow_detected = FALSE;
 991              	 .loc 1 662 0
 992 0086 0023     	 movs r3,#0
 993 0088 7B76     	 strb r3,[r7,#25]
 994              	.L44:
 663:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 664:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 665:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // Select optiga command based on rule
 666:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             for (index = 0; index < OPTIGA_CMD_MAX_REGISTRATIONS; index++)
 995              	 .loc 1 666 0
 996 008a 0023     	 movs r3,#0
 997 008c FB76     	 strb r3,[r7,#27]
 998 008e 5CE0     	 b .L45
 999              	.L53:
 667:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 668:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_queue_entry = &(p_optiga_ctx->optiga_cmd_execution_queue[index]);
 1000              	 .loc 1 668 0
 1001 0090 FA7E     	 ldrb r2,[r7,#27]
 1002 0092 1346     	 mov r3,r2
 1003 0094 5B00     	 lsls r3,r3,#1
 1004 0096 1344     	 add r3,r3,r2
 1005 0098 9B00     	 lsls r3,r3,#2
 1006 009a 03F5C463 	 add r3,r3,#1568
 1007 009e 7A69     	 ldr r2,[r7,#20]
 1008 00a0 1344     	 add r3,r3,r2
 1009 00a2 0433     	 adds r3,r3,#4
 1010 00a4 FB60     	 str r3,[r7,#12]
 669:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 670:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // if any slot has acquired strict lock, highest priority is given to it
 671:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (1 == optiga_cmd_queue_get_count_of(p_optiga_ctx, OPTIGA_CMD_QUEUE_SLOT_STATE , 
 1011              	 .loc 1 671 0
 1012 00a6 7869     	 ldr r0,[r7,#20]
 1013 00a8 0921     	 movs r1,#9
 1014 00aa 0822     	 movs r2,#8
 1015 00ac FFF7FEFF 	 bl optiga_cmd_queue_get_count_of
 1016 00b0 0346     	 mov r3,r0
 1017 00b2 012B     	 cmp r3,#1
 1018 00b4 0DD1     	 bne .L46
 672:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 673:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     // Select the slot which has acquired strict lock
 674:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     if ((OPTIGA_CMD_QUEUE_RESUME == p_queue_entry->state_of_entry) &&
 1019              	 .loc 1 674 0
 1020 00b6 FB68     	 ldr r3,[r7,#12]
 1021 00b8 5B7A     	 ldrb r3,[r3,#9]
 1022 00ba 082B     	 cmp r3,#8
 1023 00bc 42D1     	 bne .L48
 675:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == p_queue_entry->request_type))
 1024              	 .loc 1 675 0 discriminator 1
 1025 00be FB68     	 ldr r3,[r7,#12]
 1026 00c0 1B7A     	 ldrb r3,[r3,#8]
 674:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == p_queue_entry->request_type))
 1027              	 .loc 1 674 0 discriminator 1
 1028 00c2 232B     	 cmp r3,#35
 1029 00c4 3ED1     	 bne .L48
 676:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     {
 677:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         reference_time_stamp = p_queue_entry->arrival_time;
 1030              	 .loc 1 677 0
 1031 00c6 FB68     	 ldr r3,[r7,#12]
 1032 00c8 5B68     	 ldr r3,[r3,#4]
 1033 00ca FB61     	 str r3,[r7,#28]
 678:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         prefered_index = index;
 1034              	 .loc 1 678 0
 1035 00cc FB7E     	 ldrb r3,[r7,#27]
 1036 00ce BB76     	 strb r3,[r7,#26]
 1037 00d0 38E0     	 b .L48
 1038              	.L46:
 679:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     }
 680:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 681:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 682:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
 683:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 684:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     // pick only requested queue slot and earliest arrival time
 685:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     if (p_queue_entry->state_of_entry == OPTIGA_CMD_QUEUE_REQUEST)
 1039              	 .loc 1 685 0
 1040 00d2 FB68     	 ldr r3,[r7,#12]
 1041 00d4 5B7A     	 ldrb r3,[r3,#9]
 1042 00d6 022B     	 cmp r3,#2
 1043 00d8 34D1     	 bne .L48
 686:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     {
 687:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         // remember that overflow has occurred in one of the entry
 688:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         if (p_queue_entry->arrival_time < p_optiga_ctx->last_time_stamp)
 1044              	 .loc 1 688 0
 1045 00da FB68     	 ldr r3,[r7,#12]
 1046 00dc 5A68     	 ldr r2,[r3,#4]
 1047 00de 7B69     	 ldr r3,[r7,#20]
 1048 00e0 D3F87036 	 ldr r3,[r3,#1648]
 1049 00e4 9A42     	 cmp r2,r3
 1050 00e6 01D2     	 bcs .L49
 689:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         {
 690:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             overflow_detected = TRUE;
 1051              	 .loc 1 690 0
 1052 00e8 0123     	 movs r3,#1
 1053 00ea 7B76     	 strb r3,[r7,#25]
 1054              	.L49:
 691:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         }
 692:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 693:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         // if lock request or session request and session available(either already 
 694:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         if (((p_queue_entry->arrival_time <= reference_time_stamp) && (p_queue_entr
 1055              	 .loc 1 694 0
 1056 00ec FB68     	 ldr r3,[r7,#12]
 1057 00ee 5A68     	 ldr r2,[r3,#4]
 1058 00f0 FB69     	 ldr r3,[r7,#28]
 1059 00f2 9A42     	 cmp r2,r3
 1060 00f4 26D8     	 bhi .L48
 1061              	 .loc 1 694 0 is_stmt 0 discriminator 1
 1062 00f6 FB68     	 ldr r3,[r7,#12]
 1063 00f8 5A68     	 ldr r2,[r3,#4]
 1064 00fa 7B69     	 ldr r3,[r7,#20]
 1065 00fc D3F87036 	 ldr r3,[r3,#1648]
 1066 0100 9A42     	 cmp r2,r3
 1067 0102 1FD3     	 bcc .L48
 695:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             (((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && 
 1068              	 .loc 1 695 0 is_stmt 1 discriminator 2
 1069 0104 FB68     	 ldr r3,[r7,#12]
 1070 0106 1B7A     	 ldrb r3,[r3,#8]
 694:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             (((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && 
 1071              	 .loc 1 694 0 discriminator 2
 1072 0108 222B     	 cmp r3,#34
 1073 010a 05D1     	 bne .L50
 1074              	 .loc 1 695 0
 1075 010c 7869     	 ldr r0,[r7,#20]
 1076 010e FFF7FEFF 	 bl optiga_cmd_session_available
 1077 0112 0346     	 mov r3,r0
 1078 0114 012B     	 cmp r3,#1
 1079 0116 10D0     	 beq .L51
 1080              	.L50:
 696:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             ((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && (
 1081              	 .loc 1 696 0 discriminator 1
 1082 0118 FB68     	 ldr r3,[r7,#12]
 1083 011a 1B7A     	 ldrb r3,[r3,#8]
 695:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             (((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && 
 1084              	 .loc 1 695 0 discriminator 1
 1085 011c 222B     	 cmp r3,#34
 1086 011e 04D1     	 bne .L52
 1087              	 .loc 1 696 0
 1088 0120 FB68     	 ldr r3,[r7,#12]
 1089 0122 1B68     	 ldr r3,[r3]
 1090 0124 9B8A     	 ldrh r3,[r3,#20]
 1091 0126 002B     	 cmp r3,#0
 1092 0128 07D1     	 bne .L51
 1093              	.L52:
 697:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             (OPTIGA_CMD_QUEUE_REQUEST_LOCK == p_queue_entry->request_type) ||
 1094              	 .loc 1 697 0 discriminator 1
 1095 012a FB68     	 ldr r3,[r7,#12]
 1096 012c 1B7A     	 ldrb r3,[r3,#8]
 696:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             ((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_queue_entry->request_type) && (
 1097              	 .loc 1 696 0 discriminator 1
 1098 012e 212B     	 cmp r3,#33
 1099 0130 03D0     	 beq .L51
 698:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == p_queue_entry->request_type)))
 1100              	 .loc 1 698 0
 1101 0132 FB68     	 ldr r3,[r7,#12]
 1102 0134 1B7A     	 ldrb r3,[r3,#8]
 697:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             (OPTIGA_CMD_QUEUE_REQUEST_LOCK == p_queue_entry->request_type) ||
 1103              	 .loc 1 697 0
 1104 0136 232B     	 cmp r3,#35
 1105 0138 04D1     	 bne .L48
 1106              	.L51:
 699:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         {
 700:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             reference_time_stamp = p_queue_entry->arrival_time;
 1107              	 .loc 1 700 0
 1108 013a FB68     	 ldr r3,[r7,#12]
 1109 013c 5B68     	 ldr r3,[r3,#4]
 1110 013e FB61     	 str r3,[r7,#28]
 701:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                             prefered_index = index;
 1111              	 .loc 1 701 0
 1112 0140 FB7E     	 ldrb r3,[r7,#27]
 1113 0142 BB76     	 strb r3,[r7,#26]
 1114              	.L48:
 666:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 1115              	 .loc 1 666 0 discriminator 2
 1116 0144 FB7E     	 ldrb r3,[r7,#27]
 1117 0146 0133     	 adds r3,r3,#1
 1118 0148 FB76     	 strb r3,[r7,#27]
 1119              	.L45:
 666:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 1120              	 .loc 1 666 0 is_stmt 0 discriminator 1
 1121 014a FB7E     	 ldrb r3,[r7,#27]
 1122 014c 052B     	 cmp r3,#5
 1123 014e 9FD9     	 bls .L53
 702:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         }
 703:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     }
 704:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 705:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 706:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         } while((0xFF == prefered_index) && (TRUE == overflow_detected));
 1124              	 .loc 1 706 0 is_stmt 1
 1125 0150 BB7E     	 ldrb r3,[r7,#26]
 1126 0152 FF2B     	 cmp r3,#255
 1127 0154 02D1     	 bne .L54
 1128              	 .loc 1 706 0 is_stmt 0 discriminator 1
 1129 0156 7B7E     	 ldrb r3,[r7,#25]
 1130 0158 012B     	 cmp r3,#1
 1131 015a 8DD0     	 beq .L55
 1132              	.L54:
 707:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 708:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // Improve : check the index and max queue size check
 709:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // If slot is identified then go further
 710:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (0xFF != prefered_index)
 1133              	 .loc 1 710 0 is_stmt 1
 1134 015c BB7E     	 ldrb r3,[r7,#26]
 1135 015e FF2B     	 cmp r3,#255
 1136 0160 56D0     	 beq .L56
 711:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 712:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             p_queue_entry = &(p_optiga_ctx->optiga_cmd_execution_queue[prefered_index]);
 1137              	 .loc 1 712 0
 1138 0162 BA7E     	 ldrb r2,[r7,#26]
 1139 0164 1346     	 mov r3,r2
 1140 0166 5B00     	 lsls r3,r3,#1
 1141 0168 1344     	 add r3,r3,r2
 1142 016a 9B00     	 lsls r3,r3,#2
 1143 016c 03F5C463 	 add r3,r3,#1568
 1144 0170 7A69     	 ldr r2,[r7,#20]
 1145 0172 1344     	 add r3,r3,r2
 1146 0174 0433     	 adds r3,r3,#4
 1147 0176 FB60     	 str r3,[r7,#12]
 713:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // assign session
 714:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if ((OPTIGA_CMD_QUEUE_REQUEST_SESSION == p_optiga_ctx->optiga_cmd_execution_queue[prefe
 1148              	 .loc 1 714 0
 1149 0178 BA7E     	 ldrb r2,[r7,#26]
 1150 017a 7969     	 ldr r1,[r7,#20]
 1151 017c 1346     	 mov r3,r2
 1152 017e 5B00     	 lsls r3,r3,#1
 1153 0180 1344     	 add r3,r3,r2
 1154 0182 9B00     	 lsls r3,r3,#2
 1155 0184 0B44     	 add r3,r3,r1
 1156 0186 03F5C563 	 add r3,r3,#1576
 1157 018a 1B79     	 ldrb r3,[r3,#4]
 1158 018c 222B     	 cmp r3,#34
 1159 018e 11D1     	 bne .L57
 715:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 (OPTIGA_CMD_NO_SESSION_OID == ((optiga_cmd_t *)p_queue_entry->registered_ctx)->sess
 1160              	 .loc 1 715 0 discriminator 1
 1161 0190 FB68     	 ldr r3,[r7,#12]
 1162 0192 1B68     	 ldr r3,[r3]
 1163 0194 9B8A     	 ldrh r3,[r3,#20]
 714:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 (OPTIGA_CMD_NO_SESSION_OID == ((optiga_cmd_t *)p_queue_entry->registered_ctx)->sess
 1164              	 .loc 1 714 0 discriminator 1
 1165 0196 002B     	 cmp r3,#0
 1166 0198 0CD1     	 bne .L57
 716:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 717:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_session_assign((optiga_cmd_t *)(p_optiga_ctx->optiga_cmd_execution_queue
 1167              	 .loc 1 717 0
 1168 019a BA7E     	 ldrb r2,[r7,#26]
 1169 019c 7969     	 ldr r1,[r7,#20]
 1170 019e 1346     	 mov r3,r2
 1171 01a0 5B00     	 lsls r3,r3,#1
 1172 01a2 1344     	 add r3,r3,r2
 1173 01a4 9B00     	 lsls r3,r3,#2
 1174 01a6 0B44     	 add r3,r3,r1
 1175 01a8 03F5C463 	 add r3,r3,#1568
 1176 01ac 5B68     	 ldr r3,[r3,#4]
 1177 01ae 1846     	 mov r0,r3
 1178 01b0 FFF7FEFF 	 bl optiga_cmd_session_assign
 1179              	.L57:
 718:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // Improve : Change the state of the type here. This will reduce 0x0000 check
 719:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 720:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 721:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // schedule with selected context
 722:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             my_os_event = ((optiga_cmd_t *)(p_optiga_ctx->optiga_cmd_execution_queue[prefered_index
 1180              	 .loc 1 722 0
 1181 01b4 BA7E     	 ldrb r2,[r7,#26]
 1182 01b6 7969     	 ldr r1,[r7,#20]
 1183 01b8 1346     	 mov r3,r2
 1184 01ba 5B00     	 lsls r3,r3,#1
 1185 01bc 1344     	 add r3,r3,r2
 1186 01be 9B00     	 lsls r3,r3,#2
 1187 01c0 0B44     	 add r3,r3,r1
 1188 01c2 03F5C463 	 add r3,r3,#1568
 1189 01c6 5B68     	 ldr r3,[r3,#4]
 1190 01c8 1B68     	 ldr r3,[r3]
 1191 01ca D3F86C36 	 ldr r3,[r3,#1644]
 1192 01ce 3B61     	 str r3,[r7,#16]
 723:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(my_os_event,
 1193              	 .loc 1 723 0
 1194 01d0 BA7E     	 ldrb r2,[r7,#26]
 1195 01d2 7969     	 ldr r1,[r7,#20]
 1196 01d4 1346     	 mov r3,r2
 1197 01d6 5B00     	 lsls r3,r3,#1
 1198 01d8 1344     	 add r3,r3,r2
 1199 01da 9B00     	 lsls r3,r3,#2
 1200 01dc 0B44     	 add r3,r3,r1
 1201 01de 03F5C463 	 add r3,r3,#1568
 1202 01e2 5B68     	 ldr r3,[r3,#4]
 1203 01e4 3869     	 ldr r0,[r7,#16]
 1204 01e6 1049     	 ldr r1,.L58+4
 1205 01e8 1A46     	 mov r2,r3
 1206 01ea 3223     	 movs r3,#50
 1207 01ec FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 724:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    optiga_cmd_event_trigger_execute,
 725:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    ((optiga_cmd_t *)(p_optiga_ctx->optiga_cmd_execu
 726:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    OPTIGA_CMD_SCHEDULER_RUNNING_TIME_MS);
 727:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             p_optiga_ctx->optiga_cmd_execution_queue[prefered_index].state_of_entry = OPTIGA_CMD_QU
 1208              	 .loc 1 727 0
 1209 01f0 BA7E     	 ldrb r2,[r7,#26]
 1210 01f2 7969     	 ldr r1,[r7,#20]
 1211 01f4 1346     	 mov r3,r2
 1212 01f6 5B00     	 lsls r3,r3,#1
 1213 01f8 1344     	 add r3,r3,r2
 1214 01fa 9B00     	 lsls r3,r3,#2
 1215 01fc 0B44     	 add r3,r3,r1
 1216 01fe 03F5C563 	 add r3,r3,#1576
 1217 0202 0422     	 movs r2,#4
 1218 0204 5A71     	 strb r2,[r3,#5]
 728:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             p_optiga_ctx->last_time_stamp = reference_time_stamp;
 1219              	 .loc 1 728 0
 1220 0206 7B69     	 ldr r3,[r7,#20]
 1221 0208 FA69     	 ldr r2,[r7,#28]
 1222 020a C3F87026 	 str r2,[r3,#1648]
 1223 020e 06E0     	 b .L39
 1224              	.L56:
 729:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 730:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         else
 731:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 732:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot( my_os_event, optiga_cmd_queue_scheduler,
 1225              	 .loc 1 732 0
 1226 0210 3869     	 ldr r0,[r7,#16]
 1227 0212 0449     	 ldr r1,.L58
 1228 0214 7A69     	 ldr r2,[r7,#20]
 1229 0216 4FF47A73 	 mov r3,#1000
 1230 021a FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 1231              	.L39:
 733:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     p_optiga_ctx,OPTIGA_CMD_SCHEDULER_IDLING_TIME_M
 734:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 735:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 736:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1232              	 .loc 1 736 0
 1233 021e 2037     	 adds r7,r7,#32
 1234              	.LCFI66:
 1235              	 .cfi_def_cfa_offset 8
 1236 0220 BD46     	 mov sp,r7
 1237              	.LCFI67:
 1238              	 .cfi_def_cfa_register 13
 1239              	 
 1240 0222 80BD     	 pop {r7,pc}
 1241              	.L59:
 1242              	 .align 2
 1243              	.L58:
 1244 0224 00000000 	 .word optiga_cmd_queue_scheduler
 1245 0228 00000000 	 .word optiga_cmd_event_trigger_execute
 1246              	 .cfi_endproc
 1247              	.LFE11:
 1249              	 .section .text.optiga_cmd_queue_update_slot,"ax",%progbits
 1250              	 .align 2
 1251              	 .thumb
 1252              	 .thumb_func
 1254              	optiga_cmd_queue_update_slot:
 1255              	.LFB12:
 737:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 738:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 739:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Updates a execution queue slot
 740:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 741:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_update_slot(optiga_cmd_t * me, uint8_t request_type)
 742:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1256              	 .loc 1 742 0
 1257              	 .cfi_startproc
 1258              	 
 1259              	 
 1260 0000 B0B5     	 push {r4,r5,r7,lr}
 1261              	.LCFI68:
 1262              	 .cfi_def_cfa_offset 16
 1263              	 .cfi_offset 4,-16
 1264              	 .cfi_offset 5,-12
 1265              	 .cfi_offset 7,-8
 1266              	 .cfi_offset 14,-4
 1267 0002 82B0     	 sub sp,sp,#8
 1268              	.LCFI69:
 1269              	 .cfi_def_cfa_offset 24
 1270 0004 00AF     	 add r7,sp,#0
 1271              	.LCFI70:
 1272              	 .cfi_def_cfa_register 7
 1273 0006 7860     	 str r0,[r7,#4]
 1274 0008 0B46     	 mov r3,r1
 1275 000a FB70     	 strb r3,[r7,#3]
 743:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != me->p_optiga->optiga_cmd_execution_queue[me->queue
 1276              	 .loc 1 743 0
 1277 000c 7B68     	 ldr r3,[r7,#4]
 1278 000e 1A68     	 ldr r2,[r3]
 1279 0010 7B68     	 ldr r3,[r7,#4]
 1280 0012 DB7E     	 ldrb r3,[r3,#27]
 1281 0014 1946     	 mov r1,r3
 1282 0016 0B46     	 mov r3,r1
 1283 0018 5B00     	 lsls r3,r3,#1
 1284 001a 0B44     	 add r3,r3,r1
 1285 001c 9B00     	 lsls r3,r3,#2
 1286 001e 1344     	 add r3,r3,r2
 1287 0020 03F5C563 	 add r3,r3,#1576
 1288 0024 1B79     	 ldrb r3,[r3,#4]
 1289 0026 232B     	 cmp r3,#35
 1290 0028 11D1     	 bne .L61
 744:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****        ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == me->p_optiga->optiga_cmd_execution_queue[me->queue
 1291              	 .loc 1 744 0 discriminator 1
 1292 002a 7B68     	 ldr r3,[r7,#4]
 1293 002c 1A68     	 ldr r2,[r3]
 1294 002e 7B68     	 ldr r3,[r7,#4]
 1295 0030 DB7E     	 ldrb r3,[r3,#27]
 1296 0032 1946     	 mov r1,r3
 1297 0034 0B46     	 mov r3,r1
 1298 0036 5B00     	 lsls r3,r3,#1
 1299 0038 0B44     	 add r3,r3,r1
 1300 003a 9B00     	 lsls r3,r3,#2
 1301 003c 1344     	 add r3,r3,r2
 1302 003e 03F5C563 	 add r3,r3,#1576
 1303 0042 1B79     	 ldrb r3,[r3,#4]
 743:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != me->p_optiga->optiga_cmd_execution_queue[me->queue
 1304              	 .loc 1 743 0 discriminator 1
 1305 0044 232B     	 cmp r3,#35
 1306 0046 12D1     	 bne .L62
 1307              	 .loc 1 744 0
 1308 0048 FB78     	 ldrb r3,[r7,#3]
 1309 004a 232B     	 cmp r3,#35
 1310 004c 0FD0     	 beq .L62
 1311              	.L61:
 745:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****        (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != request_type)))
 746:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 747:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         //add time stamp
 748:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->p_optiga->optiga_cmd_execution_queue[me->queue_id].arrival_time = pal_os_timer_get_time
 1312              	 .loc 1 748 0
 1313 004e 7B68     	 ldr r3,[r7,#4]
 1314 0050 1C68     	 ldr r4,[r3]
 1315 0052 7B68     	 ldr r3,[r7,#4]
 1316 0054 DB7E     	 ldrb r3,[r3,#27]
 1317 0056 1D46     	 mov r5,r3
 1318 0058 FFF7FEFF 	 bl pal_os_timer_get_time_in_microseconds
 1319 005c 0246     	 mov r2,r0
 1320 005e 2B46     	 mov r3,r5
 1321 0060 5B00     	 lsls r3,r3,#1
 1322 0062 2B44     	 add r3,r3,r5
 1323 0064 9B00     	 lsls r3,r3,#2
 1324 0066 2344     	 add r3,r3,r4
 1325 0068 03F5C463 	 add r3,r3,#1568
 1326 006c 9A60     	 str r2,[r3,#8]
 1327              	.L62:
 749:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 750:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 751:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     //add optiga_cmd ctx
 752:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].registered_ctx = (void * )me;
 1328              	 .loc 1 752 0
 1329 006e 7B68     	 ldr r3,[r7,#4]
 1330 0070 1A68     	 ldr r2,[r3]
 1331 0072 7B68     	 ldr r3,[r7,#4]
 1332 0074 DB7E     	 ldrb r3,[r3,#27]
 1333 0076 1946     	 mov r1,r3
 1334 0078 0B46     	 mov r3,r1
 1335 007a 5B00     	 lsls r3,r3,#1
 1336 007c 0B44     	 add r3,r3,r1
 1337 007e 9B00     	 lsls r3,r3,#2
 1338 0080 1344     	 add r3,r3,r2
 1339 0082 03F5C463 	 add r3,r3,#1568
 1340 0086 7A68     	 ldr r2,[r7,#4]
 1341 0088 5A60     	 str r2,[r3,#4]
 753:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // set the state of slot to Requested state
 754:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == me->p_optiga->optiga_cmd_execution_queue[me->queue
 1342              	 .loc 1 754 0
 1343 008a 7B68     	 ldr r3,[r7,#4]
 1344 008c 1A68     	 ldr r2,[r3]
 1345 008e 7B68     	 ldr r3,[r7,#4]
 1346 0090 DB7E     	 ldrb r3,[r3,#27]
 1347 0092 1946     	 mov r1,r3
 1348 0094 0B46     	 mov r3,r1
 1349 0096 5B00     	 lsls r3,r3,#1
 1350 0098 0B44     	 add r3,r3,r1
 1351 009a 9B00     	 lsls r3,r3,#2
 1352 009c 1344     	 add r3,r3,r2
 1353 009e 03F5C563 	 add r3,r3,#1576
 1354 00a2 1B79     	 ldrb r3,[r3,#4]
 1355 00a4 232B     	 cmp r3,#35
 1356 00a6 11D1     	 bne .L63
 1357              	 .loc 1 754 0 is_stmt 0 discriminator 1
 1358 00a8 FB78     	 ldrb r3,[r7,#3]
 1359 00aa 232B     	 cmp r3,#35
 1360 00ac 0ED1     	 bne .L63
 755:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         (OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK == request_type))
 756:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 757:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry = OPTIGA_CMD_QUEUE_RE
 1361              	 .loc 1 757 0 is_stmt 1
 1362 00ae 7B68     	 ldr r3,[r7,#4]
 1363 00b0 1A68     	 ldr r2,[r3]
 1364 00b2 7B68     	 ldr r3,[r7,#4]
 1365 00b4 DB7E     	 ldrb r3,[r3,#27]
 1366 00b6 1946     	 mov r1,r3
 1367 00b8 0B46     	 mov r3,r1
 1368 00ba 5B00     	 lsls r3,r3,#1
 1369 00bc 0B44     	 add r3,r3,r1
 1370 00be 9B00     	 lsls r3,r3,#2
 1371 00c0 1344     	 add r3,r3,r2
 1372 00c2 03F5C563 	 add r3,r3,#1576
 1373 00c6 0822     	 movs r2,#8
 1374 00c8 5A71     	 strb r2,[r3,#5]
 1375 00ca 0DE0     	 b .L64
 1376              	.L63:
 758:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 759:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     else
 760:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 761:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry = OPTIGA_CMD_QUEUE_RE
 1377              	 .loc 1 761 0
 1378 00cc 7B68     	 ldr r3,[r7,#4]
 1379 00ce 1A68     	 ldr r2,[r3]
 1380 00d0 7B68     	 ldr r3,[r7,#4]
 1381 00d2 DB7E     	 ldrb r3,[r3,#27]
 1382 00d4 1946     	 mov r1,r3
 1383 00d6 0B46     	 mov r3,r1
 1384 00d8 5B00     	 lsls r3,r3,#1
 1385 00da 0B44     	 add r3,r3,r1
 1386 00dc 9B00     	 lsls r3,r3,#2
 1387 00de 1344     	 add r3,r3,r2
 1388 00e0 03F5C563 	 add r3,r3,#1576
 1389 00e4 0222     	 movs r2,#2
 1390 00e6 5A71     	 strb r2,[r3,#5]
 1391              	.L64:
 762:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 763:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     //add request type
 764:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type = request_type;
 1392              	 .loc 1 764 0
 1393 00e8 7B68     	 ldr r3,[r7,#4]
 1394 00ea 1A68     	 ldr r2,[r3]
 1395 00ec 7B68     	 ldr r3,[r7,#4]
 1396 00ee DB7E     	 ldrb r3,[r3,#27]
 1397 00f0 1946     	 mov r1,r3
 1398 00f2 0B46     	 mov r3,r1
 1399 00f4 5B00     	 lsls r3,r3,#1
 1400 00f6 0B44     	 add r3,r3,r1
 1401 00f8 9B00     	 lsls r3,r3,#2
 1402 00fa 1344     	 add r3,r3,r2
 1403 00fc 03F5C563 	 add r3,r3,#1576
 1404 0100 FA78     	 ldrb r2,[r7,#3]
 1405 0102 1A71     	 strb r2,[r3,#4]
 765:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1406              	 .loc 1 765 0
 1407 0104 0837     	 adds r7,r7,#8
 1408              	.LCFI71:
 1409              	 .cfi_def_cfa_offset 16
 1410 0106 BD46     	 mov sp,r7
 1411              	.LCFI72:
 1412              	 .cfi_def_cfa_register 13
 1413              	 
 1414 0108 B0BD     	 pop {r4,r5,r7,pc}
 1415              	 .cfi_endproc
 1416              	.LFE12:
 1418 010a 00BF     	 .section .text.optiga_cmd_queue_reset_slot,"ax",%progbits
 1419              	 .align 2
 1420              	 .thumb
 1421              	 .thumb_func
 1423              	optiga_cmd_queue_reset_slot:
 1424              	.LFB13:
 766:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 767:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
 768:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Resets a execution slot
 769:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
 770:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_queue_reset_slot(const optiga_cmd_t * me)
 771:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1425              	 .loc 1 771 0
 1426              	 .cfi_startproc
 1427              	 
 1428              	 
 1429 0000 80B5     	 push {r7,lr}
 1430              	.LCFI73:
 1431              	 .cfi_def_cfa_offset 8
 1432              	 .cfi_offset 7,-8
 1433              	 .cfi_offset 14,-4
 1434 0002 82B0     	 sub sp,sp,#8
 1435              	.LCFI74:
 1436              	 .cfi_def_cfa_offset 16
 1437 0004 00AF     	 add r7,sp,#0
 1438              	.LCFI75:
 1439              	 .cfi_def_cfa_register 7
 1440 0006 7860     	 str r0,[r7,#4]
 772:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // Reset the arrival time
 773:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].arrival_time = 0xFFFFFFFF;
 1441              	 .loc 1 773 0
 1442 0008 7B68     	 ldr r3,[r7,#4]
 1443 000a 1A68     	 ldr r2,[r3]
 1444 000c 7B68     	 ldr r3,[r7,#4]
 1445 000e DB7E     	 ldrb r3,[r3,#27]
 1446 0010 1946     	 mov r1,r3
 1447 0012 0B46     	 mov r3,r1
 1448 0014 5B00     	 lsls r3,r3,#1
 1449 0016 0B44     	 add r3,r3,r1
 1450 0018 9B00     	 lsls r3,r3,#2
 1451 001a 1344     	 add r3,r3,r2
 1452 001c 03F5C463 	 add r3,r3,#1568
 1453 0020 4FF0FF32 	 mov r2,#-1
 1454 0024 9A60     	 str r2,[r3,#8]
 774:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     //add optiga_cmd ctx
 775:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].registered_ctx = NULL;
 1455              	 .loc 1 775 0
 1456 0026 7B68     	 ldr r3,[r7,#4]
 1457 0028 1A68     	 ldr r2,[r3]
 1458 002a 7B68     	 ldr r3,[r7,#4]
 1459 002c DB7E     	 ldrb r3,[r3,#27]
 1460 002e 1946     	 mov r1,r3
 1461 0030 0B46     	 mov r3,r1
 1462 0032 5B00     	 lsls r3,r3,#1
 1463 0034 0B44     	 add r3,r3,r1
 1464 0036 9B00     	 lsls r3,r3,#2
 1465 0038 1344     	 add r3,r3,r2
 1466 003a 03F5C463 	 add r3,r3,#1568
 1467 003e 0022     	 movs r2,#0
 1468 0040 5A60     	 str r2,[r3,#4]
 776:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     //add request type
 777:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].request_type = 0;
 1469              	 .loc 1 777 0
 1470 0042 7B68     	 ldr r3,[r7,#4]
 1471 0044 1A68     	 ldr r2,[r3]
 1472 0046 7B68     	 ldr r3,[r7,#4]
 1473 0048 DB7E     	 ldrb r3,[r3,#27]
 1474 004a 1946     	 mov r1,r3
 1475 004c 0B46     	 mov r3,r1
 1476 004e 5B00     	 lsls r3,r3,#1
 1477 0050 0B44     	 add r3,r3,r1
 1478 0052 9B00     	 lsls r3,r3,#2
 1479 0054 1344     	 add r3,r3,r2
 1480 0056 03F5C563 	 add r3,r3,#1576
 1481 005a 0022     	 movs r2,#0
 1482 005c 1A71     	 strb r2,[r3,#4]
 778:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // set the slot state to assigned
 779:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     me->p_optiga->optiga_cmd_execution_queue[me->queue_id].state_of_entry = OPTIGA_CMD_QUEUE_ASSIGN
 1483              	 .loc 1 779 0
 1484 005e 7B68     	 ldr r3,[r7,#4]
 1485 0060 1A68     	 ldr r2,[r3]
 1486 0062 7B68     	 ldr r3,[r7,#4]
 1487 0064 DB7E     	 ldrb r3,[r3,#27]
 1488 0066 1946     	 mov r1,r3
 1489 0068 0B46     	 mov r3,r1
 1490 006a 5B00     	 lsls r3,r3,#1
 1491 006c 0B44     	 add r3,r3,r1
 1492 006e 9B00     	 lsls r3,r3,#2
 1493 0070 1344     	 add r3,r3,r2
 1494 0072 03F5C563 	 add r3,r3,#1576
 1495 0076 0122     	 movs r2,#1
 1496 0078 5A71     	 strb r2,[r3,#5]
 780:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // start the event scheduler
 781:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     pal_os_event_start(me->p_optiga->p_pal_os_event_ctx, optiga_cmd_queue_scheduler, me->p_optiga);
 1497              	 .loc 1 781 0
 1498 007a 7B68     	 ldr r3,[r7,#4]
 1499 007c 1B68     	 ldr r3,[r3]
 1500 007e D3F86C26 	 ldr r2,[r3,#1644]
 1501 0082 7B68     	 ldr r3,[r7,#4]
 1502 0084 1B68     	 ldr r3,[r3]
 1503 0086 1046     	 mov r0,r2
 1504 0088 0349     	 ldr r1,.L66
 1505 008a 1A46     	 mov r2,r3
 1506 008c FFF7FEFF 	 bl pal_os_event_start
 782:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1507              	 .loc 1 782 0
 1508 0090 0837     	 adds r7,r7,#8
 1509              	.LCFI76:
 1510              	 .cfi_def_cfa_offset 8
 1511 0092 BD46     	 mov sp,r7
 1512              	.LCFI77:
 1513              	 .cfi_def_cfa_register 13
 1514              	 
 1515 0094 80BD     	 pop {r7,pc}
 1516              	.L67:
 1517 0096 00BF     	 .align 2
 1518              	.L66:
 1519 0098 00000000 	 .word optiga_cmd_queue_scheduler
 1520              	 .cfi_endproc
 1521              	.LFE13:
 1523              	 .section .text.optiga_cmd_request_session,"ax",%progbits
 1524              	 .align 2
 1525              	 .global optiga_cmd_request_session
 1526              	 .thumb
 1527              	 .thumb_func
 1529              	optiga_cmd_request_session:
 1530              	.LFB14:
 783:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 784:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 785:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_request_session(optiga_cmd_t * me)
 786:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1531              	 .loc 1 786 0
 1532              	 .cfi_startproc
 1533              	 
 1534              	 
 1535 0000 80B5     	 push {r7,lr}
 1536              	.LCFI78:
 1537              	 .cfi_def_cfa_offset 8
 1538              	 .cfi_offset 7,-8
 1539              	 .cfi_offset 14,-4
 1540 0002 82B0     	 sub sp,sp,#8
 1541              	.LCFI79:
 1542              	 .cfi_def_cfa_offset 16
 1543 0004 00AF     	 add r7,sp,#0
 1544              	.LCFI80:
 1545              	 .cfi_def_cfa_register 7
 1546 0006 7860     	 str r0,[r7,#4]
 787:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_update_slot(me , OPTIGA_CMD_QUEUE_REQUEST_SESSION);
 1547              	 .loc 1 787 0
 1548 0008 7868     	 ldr r0,[r7,#4]
 1549 000a 2221     	 movs r1,#34
 1550 000c FFF7FEFF 	 bl optiga_cmd_queue_update_slot
 788:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 1551              	 .loc 1 788 0
 1552 0010 0023     	 movs r3,#0
 789:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1553              	 .loc 1 789 0
 1554 0012 1846     	 mov r0,r3
 1555 0014 0837     	 adds r7,r7,#8
 1556              	.LCFI81:
 1557              	 .cfi_def_cfa_offset 8
 1558 0016 BD46     	 mov sp,r7
 1559              	.LCFI82:
 1560              	 .cfi_def_cfa_register 13
 1561              	 
 1562 0018 80BD     	 pop {r7,pc}
 1563              	 .cfi_endproc
 1564              	.LFE14:
 1566 001a 00BF     	 .section .text.optiga_cmd_release_session,"ax",%progbits
 1567              	 .align 2
 1568              	 .global optiga_cmd_release_session
 1569              	 .thumb
 1570              	 .thumb_func
 1572              	optiga_cmd_release_session:
 1573              	.LFB15:
 790:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 791:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_release_session(optiga_cmd_t * me)
 792:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1574              	 .loc 1 792 0
 1575              	 .cfi_startproc
 1576              	 
 1577              	 
 1578 0000 80B5     	 push {r7,lr}
 1579              	.LCFI83:
 1580              	 .cfi_def_cfa_offset 8
 1581              	 .cfi_offset 7,-8
 1582              	 .cfi_offset 14,-4
 1583 0002 82B0     	 sub sp,sp,#8
 1584              	.LCFI84:
 1585              	 .cfi_def_cfa_offset 16
 1586 0004 00AF     	 add r7,sp,#0
 1587              	.LCFI85:
 1588              	 .cfi_def_cfa_register 7
 1589 0006 7860     	 str r0,[r7,#4]
 793:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_session_free(me);
 1590              	 .loc 1 793 0
 1591 0008 7868     	 ldr r0,[r7,#4]
 1592 000a FFF7FEFF 	 bl optiga_cmd_session_free
 794:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 1593              	 .loc 1 794 0
 1594 000e 0023     	 movs r3,#0
 795:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1595              	 .loc 1 795 0
 1596 0010 1846     	 mov r0,r3
 1597 0012 0837     	 adds r7,r7,#8
 1598              	.LCFI86:
 1599              	 .cfi_def_cfa_offset 8
 1600 0014 BD46     	 mov sp,r7
 1601              	.LCFI87:
 1602              	 .cfi_def_cfa_register 13
 1603              	 
 1604 0016 80BD     	 pop {r7,pc}
 1605              	 .cfi_endproc
 1606              	.LFE15:
 1608              	 .section .text.optiga_cmd_request_lock,"ax",%progbits
 1609              	 .align 2
 1610              	 .global optiga_cmd_request_lock
 1611              	 .thumb
 1612              	 .thumb_func
 1614              	optiga_cmd_request_lock:
 1615              	.LFB16:
 796:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 797:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_request_lock(optiga_cmd_t * me, uint8_t lock_type)
 798:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1616              	 .loc 1 798 0
 1617              	 .cfi_startproc
 1618              	 
 1619              	 
 1620 0000 80B5     	 push {r7,lr}
 1621              	.LCFI88:
 1622              	 .cfi_def_cfa_offset 8
 1623              	 .cfi_offset 7,-8
 1624              	 .cfi_offset 14,-4
 1625 0002 82B0     	 sub sp,sp,#8
 1626              	.LCFI89:
 1627              	 .cfi_def_cfa_offset 16
 1628 0004 00AF     	 add r7,sp,#0
 1629              	.LCFI90:
 1630              	 .cfi_def_cfa_register 7
 1631 0006 7860     	 str r0,[r7,#4]
 1632 0008 0B46     	 mov r3,r1
 1633 000a FB70     	 strb r3,[r7,#3]
 799:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_update_slot(me , lock_type);
 1634              	 .loc 1 799 0
 1635 000c FB78     	 ldrb r3,[r7,#3]
 1636 000e 7868     	 ldr r0,[r7,#4]
 1637 0010 1946     	 mov r1,r3
 1638 0012 FFF7FEFF 	 bl optiga_cmd_queue_update_slot
 800:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 1639              	 .loc 1 800 0
 1640 0016 0023     	 movs r3,#0
 801:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1641              	 .loc 1 801 0
 1642 0018 1846     	 mov r0,r3
 1643 001a 0837     	 adds r7,r7,#8
 1644              	.LCFI91:
 1645              	 .cfi_def_cfa_offset 8
 1646 001c BD46     	 mov sp,r7
 1647              	.LCFI92:
 1648              	 .cfi_def_cfa_register 13
 1649              	 
 1650 001e 80BD     	 pop {r7,pc}
 1651              	 .cfi_endproc
 1652              	.LFE16:
 1654              	 .section .text.optiga_cmd_release_lock,"ax",%progbits
 1655              	 .align 2
 1656              	 .global optiga_cmd_release_lock
 1657              	 .thumb
 1658              	 .thumb_func
 1660              	optiga_cmd_release_lock:
 1661              	.LFB17:
 802:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 803:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_release_lock(const optiga_cmd_t * me)
 804:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1662              	 .loc 1 804 0
 1663              	 .cfi_startproc
 1664              	 
 1665              	 
 1666 0000 80B5     	 push {r7,lr}
 1667              	.LCFI93:
 1668              	 .cfi_def_cfa_offset 8
 1669              	 .cfi_offset 7,-8
 1670              	 .cfi_offset 14,-4
 1671 0002 82B0     	 sub sp,sp,#8
 1672              	.LCFI94:
 1673              	 .cfi_def_cfa_offset 16
 1674 0004 00AF     	 add r7,sp,#0
 1675              	.LCFI95:
 1676              	 .cfi_def_cfa_register 7
 1677 0006 7860     	 str r0,[r7,#4]
 805:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_queue_reset_slot(me);
 1678              	 .loc 1 805 0
 1679 0008 7868     	 ldr r0,[r7,#4]
 1680 000a FFF7FEFF 	 bl optiga_cmd_queue_reset_slot
 806:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_CMD_SUCCESS);
 1681              	 .loc 1 806 0
 1682 000e 0023     	 movs r3,#0
 807:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1683              	 .loc 1 807 0
 1684 0010 1846     	 mov r0,r3
 1685 0012 0837     	 adds r7,r7,#8
 1686              	.LCFI96:
 1687              	 .cfi_def_cfa_offset 8
 1688 0014 BD46     	 mov sp,r7
 1689              	.LCFI97:
 1690              	 .cfi_def_cfa_register 13
 1691              	 
 1692 0016 80BD     	 pop {r7,pc}
 1693              	 .cfi_endproc
 1694              	.LFE17:
 1696              	 .section .text.optiga_cmd_restore_context,"ax",%progbits
 1697              	 .align 2
 1698              	 .thumb
 1699              	 .thumb_func
 1701              	optiga_cmd_restore_context:
 1702              	.LFB18:
 808:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 809:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_restore_context(const optiga_cmd_t * me)
 810:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1703              	 .loc 1 810 0
 1704              	 .cfi_startproc
 1705              	 
 1706              	 
 1707 0000 80B5     	 push {r7,lr}
 1708              	.LCFI98:
 1709              	 .cfi_def_cfa_offset 8
 1710              	 .cfi_offset 7,-8
 1711              	 .cfi_offset 14,-4
 1712 0002 84B0     	 sub sp,sp,#16
 1713              	.LCFI99:
 1714              	 .cfi_def_cfa_offset 24
 1715 0004 00AF     	 add r7,sp,#0
 1716              	.LCFI100:
 1717              	 .cfi_def_cfa_register 7
 1718 0006 7860     	 str r0,[r7,#4]
 811:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OF_CONTEXT_HANDLE_4TH_BYTE         (0x04)
 812:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t context_handle_length;
 813:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 1719              	 .loc 1 813 0
 1720 0008 40F20223 	 movw r3,#514
 1721 000c FB81     	 strh r3,[r7,#14]
 814:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
 815:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 816:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id)
 1722              	 .loc 1 816 0
 1723 000e 7B68     	 ldr r3,[r7,#4]
 1724 0010 DB8B     	 ldrh r3,[r3,#30]
 1725 0012 002B     	 cmp r3,#0
 1726 0014 14D0     	 beq .L77
 817:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 818:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             context_handle_length = sizeof(me->p_optiga->optiga_context_handle_buffer);
 1727              	 .loc 1 818 0
 1728 0016 0823     	 movs r3,#8
 1729 0018 BB81     	 strh r3,[r7,#12]
 819:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //Reading context handle secret from datastore
 820:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = pal_os_datastore_read(me->optiga_context_datastore_id,
 1730              	 .loc 1 820 0
 1731 001a 7B68     	 ldr r3,[r7,#4]
 1732 001c D98B     	 ldrh r1,[r3,#30]
 821:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                   me->p_optiga->optiga_context_handle_buffer,
 1733              	 .loc 1 821 0
 1734 001e 7B68     	 ldr r3,[r7,#4]
 1735 0020 1B68     	 ldr r3,[r3]
 1736 0022 03F27462 	 addw r2,r3,#1652
 820:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                   me->p_optiga->optiga_context_handle_buffer,
 1737              	 .loc 1 820 0
 1738 0026 07F10C03 	 add r3,r7,#12
 1739 002a 0846     	 mov r0,r1
 1740 002c 1146     	 mov r1,r2
 1741 002e 1A46     	 mov r2,r3
 1742 0030 FFF7FEFF 	 bl pal_os_datastore_read
 1743 0034 0346     	 mov r3,r0
 1744 0036 FB81     	 strh r3,[r7,#14]
 822:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                   &context_handle_length);
 823:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (PAL_STATUS_SUCCESS != return_status)
 1745              	 .loc 1 823 0
 1746 0038 FB89     	 ldrh r3,[r7,#14]
 1747 003a 002B     	 cmp r3,#0
 1748 003c 00D0     	 beq .L77
 824:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 825:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 1749              	 .loc 1 825 0
 1750 003e 19E0     	 b .L78
 1751              	.L77:
 826:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 827:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 828:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // Check for valid context value
 829:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (0 == optiga_common_get_uint32(me->p_optiga->optiga_context_handle_buffer) &&
 1752              	 .loc 1 829 0
 1753 0040 7B68     	 ldr r3,[r7,#4]
 1754 0042 1B68     	 ldr r3,[r3]
 1755 0044 03F27463 	 addw r3,r3,#1652
 1756 0048 1846     	 mov r0,r3
 1757 004a FFF7FEFF 	 bl optiga_common_get_uint32
 1758 004e 0346     	 mov r3,r0
 1759 0050 002B     	 cmp r3,#0
 1760 0052 0DD1     	 bne .L79
 830:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             0 == optiga_common_get_uint32(&me->p_optiga->optiga_context_handle_buffer[OPTIGA_CMD_OF
 1761              	 .loc 1 830 0 discriminator 1
 1762 0054 7B68     	 ldr r3,[r7,#4]
 1763 0056 1B68     	 ldr r3,[r3]
 1764 0058 03F5CF63 	 add r3,r3,#1656
 1765 005c 1846     	 mov r0,r3
 1766 005e FFF7FEFF 	 bl optiga_common_get_uint32
 1767 0062 0346     	 mov r3,r0
 829:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             0 == optiga_common_get_uint32(&me->p_optiga->optiga_context_handle_buffer[OPTIGA_CMD_OF
 1768              	 .loc 1 829 0 discriminator 1
 1769 0064 002B     	 cmp r3,#0
 1770 0066 03D1     	 bne .L79
 831:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 832:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_CMD_ERROR;
 1771              	 .loc 1 832 0
 1772 0068 40F20223 	 movw r3,#514
 1773 006c FB81     	 strh r3,[r7,#14]
 833:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 1774              	 .loc 1 833 0
 1775 006e 01E0     	 b .L78
 1776              	.L79:
 834:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 835:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 836:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         return_status = OPTIGA_LIB_SUCCESS;
 1777              	 .loc 1 836 0
 1778 0070 0023     	 movs r3,#0
 1779 0072 FB81     	 strh r3,[r7,#14]
 1780              	.L78:
 837:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
 838:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_OFFSET_OF_NEXT_BYTE
 839:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 1781              	 .loc 1 839 0
 1782 0074 FB89     	 ldrh r3,[r7,#14]
 840:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1783              	 .loc 1 840 0
 1784 0076 1846     	 mov r0,r3
 1785 0078 1037     	 adds r7,r7,#16
 1786              	.LCFI101:
 1787              	 .cfi_def_cfa_offset 8
 1788 007a BD46     	 mov sp,r7
 1789              	.LCFI102:
 1790              	 .cfi_def_cfa_register 13
 1791              	 
 1792 007c 80BD     	 pop {r7,pc}
 1793              	 .cfi_endproc
 1794              	.LFE18:
 1796 007e 00BF     	 .section .text.optiga_cmd_store_context,"ax",%progbits
 1797              	 .align 2
 1798              	 .thumb
 1799              	 .thumb_func
 1801              	optiga_cmd_store_context:
 1802              	.LFB19:
 841:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_store_context(const optiga_cmd_t * me)
 842:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1803              	 .loc 1 842 0
 1804              	 .cfi_startproc
 1805              	 
 1806              	 
 1807 0000 80B5     	 push {r7,lr}
 1808              	.LCFI103:
 1809              	 .cfi_def_cfa_offset 8
 1810              	 .cfi_offset 7,-8
 1811              	 .cfi_offset 14,-4
 1812 0002 84B0     	 sub sp,sp,#16
 1813              	.LCFI104:
 1814              	 .cfi_def_cfa_offset 24
 1815 0004 00AF     	 add r7,sp,#0
 1816              	.LCFI105:
 1817              	 .cfi_def_cfa_register 7
 1818 0006 7860     	 str r0,[r7,#4]
 843:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 1819              	 .loc 1 843 0
 1820 0008 40F20223 	 movw r3,#514
 1821 000c FB81     	 strh r3,[r7,#14]
 844:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
 845:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 846:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id)
 1822              	 .loc 1 846 0
 1823 000e 7B68     	 ldr r3,[r7,#4]
 1824 0010 DB8B     	 ldrh r3,[r3,#30]
 1825 0012 002B     	 cmp r3,#0
 1826 0014 10D0     	 beq .L82
 847:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 848:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //Reading context handle secret from datastore
 849:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = pal_os_datastore_write(me->optiga_context_datastore_id,
 1827              	 .loc 1 849 0
 1828 0016 7B68     	 ldr r3,[r7,#4]
 1829 0018 DA8B     	 ldrh r2,[r3,#30]
 850:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    me->p_optiga->optiga_context_handle_buffer,
 1830              	 .loc 1 850 0
 1831 001a 7B68     	 ldr r3,[r7,#4]
 1832 001c 1B68     	 ldr r3,[r3]
 1833 001e 03F27463 	 addw r3,r3,#1652
 849:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    me->p_optiga->optiga_context_handle_buffer,
 1834              	 .loc 1 849 0
 1835 0022 1046     	 mov r0,r2
 1836 0024 1946     	 mov r1,r3
 1837 0026 0822     	 movs r2,#8
 1838 0028 FFF7FEFF 	 bl pal_os_datastore_write
 1839 002c 0346     	 mov r3,r0
 1840 002e FB81     	 strh r3,[r7,#14]
 851:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    sizeof(me->p_optiga->optiga_context_handle_buffe
 852:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (PAL_STATUS_SUCCESS != return_status)
 1841              	 .loc 1 852 0
 1842 0030 FB89     	 ldrh r3,[r7,#14]
 1843 0032 002B     	 cmp r3,#0
 1844 0034 00D0     	 beq .L82
 853:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 854:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 1845              	 .loc 1 854 0
 1846 0036 01E0     	 b .L83
 1847              	.L82:
 855:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 856:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 857:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 858:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         return_status = OPTIGA_LIB_SUCCESS;
 1848              	 .loc 1 858 0
 1849 0038 0023     	 movs r3,#0
 1850 003a FB81     	 strh r3,[r7,#14]
 1851              	.L83:
 859:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
 860:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 1852              	 .loc 1 860 0
 1853 003c FB89     	 ldrh r3,[r7,#14]
 861:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 1854              	 .loc 1 861 0
 1855 003e 1846     	 mov r0,r3
 1856 0040 1037     	 adds r7,r7,#16
 1857              	.LCFI106:
 1858              	 .cfi_def_cfa_offset 8
 1859 0042 BD46     	 mov sp,r7
 1860              	.LCFI107:
 1861              	 .cfi_def_cfa_register 13
 1862              	 
 1863 0044 80BD     	 pop {r7,pc}
 1864              	 .cfi_endproc
 1865              	.LFE19:
 1867 0046 00BF     	 .section .text.optiga_cmd_execute_comms_open,"ax",%progbits
 1868              	 .align 2
 1869              	 .thumb
 1870              	 .thumb_func
 1872              	optiga_cmd_execute_comms_open:
 1873              	.LFB20:
 862:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 863:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 864:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_clear_app_ctx(void * p_ctx)
 865:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 866:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_t * me = (optiga_cmd_t *)p_ctx;
 867:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     /*In the case of hibernate if any low level error occurs while performing
 868:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****       close application this section clears the saved application context.*/
 869:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT != me->cmd_param) &&
 870:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         (OPTIGA_COMMS_SESSION_CONTEXT_SAVE == me->manage_context_operation))
 871:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 872:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         pal_os_memset(me->p_optiga->optiga_context_handle_buffer,0,
 873:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         sizeof(me->p_optiga->optiga_context_handle_buffer));
 874:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if ((OPTIGA_HIBERNATE_CONTEXT_ID == me->optiga_context_datastore_id) &&
 875:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id))
 876:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 877:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //Clearing context handle secret from datastore
 878:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->exit_status = pal_os_datastore_write(me->optiga_context_datastore_id,
 879:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                      me->p_optiga->optiga_context_handle_buffer,
 880:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                      sizeof(me->p_optiga->optiga_context_handle_buf
 881:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (PAL_STATUS_SUCCESS != me->exit_status)
 882:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 883:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
 884:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 885:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 886:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
 887:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 888:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif
 889:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 890:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_comms_open(optiga_cmd_t * me, uint8_t * exit_loop)
 891:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 1874              	 .loc 1 891 0
 1875              	 .cfi_startproc
 1876              	 
 1877              	 
 1878 0000 80B5     	 push {r7,lr}
 1879              	.LCFI108:
 1880              	 .cfi_def_cfa_offset 8
 1881              	 .cfi_offset 7,-8
 1882              	 .cfi_offset 14,-4
 1883 0002 82B0     	 sub sp,sp,#8
 1884              	.LCFI109:
 1885              	 .cfi_def_cfa_offset 16
 1886 0004 00AF     	 add r7,sp,#0
 1887              	.LCFI110:
 1888              	 .cfi_def_cfa_register 7
 1889 0006 7860     	 str r0,[r7,#4]
 1890 0008 3960     	 str r1,[r7]
 1891              	.L94:
 892:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
 893:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 894:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 1892              	 .loc 1 894 0
 1893 000a 3B68     	 ldr r3,[r7]
 1894 000c 0122     	 movs r2,#1
 1895 000e 1A70     	 strb r2,[r3]
 895:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_sub_execution_state)
 1896              	 .loc 1 895 0
 1897 0010 7B68     	 ldr r3,[r7,#4]
 1898 0012 DB7D     	 ldrb r3,[r3,#23]
 1899 0014 012B     	 cmp r3,#1
 1900 0016 1ED0     	 beq .L87
 1901 0018 022B     	 cmp r3,#2
 1902 001a 40D0     	 beq .L88
 1903 001c 002B     	 cmp r3,#0
 1904 001e 4FD1     	 bne .L95
 896:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 897:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_OPEN_ACQUIRE_LOCK:
 898:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 899:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 900:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // add to queue and exit
 901:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_cmd_request_lock(me, OPTIGA_CMD_QUEUE_REQUEST_LOCK);
 1905              	 .loc 1 901 0
 1906 0020 7868     	 ldr r0,[r7,#4]
 1907 0022 2121     	 movs r1,#33
 1908 0024 FFF7FEFF 	 bl optiga_cmd_request_lock
 1909 0028 0346     	 mov r3,r0
 1910 002a 1A46     	 mov r2,r3
 1911 002c 7B68     	 ldr r3,[r7,#4]
 1912 002e 9A83     	 strh r2,[r3,#28]
 902:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 1913              	 .loc 1 902 0
 1914 0030 7B68     	 ldr r3,[r7,#4]
 1915 0032 9B8B     	 ldrh r3,[r3,#28]
 1916 0034 002B     	 cmp r3,#0
 1917 0036 0AD0     	 beq .L90
 903:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 904:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 1918              	 .loc 1 904 0
 1919 0038 7B68     	 ldr r3,[r7,#4]
 1920 003a 0422     	 movs r2,#4
 1921 003c 9A75     	 strb r2,[r3,#22]
 1922 003e 7B68     	 ldr r3,[r7,#4]
 1923 0040 40F20222 	 movw r2,#514
 1924 0044 9A83     	 strh r2,[r3,#28]
 1925 0046 3B68     	 ldr r3,[r7]
 1926 0048 0022     	 movs r2,#0
 1927 004a 1A70     	 strb r2,[r3]
 905:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 1928              	 .loc 1 905 0
 1929 004c 43E0     	 b .L91
 1930              	.L90:
 906:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 907:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_OPEN_START;
 1931              	 .loc 1 907 0
 1932 004e 7B68     	 ldr r3,[r7,#4]
 1933 0050 0122     	 movs r2,#1
 1934 0052 DA75     	 strb r2,[r3,#23]
 908:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 1935              	 .loc 1 908 0
 1936 0054 3FE0     	 b .L91
 1937              	.L87:
 909:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 910:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_OPEN_START:
 911:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 912:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 913:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protection_level =  me->protection_level;
 914:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 915:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->manage_context_operation = me->manage_context_operati
 916:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->p_pal_os_event_ctx = me->p_optiga->p_pal_os_event_ctx
 917:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 918:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 919:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 (void)optiga_comms_set_callback_context(me->p_optiga->p_optiga_comms, me);
 1938              	 .loc 1 919 0
 1939 0056 7B68     	 ldr r3,[r7,#4]
 1940 0058 1B68     	 ldr r3,[r3]
 1941 005a 1B68     	 ldr r3,[r3]
 1942 005c 1846     	 mov r0,r3
 1943 005e 7968     	 ldr r1,[r7,#4]
 1944 0060 FFF7FEFF 	 bl optiga_comms_set_callback_context
 920:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_open(me->p_optiga->p_optiga_comms);
 1945              	 .loc 1 920 0
 1946 0064 7B68     	 ldr r3,[r7,#4]
 1947 0066 1B68     	 ldr r3,[r3]
 1948 0068 1B68     	 ldr r3,[r3]
 1949 006a 1846     	 mov r0,r3
 1950 006c FFF7FEFF 	 bl optiga_comms_open
 1951 0070 0346     	 mov r3,r0
 1952 0072 1A46     	 mov r2,r3
 1953 0074 7B68     	 ldr r3,[r7,#4]
 1954 0076 9A83     	 strh r2,[r3,#28]
 921:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 922:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 1955              	 .loc 1 922 0
 1956 0078 7B68     	 ldr r3,[r7,#4]
 1957 007a 9B8B     	 ldrh r3,[r3,#28]
 1958 007c 002B     	 cmp r3,#0
 1959 007e 0AD0     	 beq .L92
 923:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 924:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 1960              	 .loc 1 924 0
 1961 0080 7B68     	 ldr r3,[r7,#4]
 1962 0082 0422     	 movs r2,#4
 1963 0084 9A75     	 strb r2,[r3,#22]
 1964 0086 7B68     	 ldr r3,[r7,#4]
 1965 0088 40F20222 	 movw r2,#514
 1966 008c 9A83     	 strh r2,[r3,#28]
 1967 008e 3B68     	 ldr r3,[r7]
 1968 0090 0022     	 movs r2,#0
 1969 0092 1A70     	 strb r2,[r3]
 925:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 1970              	 .loc 1 925 0
 1971 0094 1FE0     	 b .L91
 1972              	.L92:
 926:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 927:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_OPEN_DONE;
 1973              	 .loc 1 927 0
 1974 0096 7B68     	 ldr r3,[r7,#4]
 1975 0098 0222     	 movs r2,#2
 1976 009a DA75     	 strb r2,[r3,#23]
 928:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 1977              	 .loc 1 928 0
 1978 009c 1BE0     	 b .L91
 1979              	.L88:
 929:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 930:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_OPEN_DONE:
 931:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 932:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 1980              	 .loc 1 932 0
 1981 009e 7B68     	 ldr r3,[r7,#4]
 1982 00a0 1B68     	 ldr r3,[r3]
 1983 00a2 D3F86C36 	 ldr r3,[r3,#1644]
 1984 00a6 1846     	 mov r0,r3
 1985 00a8 1049     	 ldr r1,.L96
 1986 00aa 7A68     	 ldr r2,[r7,#4]
 1987 00ac 3223     	 movs r3,#50
 1988 00ae FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
 933:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        (register_callback)optiga_cmd_event_trigger_
 934:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        me, OPTIGA_CMD_SCHEDULER_RUNNING_TIME_MS);
 935:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PREPARE_COMMAND;
 1989              	 .loc 1 935 0
 1990 00b2 7B68     	 ldr r3,[r7,#4]
 1991 00b4 0222     	 movs r2,#2
 1992 00b6 9A75     	 strb r2,[r3,#22]
 936:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
 1993              	 .loc 1 936 0
 1994 00b8 7B68     	 ldr r3,[r7,#4]
 1995 00ba 0822     	 movs r2,#8
 1996 00bc DA75     	 strb r2,[r3,#23]
 937:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 1997              	 .loc 1 937 0
 1998 00be 0AE0     	 b .L91
 1999              	.L95:
 938:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 939:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             default:
 940:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 EXIT_STATE_WITH_ERROR(me,*exit_loop);
 2000              	 .loc 1 940 0
 2001 00c0 7B68     	 ldr r3,[r7,#4]
 2002 00c2 0422     	 movs r2,#4
 2003 00c4 9A75     	 strb r2,[r3,#22]
 2004 00c6 7B68     	 ldr r3,[r7,#4]
 2005 00c8 40F20222 	 movw r2,#514
 2006 00cc 9A83     	 strh r2,[r3,#28]
 2007 00ce 3B68     	 ldr r3,[r7]
 2008 00d0 0022     	 movs r2,#0
 2009 00d2 1A70     	 strb r2,[r3]
 941:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 2010              	 .loc 1 941 0
 2011 00d4 00BF     	 nop
 2012              	.L91:
 942:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
 943:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 944:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 945:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while ((FALSE == *exit_loop) && (OPTIGA_CMD_EXEC_COMMS_OPEN == me->cmd_next_execution_state))
 2013              	 .loc 1 945 0
 2014 00d6 3B68     	 ldr r3,[r7]
 2015 00d8 1B78     	 ldrb r3,[r3]
 2016 00da 002B     	 cmp r3,#0
 2017 00dc 03D1     	 bne .L85
 2018              	 .loc 1 945 0 is_stmt 0 discriminator 1
 2019 00de 7B68     	 ldr r3,[r7,#4]
 2020 00e0 9B7D     	 ldrb r3,[r3,#22]
 2021 00e2 002B     	 cmp r3,#0
 2022 00e4 91D0     	 beq .L94
 2023              	.L85:
 946:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 2024              	 .loc 1 946 0 is_stmt 1
 2025 00e6 0837     	 adds r7,r7,#8
 2026              	.LCFI111:
 2027              	 .cfi_def_cfa_offset 8
 2028 00e8 BD46     	 mov sp,r7
 2029              	.LCFI112:
 2030              	 .cfi_def_cfa_register 13
 2031              	 
 2032 00ea 80BD     	 pop {r7,pc}
 2033              	.L97:
 2034              	 .align 2
 2035              	.L96:
 2036 00ec 00000000 	 .word optiga_cmd_event_trigger_execute
 2037              	 .cfi_endproc
 2038              	.LFE20:
 2040              	 .section .text.optiga_cmd_execute_comms_close,"ax",%progbits
 2041              	 .align 2
 2042              	 .thumb
 2043              	 .thumb_func
 2045              	optiga_cmd_execute_comms_close:
 2046              	.LFB21:
 947:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 948:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_comms_close(optiga_cmd_t * me, uint8_t * exit_loop)
 949:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 2047              	 .loc 1 949 0
 2048              	 .cfi_startproc
 2049              	 
 2050              	 
 2051 0000 80B5     	 push {r7,lr}
 2052              	.LCFI113:
 2053              	 .cfi_def_cfa_offset 8
 2054              	 .cfi_offset 7,-8
 2055              	 .cfi_offset 14,-4
 2056 0002 82B0     	 sub sp,sp,#8
 2057              	.LCFI114:
 2058              	 .cfi_def_cfa_offset 16
 2059 0004 00AF     	 add r7,sp,#0
 2060              	.LCFI115:
 2061              	 .cfi_def_cfa_register 7
 2062 0006 7860     	 str r0,[r7,#4]
 2063 0008 3960     	 str r1,[r7]
 2064              	.L105:
 950:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
 951:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
 952:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 2065              	 .loc 1 952 0
 2066 000a 3B68     	 ldr r3,[r7]
 2067 000c 0122     	 movs r2,#1
 2068 000e 1A70     	 strb r2,[r3]
 953:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_sub_execution_state)
 2069              	 .loc 1 953 0
 2070 0010 7B68     	 ldr r3,[r7,#4]
 2071 0012 DB7D     	 ldrb r3,[r3,#23]
 2072 0014 032B     	 cmp r3,#3
 2073 0016 02D0     	 beq .L100
 2074 0018 042B     	 cmp r3,#4
 2075 001a 33D0     	 beq .L101
 2076 001c 3AE0     	 b .L106
 2077              	.L100:
 954:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
 955:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_CLOSE_START:
 956:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 957:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 958:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // In case PRL is enabled and save context is not invoked or is PRL is not enabled,
 959:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //change state to OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE, since it synchronous in nature
 960:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_COMMS_SESSION_CONTEXT_SAVE != me->manage_context_operation)
 961:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 962:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE;
 963:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 964:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protection_level =  me->protection_level;
 965:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
 966:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (0 != me->p_optiga->protection_level_state)
 967:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 968:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->p_optiga->p_optiga_comms->manage_context_operation = me->manage_context_ope
 969:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 970:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
 971:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 972:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->p_optiga->p_optiga_comms->manage_context_operation = OPTIGA_COMMS_SESSION_C
 973:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 974:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->protection_level_state = 0;
 975:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
 976:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE;
 2078              	 .loc 1 976 0
 2079 001e 7B68     	 ldr r3,[r7,#4]
 2080 0020 0422     	 movs r2,#4
 2081 0022 DA75     	 strb r2,[r3,#23]
 977:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 978:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->p_pal_os_event_ctx = me->p_optiga->p_pal_os_event_ctx
 2082              	 .loc 1 978 0
 2083 0024 7B68     	 ldr r3,[r7,#4]
 2084 0026 1B68     	 ldr r3,[r3]
 2085 0028 1B68     	 ldr r3,[r3]
 2086 002a 7A68     	 ldr r2,[r7,#4]
 2087 002c 1268     	 ldr r2,[r2]
 2088 002e D2F86C26 	 ldr r2,[r2,#1644]
 2089 0032 1A61     	 str r2,[r3,#16]
 979:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 980:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 (void)optiga_comms_set_callback_context(me->p_optiga->p_optiga_comms, me);
 2090              	 .loc 1 980 0
 2091 0034 7B68     	 ldr r3,[r7,#4]
 2092 0036 1B68     	 ldr r3,[r3]
 2093 0038 1B68     	 ldr r3,[r3]
 2094 003a 1846     	 mov r0,r3
 2095 003c 7968     	 ldr r1,[r7,#4]
 2096 003e FFF7FEFF 	 bl optiga_comms_set_callback_context
 981:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_close(me->p_optiga->p_optiga_comms);
 2097              	 .loc 1 981 0
 2098 0042 7B68     	 ldr r3,[r7,#4]
 2099 0044 1B68     	 ldr r3,[r3]
 2100 0046 1B68     	 ldr r3,[r3]
 2101 0048 1846     	 mov r0,r3
 2102 004a FFF7FEFF 	 bl optiga_comms_close
 2103 004e 0346     	 mov r3,r0
 2104 0050 1A46     	 mov r2,r3
 2105 0052 7B68     	 ldr r3,[r7,#4]
 2106 0054 9A83     	 strh r2,[r3,#28]
 982:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 983:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 2107              	 .loc 1 983 0
 2108 0056 7B68     	 ldr r3,[r7,#4]
 2109 0058 9B8B     	 ldrh r3,[r3,#28]
 2110 005a 002B     	 cmp r3,#0
 2111 005c 0AD0     	 beq .L102
 984:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 985:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 2112              	 .loc 1 985 0
 2113 005e 7B68     	 ldr r3,[r7,#4]
 2114 0060 0422     	 movs r2,#4
 2115 0062 9A75     	 strb r2,[r3,#22]
 2116 0064 7B68     	 ldr r3,[r7,#4]
 2117 0066 40F20222 	 movw r2,#514
 2118 006a 9A83     	 strh r2,[r3,#28]
 2119 006c 3B68     	 ldr r3,[r7]
 2120 006e 0022     	 movs r2,#0
 2121 0070 1A70     	 strb r2,[r3]
 986:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 2122              	 .loc 1 986 0
 2123 0072 1AE0     	 b .L103
 2124              	.L102:
 987:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 988:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 989:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
 990:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // In case PRL is enabled and save context is requested,
 991:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //change state to OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE, since it asynchronous in nature
 992:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_COMMS_SESSION_CONTEXT_SAVE == me->manage_context_operation)
 993:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 994:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE;
 995:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *exit_loop = TRUE;
 996:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 997:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // For synchronous behavior: After exit from optiga_comms_close, release lock
 998:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
 999:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1000:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->exit_status = optiga_cmd_release_lock(me);
1001:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1002:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #else
1003:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_cmd_release_lock(me);
 2125              	 .loc 1 1003 0
 2126 0074 7868     	 ldr r0,[r7,#4]
 2127 0076 FFF7FEFF 	 bl optiga_cmd_release_lock
 2128 007a 0346     	 mov r3,r0
 2129 007c 1A46     	 mov r2,r3
 2130 007e 7B68     	 ldr r3,[r7,#4]
 2131 0080 9A83     	 strh r2,[r3,#28]
1004:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1005:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2132              	 .loc 1 1005 0
 2133 0082 12E0     	 b .L103
 2134              	.L101:
1006:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1007:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_CLOSE_DONE:
1008:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1009:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->handler(me->caller_context, OPTIGA_LIB_SUCCESS);
 2135              	 .loc 1 1009 0
 2136 0084 7B68     	 ldr r3,[r7,#4]
 2137 0086 1B69     	 ldr r3,[r3,#16]
 2138 0088 7A68     	 ldr r2,[r7,#4]
 2139 008a D268     	 ldr r2,[r2,#12]
 2140 008c 1046     	 mov r0,r2
 2141 008e 0021     	 movs r1,#0
 2142 0090 9847     	 blx r3
1010:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1011:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // For asynchronous behavior, change state to release the lock
1012:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_COMMS_SESSION_CONTEXT_SAVE == me->manage_context_operation)
1013:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1014:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->exit_status = optiga_cmd_release_lock(me);
1015:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1016:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1017:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2143              	 .loc 1 1017 0
 2144 0092 0AE0     	 b .L103
 2145              	.L106:
1018:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1019:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             default:
1020:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 EXIT_STATE_WITH_ERROR(me,*exit_loop);
 2146              	 .loc 1 1020 0
 2147 0094 7B68     	 ldr r3,[r7,#4]
 2148 0096 0422     	 movs r2,#4
 2149 0098 9A75     	 strb r2,[r3,#22]
 2150 009a 7B68     	 ldr r3,[r7,#4]
 2151 009c 40F20222 	 movw r2,#514
 2152 00a0 9A83     	 strh r2,[r3,#28]
 2153 00a2 3B68     	 ldr r3,[r7]
 2154 00a4 0022     	 movs r2,#0
 2155 00a6 1A70     	 strb r2,[r3]
1021:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 2156              	 .loc 1 1021 0
 2157 00a8 00BF     	 nop
 2158              	.L103:
1022:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
1023:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1024:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while ((FALSE == *exit_loop) && (OPTIGA_CMD_EXEC_COMMS_CLOSE == me->cmd_next_execution_state)
 2159              	 .loc 1 1024 0
 2160 00aa 3B68     	 ldr r3,[r7]
 2161 00ac 1B78     	 ldrb r3,[r3]
 2162 00ae 002B     	 cmp r3,#0
 2163 00b0 03D1     	 bne .L98
 2164              	 .loc 1 1024 0 is_stmt 0 discriminator 1
 2165 00b2 7B68     	 ldr r3,[r7,#4]
 2166 00b4 9B7D     	 ldrb r3,[r3,#22]
 2167 00b6 012B     	 cmp r3,#1
 2168 00b8 A7D0     	 beq .L105
 2169              	.L98:
1025:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 2170              	 .loc 1 1025 0 is_stmt 1
 2171 00ba 0837     	 adds r7,r7,#8
 2172              	.LCFI116:
 2173              	 .cfi_def_cfa_offset 8
 2174 00bc BD46     	 mov sp,r7
 2175              	.LCFI117:
 2176              	 .cfi_def_cfa_register 13
 2177              	 
 2178 00be 80BD     	 pop {r7,pc}
 2179              	 .cfi_endproc
 2180              	.LFE21:
 2182              	 .section .text.optiga_cmd_execute_prepare_command,"ax",%progbits
 2183              	 .align 2
 2184              	 .thumb
 2185              	 .thumb_func
 2187              	optiga_cmd_execute_prepare_command:
 2188              	.LFB22:
1026:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1027:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_prepare_command(optiga_cmd_t * me, uint8_t * exit_loop)
1028:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 2189              	 .loc 1 1028 0
 2190              	 .cfi_startproc
 2191              	 
 2192              	 
 2193 0000 90B5     	 push {r4,r7,lr}
 2194              	.LCFI118:
 2195              	 .cfi_def_cfa_offset 12
 2196              	 .cfi_offset 4,-12
 2197              	 .cfi_offset 7,-8
 2198              	 .cfi_offset 14,-4
 2199 0002 87B0     	 sub sp,sp,#28
 2200              	.LCFI119:
 2201              	 .cfi_def_cfa_offset 40
 2202 0004 02AF     	 add r7,sp,#8
 2203              	.LCFI120:
 2204              	 .cfi_def_cfa 7,32
 2205 0006 7860     	 str r0,[r7,#4]
 2206 0008 3960     	 str r1,[r7]
1029:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_handler_t optiga_cmd_handler = me->cmd_hdlrs;
 2207              	 .loc 1 1029 0
 2208 000a 7B68     	 ldr r3,[r7,#4]
 2209 000c 5B68     	 ldr r3,[r3,#4]
 2210 000e FB60     	 str r3,[r7,#12]
 2211              	.L121:
1030:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
1031:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1032:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_sub_execution_state)
 2212              	 .loc 1 1032 0
 2213 0010 7B68     	 ldr r3,[r7,#4]
 2214 0012 DB7D     	 ldrb r3,[r3,#23]
 2215 0014 053B     	 subs r3,r3,#5
 2216 0016 032B     	 cmp r3,#3
 2217 0018 00F2B280 	 bhi .L108
 2218 001c 01A2     	 adr r2,.L110
 2219 001e 52F823F0 	 ldr pc,[r2,r3,lsl#2]
 2220 0022 00BF     	 .p2align 2
 2221              	.L110:
 2222 0024 35000000 	 .word .L109+1
 2223 0028 35000000 	 .word .L109+1
 2224 002c 89000000 	 .word .L111+1
 2225 0030 C5000000 	 .word .L112+1
 2226              	 .p2align 1
 2227              	.L109:
1033:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1034:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_REQUEST_LOCK:
1035:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_REQUEST_SESSION:
1036:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1037:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
 2228              	 .loc 1 1037 0
 2229 0034 3B68     	 ldr r3,[r7]
 2230 0036 0122     	 movs r2,#1
 2231 0038 1A70     	 strb r2,[r3]
1038:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (me->cmd_sub_execution_state == OPTIGA_CMD_EXEC_REQUEST_SESSION)
 2232              	 .loc 1 1038 0
 2233 003a 7B68     	 ldr r3,[r7,#4]
 2234 003c DB7D     	 ldrb r3,[r3,#23]
 2235 003e 052B     	 cmp r3,#5
 2236 0040 07D1     	 bne .L113
1039:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1040:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->exit_status = optiga_cmd_request_session(me);
 2237              	 .loc 1 1040 0
 2238 0042 7868     	 ldr r0,[r7,#4]
 2239 0044 FFF7FEFF 	 bl optiga_cmd_request_session
 2240 0048 0346     	 mov r3,r0
 2241 004a 1A46     	 mov r2,r3
 2242 004c 7B68     	 ldr r3,[r7,#4]
 2243 004e 9A83     	 strh r2,[r3,#28]
 2244 0050 07E0     	 b .L114
 2245              	.L113:
1041:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1042:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
1043:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1044:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->exit_status = optiga_cmd_request_lock(me, OPTIGA_CMD_QUEUE_REQUEST_LOCK);
 2246              	 .loc 1 1044 0
 2247 0052 7868     	 ldr r0,[r7,#4]
 2248 0054 2121     	 movs r1,#33
 2249 0056 FFF7FEFF 	 bl optiga_cmd_request_lock
 2250 005a 0346     	 mov r3,r0
 2251 005c 1A46     	 mov r2,r3
 2252 005e 7B68     	 ldr r3,[r7,#4]
 2253 0060 9A83     	 strh r2,[r3,#28]
 2254              	.L114:
1045:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1046:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 2255              	 .loc 1 1046 0
 2256 0062 7B68     	 ldr r3,[r7,#4]
 2257 0064 9B8B     	 ldrh r3,[r3,#28]
 2258 0066 002B     	 cmp r3,#0
 2259 0068 0AD0     	 beq .L115
1047:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1048:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 2260              	 .loc 1 1048 0
 2261 006a 7B68     	 ldr r3,[r7,#4]
 2262 006c 0422     	 movs r2,#4
 2263 006e 9A75     	 strb r2,[r3,#22]
 2264 0070 7B68     	 ldr r3,[r7,#4]
 2265 0072 40F20222 	 movw r2,#514
 2266 0076 9A83     	 strh r2,[r3,#28]
 2267 0078 3B68     	 ldr r3,[r7]
 2268 007a 0022     	 movs r2,#0
 2269 007c 1A70     	 strb r2,[r3]
1049:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 2270              	 .loc 1 1049 0
 2271 007e 8AE0     	 b .L116
 2272              	.L115:
1050:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1051:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1052:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
 2273              	 .loc 1 1052 0
 2274 0080 7B68     	 ldr r3,[r7,#4]
 2275 0082 0822     	 movs r2,#8
 2276 0084 DA75     	 strb r2,[r3,#23]
1053:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2277              	 .loc 1 1053 0
 2278 0086 86E0     	 b .L116
 2279              	.L111:
1054:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1055:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_REQUEST_STRICT_LOCK:
1056:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1057:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_cmd_request_lock(me, OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK)
 2280              	 .loc 1 1057 0
 2281 0088 7868     	 ldr r0,[r7,#4]
 2282 008a 2321     	 movs r1,#35
 2283 008c FFF7FEFF 	 bl optiga_cmd_request_lock
 2284 0090 0346     	 mov r3,r0
 2285 0092 1A46     	 mov r2,r3
 2286 0094 7B68     	 ldr r3,[r7,#4]
 2287 0096 9A83     	 strh r2,[r3,#28]
1058:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 2288              	 .loc 1 1058 0
 2289 0098 7B68     	 ldr r3,[r7,#4]
 2290 009a 9B8B     	 ldrh r3,[r3,#28]
 2291 009c 002B     	 cmp r3,#0
 2292 009e 0AD0     	 beq .L117
1059:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1060:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 2293              	 .loc 1 1060 0
 2294 00a0 7B68     	 ldr r3,[r7,#4]
 2295 00a2 0422     	 movs r2,#4
 2296 00a4 9A75     	 strb r2,[r3,#22]
 2297 00a6 7B68     	 ldr r3,[r7,#4]
 2298 00a8 40F20222 	 movw r2,#514
 2299 00ac 9A83     	 strh r2,[r3,#28]
 2300 00ae 3B68     	 ldr r3,[r7]
 2301 00b0 0022     	 movs r2,#0
 2302 00b2 1A70     	 strb r2,[r3]
1061:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 2303              	 .loc 1 1061 0
 2304 00b4 6FE0     	 b .L116
 2305              	.L117:
1062:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1063:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
 2306              	 .loc 1 1063 0
 2307 00b6 7B68     	 ldr r3,[r7,#4]
 2308 00b8 0822     	 movs r2,#8
 2309 00ba DA75     	 strb r2,[r3,#23]
1064:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
 2310              	 .loc 1 1064 0
 2311 00bc 3B68     	 ldr r3,[r7]
 2312 00be 0122     	 movs r2,#1
 2313 00c0 1A70     	 strb r2,[r3]
1065:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2314              	 .loc 1 1065 0
 2315 00c2 68E0     	 b .L116
 2316              	.L112:
1066:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1067:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_PREPARE_APDU:
1068:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1069:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
 2317              	 .loc 1 1069 0
 2318 00c4 3B68     	 ldr r3,[r7]
 2319 00c6 0122     	 movs r2,#1
 2320 00c8 1A70     	 strb r2,[r3]
1070:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_cmd_handler(me);
 2321              	 .loc 1 1070 0
 2322 00ca FB68     	 ldr r3,[r7,#12]
 2323 00cc 7868     	 ldr r0,[r7,#4]
 2324 00ce 9847     	 blx r3
 2325 00d0 0346     	 mov r3,r0
 2326 00d2 1A46     	 mov r2,r3
 2327 00d4 7B68     	 ldr r3,[r7,#4]
 2328 00d6 9A83     	 strh r2,[r3,#28]
1071:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 2329              	 .loc 1 1071 0
 2330 00d8 7B68     	 ldr r3,[r7,#4]
 2331 00da 9B8B     	 ldrh r3,[r3,#28]
 2332 00dc 002B     	 cmp r3,#0
 2333 00de 06D0     	 beq .L118
1072:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1073:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
 2334              	 .loc 1 1073 0
 2335 00e0 7B68     	 ldr r3,[r7,#4]
 2336 00e2 0422     	 movs r2,#4
 2337 00e4 9A75     	 strb r2,[r3,#22]
1074:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *exit_loop = FALSE;
 2338              	 .loc 1 1074 0
 2339 00e6 3B68     	 ldr r3,[r7]
 2340 00e8 0022     	 movs r2,#0
 2341 00ea 1A70     	 strb r2,[r3]
1075:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 2342              	 .loc 1 1075 0
 2343 00ec 53E0     	 b .L116
 2344              	.L118:
1076:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1077:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->comms_rx_size = OPTIGA_CMD_TOTAL_COMMS_BUFFER_SIZE;
 2345              	 .loc 1 1077 0
 2346 00ee 7B68     	 ldr r3,[r7,#4]
 2347 00f0 1B68     	 ldr r3,[r3]
 2348 00f2 40F21562 	 movw r2,#1557
 2349 00f6 DA80     	 strh r2,[r3,#6]
1078:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1079:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protection_level = me->protection_level;
1080:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
1081:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->p_optiga->protection_level_state |= me->protection_level;
1082:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1083:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 (void)optiga_comms_set_callback_context(me->p_optiga->p_optiga_comms, me);
 2350              	 .loc 1 1083 0
 2351 00f8 7B68     	 ldr r3,[r7,#4]
 2352 00fa 1B68     	 ldr r3,[r3]
 2353 00fc 1B68     	 ldr r3,[r3]
 2354 00fe 1846     	 mov r0,r3
 2355 0100 7968     	 ldr r1,[r7,#4]
 2356 0102 FFF7FEFF 	 bl optiga_comms_set_callback_context
1084:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_transceive(me->p_optiga->p_optiga_comms,
 2357              	 .loc 1 1084 0
 2358 0106 7B68     	 ldr r3,[r7,#4]
 2359 0108 1B68     	 ldr r3,[r3]
 2360 010a 1868     	 ldr r0,[r3]
1085:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->optiga_comms_buffer,
 2361              	 .loc 1 1085 0
 2362 010c 7B68     	 ldr r3,[r7,#4]
 2363 010e 1B68     	 ldr r3,[r3]
 2364 0110 03F10D01 	 add r1,r3,#13
1086:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->comms_tx_size,
 2365              	 .loc 1 1086 0
 2366 0114 7B68     	 ldr r3,[r7,#4]
 2367 0116 1B68     	 ldr r3,[r3]
1084:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->exit_status = optiga_comms_transceive(me->p_optiga->p_optiga_comms,
 2368              	 .loc 1 1084 0
 2369 0118 9A88     	 ldrh r2,[r3,#4]
1087:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->optiga_comms_buffer,
 2370              	 .loc 1 1087 0
 2371 011a 7B68     	 ldr r3,[r7,#4]
 2372 011c 1B68     	 ldr r3,[r3]
 2373 011e 03F10D04 	 add r4,r3,#13
1088:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                           &(me->p_optiga->comms_rx_size));
 2374              	 .loc 1 1088 0
 2375 0122 7B68     	 ldr r3,[r7,#4]
 2376 0124 1B68     	 ldr r3,[r3]
1084:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                           me->p_optiga->optiga_comms_buffer,
 2377              	 .loc 1 1084 0
 2378 0126 0633     	 adds r3,r3,#6
 2379 0128 0093     	 str r3,[sp]
 2380 012a 2346     	 mov r3,r4
 2381 012c FFF7FEFF 	 bl optiga_comms_transceive
 2382 0130 0346     	 mov r3,r0
 2383 0132 1A46     	 mov r2,r3
 2384 0134 7B68     	 ldr r3,[r7,#4]
 2385 0136 9A83     	 strh r2,[r3,#28]
1089:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1090:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != me->exit_status)
 2386              	 .loc 1 1090 0
 2387 0138 7B68     	 ldr r3,[r7,#4]
 2388 013a 9B8B     	 ldrh r3,[r3,#28]
 2389 013c 002B     	 cmp r3,#0
 2390 013e 0AD0     	 beq .L119
1091:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1092:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     EXIT_STATE_WITH_ERROR(me,*exit_loop);
 2391              	 .loc 1 1092 0
 2392 0140 7B68     	 ldr r3,[r7,#4]
 2393 0142 0422     	 movs r2,#4
 2394 0144 9A75     	 strb r2,[r3,#22]
 2395 0146 7B68     	 ldr r3,[r7,#4]
 2396 0148 40F20222 	 movw r2,#514
 2397 014c 9A83     	 strh r2,[r3,#28]
 2398 014e 3B68     	 ldr r3,[r7]
 2399 0150 0022     	 movs r2,#0
 2400 0152 1A70     	 strb r2,[r3]
1093:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 2401              	 .loc 1 1093 0
 2402 0154 1FE0     	 b .L116
 2403              	.L119:
1094:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1095:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1096:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PROCESS_RESPONSE;
 2404              	 .loc 1 1096 0
 2405 0156 7B68     	 ldr r3,[r7,#4]
 2406 0158 0322     	 movs r2,#3
 2407 015a 9A75     	 strb r2,[r3,#22]
1097:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE;
 2408              	 .loc 1 1097 0
 2409 015c 7B68     	 ldr r3,[r7,#4]
 2410 015e 0922     	 movs r2,#9
 2411 0160 DA75     	 strb r2,[r3,#23]
1098:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_ENTER_HANDLER_CALL);
 2412              	 .loc 1 1098 0
 2413 0162 7B68     	 ldr r3,[r7,#4]
 2414 0164 9B7E     	 ldrb r3,[r3,#26]
 2415 0166 03F07F03 	 and r3,r3,#127
 2416 016a DAB2     	 uxtb r2,r3
 2417 016c 7B68     	 ldr r3,[r7,#4]
 2418 016e 9A76     	 strb r2,[r3,#26]
 2419 0170 7B68     	 ldr r3,[r7,#4]
 2420 0172 9B7E     	 ldrb r3,[r3,#26]
 2421 0174 63F07F03 	 orn r3,r3,#127
 2422 0178 DAB2     	 uxtb r2,r3
 2423 017a 7B68     	 ldr r3,[r7,#4]
 2424 017c 9A76     	 strb r2,[r3,#26]
1099:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2425              	 .loc 1 1099 0
 2426 017e 0AE0     	 b .L116
 2427              	.L108:
1100:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1101:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             default:
1102:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 EXIT_STATE_WITH_ERROR(me,*exit_loop);
 2428              	 .loc 1 1102 0
 2429 0180 7B68     	 ldr r3,[r7,#4]
 2430 0182 0422     	 movs r2,#4
 2431 0184 9A75     	 strb r2,[r3,#22]
 2432 0186 7B68     	 ldr r3,[r7,#4]
 2433 0188 40F20222 	 movw r2,#514
 2434 018c 9A83     	 strh r2,[r3,#28]
 2435 018e 3B68     	 ldr r3,[r7]
 2436 0190 0022     	 movs r2,#0
 2437 0192 1A70     	 strb r2,[r3]
1103:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 2438              	 .loc 1 1103 0
 2439 0194 00BF     	 nop
 2440              	.L116:
1104:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
1105:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1106:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while ((FALSE == *exit_loop) && (OPTIGA_CMD_EXEC_PREPARE_COMMAND == me->cmd_next_execution_st
 2441              	 .loc 1 1106 0
 2442 0196 3B68     	 ldr r3,[r7]
 2443 0198 1B78     	 ldrb r3,[r3]
 2444 019a 002B     	 cmp r3,#0
 2445 019c 04D1     	 bne .L107
 2446              	 .loc 1 1106 0 is_stmt 0 discriminator 1
 2447 019e 7B68     	 ldr r3,[r7,#4]
 2448 01a0 9B7D     	 ldrb r3,[r3,#22]
 2449 01a2 022B     	 cmp r3,#2
 2450 01a4 3FF434AF 	 beq .L121
 2451              	.L107:
1107:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 2452              	 .loc 1 1107 0 is_stmt 1
 2453 01a8 1437     	 adds r7,r7,#20
 2454              	.LCFI121:
 2455              	 .cfi_def_cfa_offset 12
 2456 01aa BD46     	 mov sp,r7
 2457              	.LCFI122:
 2458              	 .cfi_def_cfa_register 13
 2459              	 
 2460 01ac 90BD     	 pop {r4,r7,pc}
 2461              	 .cfi_endproc
 2462              	.LFE22:
 2464 01ae 00BF     	 .section .text.optiga_cmd_execute_get_device_error,"ax",%progbits
 2465              	 .align 2
 2466              	 .thumb
 2467              	 .thumb_func
 2469              	optiga_cmd_execute_get_device_error:
 2470              	.LFB23:
1108:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1109:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_get_device_error(optiga_cmd_t * me, uint8_t * exit_loop)
1110:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 2471              	 .loc 1 1110 0
 2472              	 .cfi_startproc
 2473              	 
 2474              	 
 2475 0000 80B5     	 push {r7,lr}
 2476              	.LCFI123:
 2477              	 .cfi_def_cfa_offset 8
 2478              	 .cfi_offset 7,-8
 2479              	 .cfi_offset 14,-4
 2480 0002 82B0     	 sub sp,sp,#8
 2481              	.LCFI124:
 2482              	 .cfi_def_cfa_offset 16
 2483 0004 00AF     	 add r7,sp,#0
 2484              	.LCFI125:
 2485              	 .cfi_def_cfa_register 7
 2486 0006 7860     	 str r0,[r7,#4]
 2487 0008 3960     	 str r1,[r7]
1111:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
1112:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1113:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 2488              	 .loc 1 1113 0
 2489 000a 3B68     	 ldr r3,[r7]
 2490 000c 0122     	 movs r2,#1
 2491 000e 1A70     	 strb r2,[r3]
1114:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->exit_status = optiga_cmd_get_error_code_handler(me);
 2492              	 .loc 1 1114 0
 2493 0010 7868     	 ldr r0,[r7,#4]
 2494 0012 FFF7FEFF 	 bl optiga_cmd_get_error_code_handler
 2495 0016 0346     	 mov r3,r0
 2496 0018 1A46     	 mov r2,r3
 2497 001a 7B68     	 ldr r3,[r7,#4]
 2498 001c 9A83     	 strh r2,[r3,#28]
1115:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (((OPTIGA_LIB_SUCCESS != me->exit_status) && !(OPTIGA_DEVICE_ERROR & me->exit_status)) |
 2499              	 .loc 1 1115 0
 2500 001e 7B68     	 ldr r3,[r7,#4]
 2501 0020 9B8B     	 ldrh r3,[r3,#28]
 2502 0022 002B     	 cmp r3,#0
 2503 0024 05D0     	 beq .L123
 2504              	 .loc 1 1115 0 is_stmt 0 discriminator 1
 2505 0026 7B68     	 ldr r3,[r7,#4]
 2506 0028 9B8B     	 ldrh r3,[r3,#28]
 2507 002a 9BB2     	 uxth r3,r3
 2508 002c 1BB2     	 sxth r3,r3
 2509 002e 002B     	 cmp r3,#0
 2510 0030 0ADA     	 bge .L124
 2511              	.L123:
1116:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             ((OPTIGA_DEVICE_ERROR == me->exit_status) &&
 2512              	 .loc 1 1116 0 is_stmt 1 discriminator 3
 2513 0032 7B68     	 ldr r3,[r7,#4]
 2514 0034 9B8B     	 ldrh r3,[r3,#28]
1115:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (((OPTIGA_LIB_SUCCESS != me->exit_status) && !(OPTIGA_DEVICE_ERROR & me->exit_status)) |
 2515              	 .loc 1 1115 0 discriminator 3
 2516 0036 B3F5004F 	 cmp r3,#32768
 2517 003a 0CD1     	 bne .L122
1117:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             ((me->device_error_status & OPTIGA_CMD_ERROR_CODE_STATE_MASK) == OPTIGA_CMD_ERROR_CODE_
 2518              	 .loc 1 1117 0
 2519 003c 7B68     	 ldr r3,[r7,#4]
 2520 003e 9B7E     	 ldrb r3,[r3,#26]
 2521 0040 03F00303 	 and r3,r3,#3
1116:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             ((OPTIGA_DEVICE_ERROR == me->exit_status) &&
 2522              	 .loc 1 1116 0
 2523 0044 032B     	 cmp r3,#3
 2524 0046 06D1     	 bne .L122
 2525              	.L124:
1118:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1119:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
 2526              	 .loc 1 1119 0
 2527 0048 7B68     	 ldr r3,[r7,#4]
 2528 004a 0422     	 movs r2,#4
 2529 004c 9A75     	 strb r2,[r3,#22]
1120:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             *exit_loop = FALSE;
 2530              	 .loc 1 1120 0
 2531 004e 3B68     	 ldr r3,[r7]
 2532 0050 0022     	 movs r2,#0
 2533 0052 1A70     	 strb r2,[r3]
1121:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 2534              	 .loc 1 1121 0
 2535 0054 00BF     	 nop
 2536              	.L122:
1122:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1123:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1124:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 2537              	 .loc 1 1124 0
 2538 0056 0837     	 adds r7,r7,#8
 2539              	.LCFI126:
 2540              	 .cfi_def_cfa_offset 8
 2541 0058 BD46     	 mov sp,r7
 2542              	.LCFI127:
 2543              	 .cfi_def_cfa_register 13
 2544              	 
 2545 005a 80BD     	 pop {r7,pc}
 2546              	 .cfi_endproc
 2547              	.LFE23:
 2549              	 .section .text.optiga_cmd_execute_process_optiga_response,"ax",%progbits
 2550              	 .align 2
 2551              	 .thumb
 2552              	 .thumb_func
 2554              	optiga_cmd_execute_process_optiga_response:
 2555              	.LFB24:
1125:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1126:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_process_optiga_response(optiga_cmd_t * me, uint8_t * exit_loop)
1127:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 2556              	 .loc 1 1127 0
 2557              	 .cfi_startproc
 2558              	 
 2559              	 
 2560 0000 80B5     	 push {r7,lr}
 2561              	.LCFI128:
 2562              	 .cfi_def_cfa_offset 8
 2563              	 .cfi_offset 7,-8
 2564              	 .cfi_offset 14,-4
 2565 0002 84B0     	 sub sp,sp,#16
 2566              	.LCFI129:
 2567              	 .cfi_def_cfa_offset 24
 2568 0004 00AF     	 add r7,sp,#0
 2569              	.LCFI130:
 2570              	 .cfi_def_cfa_register 7
 2571 0006 7860     	 str r0,[r7,#4]
 2572 0008 3960     	 str r1,[r7]
1128:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_handler_t optiga_cmd_handler = me->cmd_hdlrs;
 2573              	 .loc 1 1128 0
 2574 000a 7B68     	 ldr r3,[r7,#4]
 2575 000c 5B68     	 ldr r3,[r3,#4]
 2576 000e FB60     	 str r3,[r7,#12]
1129:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
1130:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1131:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 2577              	 .loc 1 1131 0
 2578 0010 3B68     	 ldr r3,[r7]
 2579 0012 0122     	 movs r2,#1
 2580 0014 1A70     	 strb r2,[r3]
1132:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_CMD_ZERO_LENGTH_OR_VALUE != (me->device_error_status & OPTIGA_CMD_ENTER_HANDLER_
 2581              	 .loc 1 1132 0
 2582 0016 7B68     	 ldr r3,[r7,#4]
 2583 0018 9B7E     	 ldrb r3,[r3,#26]
 2584 001a DBB2     	 uxtb r3,r3
 2585 001c 5BB2     	 sxtb r3,r3
 2586 001e 002B     	 cmp r3,#0
 2587 0020 0BDA     	 bge .L127
1133:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1134:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->exit_status = optiga_cmd_handler(me);
 2588              	 .loc 1 1134 0
 2589 0022 FB68     	 ldr r3,[r7,#12]
 2590 0024 7868     	 ldr r0,[r7,#4]
 2591 0026 9847     	 blx r3
 2592 0028 0346     	 mov r3,r0
 2593 002a 1A46     	 mov r2,r3
 2594 002c 7B68     	 ldr r3,[r7,#4]
 2595 002e 9A83     	 strh r2,[r3,#28]
1135:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1136:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         else
1137:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1138:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
1139:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             *exit_loop = FALSE;
1140:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
1141:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1142:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_LIB_SUCCESS == me->exit_status)
 2596              	 .loc 1 1142 0
 2597 0030 7B68     	 ldr r3,[r7,#4]
 2598 0032 9B8B     	 ldrh r3,[r3,#28]
 2599 0034 002B     	 cmp r3,#0
 2600 0036 45D1     	 bne .L130
 2601 0038 06E0     	 b .L136
 2602              	.L127:
1138:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             *exit_loop = FALSE;
 2603              	 .loc 1 1138 0
 2604 003a 7B68     	 ldr r3,[r7,#4]
 2605 003c 0422     	 movs r2,#4
 2606 003e 9A75     	 strb r2,[r3,#22]
1139:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 2607              	 .loc 1 1139 0
 2608 0040 3B68     	 ldr r3,[r7]
 2609 0042 0022     	 movs r2,#0
 2610 0044 1A70     	 strb r2,[r3]
1140:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 2611              	 .loc 1 1140 0
 2612 0046 5DE0     	 b .L126
 2613              	.L136:
1143:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // After successful Close Application, change state to invoke optiga_comms_close
1145:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_CLOSE_APPLICATION == OPTIGA_CMD_GET_APDU_CMD(me->apdu_data))
 2614              	 .loc 1 1145 0
 2615 0048 7B68     	 ldr r3,[r7,#4]
 2616 004a 1B8C     	 ldrh r3,[r3,#32]
 2617 004c DBB2     	 uxtb r3,r3
 2618 004e F12B     	 cmp r3,#241
 2619 0050 14D1     	 bne .L131
1146:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1147:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 2620              	 .loc 1 1147 0
 2621 0052 7B68     	 ldr r3,[r7,#4]
 2622 0054 1B68     	 ldr r3,[r3]
 2623 0056 D3F86C36 	 ldr r3,[r3,#1644]
 2624 005a 1846     	 mov r0,r3
 2625 005c 2B49     	 ldr r1,.L137
 2626 005e 7A68     	 ldr r2,[r7,#4]
 2627 0060 4FF47A73 	 mov r3,#1000
 2628 0064 FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
1148:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        (register_callback)optiga_cmd_event_trigger_
1149:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        me,
1150:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
1151:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
 2629              	 .loc 1 1151 0
 2630 0068 3B68     	 ldr r3,[r7]
 2631 006a 0122     	 movs r2,#1
 2632 006c 1A70     	 strb r2,[r3]
1152:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_next_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE;
 2633              	 .loc 1 1152 0
 2634 006e 7B68     	 ldr r3,[r7,#4]
 2635 0070 0122     	 movs r2,#1
 2636 0072 9A75     	 strb r2,[r3,#22]
1153:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_COMMS_CLOSE_START;
 2637              	 .loc 1 1153 0
 2638 0074 7B68     	 ldr r3,[r7,#4]
 2639 0076 0322     	 movs r2,#3
 2640 0078 DA75     	 strb r2,[r3,#23]
 2641 007a 43E0     	 b .L126
 2642              	.L131:
1154:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1155:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
1156:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1157:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (FALSE == me->chaining_ongoing)
 2643              	 .loc 1 1157 0
 2644 007c 7B68     	 ldr r3,[r7,#4]
 2645 007e 1B7E     	 ldrb r3,[r3,#24]
 2646 0080 002B     	 cmp r3,#0
 2647 0082 0AD1     	 bne .L133
1158:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     if (OPTIGA_CMD_STATE_EXIT != me->cmd_sub_execution_state)
 2648              	 .loc 1 1159 0
 2649 0084 7B68     	 ldr r3,[r7,#4]
 2650 0086 DB7D     	 ldrb r3,[r3,#23]
 2651 0088 0C2B     	 cmp r3,#12
 2652 008a 02D0     	 beq .L134
1160:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     {
1161:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_RELEASE_LOCK;
 2653              	 .loc 1 1161 0
 2654 008c 7B68     	 ldr r3,[r7,#4]
 2655 008e 0B22     	 movs r2,#11
 2656 0090 DA75     	 strb r2,[r3,#23]
 2657              	.L134:
1162:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     }
1163:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *exit_loop = FALSE;
 2658              	 .loc 1 1163 0
 2659 0092 3B68     	 ldr r3,[r7]
 2660 0094 0022     	 movs r2,#0
 2661 0096 1A70     	 strb r2,[r3]
1164:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 2662              	 .loc 1 1164 0
 2663 0098 34E0     	 b .L126
 2664              	.L133:
1165:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1166:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // for chaining, trigger preparing of next command
1167:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
1168:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1169:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 2665              	 .loc 1 1169 0
 2666 009a 7B68     	 ldr r3,[r7,#4]
 2667 009c 1B68     	 ldr r3,[r3]
 2668 009e D3F86C36 	 ldr r3,[r3,#1644]
 2669 00a2 1846     	 mov r0,r3
 2670 00a4 1949     	 ldr r1,.L137
 2671 00a6 7A68     	 ldr r2,[r7,#4]
 2672 00a8 4FF47A73 	 mov r3,#1000
 2673 00ac FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
1170:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                            (register_callback)optiga_cmd_event_trig
1171:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                            (void*)me,
1172:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                            OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
1173:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *exit_loop = TRUE;
 2674              	 .loc 1 1173 0
 2675 00b0 3B68     	 ldr r3,[r7]
 2676 00b2 0122     	 movs r2,#1
 2677 00b4 1A70     	 strb r2,[r3]
1174:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1175:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1176:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->protection_level &= OPTIGA_PROTECTION_LEVEL_MASK;
1177:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1178:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1179:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PREPARE_COMMAND;
 2678              	 .loc 1 1179 0
 2679 00b6 7B68     	 ldr r3,[r7,#4]
 2680 00b8 0222     	 movs r2,#2
 2681 00ba 9A75     	 strb r2,[r3,#22]
1180:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PREPARE_APDU;
 2682              	 .loc 1 1180 0
 2683 00bc 7B68     	 ldr r3,[r7,#4]
 2684 00be 0822     	 movs r2,#8
 2685 00c0 DA75     	 strb r2,[r3,#23]
 2686 00c2 1FE0     	 b .L126
 2687              	.L130:
1181:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1182:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1183:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1184:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         else
1185:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1186:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // After OPTIGA error is analyzed, invoke upper layer handler and release lock
1187:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT == me->exit_status)
 2688              	 .loc 1 1187 0
 2689 00c4 7B68     	 ldr r3,[r7,#4]
 2690 00c6 9B8B     	 ldrh r3,[r3,#28]
 2691 00c8 B3F5017F 	 cmp r3,#516
 2692 00cc 06D1     	 bne .L135
1188:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1189:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_RELEASE_LOCK;
 2693              	 .loc 1 1189 0
 2694 00ce 7B68     	 ldr r3,[r7,#4]
 2695 00d0 0B22     	 movs r2,#11
 2696 00d2 DA75     	 strb r2,[r3,#23]
1190:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *exit_loop = FALSE;
 2697              	 .loc 1 1190 0
 2698 00d4 3B68     	 ldr r3,[r7]
 2699 00d6 0022     	 movs r2,#0
 2700 00d8 1A70     	 strb r2,[r3]
1191:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2701              	 .loc 1 1191 0
 2702 00da 13E0     	 b .L126
 2703              	.L135:
1192:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1193:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // After OPTIGA responds with failure, invoke the next state to check which error occur
1194:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
1195:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1196:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_GET_DEVICE_ERROR;
 2704              	 .loc 1 1196 0
 2705 00dc 7B68     	 ldr r3,[r7,#4]
 2706 00de 0A22     	 movs r2,#10
 2707 00e0 DA75     	 strb r2,[r3,#23]
1197:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_PREPARE);
 2708              	 .loc 1 1197 0
 2709 00e2 7B68     	 ldr r3,[r7,#4]
 2710 00e4 9B7E     	 ldrb r3,[r3,#26]
 2711 00e6 23F00303 	 bic r3,r3,#3
 2712 00ea DAB2     	 uxtb r2,r3
 2713 00ec 7B68     	 ldr r3,[r7,#4]
 2714 00ee 9A76     	 strb r2,[r3,#26]
 2715 00f0 7B68     	 ldr r3,[r7,#4]
 2716 00f2 9B7E     	 ldrb r3,[r3,#26]
 2717 00f4 43F00103 	 orr r3,r3,#1
 2718 00f8 DAB2     	 uxtb r2,r3
 2719 00fa 7B68     	 ldr r3,[r7,#4]
 2720 00fc 9A76     	 strb r2,[r3,#26]
1198:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *exit_loop = FALSE;
 2721              	 .loc 1 1198 0
 2722 00fe 3B68     	 ldr r3,[r7]
 2723 0100 0022     	 movs r2,#0
 2724 0102 1A70     	 strb r2,[r3]
 2725              	.L126:
1199:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1200:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1201:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1202:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 2726              	 .loc 1 1202 0
 2727 0104 1037     	 adds r7,r7,#16
 2728              	.LCFI131:
 2729              	 .cfi_def_cfa_offset 8
 2730 0106 BD46     	 mov sp,r7
 2731              	.LCFI132:
 2732              	 .cfi_def_cfa_register 13
 2733              	 
 2734 0108 80BD     	 pop {r7,pc}
 2735              	.L138:
 2736 010a 00BF     	 .align 2
 2737              	.L137:
 2738 010c 00000000 	 .word optiga_cmd_event_trigger_execute
 2739              	 .cfi_endproc
 2740              	.LFE24:
 2742              	 .section .text.optiga_cmd_execute_process_response,"ax",%progbits
 2743              	 .align 2
 2744              	 .thumb
 2745              	 .thumb_func
 2747              	optiga_cmd_execute_process_response:
 2748              	.LFB25:
1203:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1204:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_process_response(optiga_cmd_t * me, uint8_t * exit_loop)
1205:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 2749              	 .loc 1 1205 0
 2750              	 .cfi_startproc
 2751              	 
 2752              	 
 2753 0000 80B5     	 push {r7,lr}
 2754              	.LCFI133:
 2755              	 .cfi_def_cfa_offset 8
 2756              	 .cfi_offset 7,-8
 2757              	 .cfi_offset 14,-4
 2758 0002 82B0     	 sub sp,sp,#8
 2759              	.LCFI134:
 2760              	 .cfi_def_cfa_offset 16
 2761 0004 00AF     	 add r7,sp,#0
 2762              	.LCFI135:
 2763              	 .cfi_def_cfa_register 7
 2764 0006 7860     	 str r0,[r7,#4]
 2765 0008 3960     	 str r1,[r7]
 2766              	.L148:
1206:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
1207:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1208:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_sub_execution_state)
 2767              	 .loc 1 1208 0
 2768 000a 7B68     	 ldr r3,[r7,#4]
 2769 000c DB7D     	 ldrb r3,[r3,#23]
 2770 000e 093B     	 subs r3,r3,#9
 2771 0010 032B     	 cmp r3,#3
 2772 0012 2CD8     	 bhi .L140
 2773 0014 01A2     	 adr r2,.L142
 2774 0016 52F823F0 	 ldr pc,[r2,r3,lsl#2]
 2775 001a 00BF     	 .p2align 2
 2776              	.L142:
 2777 001c 2D000000 	 .word .L141+1
 2778 0020 37000000 	 .word .L143+1
 2779 0024 41000000 	 .word .L144+1
 2780 0028 55000000 	 .word .L145+1
 2781              	 .p2align 1
 2782              	.L141:
1209:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1210:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE:
1211:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1212:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_process_optiga_response(me, exit_loop);
 2783              	 .loc 1 1212 0
 2784 002c 7868     	 ldr r0,[r7,#4]
 2785 002e 3968     	 ldr r1,[r7]
 2786 0030 FFF7FEFF 	 bl optiga_cmd_execute_process_optiga_response
1213:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2787              	 .loc 1 1213 0
 2788 0034 26E0     	 b .L146
 2789              	.L143:
1214:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1215:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_GET_DEVICE_ERROR:
1216:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1217:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_get_device_error(me, exit_loop);
 2790              	 .loc 1 1217 0
 2791 0036 7868     	 ldr r0,[r7,#4]
 2792 0038 3968     	 ldr r1,[r7]
 2793 003a FFF7FEFF 	 bl optiga_cmd_execute_get_device_error
1218:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2794              	 .loc 1 1218 0
 2795 003e 21E0     	 b .L146
 2796              	.L144:
1219:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1220:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_RELEASE_LOCK:
1221:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1222:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{534} suppress "The return code is not checked because this is exit state
1223:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_release_lock(me);
 2797              	 .loc 1 1223 0
 2798 0040 7868     	 ldr r0,[r7,#4]
 2799 0042 FFF7FEFF 	 bl optiga_cmd_release_lock
1224:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_STATE_EXIT;
 2800              	 .loc 1 1224 0
 2801 0046 7B68     	 ldr r3,[r7,#4]
 2802 0048 0C22     	 movs r2,#12
 2803 004a DA75     	 strb r2,[r3,#23]
1225:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *exit_loop = FALSE;
 2804              	 .loc 1 1225 0
 2805 004c 3B68     	 ldr r3,[r7]
 2806 004e 0022     	 movs r2,#0
 2807 0050 1A70     	 strb r2,[r3]
1226:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2808              	 .loc 1 1226 0
 2809 0052 17E0     	 b .L146
 2810              	.L145:
1227:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1228:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_STATE_EXIT:
1229:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1230:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->handler(me->caller_context, me->exit_status);
 2811              	 .loc 1 1230 0
 2812 0054 7B68     	 ldr r3,[r7,#4]
 2813 0056 1B69     	 ldr r3,[r3,#16]
 2814 0058 7A68     	 ldr r2,[r7,#4]
 2815 005a D168     	 ldr r1,[r2,#12]
 2816 005c 7A68     	 ldr r2,[r7,#4]
 2817 005e 928B     	 ldrh r2,[r2,#28]
 2818 0060 0846     	 mov r0,r1
 2819 0062 1146     	 mov r1,r2
 2820 0064 9847     	 blx r3
1231:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *exit_loop = TRUE;
 2821              	 .loc 1 1231 0
 2822 0066 3B68     	 ldr r3,[r7]
 2823 0068 0122     	 movs r2,#1
 2824 006a 1A70     	 strb r2,[r3]
1232:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2825              	 .loc 1 1232 0
 2826 006c 0AE0     	 b .L146
 2827              	.L140:
1233:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1234:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             default:
1235:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 EXIT_STATE_WITH_ERROR(me,*exit_loop);
 2828              	 .loc 1 1235 0
 2829 006e 7B68     	 ldr r3,[r7,#4]
 2830 0070 0422     	 movs r2,#4
 2831 0072 9A75     	 strb r2,[r3,#22]
 2832 0074 7B68     	 ldr r3,[r7,#4]
 2833 0076 40F20222 	 movw r2,#514
 2834 007a 9A83     	 strh r2,[r3,#28]
 2835 007c 3B68     	 ldr r3,[r7]
 2836 007e 0022     	 movs r2,#0
 2837 0080 1A70     	 strb r2,[r3]
1236:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 2838              	 .loc 1 1236 0
 2839 0082 00BF     	 nop
 2840              	.L146:
1237:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
1238:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1239:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while ((FALSE == *exit_loop) && (OPTIGA_CMD_EXEC_PROCESS_RESPONSE == me->cmd_next_execution_s
 2841              	 .loc 1 1239 0
 2842 0084 3B68     	 ldr r3,[r7]
 2843 0086 1B78     	 ldrb r3,[r3]
 2844 0088 002B     	 cmp r3,#0
 2845 008a 03D1     	 bne .L139
 2846              	 .loc 1 1239 0 is_stmt 0 discriminator 1
 2847 008c 7B68     	 ldr r3,[r7,#4]
 2848 008e 9B7D     	 ldrb r3,[r3,#22]
 2849 0090 032B     	 cmp r3,#3
 2850 0092 BAD0     	 beq .L148
 2851              	.L139:
1240:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 2852              	 .loc 1 1240 0 is_stmt 1
 2853 0094 0837     	 adds r7,r7,#8
 2854              	.LCFI136:
 2855              	 .cfi_def_cfa_offset 8
 2856 0096 BD46     	 mov sp,r7
 2857              	.LCFI137:
 2858              	 .cfi_def_cfa_register 13
 2859              	 
 2860 0098 80BD     	 pop {r7,pc}
 2861              	 .cfi_endproc
 2862              	.LFE25:
 2864 009a 00BF     	 .section .text.optiga_cmd_execute_error_handler,"ax",%progbits
 2865              	 .align 2
 2866              	 .thumb
 2867              	 .thumb_func
 2869              	optiga_cmd_execute_error_handler:
 2870              	.LFB26:
1241:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1242:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_error_handler(const optiga_cmd_t * me, uint8_t * exit_loop)
1243:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 2871              	 .loc 1 1243 0
 2872              	 .cfi_startproc
 2873              	 
 2874              	 
 2875 0000 80B5     	 push {r7,lr}
 2876              	.LCFI138:
 2877              	 .cfi_def_cfa_offset 8
 2878              	 .cfi_offset 7,-8
 2879              	 .cfi_offset 14,-4
 2880 0002 82B0     	 sub sp,sp,#8
 2881              	.LCFI139:
 2882              	 .cfi_def_cfa_offset 16
 2883 0004 00AF     	 add r7,sp,#0
 2884              	.LCFI140:
 2885              	 .cfi_def_cfa_register 7
 2886 0006 7860     	 str r0,[r7,#4]
 2887 0008 3960     	 str r1,[r7]
1244:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
1245:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1246:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         //lint --e{534} suppress "The return code is not checked because this is exit state."
1247:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_cmd_release_lock(me);
 2888              	 .loc 1 1247 0
 2889 000a 7868     	 ldr r0,[r7,#4]
 2890 000c FFF7FEFF 	 bl optiga_cmd_release_lock
1248:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->handler(me->caller_context, me->exit_status);
 2891              	 .loc 1 1248 0
 2892 0010 7B68     	 ldr r3,[r7,#4]
 2893 0012 1B69     	 ldr r3,[r3,#16]
 2894 0014 7A68     	 ldr r2,[r7,#4]
 2895 0016 D168     	 ldr r1,[r2,#12]
 2896 0018 7A68     	 ldr r2,[r7,#4]
 2897 001a 928B     	 ldrh r2,[r2,#28]
 2898 001c 0846     	 mov r0,r1
 2899 001e 1146     	 mov r1,r2
 2900 0020 9847     	 blx r3
1249:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         *exit_loop = TRUE;
 2901              	 .loc 1 1249 0
 2902 0022 3B68     	 ldr r3,[r7]
 2903 0024 0122     	 movs r2,#1
 2904 0026 1A70     	 strb r2,[r3]
1250:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1251:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 2905              	 .loc 1 1251 0
 2906 0028 0837     	 adds r7,r7,#8
 2907              	.LCFI141:
 2908              	 .cfi_def_cfa_offset 8
 2909 002a BD46     	 mov sp,r7
 2910              	.LCFI142:
 2911              	 .cfi_def_cfa_register 13
 2912              	 
 2913 002c 80BD     	 pop {r7,pc}
 2914              	 .cfi_endproc
 2915              	.LFE26:
 2917 002e 00BF     	 .section .text.optiga_cmd_execute_handler,"ax",%progbits
 2918              	 .align 2
 2919              	 .thumb
 2920              	 .thumb_func
 2922              	optiga_cmd_execute_handler:
 2923              	.LFB27:
1252:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1253:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_execute_handler(void * p_ctx, optiga_lib_status_t event)
1254:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 2924              	 .loc 1 1254 0
 2925              	 .cfi_startproc
 2926              	 
 2927              	 
 2928 0000 80B5     	 push {r7,lr}
 2929              	.LCFI143:
 2930              	 .cfi_def_cfa_offset 8
 2931              	 .cfi_offset 7,-8
 2932              	 .cfi_offset 14,-4
 2933 0002 84B0     	 sub sp,sp,#16
 2934              	.LCFI144:
 2935              	 .cfi_def_cfa_offset 24
 2936 0004 00AF     	 add r7,sp,#0
 2937              	.LCFI145:
 2938              	 .cfi_def_cfa_register 7
 2939 0006 7860     	 str r0,[r7,#4]
 2940 0008 0B46     	 mov r3,r1
 2941 000a 7B80     	 strh r3,[r7,#2]
1255:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t exit_loop = TRUE;
 2942              	 .loc 1 1255 0
 2943 000c 0123     	 movs r3,#1
 2944 000e FB72     	 strb r3,[r7,#11]
1256:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_t * me = (optiga_cmd_t *)p_ctx;
 2945              	 .loc 1 1256 0
 2946 0010 7B68     	 ldr r3,[r7,#4]
 2947 0012 FB60     	 str r3,[r7,#12]
1257:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1258:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // in event of no success, release lock and exit
1259:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if (OPTIGA_LIB_SUCCESS != event)
 2948              	 .loc 1 1259 0
 2949 0014 7B88     	 ldrh r3,[r7,#2]
 2950 0016 002B     	 cmp r3,#0
 2951 0018 05D0     	 beq .L151
1260:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1261:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1262:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_cmd_clear_app_ctx(p_ctx);
1263:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1264:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->cmd_next_execution_state = OPTIGA_CMD_EXEC_ERROR_HANDLER;
 2952              	 .loc 1 1264 0
 2953 001a FB68     	 ldr r3,[r7,#12]
 2954 001c 0422     	 movs r2,#4
 2955 001e 9A75     	 strb r2,[r3,#22]
1265:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->exit_status = event;
 2956              	 .loc 1 1265 0
 2957 0020 FB68     	 ldr r3,[r7,#12]
 2958 0022 7A88     	 ldrh r2,[r7,#2]
 2959 0024 9A83     	 strh r2,[r3,#28]
 2960              	.L151:
1266:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
1267:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1268:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
1269:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1270:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         switch (me->cmd_next_execution_state)
 2961              	 .loc 1 1270 0
 2962 0026 FB68     	 ldr r3,[r7,#12]
 2963 0028 9B7D     	 ldrb r3,[r3,#22]
 2964 002a 042B     	 cmp r3,#4
 2965 002c 2FD8     	 bhi .L160
 2966 002e 01A2     	 adr r2,.L154
 2967 0030 52F823F0 	 ldr pc,[r2,r3,lsl#2]
 2968              	 .p2align 2
 2969              	.L154:
 2970 0034 49000000 	 .word .L153+1
 2971 0038 57000000 	 .word .L155+1
 2972 003c 65000000 	 .word .L156+1
 2973 0040 73000000 	 .word .L157+1
 2974 0044 81000000 	 .word .L158+1
 2975              	 .p2align 1
 2976              	.L153:
1271:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1272:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_OPEN:
1273:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1274:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_comms_open(me, &exit_loop);
 2977              	 .loc 1 1274 0
 2978 0048 07F10B03 	 add r3,r7,#11
 2979 004c F868     	 ldr r0,[r7,#12]
 2980 004e 1946     	 mov r1,r3
 2981 0050 FFF7FEFF 	 bl optiga_cmd_execute_comms_open
1275:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2982              	 .loc 1 1275 0
 2983 0054 1CE0     	 b .L159
 2984              	.L155:
1276:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1277:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_COMMS_CLOSE:
1278:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1279:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_comms_close(me, &exit_loop);
 2985              	 .loc 1 1279 0
 2986 0056 07F10B03 	 add r3,r7,#11
 2987 005a F868     	 ldr r0,[r7,#12]
 2988 005c 1946     	 mov r1,r3
 2989 005e FFF7FEFF 	 bl optiga_cmd_execute_comms_close
1280:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2990              	 .loc 1 1280 0
 2991 0062 15E0     	 b .L159
 2992              	.L156:
1281:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1282:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1283:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1284:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_prepare_command(me, &exit_loop);
 2993              	 .loc 1 1284 0
 2994 0064 07F10B03 	 add r3,r7,#11
 2995 0068 F868     	 ldr r0,[r7,#12]
 2996 006a 1946     	 mov r1,r3
 2997 006c FFF7FEFF 	 bl optiga_cmd_execute_prepare_command
1285:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 2998              	 .loc 1 1285 0
 2999 0070 0EE0     	 b .L159
 3000              	.L157:
1286:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1287:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1288:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1289:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_process_response(me, &exit_loop);
 3001              	 .loc 1 1289 0
 3002 0072 07F10B03 	 add r3,r7,#11
 3003 0076 F868     	 ldr r0,[r7,#12]
 3004 0078 1946     	 mov r1,r3
 3005 007a FFF7FEFF 	 bl optiga_cmd_execute_process_response
1290:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3006              	 .loc 1 1290 0
 3007 007e 07E0     	 b .L159
 3008              	.L158:
1291:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1292:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             case OPTIGA_CMD_EXEC_ERROR_HANDLER:
1293:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1294:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_execute_error_handler(me, &exit_loop);
 3009              	 .loc 1 1294 0
 3010 0080 07F10B03 	 add r3,r7,#11
 3011 0084 F868     	 ldr r0,[r7,#12]
 3012 0086 1946     	 mov r1,r3
 3013 0088 FFF7FEFF 	 bl optiga_cmd_execute_error_handler
1295:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3014              	 .loc 1 1295 0
 3015 008c 00E0     	 b .L159
 3016              	.L160:
1296:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1297:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             default :
1298:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3017              	 .loc 1 1298 0
 3018 008e 00BF     	 nop
 3019              	.L159:
1299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{788} suppress "Not all states are used as same enum is used for both main an
1300:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1301:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE == exit_loop);
 3020              	 .loc 1 1301 0
 3021 0090 FB7A     	 ldrb r3,[r7,#11]
 3022 0092 002B     	 cmp r3,#0
 3023 0094 C7D0     	 beq .L151
1302:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 3024              	 .loc 1 1302 0
 3025 0096 1037     	 adds r7,r7,#16
 3026              	.LCFI146:
 3027              	 .cfi_def_cfa_offset 8
 3028 0098 BD46     	 mov sp,r7
 3029              	.LCFI147:
 3030              	 .cfi_def_cfa_register 13
 3031              	 
 3032 009a 80BD     	 pop {r7,pc}
 3033              	 .cfi_endproc
 3034              	.LFE27:
 3036              	 .section .text.optiga_cmd_create,"ax",%progbits
 3037              	 .align 2
 3038              	 .global optiga_cmd_create
 3039              	 .thumb
 3040              	 .thumb_func
 3042              	optiga_cmd_create:
 3043              	.LFB28:
1303:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1304:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_cmd_t * optiga_cmd_create(uint8_t optiga_instance_id, callback_handler_t handler, void * cal
1305:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 3044              	 .loc 1 1305 0
 3045              	 .cfi_startproc
 3046              	 
 3047              	 
 3048 0000 90B5     	 push {r4,r7,lr}
 3049              	.LCFI148:
 3050              	 .cfi_def_cfa_offset 12
 3051              	 .cfi_offset 4,-12
 3052              	 .cfi_offset 7,-8
 3053              	 .cfi_offset 14,-4
 3054 0002 87B0     	 sub sp,sp,#28
 3055              	.LCFI149:
 3056              	 .cfi_def_cfa_offset 40
 3057 0004 00AF     	 add r7,sp,#0
 3058              	.LCFI150:
 3059              	 .cfi_def_cfa_register 7
 3060 0006 0346     	 mov r3,r0
 3061 0008 B960     	 str r1,[r7,#8]
 3062 000a 7A60     	 str r2,[r7,#4]
 3063 000c FB73     	 strb r3,[r7,#15]
1306:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_t * me = NULL;
 3064              	 .loc 1 1306 0
 3065 000e 0023     	 movs r3,#0
 3066 0010 7B61     	 str r3,[r7,#20]
1307:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1308:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     pal_os_lock_enter_critical_section();
 3067              	 .loc 1 1308 0
 3068 0012 FFF7FEFF 	 bl pal_os_lock_enter_critical_section
1309:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
1310:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1311:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // Get number of free slots
1312:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (0 == optiga_cmd_queue_get_count_of(g_optiga_list[optiga_instance_id],
 3069              	 .loc 1 1312 0
 3070 0016 FB7B     	 ldrb r3,[r7,#15]
 3071 0018 314A     	 ldr r2,.L168
 3072 001a 52F82330 	 ldr r3,[r2,r3,lsl#2]
 3073 001e 1846     	 mov r0,r3
 3074 0020 0921     	 movs r1,#9
 3075 0022 0022     	 movs r2,#0
 3076 0024 FFF7FEFF 	 bl optiga_cmd_queue_get_count_of
 3077 0028 0346     	 mov r3,r0
 3078 002a 002B     	 cmp r3,#0
 3079 002c 00D1     	 bne .L162
1313:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_QUEUE_SLOT_STATE,
1314:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_QUEUE_NOT_ASSIGNED))
1315:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1316:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 3080              	 .loc 1 1316 0
 3081 002e 4FE0     	 b .L163
 3082              	.L162:
1317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1318:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1319:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me = (optiga_cmd_t *)pal_os_calloc(1, sizeof(optiga_cmd_t));
 3083              	 .loc 1 1319 0
 3084 0030 0120     	 movs r0,#1
 3085 0032 2421     	 movs r1,#36
 3086 0034 FFF7FEFF 	 bl pal_os_calloc
 3087 0038 7861     	 str r0,[r7,#20]
1320:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (NULL == me)
 3088              	 .loc 1 1320 0
 3089 003a 7B69     	 ldr r3,[r7,#20]
 3090 003c 002B     	 cmp r3,#0
 3091 003e 00D1     	 bne .L164
1321:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1322:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 3092              	 .loc 1 1322 0
 3093 0040 46E0     	 b .L163
 3094              	.L164:
1323:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1324:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1325:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->handler = handler;
 3095              	 .loc 1 1325 0
 3096 0042 7B69     	 ldr r3,[r7,#20]
 3097 0044 BA68     	 ldr r2,[r7,#8]
 3098 0046 1A61     	 str r2,[r3,#16]
1326:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->caller_context = caller_context;
 3099              	 .loc 1 1326 0
 3100 0048 7B69     	 ldr r3,[r7,#20]
 3101 004a 7A68     	 ldr r2,[r7,#4]
 3102 004c DA60     	 str r2,[r3,#12]
1327:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1328:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->p_optiga = g_optiga_list[optiga_instance_id];
 3103              	 .loc 1 1328 0
 3104 004e FB7B     	 ldrb r3,[r7,#15]
 3105 0050 234A     	 ldr r2,.L168
 3106 0052 52F82320 	 ldr r2,[r2,r3,lsl#2]
 3107 0056 7B69     	 ldr r3,[r7,#20]
 3108 0058 1A60     	 str r2,[r3]
1329:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         me->optiga_context_datastore_id = g_hibernate_datastore_id_list[optiga_instance_id];
 3109              	 .loc 1 1329 0
 3110 005a FB7B     	 ldrb r3,[r7,#15]
 3111 005c 214A     	 ldr r2,.L168+4
 3112 005e 32F81320 	 ldrh r2,[r2,r3,lsl#1]
 3113 0062 7B69     	 ldr r3,[r7,#20]
 3114 0064 DA83     	 strh r2,[r3,#30]
1330:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1331:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (FALSE == me->p_optiga->instance_init_state)
 3115              	 .loc 1 1331 0
 3116 0066 7B69     	 ldr r3,[r7,#20]
 3117 0068 1B68     	 ldr r3,[r3]
 3118 006a 1B7B     	 ldrb r3,[r3,#12]
 3119 006c 002B     	 cmp r3,#0
 3120 006e 29D1     	 bne .L165
1332:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1333:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //create pal os event
1334:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_pal_os_event_ctx = pal_os_event_create(optiga_cmd_queue_scheduler, me->
 3121              	 .loc 1 1334 0
 3122 0070 7B69     	 ldr r3,[r7,#20]
 3123 0072 1C68     	 ldr r4,[r3]
 3124 0074 7B69     	 ldr r3,[r7,#20]
 3125 0076 1B68     	 ldr r3,[r3]
 3126 0078 1B48     	 ldr r0,.L168+8
 3127 007a 1946     	 mov r1,r3
 3128 007c FFF7FEFF 	 bl pal_os_event_create
 3129 0080 0346     	 mov r3,r0
 3130 0082 C4F86C36 	 str r3,[r4,#1644]
1335:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms = optiga_comms_create(optiga_cmd_execute_handler, me);
 3131              	 .loc 1 1335 0
 3132 0086 7B69     	 ldr r3,[r7,#20]
 3133 0088 1C68     	 ldr r4,[r3]
 3134 008a 1848     	 ldr r0,.L168+12
 3135 008c 7969     	 ldr r1,[r7,#20]
 3136 008e FFF7FEFF 	 bl optiga_comms_create
 3137 0092 0346     	 mov r3,r0
 3138 0094 2360     	 str r3,[r4]
1336:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (NULL == me->p_optiga->p_optiga_comms)
 3139              	 .loc 1 1336 0
 3140 0096 7B69     	 ldr r3,[r7,#20]
 3141 0098 1B68     	 ldr r3,[r3]
 3142 009a 1B68     	 ldr r3,[r3]
 3143 009c 002B     	 cmp r3,#0
 3144 009e 05D1     	 bne .L166
1337:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1338:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_free(me);
 3145              	 .loc 1 1338 0
 3146 00a0 7869     	 ldr r0,[r7,#20]
 3147 00a2 FFF7FEFF 	 bl pal_os_free
1339:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me = NULL;
 3148              	 .loc 1 1339 0
 3149 00a6 0023     	 movs r3,#0
 3150 00a8 7B61     	 str r3,[r7,#20]
1340:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3151              	 .loc 1 1340 0
 3152 00aa 11E0     	 b .L163
 3153              	.L166:
1341:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1342:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->instance_init_state = TRUE;
 3154              	 .loc 1 1342 0
 3155 00ac 7B69     	 ldr r3,[r7,#20]
 3156 00ae 1B68     	 ldr r3,[r3]
 3157 00b0 0122     	 movs r2,#1
 3158 00b2 1A73     	 strb r2,[r3,#12]
1343:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->p_pal_os_event_ctx = me->p_optiga->p_pal_os_event_ctx;
 3159              	 .loc 1 1343 0
 3160 00b4 7B69     	 ldr r3,[r7,#20]
 3161 00b6 1B68     	 ldr r3,[r3]
 3162 00b8 1B68     	 ldr r3,[r3]
 3163 00ba 7A69     	 ldr r2,[r7,#20]
 3164 00bc 1268     	 ldr r2,[r2]
 3165 00be D2F86C26 	 ldr r2,[r2,#1644]
 3166 00c2 1A61     	 str r2,[r3,#16]
 3167              	.L165:
1344:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1345:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // attach optiga cmd queue entry
1346:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_cmd_queue_assign_slot(me, &(me->queue_id));
 3168              	 .loc 1 1346 0
 3169 00c4 7B69     	 ldr r3,[r7,#20]
 3170 00c6 1B33     	 adds r3,r3,#27
 3171 00c8 7869     	 ldr r0,[r7,#20]
 3172 00ca 1946     	 mov r1,r3
 3173 00cc FFF7FEFF 	 bl optiga_cmd_queue_assign_slot
 3174              	.L163:
1347:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1348:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1349:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     pal_os_lock_exit_critical_section();
 3175              	 .loc 1 1349 0
 3176 00d0 FFF7FEFF 	 bl pal_os_lock_exit_critical_section
1350:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (me);
 3177              	 .loc 1 1350 0
 3178 00d4 7B69     	 ldr r3,[r7,#20]
1351:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 3179              	 .loc 1 1351 0
 3180 00d6 1846     	 mov r0,r3
 3181 00d8 1C37     	 adds r7,r7,#28
 3182              	.LCFI151:
 3183              	 .cfi_def_cfa_offset 12
 3184 00da BD46     	 mov sp,r7
 3185              	.LCFI152:
 3186              	 .cfi_def_cfa_register 13
 3187              	 
 3188 00dc 90BD     	 pop {r4,r7,pc}
 3189              	.L169:
 3190 00de 00BF     	 .align 2
 3191              	.L168:
 3192 00e0 00000000 	 .word g_optiga_list
 3193 00e4 00000000 	 .word g_hibernate_datastore_id_list
 3194 00e8 00000000 	 .word optiga_cmd_queue_scheduler
 3195 00ec 00000000 	 .word optiga_cmd_execute_handler
 3196              	 .cfi_endproc
 3197              	.LFE28:
 3199              	 .section .text.optiga_cmd_destroy,"ax",%progbits
 3200              	 .align 2
 3201              	 .global optiga_cmd_destroy
 3202              	 .thumb
 3203              	 .thumb_func
 3205              	optiga_cmd_destroy:
 3206              	.LFB29:
1352:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1353:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_destroy(optiga_cmd_t * me)
1354:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 3207              	 .loc 1 1354 0
 3208              	 .cfi_startproc
 3209              	 
 3210              	 
 3211 0000 80B5     	 push {r7,lr}
 3212              	.LCFI153:
 3213              	 .cfi_def_cfa_offset 8
 3214              	 .cfi_offset 7,-8
 3215              	 .cfi_offset 14,-4
 3216 0002 84B0     	 sub sp,sp,#16
 3217              	.LCFI154:
 3218              	 .cfi_def_cfa_offset 24
 3219 0004 00AF     	 add r7,sp,#0
 3220              	.LCFI155:
 3221              	 .cfi_def_cfa_register 7
 3222 0006 7860     	 str r0,[r7,#4]
1355:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 3223              	 .loc 1 1355 0
 3224 0008 40F20223 	 movw r3,#514
 3225 000c FB81     	 strh r3,[r7,#14]
1356:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
1357:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1358:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (NULL != me)
 3226              	 .loc 1 1358 0
 3227 000e 7B68     	 ldr r3,[r7,#4]
 3228 0010 002B     	 cmp r3,#0
 3229 0012 0CD0     	 beq .L171
1359:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1360:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = optiga_cmd_release_session(me);
 3230              	 .loc 1 1360 0
 3231 0014 7868     	 ldr r0,[r7,#4]
 3232 0016 FFF7FEFF 	 bl optiga_cmd_release_session
 3233 001a 0346     	 mov r3,r0
 3234 001c FB81     	 strh r3,[r7,#14]
1361:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // attach optiga cmd queue entry
1362:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_queue_deassign_slot(me);
 3235              	 .loc 1 1362 0
 3236 001e 7868     	 ldr r0,[r7,#4]
 3237 0020 FFF7FEFF 	 bl optiga_cmd_queue_deassign_slot
1363:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_free(me);
 3238              	 .loc 1 1363 0
 3239 0024 7868     	 ldr r0,[r7,#4]
 3240 0026 FFF7FEFF 	 bl pal_os_free
1364:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{838} suppress "Release session API returns success. Status is checked for fu
1365:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 3241              	 .loc 1 1365 0
 3242 002a 0023     	 movs r3,#0
 3243 002c FB81     	 strh r3,[r7,#14]
 3244              	.L171:
1366:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1367:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
1368:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 3245              	 .loc 1 1368 0
 3246 002e FB89     	 ldrh r3,[r7,#14]
1369:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 3247              	 .loc 1 1369 0
 3248 0030 1846     	 mov r0,r3
 3249 0032 1037     	 adds r7,r7,#16
 3250              	.LCFI156:
 3251              	 .cfi_def_cfa_offset 8
 3252 0034 BD46     	 mov sp,r7
 3253              	.LCFI157:
 3254              	 .cfi_def_cfa_register 13
 3255              	 
 3256 0036 80BD     	 pop {r7,pc}
 3257              	 .cfi_endproc
 3258              	.LFE29:
 3260              	 .section .text.optiga_cmd_get_error_code_handler,"ax",%progbits
 3261              	 .align 2
 3262              	 .thumb
 3263              	 .thumb_func
 3265              	optiga_cmd_get_error_code_handler:
 3266              	.LFB30:
1370:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1371:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1372:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
1373:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Last error code handler
1374:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
1375:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_get_error_code_handler(optiga_cmd_t * me)
1376:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 3267              	 .loc 1 1376 0
 3268              	 .cfi_startproc
 3269              	 
 3270              	 
 3271 0000 90B5     	 push {r4,r7,lr}
 3272              	.LCFI158:
 3273              	 .cfi_def_cfa_offset 12
 3274              	 .cfi_offset 4,-12
 3275              	 .cfi_offset 7,-8
 3276              	 .cfi_offset 14,-4
 3277 0002 87B0     	 sub sp,sp,#28
 3278              	.LCFI159:
 3279              	 .cfi_def_cfa_offset 40
 3280 0004 02AF     	 add r7,sp,#8
 3281              	.LCFI160:
 3282              	 .cfi_def_cfa 7,32
 3283 0006 7860     	 str r0,[r7,#4]
1377:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_context_t * p_optiga;
1378:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_DEVICE_ERROR;
 3284              	 .loc 1 1378 0
 3285 0008 4FF40043 	 mov r3,#32768
 3286 000c FB81     	 strh r3,[r7,#14]
1379:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 3287              	 .loc 1 1379 0
 3288 000e 0423     	 movs r3,#4
 3289 0010 BB81     	 strh r3,[r7,#12]
1380:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1381:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_OFFSET                     (0x0000)
1382:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_BYTES_TO_READ              (0x0001)
1383:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_GET_DATA_OBJECT_CMD        (0x01)
1384:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #define OPTIGA_CMD_PARAM                      (0x00)
1385:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1386:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     p_optiga = me->p_optiga;
 3290              	 .loc 1 1386 0
 3291 0012 7B68     	 ldr r3,[r7,#4]
 3292 0014 1B68     	 ldr r3,[r3]
 3293 0016 BB60     	 str r3,[r7,#8]
1387:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1388:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch (me->device_error_status & OPTIGA_CMD_ERROR_CODE_STATE_MASK)
 3294              	 .loc 1 1388 0
 3295 0018 7B68     	 ldr r3,[r7,#4]
 3296 001a 9B7E     	 ldrb r3,[r3,#26]
 3297 001c 03F00303 	 and r3,r3,#3
 3298 0020 022B     	 cmp r3,#2
 3299 0022 55D0     	 beq .L175
 3300 0024 032B     	 cmp r3,#3
 3301 0026 00F08680 	 beq .L176
 3302 002a 012B     	 cmp r3,#1
 3303 002c 00D0     	 beq .L177
1389:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1390:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_ERROR_CODE_PREPARE:
1391:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1392:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), OPTIGA_C
1393:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1394:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), OPTIGA_C
1395:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1396:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), OPTIGA_C
1397:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1398:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1399:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_GET_DATA_OBJECT_CMD,
1400:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            OPTIGA_CMD_PARAM,
1401:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSE
1402:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
1403:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1404:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (uint16_t)(index_for_data - OPTIGA_COMMS_DATA_OFFSET);
1405:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_TX);
1406:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
1407:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    (register_callback)optiga_cmd_event_trigger_exec
1408:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    me, OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
1409:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1410:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1411:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_ERROR_CODE_TX:
1412:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1413:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_rx_size = OPTIGA_CMD_TOTAL_COMMS_BUFFER_SIZE;
1414:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1415:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1416:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->protection_level = me->protection_level;
1417:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->protocol_version = me->protocol_version;
1418:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1419:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1420:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             (void)optiga_comms_set_callback_context(p_optiga->p_optiga_comms, (void*)me);
1421:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = optiga_comms_transceive(p_optiga->p_optiga_comms,
1422:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->optiga_comms_buffer,
1423:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->comms_tx_size,
1424:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->optiga_comms_buffer,
1425:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     &p_optiga->comms_rx_size);
1426:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_COMMS_SUCCESS != return_status)
1427:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1428:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR;
1429:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1430:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1431:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_RX);
1432:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1433:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1434:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_ERROR_CODE_RX:
1435:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1436:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_FAILURE == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
1437:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1438:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1439:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1440:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET];
1441:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = return_status | OPTIGA_DEVICE_ERROR;
1442:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PROCESS_RESPONSE;
1443:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE;
1444:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
1445:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    (register_callback)optiga_cmd_event_trigger_exec
1446:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    me, OPTIGA_CMD_SCHEDULER_IDLING_TIME_MS);
1447:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1448:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1449:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
1450:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 3304              	 .loc 1 1450 0
 3305 002e A4E0     	 b .L178
 3306              	.L177:
1392:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 3307              	 .loc 1 1392 0
 3308 0030 7B68     	 ldr r3,[r7,#4]
 3309 0032 1A68     	 ldr r2,[r3]
 3310 0034 BB89     	 ldrh r3,[r7,#12]
 3311 0036 0833     	 adds r3,r3,#8
 3312 0038 1344     	 add r3,r3,r2
 3313 003a 0533     	 adds r3,r3,#5
 3314 003c 1846     	 mov r0,r3
 3315 003e 4FF2C211 	 movw r1,#61890
 3316 0042 FFF7FEFF 	 bl optiga_common_set_uint16
1393:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), OPTIGA_C
 3317              	 .loc 1 1393 0
 3318 0046 BB89     	 ldrh r3,[r7,#12]
 3319 0048 0233     	 adds r3,r3,#2
 3320 004a BB81     	 strh r3,[r7,#12]
1394:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 3321              	 .loc 1 1394 0
 3322 004c 7B68     	 ldr r3,[r7,#4]
 3323 004e 1A68     	 ldr r2,[r3]
 3324 0050 BB89     	 ldrh r3,[r7,#12]
 3325 0052 0833     	 adds r3,r3,#8
 3326 0054 1344     	 add r3,r3,r2
 3327 0056 0533     	 adds r3,r3,#5
 3328 0058 1846     	 mov r0,r3
 3329 005a 0021     	 movs r1,#0
 3330 005c FFF7FEFF 	 bl optiga_common_set_uint16
1395:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), OPTIGA_C
 3331              	 .loc 1 1395 0
 3332 0060 BB89     	 ldrh r3,[r7,#12]
 3333 0062 0233     	 adds r3,r3,#2
 3334 0064 BB81     	 strh r3,[r7,#12]
1396:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 3335              	 .loc 1 1396 0
 3336 0066 7B68     	 ldr r3,[r7,#4]
 3337 0068 1A68     	 ldr r2,[r3]
 3338 006a BB89     	 ldrh r3,[r7,#12]
 3339 006c 0833     	 adds r3,r3,#8
 3340 006e 1344     	 add r3,r3,r2
 3341 0070 0533     	 adds r3,r3,#5
 3342 0072 1846     	 mov r0,r3
 3343 0074 0121     	 movs r1,#1
 3344 0076 FFF7FEFF 	 bl optiga_common_set_uint16
1397:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 3345              	 .loc 1 1397 0
 3346 007a BB89     	 ldrh r3,[r7,#12]
 3347 007c 0233     	 adds r3,r3,#2
 3348 007e BB81     	 strh r3,[r7,#12]
1399:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            OPTIGA_CMD_PARAM,
 3349              	 .loc 1 1399 0
 3350 0080 BB89     	 ldrh r3,[r7,#12]
 3351 0082 043B     	 subs r3,r3,#4
 3352 0084 9AB2     	 uxth r2,r3
1402:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 3353              	 .loc 1 1402 0
 3354 0086 7B68     	 ldr r3,[r7,#4]
 3355 0088 1B68     	 ldr r3,[r3]
 3356 008a 0D33     	 adds r3,r3,#13
1399:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            OPTIGA_CMD_PARAM,
 3357              	 .loc 1 1399 0
 3358 008c 0120     	 movs r0,#1
 3359 008e 0021     	 movs r1,#0
 3360 0090 FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
1404:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             SET_DEV_ERROR_HANDLER_STATE(OPTIGA_CMD_ERROR_CODE_TX);
 3361              	 .loc 1 1404 0
 3362 0094 7B68     	 ldr r3,[r7,#4]
 3363 0096 1B68     	 ldr r3,[r3]
 3364 0098 BA89     	 ldrh r2,[r7,#12]
 3365 009a 9A80     	 strh r2,[r3,#4]
1405:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 3366              	 .loc 1 1405 0
 3367 009c 7B68     	 ldr r3,[r7,#4]
 3368 009e 9B7E     	 ldrb r3,[r3,#26]
 3369 00a0 23F00303 	 bic r3,r3,#3
 3370 00a4 DAB2     	 uxtb r2,r3
 3371 00a6 7B68     	 ldr r3,[r7,#4]
 3372 00a8 9A76     	 strb r2,[r3,#26]
 3373 00aa 7B68     	 ldr r3,[r7,#4]
 3374 00ac 9B7E     	 ldrb r3,[r3,#26]
 3375 00ae 43F00203 	 orr r3,r3,#2
 3376 00b2 DAB2     	 uxtb r2,r3
 3377 00b4 7B68     	 ldr r3,[r7,#4]
 3378 00b6 9A76     	 strb r2,[r3,#26]
1406:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    (register_callback)optiga_cmd_event_trigger_exec
 3379              	 .loc 1 1406 0
 3380 00b8 7B68     	 ldr r3,[r7,#4]
 3381 00ba 1B68     	 ldr r3,[r3]
 3382 00bc D3F86C36 	 ldr r3,[r3,#1644]
 3383 00c0 1846     	 mov r0,r3
 3384 00c2 3049     	 ldr r1,.L182
 3385 00c4 7A68     	 ldr r2,[r7,#4]
 3386 00c6 4FF47A73 	 mov r3,#1000
 3387 00ca FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
1410:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_ERROR_CODE_TX:
 3388              	 .loc 1 1410 0
 3389 00ce 54E0     	 b .L178
 3390              	.L175:
1413:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 3391              	 .loc 1 1413 0
 3392 00d0 7B68     	 ldr r3,[r7,#4]
 3393 00d2 1B68     	 ldr r3,[r3]
 3394 00d4 40F21562 	 movw r2,#1557
 3395 00d8 DA80     	 strh r2,[r3,#6]
1420:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = optiga_comms_transceive(p_optiga->p_optiga_comms,
 3396              	 .loc 1 1420 0
 3397 00da BB68     	 ldr r3,[r7,#8]
 3398 00dc 1B68     	 ldr r3,[r3]
 3399 00de 1846     	 mov r0,r3
 3400 00e0 7968     	 ldr r1,[r7,#4]
 3401 00e2 FFF7FEFF 	 bl optiga_comms_set_callback_context
1421:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->optiga_comms_buffer,
 3402              	 .loc 1 1421 0
 3403 00e6 BB68     	 ldr r3,[r7,#8]
 3404 00e8 1868     	 ldr r0,[r3]
1422:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->comms_tx_size,
 3405              	 .loc 1 1422 0
 3406 00ea BB68     	 ldr r3,[r7,#8]
 3407 00ec 03F10D01 	 add r1,r3,#13
1421:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->optiga_comms_buffer,
 3408              	 .loc 1 1421 0
 3409 00f0 BB68     	 ldr r3,[r7,#8]
 3410 00f2 9A88     	 ldrh r2,[r3,#4]
1424:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     &p_optiga->comms_rx_size);
 3411              	 .loc 1 1424 0
 3412 00f4 BB68     	 ldr r3,[r7,#8]
 3413 00f6 03F10D04 	 add r4,r3,#13
1421:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     p_optiga->optiga_comms_buffer,
 3414              	 .loc 1 1421 0
 3415 00fa BB68     	 ldr r3,[r7,#8]
 3416 00fc 0633     	 adds r3,r3,#6
 3417 00fe 0093     	 str r3,[sp]
 3418 0100 2346     	 mov r3,r4
 3419 0102 FFF7FEFF 	 bl optiga_comms_transceive
 3420 0106 0346     	 mov r3,r0
 3421 0108 FB81     	 strh r3,[r7,#14]
1426:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3422              	 .loc 1 1426 0
 3423 010a FB89     	 ldrh r3,[r7,#14]
 3424 010c 002B     	 cmp r3,#0
 3425 010e 03D0     	 beq .L179
1428:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3426              	 .loc 1 1428 0
 3427 0110 40F20223 	 movw r3,#514
 3428 0114 FB81     	 strh r3,[r7,#14]
1429:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 3429              	 .loc 1 1429 0
 3430 0116 30E0     	 b .L178
 3431              	.L179:
1431:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 3432              	 .loc 1 1431 0
 3433 0118 7B68     	 ldr r3,[r7,#4]
 3434 011a 9B7E     	 ldrb r3,[r3,#26]
 3435 011c 23F00303 	 bic r3,r3,#3
 3436 0120 DAB2     	 uxtb r2,r3
 3437 0122 7B68     	 ldr r3,[r7,#4]
 3438 0124 9A76     	 strb r2,[r3,#26]
 3439 0126 7B68     	 ldr r3,[r7,#4]
 3440 0128 9B7E     	 ldrb r3,[r3,#26]
 3441 012a 43F00303 	 orr r3,r3,#3
 3442 012e DAB2     	 uxtb r2,r3
 3443 0130 7B68     	 ldr r3,[r7,#4]
 3444 0132 9A76     	 strb r2,[r3,#26]
1433:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_ERROR_CODE_RX:
 3445              	 .loc 1 1433 0
 3446 0134 21E0     	 b .L178
 3447              	.L176:
1436:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3448              	 .loc 1 1436 0
 3449 0136 7B68     	 ldr r3,[r7,#4]
 3450 0138 1B68     	 ldr r3,[r3]
 3451 013a 5B7B     	 ldrb r3,[r3,#13]
 3452 013c FF2B     	 cmp r3,#255
 3453 013e 00D1     	 bne .L180
1438:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 3454              	 .loc 1 1438 0
 3455 0140 1BE0     	 b .L178
 3456              	.L180:
1440:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = return_status | OPTIGA_DEVICE_ERROR;
 3457              	 .loc 1 1440 0
 3458 0142 7B68     	 ldr r3,[r7,#4]
 3459 0144 1B68     	 ldr r3,[r3]
 3460 0146 5B7C     	 ldrb r3,[r3,#17]
 3461 0148 FB81     	 strh r3,[r7,#14]
1441:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->cmd_next_execution_state = OPTIGA_CMD_EXEC_PROCESS_RESPONSE;
 3462              	 .loc 1 1441 0
 3463 014a FB89     	 ldrh r3,[r7,#14]
 3464 014c 6FEA4343 	 mvn r3,r3,lsl#17
 3465 0150 6FEA5343 	 mvn r3,r3,lsr#17
 3466 0154 FB81     	 strh r3,[r7,#14]
1442:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_PROCESS_OPTIGA_RESPONSE;
 3467              	 .loc 1 1442 0
 3468 0156 7B68     	 ldr r3,[r7,#4]
 3469 0158 0322     	 movs r2,#3
 3470 015a 9A75     	 strb r2,[r3,#22]
1443:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_event_register_callback_oneshot(me->p_optiga->p_pal_os_event_ctx,
 3471              	 .loc 1 1443 0
 3472 015c 7B68     	 ldr r3,[r7,#4]
 3473 015e 0922     	 movs r2,#9
 3474 0160 DA75     	 strb r2,[r3,#23]
1444:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                    (register_callback)optiga_cmd_event_trigger_exec
 3475              	 .loc 1 1444 0
 3476 0162 7B68     	 ldr r3,[r7,#4]
 3477 0164 1B68     	 ldr r3,[r3]
 3478 0166 D3F86C36 	 ldr r3,[r3,#1644]
 3479 016a 1846     	 mov r0,r3
 3480 016c 0549     	 ldr r1,.L182
 3481 016e 7A68     	 ldr r2,[r7,#4]
 3482 0170 4FF47A73 	 mov r3,#1000
 3483 0174 FFF7FEFF 	 bl pal_os_event_register_callback_oneshot
1448:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 3484              	 .loc 1 1448 0
 3485 0178 00BF     	 nop
 3486              	.L178:
1451:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
1452:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1453:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_OFFSET
1454:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_BYTES_TO_READ
1455:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_GET_DATA_OBJECT_CMD
1456:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #undef OPTIGA_CMD_PARAM
1457:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 3487              	 .loc 1 1457 0
 3488 017a FB89     	 ldrh r3,[r7,#14]
1458:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 3489              	 .loc 1 1458 0
 3490 017c 1846     	 mov r0,r3
 3491 017e 1437     	 adds r7,r7,#20
 3492              	.LCFI161:
 3493              	 .cfi_def_cfa_offset 12
 3494 0180 BD46     	 mov sp,r7
 3495              	.LCFI162:
 3496              	 .cfi_def_cfa_register 13
 3497              	 
 3498 0182 90BD     	 pop {r4,r7,pc}
 3499              	.L183:
 3500              	 .align 2
 3501              	.L182:
 3502 0184 00000000 	 .word optiga_cmd_event_trigger_execute
 3503              	 .cfi_endproc
 3504              	.LFE30:
 3506              	 .section .text.optiga_cmd_open_application_handler,"ax",%progbits
 3507              	 .align 2
 3508              	 .thumb
 3509              	 .thumb_func
 3511              	optiga_cmd_open_application_handler:
 3512              	.LFB31:
1459:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1460:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
1461:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Open Application handler
1462:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
1463:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_open_application_handler(optiga_cmd_t * me)
1464:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 3513              	 .loc 1 1464 0
 3514              	 .cfi_startproc
 3515              	 
 3516              	 
 3517 0000 80B5     	 push {r7,lr}
 3518              	.LCFI163:
 3519              	 .cfi_def_cfa_offset 8
 3520              	 .cfi_offset 7,-8
 3521              	 .cfi_offset 14,-4
 3522 0002 84B0     	 sub sp,sp,#16
 3523              	.LCFI164:
 3524              	 .cfi_def_cfa_offset 24
 3525 0004 00AF     	 add r7,sp,#0
 3526              	.LCFI165:
 3527              	 .cfi_def_cfa_register 7
 3528 0006 7860     	 str r0,[r7,#4]
1465:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
1466:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 3529              	 .loc 1 1466 0
 3530 0008 40F20223 	 movw r3,#514
 3531 000c FB81     	 strh r3,[r7,#14]
1467:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1468:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 3532              	 .loc 1 1468 0
 3533 000e 7B68     	 ldr r3,[r7,#4]
 3534 0010 9B7D     	 ldrb r3,[r3,#22]
 3535 0012 022B     	 cmp r3,#2
 3536 0014 02D0     	 beq .L186
 3537 0016 032B     	 cmp r3,#3
 3538 0018 76D0     	 beq .L187
1469:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1470:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1471:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1472:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1473:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending open app command...");
1474:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1475:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + sizeof(g_optiga_unique_application_id
1476:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length += ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_param) ? (0) 
1477:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (sizeof(me->p_optiga->optiga_context_handle_buffer)));
1478:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{774} suppress "If OPTIGA_MAX_COMMS_BUFFER_SIZE is set to lesser value it wil
1479:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
1480:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1481:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1482:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1483:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1484:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT != me->cmd_param)
1485:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1486:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 ///optiga context restore operation
1487:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != optiga_cmd_restore_context(me))
1488:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1489:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
1490:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1491:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1492:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_OPEN_APPLICATION,
1493:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1494:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
1495:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (sizeof(g_optiga_unique_application_identifier)) :
1496:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (sizeof(g_optiga_unique_application_identifier) +
1497:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            sizeof(me->p_optiga->optiga_context_handle_buffer))),
1498:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
1499:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1500:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
1501:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           g_optiga_unique_application_identifier,
1502:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           sizeof(g_optiga_unique_application_identifier));
1503:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT != me->cmd_param)
1504:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1505:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET +
1506:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               sizeof(g_optiga_unique_application_identifier)],
1507:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_context_handle_buffer,
1508:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               sizeof(me->p_optiga->optiga_context_handle_buffer));
1509:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1510:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1511:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (OPTIGA_CMD_APDU_HEADER_SIZE +
1512:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
1513:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            sizeof(g_optiga_unique_application_identifier):
1514:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (sizeof(g_optiga_unique_application_identifier) +
1515:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            sizeof(me->p_optiga->optiga_context_handle_buffer))));
1516:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1517:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_memset(me->p_optiga->optiga_context_handle_buffer,
1518:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           0,
1519:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           sizeof(me->p_optiga->optiga_context_handle_buffer));
1520:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_LIB_PAL_DATA_STORE_NOT_CONFIGURED != me->optiga_context_datastore_id)
1521:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1522:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //Clearing context handle secret from datastore
1523:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = pal_os_datastore_write(me->optiga_context_datastore_id,
1524:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        me->p_optiga->optiga_context_handle_buffer,
1525:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        sizeof(me->p_optiga->optiga_context_handle_b
1526:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (PAL_STATUS_SUCCESS != return_status)
1527:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1528:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR;
1529:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
1530:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1531:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1532:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1533:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1534:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1535:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1536:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1537:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for open app command...");
1538:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1539:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
1540:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1541:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing open app response...");
1542:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1543:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1544:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
1545:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1546:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1547:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_COMMS_SHIELDED_CONNECTION
1548:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->p_optiga_comms->manage_context_operation = OPTIGA_COMMS_SESSION_CONTEXT_N
1549:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_COMMS_SHIELDED_CONNECTION
1550:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of open app command is processed...");
1551:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1552:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1553:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1554:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1555:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
1556:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 3539              	 .loc 1 1556 0
 3540 001a 89E0     	 b .L191
 3541              	.L186:
1475:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length += ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_param) ? (0) 
 3542              	 .loc 1 1475 0
 3543 001c 1423     	 movs r3,#20
 3544 001e BB81     	 strh r3,[r7,#12]
1476:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (sizeof(me->p_optiga->optiga_context_handle_buffer)));
 3545              	 .loc 1 1476 0
 3546 0020 7B68     	 ldr r3,[r7,#4]
 3547 0022 5B7E     	 ldrb r3,[r3,#25]
 3548 0024 002B     	 cmp r3,#0
 3549 0026 01D1     	 bne .L188
1476:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (sizeof(me->p_optiga->optiga_context_handle_buffer)));
 3550              	 .loc 1 1476 0 is_stmt 0 discriminator 1
 3551 0028 0022     	 movs r2,#0
 3552 002a 00E0     	 b .L189
 3553              	.L188:
1476:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (sizeof(me->p_optiga->optiga_context_handle_buffer)));
 3554              	 .loc 1 1476 0 discriminator 2
 3555 002c 0822     	 movs r2,#8
 3556              	.L189:
1476:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (sizeof(me->p_optiga->optiga_context_handle_buffer)));
 3557              	 .loc 1 1476 0 discriminator 4
 3558 002e BB89     	 ldrh r3,[r7,#12]
 3559 0030 1344     	 add r3,r3,r2
 3560 0032 BB81     	 strh r3,[r7,#12]
1479:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3561              	 .loc 1 1479 0 is_stmt 1 discriminator 4
 3562 0034 BB89     	 ldrh r3,[r7,#12]
 3563 0036 40F21562 	 movw r2,#1557
 3564 003a 9342     	 cmp r3,r2
 3565 003c 03D9     	 bls .L190
1481:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3566              	 .loc 1 1481 0
 3567 003e 4FF40173 	 mov r3,#516
 3568 0042 FB81     	 strh r3,[r7,#14]
1482:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 3569              	 .loc 1 1482 0
 3570 0044 74E0     	 b .L191
 3571              	.L190:
1484:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3572              	 .loc 1 1484 0
 3573 0046 7B68     	 ldr r3,[r7,#4]
 3574 0048 5B7E     	 ldrb r3,[r3,#25]
 3575 004a 002B     	 cmp r3,#0
 3576 004c 06D0     	 beq .L192
1487:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 3577              	 .loc 1 1487 0
 3578 004e 7868     	 ldr r0,[r7,#4]
 3579 0050 FFF7FEFF 	 bl optiga_cmd_restore_context
 3580 0054 0346     	 mov r3,r0
 3581 0056 002B     	 cmp r3,#0
 3582 0058 00D0     	 beq .L192
1489:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 3583              	 .loc 1 1489 0
 3584 005a 69E0     	 b .L191
 3585              	.L192:
1492:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3586              	 .loc 1 1492 0
 3587 005c 7B68     	 ldr r3,[r7,#4]
 3588 005e 597E     	 ldrb r1,[r3,#25]
1494:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (sizeof(g_optiga_unique_application_identifier)) :
 3589              	 .loc 1 1494 0
 3590 0060 7B68     	 ldr r3,[r7,#4]
 3591 0062 5B7E     	 ldrb r3,[r3,#25]
1492:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3592              	 .loc 1 1492 0
 3593 0064 002B     	 cmp r3,#0
 3594 0066 01D1     	 bne .L193
1492:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3595              	 .loc 1 1492 0 is_stmt 0 discriminator 1
 3596 0068 1022     	 movs r2,#16
 3597 006a 00E0     	 b .L194
 3598              	.L193:
1492:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3599              	 .loc 1 1492 0 discriminator 2
 3600 006c 1822     	 movs r2,#24
 3601              	.L194:
1498:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 3602              	 .loc 1 1498 0 is_stmt 1
 3603 006e 7B68     	 ldr r3,[r7,#4]
 3604 0070 1B68     	 ldr r3,[r3]
 3605 0072 0D33     	 adds r3,r3,#13
1492:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3606              	 .loc 1 1492 0
 3607 0074 F020     	 movs r0,#240
 3608 0076 FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
1500:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           g_optiga_unique_application_identifier,
 3609              	 .loc 1 1500 0
 3610 007a 7B68     	 ldr r3,[r7,#4]
 3611 007c 1B68     	 ldr r3,[r3]
 3612 007e 1133     	 adds r3,r3,#17
 3613 0080 1846     	 mov r0,r3
 3614 0082 2E49     	 ldr r1,.L201
 3615 0084 1022     	 movs r2,#16
 3616 0086 FFF7FEFF 	 bl pal_os_memcpy
1503:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3617              	 .loc 1 1503 0
 3618 008a 7B68     	 ldr r3,[r7,#4]
 3619 008c 5B7E     	 ldrb r3,[r3,#25]
 3620 008e 002B     	 cmp r3,#0
 3621 0090 0CD0     	 beq .L195
1505:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               sizeof(g_optiga_unique_application_identifier)],
 3622              	 .loc 1 1505 0
 3623 0092 7B68     	 ldr r3,[r7,#4]
 3624 0094 1B68     	 ldr r3,[r3]
 3625 0096 03F12102 	 add r2,r3,#33
1507:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               sizeof(me->p_optiga->optiga_context_handle_buffer));
 3626              	 .loc 1 1507 0
 3627 009a 7B68     	 ldr r3,[r7,#4]
 3628 009c 1B68     	 ldr r3,[r3]
 3629 009e 03F27463 	 addw r3,r3,#1652
1505:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               sizeof(g_optiga_unique_application_identifier)],
 3630              	 .loc 1 1505 0
 3631 00a2 1046     	 mov r0,r2
 3632 00a4 1946     	 mov r1,r3
 3633 00a6 0822     	 movs r2,#8
 3634 00a8 FFF7FEFF 	 bl pal_os_memcpy
 3635              	.L195:
1511:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
 3636              	 .loc 1 1511 0
 3637 00ac 7B68     	 ldr r3,[r7,#4]
 3638 00ae 1B68     	 ldr r3,[r3]
1512:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            sizeof(g_optiga_unique_application_identifier):
 3639              	 .loc 1 1512 0
 3640 00b0 7A68     	 ldr r2,[r7,#4]
 3641 00b2 527E     	 ldrb r2,[r2,#25]
1511:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
 3642              	 .loc 1 1511 0
 3643 00b4 002A     	 cmp r2,#0
 3644 00b6 01D1     	 bne .L196
1511:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
 3645              	 .loc 1 1511 0 is_stmt 0 discriminator 1
 3646 00b8 1422     	 movs r2,#20
 3647 00ba 00E0     	 b .L197
 3648              	.L196:
1511:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
 3649              	 .loc 1 1511 0 discriminator 2
 3650 00bc 1C22     	 movs r2,#28
 3651              	.L197:
1511:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            ((OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT == me->cmd_par
 3652              	 .loc 1 1511 0 discriminator 4
 3653 00be 9A80     	 strh r2,[r3,#4]
1517:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           0,
 3654              	 .loc 1 1517 0 is_stmt 1 discriminator 4
 3655 00c0 7B68     	 ldr r3,[r7,#4]
 3656 00c2 1B68     	 ldr r3,[r3]
 3657 00c4 03F27463 	 addw r3,r3,#1652
 3658 00c8 1846     	 mov r0,r3
 3659 00ca 0021     	 movs r1,#0
 3660 00cc 0822     	 movs r2,#8
 3661 00ce FFF7FEFF 	 bl pal_os_memset
1520:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3662              	 .loc 1 1520 0 discriminator 4
 3663 00d2 7B68     	 ldr r3,[r7,#4]
 3664 00d4 DB8B     	 ldrh r3,[r3,#30]
 3665 00d6 002B     	 cmp r3,#0
 3666 00d8 13D0     	 beq .L198
1523:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        me->p_optiga->optiga_context_handle_buffer,
 3667              	 .loc 1 1523 0
 3668 00da 7B68     	 ldr r3,[r7,#4]
 3669 00dc DA8B     	 ldrh r2,[r3,#30]
1524:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        sizeof(me->p_optiga->optiga_context_handle_b
 3670              	 .loc 1 1524 0
 3671 00de 7B68     	 ldr r3,[r7,#4]
 3672 00e0 1B68     	 ldr r3,[r3]
 3673 00e2 03F27463 	 addw r3,r3,#1652
1523:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                        me->p_optiga->optiga_context_handle_buffer,
 3674              	 .loc 1 1523 0
 3675 00e6 1046     	 mov r0,r2
 3676 00e8 1946     	 mov r1,r3
 3677 00ea 0822     	 movs r2,#8
 3678 00ec FFF7FEFF 	 bl pal_os_datastore_write
 3679 00f0 0346     	 mov r3,r0
 3680 00f2 FB81     	 strh r3,[r7,#14]
1526:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 3681              	 .loc 1 1526 0
 3682 00f4 FB89     	 ldrh r3,[r7,#14]
 3683 00f6 002B     	 cmp r3,#0
 3684 00f8 03D0     	 beq .L198
1528:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 3685              	 .loc 1 1528 0
 3686 00fa 40F20223 	 movw r3,#514
 3687 00fe FB81     	 strh r3,[r7,#14]
1529:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 3688              	 .loc 1 1529 0
 3689 0100 16E0     	 b .L191
 3690              	.L198:
1532:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 3691              	 .loc 1 1532 0
 3692 0102 0023     	 movs r3,#0
 3693 0104 FB81     	 strh r3,[r7,#14]
1534:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 3694              	 .loc 1 1534 0
 3695 0106 13E0     	 b .L191
 3696              	.L187:
1539:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3697              	 .loc 1 1539 0
 3698 0108 7B68     	 ldr r3,[r7,#4]
 3699 010a 1B68     	 ldr r3,[r3]
 3700 010c 5B7B     	 ldrb r3,[r3,#13]
 3701 010e 002B     	 cmp r3,#0
 3702 0110 0BD0     	 beq .L199
1544:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3703              	 .loc 1 1544 0
 3704 0112 7B68     	 ldr r3,[r7,#4]
 3705 0114 9B7E     	 ldrb r3,[r3,#26]
 3706 0116 03F07F03 	 and r3,r3,#127
 3707 011a DAB2     	 uxtb r2,r3
 3708 011c 7B68     	 ldr r3,[r7,#4]
 3709 011e 9A76     	 strb r2,[r3,#26]
 3710 0120 7B68     	 ldr r3,[r7,#4]
 3711 0122 9A7E     	 ldrb r2,[r3,#26]
 3712 0124 7B68     	 ldr r3,[r7,#4]
 3713 0126 9A76     	 strb r2,[r3,#26]
1545:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 3714              	 .loc 1 1545 0
 3715 0128 02E0     	 b .L191
 3716              	.L199:
1551:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 3717              	 .loc 1 1551 0
 3718 012a 0023     	 movs r3,#0
 3719 012c FB81     	 strh r3,[r7,#14]
1554:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 3720              	 .loc 1 1554 0
 3721 012e 00BF     	 nop
 3722              	.L191:
1557:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
1558:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1559:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 3723              	 .loc 1 1559 0
 3724 0130 FB89     	 ldrh r3,[r7,#14]
1560:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 3725              	 .loc 1 1560 0
 3726 0132 1846     	 mov r0,r3
 3727 0134 1037     	 adds r7,r7,#16
 3728              	.LCFI166:
 3729              	 .cfi_def_cfa_offset 8
 3730 0136 BD46     	 mov sp,r7
 3731              	.LCFI167:
 3732              	 .cfi_def_cfa_register 13
 3733              	 
 3734 0138 80BD     	 pop {r7,pc}
 3735              	.L202:
 3736 013a 00BF     	 .align 2
 3737              	.L201:
 3738 013c 00000000 	 .word g_optiga_unique_application_identifier
 3739              	 .cfi_endproc
 3740              	.LFE31:
 3742              	 .section .text.optiga_cmd_open_application,"ax",%progbits
 3743              	 .align 2
 3744              	 .global optiga_cmd_open_application
 3745              	 .thumb
 3746              	 .thumb_func
 3748              	optiga_cmd_open_application:
 3749              	.LFB32:
1561:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1562:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1563:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_open_application(optiga_cmd_t * me, uint8_t cmd_param, void * params
1564:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 3750              	 .loc 1 1564 0
 3751              	 .cfi_startproc
 3752              	 
 3753              	 
 3754 0000 80B5     	 push {r7,lr}
 3755              	.LCFI168:
 3756              	 .cfi_def_cfa_offset 8
 3757              	 .cfi_offset 7,-8
 3758              	 .cfi_offset 14,-4
 3759 0002 88B0     	 sub sp,sp,#32
 3760              	.LCFI169:
 3761              	 .cfi_def_cfa_offset 40
 3762 0004 04AF     	 add r7,sp,#16
 3763              	.LCFI170:
 3764              	 .cfi_def_cfa 7,24
 3765 0006 F860     	 str r0,[r7,#12]
 3766 0008 0B46     	 mov r3,r1
 3767 000a 7A60     	 str r2,[r7,#4]
 3768 000c FB72     	 strb r3,[r7,#11]
1565:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1566:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
 3769              	 .loc 1 1566 0
 3770 000e FA7A     	 ldrb r2,[r7,#11]
 3771 0010 0023     	 movs r3,#0
 3772 0012 0093     	 str r3,[sp]
 3773 0014 7B68     	 ldr r3,[r7,#4]
 3774 0016 0193     	 str r3,[sp,#4]
 3775 0018 F023     	 movs r3,#240
 3776 001a 0293     	 str r3,[sp,#8]
 3777 001c F868     	 ldr r0,[r7,#12]
 3778 001e 1146     	 mov r1,r2
 3779 0020 044A     	 ldr r2,.L205
 3780 0022 0023     	 movs r3,#0
 3781 0024 FFF7FEFF 	 bl optiga_cmd_execute
1567:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1568:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_open_application_handler,
1569:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_COMMS_OPEN,
1570:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_COMMS_OPEN_ACQUIRE_LOCK,
1571:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        params,
1572:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1573:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_OPEN_APPLICATION, OPTIGA_CMD_ZERO_LENGTH
1574:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1575:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
 3782              	 .loc 1 1575 0
 3783 0028 0023     	 movs r3,#0
1576:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 3784              	 .loc 1 1576 0
 3785 002a 1846     	 mov r0,r3
 3786 002c 1037     	 adds r7,r7,#16
 3787              	.LCFI171:
 3788              	 .cfi_def_cfa_offset 8
 3789 002e BD46     	 mov sp,r7
 3790              	.LCFI172:
 3791              	 .cfi_def_cfa_register 13
 3792              	 
 3793 0030 80BD     	 pop {r7,pc}
 3794              	.L206:
 3795 0032 00BF     	 .align 2
 3796              	.L205:
 3797 0034 00000000 	 .word optiga_cmd_open_application_handler
 3798              	 .cfi_endproc
 3799              	.LFE32:
 3801              	 .section .text.optiga_cmd_close_application_handler,"ax",%progbits
 3802              	 .align 2
 3803              	 .thumb
 3804              	 .thumb_func
 3806              	optiga_cmd_close_application_handler:
 3807              	.LFB33:
1577:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1578:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
1579:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Close Application handler
1580:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
1581:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_close_application_handler(optiga_cmd_t * me)
1582:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 3808              	 .loc 1 1582 0
 3809              	 .cfi_startproc
 3810              	 
 3811              	 
 3812 0000 80B5     	 push {r7,lr}
 3813              	.LCFI173:
 3814              	 .cfi_def_cfa_offset 8
 3815              	 .cfi_offset 7,-8
 3816              	 .cfi_offset 14,-4
 3817 0002 84B0     	 sub sp,sp,#16
 3818              	.LCFI174:
 3819              	 .cfi_def_cfa_offset 24
 3820 0004 00AF     	 add r7,sp,#0
 3821              	.LCFI175:
 3822              	 .cfi_def_cfa_register 7
 3823 0006 7860     	 str r0,[r7,#4]
1583:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
1584:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 3824              	 .loc 1 1584 0
 3825 0008 40F20223 	 movw r3,#514
 3826 000c FB81     	 strh r3,[r7,#14]
1585:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1586:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 3827              	 .loc 1 1586 0
 3828 000e 7B68     	 ldr r3,[r7,#4]
 3829 0010 9B7D     	 ldrb r3,[r3,#22]
 3830 0012 022B     	 cmp r3,#2
 3831 0014 02D0     	 beq .L209
 3832 0016 032B     	 cmp r3,#3
 3833 0018 1CD0     	 beq .L210
1587:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1588:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1589:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1590:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1591:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending close app command..");
1592:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1593:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE;
1594:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{774} suppress "If OPTIGA_MAX_COMMS_BUFFER_SIZE is set to lesser value it wil
1595:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
1596:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1597:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1598:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1599:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1600:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_CLOSE_APPLICATION,
1601:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1602:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
1603:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
1604:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1605:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = OPTIGA_CMD_APDU_HEADER_SIZE;
1606:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1607:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1608:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1609:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1610:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1611:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for close app command...");
1612:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if the close app was successful
1613:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
1614:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1615:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing close app response...");
1616:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1617:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1618:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
1619:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1620:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1621:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_PARAM_INITIALIZE_APP_CONTEXT != me->cmd_param)
1622:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1623:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_context_handle_buffer,
1624:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
1625:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               sizeof(me->p_optiga->optiga_context_handle_buffer));
1626:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 ///Optiga context store operation
1627:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_LIB_SUCCESS != optiga_cmd_store_context(me))
1628:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1629:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     pal_os_memset(me->p_optiga->optiga_context_handle_buffer,0,
1630:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     sizeof(me->p_optiga->optiga_context_handle_buffer));
1631:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
1632:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1633:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1634:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of close app command is processed...");
1635:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1636:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1637:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1638:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1639:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
1640:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 3834              	 .loc 1 1640 0
 3835 001a 4FE0     	 b .L212
 3836              	.L209:
1593:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{774} suppress "If OPTIGA_MAX_COMMS_BUFFER_SIZE is set to lesser value it wil
 3837              	 .loc 1 1593 0
 3838 001c 0423     	 movs r3,#4
 3839 001e BB81     	 strh r3,[r7,#12]
1595:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3840              	 .loc 1 1595 0
 3841 0020 BB89     	 ldrh r3,[r7,#12]
 3842 0022 40F21562 	 movw r2,#1557
 3843 0026 9342     	 cmp r3,r2
 3844 0028 03D9     	 bls .L211
1597:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3845              	 .loc 1 1597 0
 3846 002a 4FF40173 	 mov r3,#516
 3847 002e FB81     	 strh r3,[r7,#14]
1598:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 3848              	 .loc 1 1598 0
 3849 0030 44E0     	 b .L212
 3850              	.L211:
1600:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3851              	 .loc 1 1600 0
 3852 0032 7B68     	 ldr r3,[r7,#4]
 3853 0034 5A7E     	 ldrb r2,[r3,#25]
1603:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 3854              	 .loc 1 1603 0
 3855 0036 7B68     	 ldr r3,[r7,#4]
 3856 0038 1B68     	 ldr r3,[r3]
 3857 003a 0D33     	 adds r3,r3,#13
1600:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 3858              	 .loc 1 1600 0
 3859 003c F120     	 movs r0,#241
 3860 003e 1146     	 mov r1,r2
 3861 0040 0022     	 movs r2,#0
 3862 0042 FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
1605:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 3863              	 .loc 1 1605 0
 3864 0046 7B68     	 ldr r3,[r7,#4]
 3865 0048 1B68     	 ldr r3,[r3]
 3866 004a 0422     	 movs r2,#4
 3867 004c 9A80     	 strh r2,[r3,#4]
1606:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 3868              	 .loc 1 1606 0
 3869 004e 0023     	 movs r3,#0
 3870 0050 FB81     	 strh r3,[r7,#14]
1608:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 3871              	 .loc 1 1608 0
 3872 0052 33E0     	 b .L212
 3873              	.L210:
1613:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3874              	 .loc 1 1613 0
 3875 0054 7B68     	 ldr r3,[r7,#4]
 3876 0056 1B68     	 ldr r3,[r3]
 3877 0058 5B7B     	 ldrb r3,[r3,#13]
 3878 005a 002B     	 cmp r3,#0
 3879 005c 0BD0     	 beq .L213
1618:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 3880              	 .loc 1 1618 0
 3881 005e 7B68     	 ldr r3,[r7,#4]
 3882 0060 9B7E     	 ldrb r3,[r3,#26]
 3883 0062 03F07F03 	 and r3,r3,#127
 3884 0066 DAB2     	 uxtb r2,r3
 3885 0068 7B68     	 ldr r3,[r7,#4]
 3886 006a 9A76     	 strb r2,[r3,#26]
 3887 006c 7B68     	 ldr r3,[r7,#4]
 3888 006e 9A7E     	 ldrb r2,[r3,#26]
 3889 0070 7B68     	 ldr r3,[r7,#4]
 3890 0072 9A76     	 strb r2,[r3,#26]
1619:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 3891              	 .loc 1 1619 0
 3892 0074 22E0     	 b .L212
 3893              	.L213:
1621:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 3894              	 .loc 1 1621 0
 3895 0076 7B68     	 ldr r3,[r7,#4]
 3896 0078 5B7E     	 ldrb r3,[r3,#25]
 3897 007a 002B     	 cmp r3,#0
 3898 007c 1BD0     	 beq .L214
1623:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
 3899              	 .loc 1 1623 0
 3900 007e 7B68     	 ldr r3,[r7,#4]
 3901 0080 1B68     	 ldr r3,[r3]
 3902 0082 03F27462 	 addw r2,r3,#1652
1624:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               sizeof(me->p_optiga->optiga_context_handle_buffer));
 3903              	 .loc 1 1624 0
 3904 0086 7B68     	 ldr r3,[r7,#4]
 3905 0088 1B68     	 ldr r3,[r3]
 3906 008a 1133     	 adds r3,r3,#17
1623:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
 3907              	 .loc 1 1623 0
 3908 008c 1046     	 mov r0,r2
 3909 008e 1946     	 mov r1,r3
 3910 0090 0822     	 movs r2,#8
 3911 0092 FFF7FEFF 	 bl pal_os_memcpy
1627:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 3912              	 .loc 1 1627 0
 3913 0096 7868     	 ldr r0,[r7,#4]
 3914 0098 FFF7FEFF 	 bl optiga_cmd_store_context
 3915 009c 0346     	 mov r3,r0
 3916 009e 002B     	 cmp r3,#0
 3917 00a0 09D0     	 beq .L214
1629:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     sizeof(me->p_optiga->optiga_context_handle_buffer));
 3918              	 .loc 1 1629 0
 3919 00a2 7B68     	 ldr r3,[r7,#4]
 3920 00a4 1B68     	 ldr r3,[r3]
 3921 00a6 03F27463 	 addw r3,r3,#1652
 3922 00aa 1846     	 mov r0,r3
 3923 00ac 0021     	 movs r1,#0
 3924 00ae 0822     	 movs r2,#8
 3925 00b0 FFF7FEFF 	 bl pal_os_memset
1631:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 3926              	 .loc 1 1631 0
 3927 00b4 02E0     	 b .L212
 3928              	.L214:
1635:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 3929              	 .loc 1 1635 0
 3930 00b6 0023     	 movs r3,#0
 3931 00b8 FB81     	 strh r3,[r7,#14]
1638:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 3932              	 .loc 1 1638 0
 3933 00ba 00BF     	 nop
 3934              	.L212:
1641:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
1642:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1643:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 3935              	 .loc 1 1643 0
 3936 00bc FB89     	 ldrh r3,[r7,#14]
1644:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 3937              	 .loc 1 1644 0
 3938 00be 1846     	 mov r0,r3
 3939 00c0 1037     	 adds r7,r7,#16
 3940              	.LCFI176:
 3941              	 .cfi_def_cfa_offset 8
 3942 00c2 BD46     	 mov sp,r7
 3943              	.LCFI177:
 3944              	 .cfi_def_cfa_register 13
 3945              	 
 3946 00c4 80BD     	 pop {r7,pc}
 3947              	 .cfi_endproc
 3948              	.LFE33:
 3950 00c6 00BF     	 .section .text.optiga_cmd_close_application,"ax",%progbits
 3951              	 .align 2
 3952              	 .global optiga_cmd_close_application
 3953              	 .thumb
 3954              	 .thumb_func
 3956              	optiga_cmd_close_application:
 3957              	.LFB34:
1645:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1646:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_close_application(optiga_cmd_t * me, uint8_t cmd_param, void * param
1647:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 3958              	 .loc 1 1647 0
 3959              	 .cfi_startproc
 3960              	 
 3961              	 
 3962 0000 80B5     	 push {r7,lr}
 3963              	.LCFI178:
 3964              	 .cfi_def_cfa_offset 8
 3965              	 .cfi_offset 7,-8
 3966              	 .cfi_offset 14,-4
 3967 0002 88B0     	 sub sp,sp,#32
 3968              	.LCFI179:
 3969              	 .cfi_def_cfa_offset 40
 3970 0004 04AF     	 add r7,sp,#16
 3971              	.LCFI180:
 3972              	 .cfi_def_cfa 7,24
 3973 0006 F860     	 str r0,[r7,#12]
 3974 0008 0B46     	 mov r3,r1
 3975 000a 7A60     	 str r2,[r7,#4]
 3976 000c FB72     	 strb r3,[r7,#11]
1648:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1649:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
 3977              	 .loc 1 1649 0
 3978 000e FA7A     	 ldrb r2,[r7,#11]
 3979 0010 0623     	 movs r3,#6
 3980 0012 0093     	 str r3,[sp]
 3981 0014 7B68     	 ldr r3,[r7,#4]
 3982 0016 0193     	 str r3,[sp,#4]
 3983 0018 F123     	 movs r3,#241
 3984 001a 0293     	 str r3,[sp,#8]
 3985 001c F868     	 ldr r0,[r7,#12]
 3986 001e 1146     	 mov r1,r2
 3987 0020 044A     	 ldr r2,.L218
 3988 0022 0223     	 movs r3,#2
 3989 0024 FFF7FEFF 	 bl optiga_cmd_execute
1650:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1651:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_close_application_handler,
1652:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
1653:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
1654:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        params,
1655:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1656:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_CLOSE_APPLICATION, OPTIGA_CMD_ZERO_LENGT
1657:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1658:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
 3990              	 .loc 1 1658 0
 3991 0028 0023     	 movs r3,#0
1659:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 3992              	 .loc 1 1659 0
 3993 002a 1846     	 mov r0,r3
 3994 002c 1037     	 adds r7,r7,#16
 3995              	.LCFI181:
 3996              	 .cfi_def_cfa_offset 8
 3997 002e BD46     	 mov sp,r7
 3998              	.LCFI182:
 3999              	 .cfi_def_cfa_register 13
 4000              	 
 4001 0030 80BD     	 pop {r7,pc}
 4002              	.L219:
 4003 0032 00BF     	 .align 2
 4004              	.L218:
 4005 0034 00000000 	 .word optiga_cmd_close_application_handler
 4006              	 .cfi_endproc
 4007              	.LFE34:
 4009              	 .section .text.optiga_cmd_get_data_object_handler,"ax",%progbits
 4010              	 .align 2
 4011              	 .thumb
 4012              	 .thumb_func
 4014              	optiga_cmd_get_data_object_handler:
 4015              	.LFB35:
1660:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1661:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
1662:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Get Data Object handler
1663:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
1664:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_get_data_object_handler(optiga_cmd_t * me)
1665:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 4016              	 .loc 1 1665 0
 4017              	 .cfi_startproc
 4018              	 
 4019              	 
 4020 0000 80B5     	 push {r7,lr}
 4021              	.LCFI183:
 4022              	 .cfi_def_cfa_offset 8
 4023              	 .cfi_offset 7,-8
 4024              	 .cfi_offset 14,-4
 4025 0002 88B0     	 sub sp,sp,#32
 4026              	.LCFI184:
 4027              	 .cfi_def_cfa_offset 40
 4028 0004 00AF     	 add r7,sp,#0
 4029              	.LCFI185:
 4030              	 .cfi_def_cfa_register 7
 4031 0006 7860     	 str r0,[r7,#4]
1666:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
1667:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_get_data_object_params_t * p_optiga_read_data = (optiga_get_data_object_params_t *)me->p
 4032              	 .loc 1 1667 0
 4033 0008 7B68     	 ldr r3,[r7,#4]
 4034 000a 9B68     	 ldr r3,[r3,#8]
 4035 000c 7B61     	 str r3,[r7,#20]
1668:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 4036              	 .loc 1 1668 0
 4037 000e 40F20223 	 movw r3,#514
 4038 0012 FB83     	 strh r3,[r7,#30]
1669:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 4039              	 .loc 1 1669 0
 4040 0014 0423     	 movs r3,#4
 4041 0016 BB83     	 strh r3,[r7,#28]
1670:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t size_to_read, data_read;
1671:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint8_t cmd = OPTIGA_CMD_GET_DATA_OBJECT;
 4042              	 .loc 1 1671 0
 4043 0018 8123     	 movs r3,#129
 4044 001a FB76     	 strb r3,[r7,#27]
1672:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 4045              	 .loc 1 1672 0
 4046 001c 7B68     	 ldr r3,[r7,#4]
 4047 001e 9B7D     	 ldrb r3,[r3,#22]
 4048 0020 022B     	 cmp r3,#2
 4049 0022 02D0     	 beq .L222
 4050 0024 032B     	 cmp r3,#3
 4051 0026 6CD0     	 beq .L223
1673:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1674:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1675:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1676:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending read data command...");
1677:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // APDU header size + oid 2bytes + offset 2 bytes + length 2 bytes
1678:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
1679:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_UINT16_SIZE_IN_BYT
1680:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //lint --e{774} suppress "If OPTIGA_MAX_COMMS_BUFFER_SIZE is set to lesser value it wil
1681:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
1682:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1683:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1684:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
1685:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1686:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1687:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //oid
1688:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
1689:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      p_optiga_read_data->oid);
1690:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1691:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1692:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             size_to_read = MIN((OPTIGA_MAX_COMMS_BUFFER_SIZE - OPTIGA_CMD_APDU_HEADER_SIZE),
1693:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                (p_optiga_read_data->bytes_to_read - p_optiga_read_data->accumulated
1694:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1695:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_READ_DATA == p_optiga_read_data->data_or_metadata)
1696:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1697:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //offset
1698:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
1699:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            (p_optiga_read_data->offset + p_optiga_read_data->accumulated_size));
1700:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1701:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1702:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //length
1703:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
1704:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          size_to_read);
1705:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1706:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1707:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // If OID is for Last error code, don't clear the error code in read
1708:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_LAST_ERROR_CODE == p_optiga_read_data->oid)
1709:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1710:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 cmd = OPTIGA_CMD_GET_DATA_OBJECT_NO_ERROR_CLEAR;
1711:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1712:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //prepare APDU header
1713:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(cmd,
1714:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1715:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSET),
1716:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_O
1717:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1718:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = index_for_data - OPTIGA_COMMS_DATA_OFFSET;
1719:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             p_optiga_read_data->last_read_size = size_to_read;
1720:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1721:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1722:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1723:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1724:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1725:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for read data command...");
1726:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->chaining_ongoing = FALSE;
1727:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if the read was successful
1728:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
1729:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1730:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing read data response...");
1731:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //check if it is out of boundary issue
1732:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_CMD_ZERO_LENGTH_OR_VALUE != p_optiga_read_data->accumulated_size)
1733:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1734:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_ENTER_HANDLER_CALL);
1735:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1736:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //flag used to setting the received buffer length to 0, in case unexpected error
1737:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
1738:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1739:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for
1740:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for
1741:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
1742:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
1743:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1744:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR;
1745:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1746:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else if (me->exit_status == (optiga_lib_status_t)(OPTIGA_CMD_OUT_OF_BOUNDARY_ERROR | OP
1747:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1748:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_read_data->ref_bytes_to_read) = p_optiga_read_data->accumulated_size;
1749:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_LIB_SUCCESS;
1750:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1751:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
1752:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1753:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //copy data from optiga comms buffer to user provided buffer
1754:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 data_read = me->p_optiga->comms_rx_size - OPTIGA_CMD_APDU_HEADER_SIZE;
1755:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1756:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // check if the data received is greater than the size of read buffer
1757:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_read_data->bytes_to_read < data_read)
1758:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1759:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Error in processing read data response...");
1760:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1761:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
1762:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
1763:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1764:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1765:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //copy data from optiga comms buffer to user provided buffer
1766:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(p_optiga_read_data->buffer + p_optiga_read_data->accumulated_size,
1767:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
1768:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               data_read);
1769:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1770:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_read_data->accumulated_size += data_read;
1771:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1772:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if ((p_optiga_read_data->last_read_size > data_read) ||
1773:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     (p_optiga_read_data->accumulated_size == p_optiga_read_data->bytes_to_read))
1774:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1775:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = p_optiga_read_data->accumulated_size
1776:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     p_optiga_read_data->accumulated_size = 0;
1777:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     p_optiga_read_data->last_read_size = 0;
1778:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1779:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
1780:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
1781:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->chaining_ongoing = TRUE;
1782:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
1783:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Response of read data command is processed...");
1784:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_LIB_SUCCESS;
1785:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1786:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1787:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1788:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
1789:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 4052              	 .loc 1 1789 0
 4053 0028 EDE0     	 b .L225
 4054              	.L222:
1678:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_UINT16_SIZE_IN_BYT
 4055              	 .loc 1 1678 0
 4056 002a 0A23     	 movs r3,#10
 4057 002c 7B82     	 strh r3,[r7,#18]
1681:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4058              	 .loc 1 1681 0
 4059 002e 7B8A     	 ldrh r3,[r7,#18]
 4060 0030 40F21562 	 movw r2,#1557
 4061 0034 9342     	 cmp r3,r2
 4062 0036 07D9     	 bls .L224
1683:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
 4063              	 .loc 1 1683 0
 4064 0038 4FF40173 	 mov r3,#516
 4065 003c FB83     	 strh r3,[r7,#30]
1684:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 4066              	 .loc 1 1684 0
 4067 003e 7B69     	 ldr r3,[r7,#20]
 4068 0040 DB68     	 ldr r3,[r3,#12]
 4069 0042 0022     	 movs r2,#0
 4070 0044 1A80     	 strh r2,[r3]
1685:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4071              	 .loc 1 1685 0
 4072 0046 DEE0     	 b .L225
 4073              	.L224:
1688:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      p_optiga_read_data->oid);
 4074              	 .loc 1 1688 0
 4075 0048 7B68     	 ldr r3,[r7,#4]
 4076 004a 1A68     	 ldr r2,[r3]
 4077 004c BB8B     	 ldrh r3,[r7,#28]
 4078 004e 0833     	 adds r3,r3,#8
 4079 0050 1344     	 add r3,r3,r2
 4080 0052 5A1D     	 adds r2,r3,#5
 4081 0054 7B69     	 ldr r3,[r7,#20]
 4082 0056 1B88     	 ldrh r3,[r3]
 4083 0058 1046     	 mov r0,r2
 4084 005a 1946     	 mov r1,r3
 4085 005c FFF7FEFF 	 bl optiga_common_set_uint16
1690:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4086              	 .loc 1 1690 0
 4087 0060 BB8B     	 ldrh r3,[r7,#28]
 4088 0062 0233     	 adds r3,r3,#2
 4089 0064 BB83     	 strh r3,[r7,#28]
1692:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                (p_optiga_read_data->bytes_to_read - p_optiga_read_data->accumulated
 4090              	 .loc 1 1692 0
 4091 0066 7B69     	 ldr r3,[r7,#20]
 4092 0068 9B88     	 ldrh r3,[r3,#4]
 4093 006a 1A46     	 mov r2,r3
 4094 006c 7B69     	 ldr r3,[r7,#20]
 4095 006e DB88     	 ldrh r3,[r3,#6]
 4096 0070 D31A     	 subs r3,r2,r3
 4097 0072 40F21162 	 movw r2,#1553
 4098 0076 9342     	 cmp r3,r2
 4099 0078 A8BF     	 it ge
 4100 007a 1346     	 movge r3,r2
 4101 007c 3B82     	 strh r3,[r7,#16]
1695:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4102              	 .loc 1 1695 0
 4103 007e 7B69     	 ldr r3,[r7,#20]
 4104 0080 9B7A     	 ldrb r3,[r3,#10]
 4105 0082 002B     	 cmp r3,#0
 4106 0084 20D1     	 bne .L226
1698:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            (p_optiga_read_data->offset + p_optiga_read_data->accumulated_size));
 4107              	 .loc 1 1698 0
 4108 0086 7B68     	 ldr r3,[r7,#4]
 4109 0088 1A68     	 ldr r2,[r3]
 4110 008a BB8B     	 ldrh r3,[r7,#28]
 4111 008c 0833     	 adds r3,r3,#8
 4112 008e 1344     	 add r3,r3,r2
 4113 0090 591D     	 adds r1,r3,#5
1699:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 4114              	 .loc 1 1699 0
 4115 0092 7B69     	 ldr r3,[r7,#20]
 4116 0094 5A88     	 ldrh r2,[r3,#2]
 4117 0096 7B69     	 ldr r3,[r7,#20]
 4118 0098 DB88     	 ldrh r3,[r3,#6]
1698:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            (p_optiga_read_data->offset + p_optiga_read_data->accumulated_size));
 4119              	 .loc 1 1698 0
 4120 009a 1344     	 add r3,r3,r2
 4121 009c 9BB2     	 uxth r3,r3
 4122 009e 0846     	 mov r0,r1
 4123 00a0 1946     	 mov r1,r3
 4124 00a2 FFF7FEFF 	 bl optiga_common_set_uint16
1700:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4125              	 .loc 1 1700 0
 4126 00a6 BB8B     	 ldrh r3,[r7,#28]
 4127 00a8 0233     	 adds r3,r3,#2
 4128 00aa BB83     	 strh r3,[r7,#28]
1703:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          size_to_read);
 4129              	 .loc 1 1703 0
 4130 00ac 7B68     	 ldr r3,[r7,#4]
 4131 00ae 1A68     	 ldr r2,[r3]
 4132 00b0 BB8B     	 ldrh r3,[r7,#28]
 4133 00b2 0833     	 adds r3,r3,#8
 4134 00b4 1344     	 add r3,r3,r2
 4135 00b6 5A1D     	 adds r2,r3,#5
 4136 00b8 3B8A     	 ldrh r3,[r7,#16]
 4137 00ba 1046     	 mov r0,r2
 4138 00bc 1946     	 mov r1,r3
 4139 00be FFF7FEFF 	 bl optiga_common_set_uint16
1705:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4140              	 .loc 1 1705 0
 4141 00c2 BB8B     	 ldrh r3,[r7,#28]
 4142 00c4 0233     	 adds r3,r3,#2
 4143 00c6 BB83     	 strh r3,[r7,#28]
 4144              	.L226:
1708:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4145              	 .loc 1 1708 0
 4146 00c8 7B69     	 ldr r3,[r7,#20]
 4147 00ca 1B88     	 ldrh r3,[r3]
 4148 00cc 4FF2C212 	 movw r2,#61890
 4149 00d0 9342     	 cmp r3,r2
 4150 00d2 01D1     	 bne .L227
1710:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4151              	 .loc 1 1710 0
 4152 00d4 0123     	 movs r3,#1
 4153 00d6 FB76     	 strb r3,[r7,#27]
 4154              	.L227:
1713:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 4155              	 .loc 1 1713 0
 4156 00d8 7B68     	 ldr r3,[r7,#4]
 4157 00da 597E     	 ldrb r1,[r3,#25]
 4158 00dc BB8B     	 ldrh r3,[r7,#28]
 4159 00de 043B     	 subs r3,r3,#4
 4160 00e0 9AB2     	 uxth r2,r3
1716:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4161              	 .loc 1 1716 0
 4162 00e2 7B68     	 ldr r3,[r7,#4]
 4163 00e4 1B68     	 ldr r3,[r3]
 4164 00e6 0D33     	 adds r3,r3,#13
1713:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 4165              	 .loc 1 1713 0
 4166 00e8 F87E     	 ldrb r0,[r7,#27]
 4167 00ea FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
1718:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             p_optiga_read_data->last_read_size = size_to_read;
 4168              	 .loc 1 1718 0
 4169 00ee 7B68     	 ldr r3,[r7,#4]
 4170 00f0 1B68     	 ldr r3,[r3]
 4171 00f2 BA8B     	 ldrh r2,[r7,#28]
 4172 00f4 9A80     	 strh r2,[r3,#4]
1719:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 4173              	 .loc 1 1719 0
 4174 00f6 7B69     	 ldr r3,[r7,#20]
 4175 00f8 3A8A     	 ldrh r2,[r7,#16]
 4176 00fa 1A81     	 strh r2,[r3,#8]
1720:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 4177              	 .loc 1 1720 0
 4178 00fc 0023     	 movs r3,#0
 4179 00fe FB83     	 strh r3,[r7,#30]
1722:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 4180              	 .loc 1 1722 0
 4181 0100 81E0     	 b .L225
 4182              	.L223:
1726:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if the read was successful
 4183              	 .loc 1 1726 0
 4184 0102 7B68     	 ldr r3,[r7,#4]
 4185 0104 0022     	 movs r2,#0
 4186 0106 1A76     	 strb r2,[r3,#24]
1728:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4187              	 .loc 1 1728 0
 4188 0108 7B68     	 ldr r3,[r7,#4]
 4189 010a 1B68     	 ldr r3,[r3]
 4190 010c 5B7B     	 ldrb r3,[r3,#13]
 4191 010e 002B     	 cmp r3,#0
 4192 0110 25D0     	 beq .L228
1732:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 4193              	 .loc 1 1732 0
 4194 0112 7B69     	 ldr r3,[r7,#20]
 4195 0114 DB88     	 ldrh r3,[r3,#6]
 4196 0116 002B     	 cmp r3,#0
 4197 0118 0ED0     	 beq .L229
1734:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 4198              	 .loc 1 1734 0
 4199 011a 7B68     	 ldr r3,[r7,#4]
 4200 011c 9B7E     	 ldrb r3,[r3,#26]
 4201 011e 03F07F03 	 and r3,r3,#127
 4202 0122 DAB2     	 uxtb r2,r3
 4203 0124 7B68     	 ldr r3,[r7,#4]
 4204 0126 9A76     	 strb r2,[r3,#26]
 4205 0128 7B68     	 ldr r3,[r7,#4]
 4206 012a 9B7E     	 ldrb r3,[r3,#26]
 4207 012c 63F07F03 	 orn r3,r3,#127
 4208 0130 DAB2     	 uxtb r2,r3
 4209 0132 7B68     	 ldr r3,[r7,#4]
 4210 0134 9A76     	 strb r2,[r3,#26]
 4211 0136 0EE0     	 b .L230
 4212              	.L229:
1741:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
 4213              	 .loc 1 1741 0
 4214 0138 7B68     	 ldr r3,[r7,#4]
 4215 013a 9B7E     	 ldrb r3,[r3,#26]
 4216 013c 03F07F03 	 and r3,r3,#127
 4217 0140 DAB2     	 uxtb r2,r3
 4218 0142 7B68     	 ldr r3,[r7,#4]
 4219 0144 9A76     	 strb r2,[r3,#26]
 4220 0146 7B68     	 ldr r3,[r7,#4]
 4221 0148 9A7E     	 ldrb r2,[r3,#26]
 4222 014a 7B68     	 ldr r3,[r7,#4]
 4223 014c 9A76     	 strb r2,[r3,#26]
1742:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 4224              	 .loc 1 1742 0
 4225 014e 7B69     	 ldr r3,[r7,#20]
 4226 0150 DB68     	 ldr r3,[r3,#12]
 4227 0152 0022     	 movs r2,#0
 4228 0154 1A80     	 strh r2,[r3]
 4229              	.L230:
1744:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4230              	 .loc 1 1744 0
 4231 0156 40F20223 	 movw r3,#514
 4232 015a FB83     	 strh r3,[r7,#30]
 4233 015c 52E0     	 b .L231
 4234              	.L228:
1746:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4235              	 .loc 1 1746 0
 4236 015e 7B68     	 ldr r3,[r7,#4]
 4237 0160 9B8B     	 ldrh r3,[r3,#28]
 4238 0162 48F20802 	 movw r2,#32776
 4239 0166 9342     	 cmp r3,r2
 4240 0168 07D1     	 bne .L232
1748:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_LIB_SUCCESS;
 4241              	 .loc 1 1748 0
 4242 016a 7B69     	 ldr r3,[r7,#20]
 4243 016c DB68     	 ldr r3,[r3,#12]
 4244 016e 7A69     	 ldr r2,[r7,#20]
 4245 0170 D288     	 ldrh r2,[r2,#6]
 4246 0172 1A80     	 strh r2,[r3]
1749:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4247              	 .loc 1 1749 0
 4248 0174 0023     	 movs r3,#0
 4249 0176 FB83     	 strh r3,[r7,#30]
 4250 0178 44E0     	 b .L231
 4251              	.L232:
1754:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4252              	 .loc 1 1754 0
 4253 017a 7B68     	 ldr r3,[r7,#4]
 4254 017c 1B68     	 ldr r3,[r3]
 4255 017e DB88     	 ldrh r3,[r3,#6]
 4256 0180 043B     	 subs r3,r3,#4
 4257 0182 FB81     	 strh r3,[r7,#14]
1757:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 4258              	 .loc 1 1757 0
 4259 0184 7B69     	 ldr r3,[r7,#20]
 4260 0186 9B88     	 ldrh r3,[r3,#4]
 4261 0188 FA89     	 ldrh r2,[r7,#14]
 4262 018a 9A42     	 cmp r2,r3
 4263 018c 07D9     	 bls .L233
1760:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_read_data->ref_bytes_to_read) = 0x00;
 4264              	 .loc 1 1760 0
 4265 018e 4FF40173 	 mov r3,#516
 4266 0192 FB83     	 strh r3,[r7,#30]
1761:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 4267              	 .loc 1 1761 0
 4268 0194 7B69     	 ldr r3,[r7,#20]
 4269 0196 DB68     	 ldr r3,[r3,#12]
 4270 0198 0022     	 movs r2,#0
 4271 019a 1A80     	 strh r2,[r3]
1762:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 4272              	 .loc 1 1762 0
 4273 019c 33E0     	 b .L225
 4274              	.L233:
1766:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
 4275              	 .loc 1 1766 0
 4276 019e 7B69     	 ldr r3,[r7,#20]
 4277 01a0 1B69     	 ldr r3,[r3,#16]
 4278 01a2 7A69     	 ldr r2,[r7,#20]
 4279 01a4 D288     	 ldrh r2,[r2,#6]
 4280 01a6 9918     	 adds r1,r3,r2
1767:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               data_read);
 4281              	 .loc 1 1767 0
 4282 01a8 7B68     	 ldr r3,[r7,#4]
 4283 01aa 1B68     	 ldr r3,[r3]
 4284 01ac 03F11102 	 add r2,r3,#17
1766:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
 4285              	 .loc 1 1766 0
 4286 01b0 FB89     	 ldrh r3,[r7,#14]
 4287 01b2 0846     	 mov r0,r1
 4288 01b4 1146     	 mov r1,r2
 4289 01b6 1A46     	 mov r2,r3
 4290 01b8 FFF7FEFF 	 bl pal_os_memcpy
1770:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4291              	 .loc 1 1770 0
 4292 01bc 7B69     	 ldr r3,[r7,#20]
 4293 01be DA88     	 ldrh r2,[r3,#6]
 4294 01c0 FB89     	 ldrh r3,[r7,#14]
 4295 01c2 1344     	 add r3,r3,r2
 4296 01c4 9AB2     	 uxth r2,r3
 4297 01c6 7B69     	 ldr r3,[r7,#20]
 4298 01c8 DA80     	 strh r2,[r3,#6]
1772:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     (p_optiga_read_data->accumulated_size == p_optiga_read_data->bytes_to_read))
 4299              	 .loc 1 1772 0
 4300 01ca 7B69     	 ldr r3,[r7,#20]
 4301 01cc 1B89     	 ldrh r3,[r3,#8]
 4302 01ce FA89     	 ldrh r2,[r7,#14]
 4303 01d0 9A42     	 cmp r2,r3
 4304 01d2 05D3     	 bcc .L234
1773:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 4305              	 .loc 1 1773 0 discriminator 1
 4306 01d4 7B69     	 ldr r3,[r7,#20]
 4307 01d6 DA88     	 ldrh r2,[r3,#6]
 4308 01d8 7B69     	 ldr r3,[r7,#20]
 4309 01da 9B88     	 ldrh r3,[r3,#4]
1772:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     (p_optiga_read_data->accumulated_size == p_optiga_read_data->bytes_to_read))
 4310              	 .loc 1 1772 0 discriminator 1
 4311 01dc 9A42     	 cmp r2,r3
 4312 01de 0BD1     	 bne .L235
 4313              	.L234:
1775:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     p_optiga_read_data->accumulated_size = 0;
 4314              	 .loc 1 1775 0
 4315 01e0 7B69     	 ldr r3,[r7,#20]
 4316 01e2 DB68     	 ldr r3,[r3,#12]
 4317 01e4 7A69     	 ldr r2,[r7,#20]
 4318 01e6 D288     	 ldrh r2,[r2,#6]
 4319 01e8 1A80     	 strh r2,[r3]
1776:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     p_optiga_read_data->last_read_size = 0;
 4320              	 .loc 1 1776 0
 4321 01ea 7B69     	 ldr r3,[r7,#20]
 4322 01ec 0022     	 movs r2,#0
 4323 01ee DA80     	 strh r2,[r3,#6]
1777:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 4324              	 .loc 1 1777 0
 4325 01f0 7B69     	 ldr r3,[r7,#20]
 4326 01f2 0022     	 movs r2,#0
 4327 01f4 1A81     	 strh r2,[r3,#8]
 4328 01f6 02E0     	 b .L236
 4329              	.L235:
1781:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 4330              	 .loc 1 1781 0
 4331 01f8 7B68     	 ldr r3,[r7,#4]
 4332 01fa 0122     	 movs r2,#1
 4333 01fc 1A76     	 strb r2,[r3,#24]
 4334              	.L236:
1784:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4335              	 .loc 1 1784 0
 4336 01fe 0023     	 movs r3,#0
 4337 0200 FB83     	 strh r3,[r7,#30]
1787:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 4338              	 .loc 1 1787 0
 4339 0202 FFE7     	 b .L238
 4340              	.L231:
 4341              	.L238:
 4342 0204 00BF     	 nop
 4343              	.L225:
1790:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
1791:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1792:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 4344              	 .loc 1 1792 0
 4345 0206 FB8B     	 ldrh r3,[r7,#30]
1793:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 4346              	 .loc 1 1793 0
 4347 0208 1846     	 mov r0,r3
 4348 020a 2037     	 adds r7,r7,#32
 4349              	.LCFI186:
 4350              	 .cfi_def_cfa_offset 8
 4351 020c BD46     	 mov sp,r7
 4352              	.LCFI187:
 4353              	 .cfi_def_cfa_register 13
 4354              	 
 4355 020e 80BD     	 pop {r7,pc}
 4356              	 .cfi_endproc
 4357              	.LFE35:
 4359              	 .section .text.optiga_cmd_get_data_object,"ax",%progbits
 4360              	 .align 2
 4361              	 .global optiga_cmd_get_data_object
 4362              	 .thumb
 4363              	 .thumb_func
 4365              	optiga_cmd_get_data_object:
 4366              	.LFB36:
1794:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1795:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_get_data_object(optiga_cmd_t * me, uint8_t cmd_param,
1796:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                optiga_get_data_object_params_t * params)
1797:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 4367              	 .loc 1 1797 0
 4368              	 .cfi_startproc
 4369              	 
 4370              	 
 4371 0000 80B5     	 push {r7,lr}
 4372              	.LCFI188:
 4373              	 .cfi_def_cfa_offset 8
 4374              	 .cfi_offset 7,-8
 4375              	 .cfi_offset 14,-4
 4376 0002 88B0     	 sub sp,sp,#32
 4377              	.LCFI189:
 4378              	 .cfi_def_cfa_offset 40
 4379 0004 04AF     	 add r7,sp,#16
 4380              	.LCFI190:
 4381              	 .cfi_def_cfa 7,24
 4382 0006 F860     	 str r0,[r7,#12]
 4383 0008 0B46     	 mov r3,r1
 4384 000a 7A60     	 str r2,[r7,#4]
 4385 000c FB72     	 strb r3,[r7,#11]
1798:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1799:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
 4386              	 .loc 1 1799 0
 4387 000e FA7A     	 ldrb r2,[r7,#11]
 4388 0010 0623     	 movs r3,#6
 4389 0012 0093     	 str r3,[sp]
 4390 0014 7B68     	 ldr r3,[r7,#4]
 4391 0016 0193     	 str r3,[sp,#4]
 4392 0018 8123     	 movs r3,#129
 4393 001a 0293     	 str r3,[sp,#8]
 4394 001c F868     	 ldr r0,[r7,#12]
 4395 001e 1146     	 mov r1,r2
 4396 0020 044A     	 ldr r2,.L241
 4397 0022 0223     	 movs r3,#2
 4398 0024 FFF7FEFF 	 bl optiga_cmd_execute
1800:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1801:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_get_data_object_handler,
1802:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
1803:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
1804:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        params,
1805:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1806:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_GET_DATA_OBJECT, OPTIGA_CMD_ZERO_LENGTH_
1807:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1808:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
 4399              	 .loc 1 1808 0
 4400 0028 0023     	 movs r3,#0
1809:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 4401              	 .loc 1 1809 0
 4402 002a 1846     	 mov r0,r3
 4403 002c 1037     	 adds r7,r7,#16
 4404              	.LCFI191:
 4405              	 .cfi_def_cfa_offset 8
 4406 002e BD46     	 mov sp,r7
 4407              	.LCFI192:
 4408              	 .cfi_def_cfa_register 13
 4409              	 
 4410 0030 80BD     	 pop {r7,pc}
 4411              	.L242:
 4412 0032 00BF     	 .align 2
 4413              	.L241:
 4414 0034 00000000 	 .word optiga_cmd_get_data_object_handler
 4415              	 .cfi_endproc
 4416              	.LFE36:
 4418              	 .section .text.optiga_cmd_set_data_object_handler,"ax",%progbits
 4419              	 .align 2
 4420              	 .thumb
 4421              	 .thumb_func
 4423              	optiga_cmd_set_data_object_handler:
 4424              	.LFB37:
1810:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1811:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
1812:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Set Data Object handler
1813:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
1814:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_set_data_object_handler(optiga_cmd_t * me)
1815:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 4425              	 .loc 1 1815 0
 4426              	 .cfi_startproc
 4427              	 
 4428              	 
 4429 0000 80B5     	 push {r7,lr}
 4430              	.LCFI193:
 4431              	 .cfi_def_cfa_offset 8
 4432              	 .cfi_offset 7,-8
 4433              	 .cfi_offset 14,-4
 4434 0002 86B0     	 sub sp,sp,#24
 4435              	.LCFI194:
 4436              	 .cfi_def_cfa_offset 32
 4437 0004 00AF     	 add r7,sp,#0
 4438              	.LCFI195:
 4439              	 .cfi_def_cfa_register 7
 4440 0006 7860     	 str r0,[r7,#4]
1816:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
1817:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_set_data_object_params_t * p_optiga_write_data = (optiga_set_data_object_params_t *)me->
 4441              	 .loc 1 1817 0
 4442 0008 7B68     	 ldr r3,[r7,#4]
 4443 000a 9B68     	 ldr r3,[r3,#8]
 4444 000c 3B61     	 str r3,[r7,#16]
1818:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 4445              	 .loc 1 1818 0
 4446 000e 40F20223 	 movw r3,#514
 4447 0012 FB82     	 strh r3,[r7,#22]
1819:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t size_to_send;
1820:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 4448              	 .loc 1 1820 0
 4449 0014 0423     	 movs r3,#4
 4450 0016 FB81     	 strh r3,[r7,#14]
1821:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1822:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 4451              	 .loc 1 1822 0
 4452 0018 7B68     	 ldr r3,[r7,#4]
 4453 001a 9B7D     	 ldrb r3,[r3,#22]
 4454 001c 022B     	 cmp r3,#2
 4455 001e 03D0     	 beq .L245
 4456 0020 032B     	 cmp r3,#3
 4457 0022 00F08680 	 beq .L246
1823:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1824:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1825:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1826:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1827:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending set data command...");
1828:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->chaining_ongoing = FALSE;
1829:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //oid
1830:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
1831:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      p_optiga_write_data->oid);
1832:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1833:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1834:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //offset
1835:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
1836:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      (p_optiga_write_data->offset + p_optiga_write_data->written_si
1837:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1838:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1839:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // Check maximum size that can be written, based on optiga comms buffer size
1840:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             size_to_send = MIN((OPTIGA_MAX_COMMS_BUFFER_SIZE + OPTIGA_COMMS_DATA_OFFSET - index_for
1841:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                ((p_optiga_write_data->size) - p_optiga_write_data->written_size));
1842:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1843:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // APDU header size + oid 2 bytes + offset 2 bytes + size of data to send
1844:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
1845:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_UINT16_SIZE_IN_BYTES + size_to_send;
1846:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
1847:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1848:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
1849:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1850:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1851:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1852:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // prepare apdu
1853:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_SET_DATA_OBJECT,
1854:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1855:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (OPTIGA_CMD_APDU_HEADER_SIZE + size_to_send),
1856:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
1857:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //data to be written
1858:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_UTIL_COUNT_DATA_OBJECT == me->cmd_param)
1859:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1860:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data) = p_optiga_write_data->count;
1861:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1862:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
1863:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1864:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
1865:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_write_data->buffer + p_optiga_write_data->written_size,
1866:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               size_to_send);
1867:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1868:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             p_optiga_write_data->written_size += size_to_send;
1869:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1870:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (index_for_data + size_to_send - OPTIGA_COMMS_DATA_OFFSET
1871:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1872:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if chaining is required based on size written and the user requested write
1873:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (p_optiga_write_data->written_size != p_optiga_write_data->size)
1874:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1875:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->chaining_ongoing = TRUE;
1876:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // For chaining, the 2nd loop will be Write only
1877:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_param = OPTIGA_CMD_WRITE_ONLY;
1878:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1879:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1880:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1881:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1882:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1883:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1884:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for set data command...");
1885:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if the write was successful
1886:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
1887:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1888:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing set data response...");
1889:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1890:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1891:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
1892:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1893:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1894:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of set data command is processed...");
1895:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1896:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1897:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1898:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
1899:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 4458              	 .loc 1 1899 0
 4459 0026 98E0     	 b .L248
 4460              	.L245:
1828:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //oid
 4461              	 .loc 1 1828 0
 4462 0028 7B68     	 ldr r3,[r7,#4]
 4463 002a 0022     	 movs r2,#0
 4464 002c 1A76     	 strb r2,[r3,#24]
1830:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      p_optiga_write_data->oid);
 4465              	 .loc 1 1830 0
 4466 002e 7B68     	 ldr r3,[r7,#4]
 4467 0030 1A68     	 ldr r2,[r3]
 4468 0032 FB89     	 ldrh r3,[r7,#14]
 4469 0034 0833     	 adds r3,r3,#8
 4470 0036 1344     	 add r3,r3,r2
 4471 0038 5A1D     	 adds r2,r3,#5
 4472 003a 3B69     	 ldr r3,[r7,#16]
 4473 003c 1B88     	 ldrh r3,[r3]
 4474 003e 1046     	 mov r0,r2
 4475 0040 1946     	 mov r1,r3
 4476 0042 FFF7FEFF 	 bl optiga_common_set_uint16
1832:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4477              	 .loc 1 1832 0
 4478 0046 FB89     	 ldrh r3,[r7,#14]
 4479 0048 0233     	 adds r3,r3,#2
 4480 004a FB81     	 strh r3,[r7,#14]
1835:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      (p_optiga_write_data->offset + p_optiga_write_data->written_si
 4481              	 .loc 1 1835 0
 4482 004c 7B68     	 ldr r3,[r7,#4]
 4483 004e 1A68     	 ldr r2,[r3]
 4484 0050 FB89     	 ldrh r3,[r7,#14]
 4485 0052 0833     	 adds r3,r3,#8
 4486 0054 1344     	 add r3,r3,r2
 4487 0056 591D     	 adds r1,r3,#5
1836:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 4488              	 .loc 1 1836 0
 4489 0058 3B69     	 ldr r3,[r7,#16]
 4490 005a 5A88     	 ldrh r2,[r3,#2]
 4491 005c 3B69     	 ldr r3,[r7,#16]
 4492 005e DB88     	 ldrh r3,[r3,#6]
1835:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      (p_optiga_write_data->offset + p_optiga_write_data->written_si
 4493              	 .loc 1 1835 0
 4494 0060 1344     	 add r3,r3,r2
 4495 0062 9BB2     	 uxth r3,r3
 4496 0064 0846     	 mov r0,r1
 4497 0066 1946     	 mov r1,r3
 4498 0068 FFF7FEFF 	 bl optiga_common_set_uint16
1837:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4499              	 .loc 1 1837 0
 4500 006c FB89     	 ldrh r3,[r7,#14]
 4501 006e 0233     	 adds r3,r3,#2
 4502 0070 FB81     	 strh r3,[r7,#14]
1840:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                ((p_optiga_write_data->size) - p_optiga_write_data->written_size));
 4503              	 .loc 1 1840 0
 4504 0072 3B69     	 ldr r3,[r7,#16]
 4505 0074 9B88     	 ldrh r3,[r3,#4]
 4506 0076 1A46     	 mov r2,r3
 4507 0078 3B69     	 ldr r3,[r7,#16]
 4508 007a DB88     	 ldrh r3,[r3,#6]
 4509 007c D21A     	 subs r2,r2,r3
 4510 007e FB89     	 ldrh r3,[r7,#14]
 4511 0080 C3F5C263 	 rsb r3,r3,#1552
 4512 0084 0533     	 adds r3,r3,#5
 4513 0086 9342     	 cmp r3,r2
 4514 0088 A8BF     	 it ge
 4515 008a 1346     	 movge r3,r2
 4516 008c BB81     	 strh r3,[r7,#12]
1844:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_UINT16_SIZE_IN_BYTES + size_to_send;
 4517              	 .loc 1 1844 0
 4518 008e BB89     	 ldrh r3,[r7,#12]
 4519 0090 0833     	 adds r3,r3,#8
 4520 0092 7B81     	 strh r3,[r7,#10]
1846:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4521              	 .loc 1 1846 0
 4522 0094 7B89     	 ldrh r3,[r7,#10]
 4523 0096 40F21562 	 movw r2,#1557
 4524 009a 9342     	 cmp r3,r2
 4525 009c 03D9     	 bls .L247
1848:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 4526              	 .loc 1 1848 0
 4527 009e 4FF40173 	 mov r3,#516
 4528 00a2 FB82     	 strh r3,[r7,#22]
1849:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4529              	 .loc 1 1849 0
 4530 00a4 59E0     	 b .L248
 4531              	.L247:
1853:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 4532              	 .loc 1 1853 0
 4533 00a6 7B68     	 ldr r3,[r7,#4]
 4534 00a8 597E     	 ldrb r1,[r3,#25]
 4535 00aa BB89     	 ldrh r3,[r7,#12]
 4536 00ac 0433     	 adds r3,r3,#4
 4537 00ae 9AB2     	 uxth r2,r3
1856:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //data to be written
 4538              	 .loc 1 1856 0
 4539 00b0 7B68     	 ldr r3,[r7,#4]
 4540 00b2 1B68     	 ldr r3,[r3]
 4541 00b4 0D33     	 adds r3,r3,#13
1853:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 4542              	 .loc 1 1853 0
 4543 00b6 8220     	 movs r0,#130
 4544 00b8 FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
1858:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4545              	 .loc 1 1858 0
 4546 00bc 7B68     	 ldr r3,[r7,#4]
 4547 00be 5B7E     	 ldrb r3,[r3,#25]
 4548 00c0 022B     	 cmp r3,#2
 4549 00c2 08D1     	 bne .L249
1860:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4550              	 .loc 1 1860 0
 4551 00c4 7B68     	 ldr r3,[r7,#4]
 4552 00c6 1A68     	 ldr r2,[r3]
 4553 00c8 FB89     	 ldrh r3,[r7,#14]
 4554 00ca 3969     	 ldr r1,[r7,#16]
 4555 00cc 897B     	 ldrb r1,[r1,#14]
 4556 00ce 1344     	 add r3,r3,r2
 4557 00d0 0A46     	 mov r2,r1
 4558 00d2 5A73     	 strb r2,[r3,#13]
 4559 00d4 10E0     	 b .L250
 4560              	.L249:
1864:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_write_data->buffer + p_optiga_write_data->written_size,
 4561              	 .loc 1 1864 0
 4562 00d6 7B68     	 ldr r3,[r7,#4]
 4563 00d8 1A68     	 ldr r2,[r3]
 4564 00da FB89     	 ldrh r3,[r7,#14]
 4565 00dc 0833     	 adds r3,r3,#8
 4566 00de 1344     	 add r3,r3,r2
 4567 00e0 591D     	 adds r1,r3,#5
1865:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               size_to_send);
 4568              	 .loc 1 1865 0
 4569 00e2 3B69     	 ldr r3,[r7,#16]
 4570 00e4 9B68     	 ldr r3,[r3,#8]
 4571 00e6 3A69     	 ldr r2,[r7,#16]
 4572 00e8 D288     	 ldrh r2,[r2,#6]
1864:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_write_data->buffer + p_optiga_write_data->written_size,
 4573              	 .loc 1 1864 0
 4574 00ea 1A44     	 add r2,r2,r3
 4575 00ec BB89     	 ldrh r3,[r7,#12]
 4576 00ee 0846     	 mov r0,r1
 4577 00f0 1146     	 mov r1,r2
 4578 00f2 1A46     	 mov r2,r3
 4579 00f4 FFF7FEFF 	 bl pal_os_memcpy
 4580              	.L250:
1868:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4581              	 .loc 1 1868 0
 4582 00f8 3B69     	 ldr r3,[r7,#16]
 4583 00fa DA88     	 ldrh r2,[r3,#6]
 4584 00fc BB89     	 ldrh r3,[r7,#12]
 4585 00fe 1344     	 add r3,r3,r2
 4586 0100 9AB2     	 uxth r2,r3
 4587 0102 3B69     	 ldr r3,[r7,#16]
 4588 0104 DA80     	 strh r2,[r3,#6]
1870:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4589              	 .loc 1 1870 0
 4590 0106 7B68     	 ldr r3,[r7,#4]
 4591 0108 1B68     	 ldr r3,[r3]
 4592 010a F989     	 ldrh r1,[r7,#14]
 4593 010c BA89     	 ldrh r2,[r7,#12]
 4594 010e 0A44     	 add r2,r2,r1
 4595 0110 92B2     	 uxth r2,r2
 4596 0112 9A80     	 strh r2,[r3,#4]
1873:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4597              	 .loc 1 1873 0
 4598 0114 3B69     	 ldr r3,[r7,#16]
 4599 0116 DA88     	 ldrh r2,[r3,#6]
 4600 0118 3B69     	 ldr r3,[r7,#16]
 4601 011a 9B88     	 ldrh r3,[r3,#4]
 4602 011c 9A42     	 cmp r2,r3
 4603 011e 05D0     	 beq .L251
1875:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // For chaining, the 2nd loop will be Write only
 4604              	 .loc 1 1875 0
 4605 0120 7B68     	 ldr r3,[r7,#4]
 4606 0122 0122     	 movs r2,#1
 4607 0124 1A76     	 strb r2,[r3,#24]
1877:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4608              	 .loc 1 1877 0
 4609 0126 7B68     	 ldr r3,[r7,#4]
 4610 0128 0022     	 movs r2,#0
 4611 012a 5A76     	 strb r2,[r3,#25]
 4612              	.L251:
1879:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 4613              	 .loc 1 1879 0
 4614 012c 0023     	 movs r3,#0
 4615 012e FB82     	 strh r3,[r7,#22]
1881:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 4616              	 .loc 1 1881 0
 4617 0130 13E0     	 b .L248
 4618              	.L246:
1886:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4619              	 .loc 1 1886 0
 4620 0132 7B68     	 ldr r3,[r7,#4]
 4621 0134 1B68     	 ldr r3,[r3]
 4622 0136 5B7B     	 ldrb r3,[r3,#13]
 4623 0138 002B     	 cmp r3,#0
 4624 013a 0BD0     	 beq .L252
1891:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 4625              	 .loc 1 1891 0
 4626 013c 7B68     	 ldr r3,[r7,#4]
 4627 013e 9B7E     	 ldrb r3,[r3,#26]
 4628 0140 03F07F03 	 and r3,r3,#127
 4629 0144 DAB2     	 uxtb r2,r3
 4630 0146 7B68     	 ldr r3,[r7,#4]
 4631 0148 9A76     	 strb r2,[r3,#26]
 4632 014a 7B68     	 ldr r3,[r7,#4]
 4633 014c 9A7E     	 ldrb r2,[r3,#26]
 4634 014e 7B68     	 ldr r3,[r7,#4]
 4635 0150 9A76     	 strb r2,[r3,#26]
1892:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4636              	 .loc 1 1892 0
 4637 0152 02E0     	 b .L248
 4638              	.L252:
1895:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 4639              	 .loc 1 1895 0
 4640 0154 0023     	 movs r3,#0
 4641 0156 FB82     	 strh r3,[r7,#22]
1897:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 4642              	 .loc 1 1897 0
 4643 0158 00BF     	 nop
 4644              	.L248:
1900:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
1901:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 4645              	 .loc 1 1901 0
 4646 015a FB8A     	 ldrh r3,[r7,#22]
1902:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 4647              	 .loc 1 1902 0
 4648 015c 1846     	 mov r0,r3
 4649 015e 1837     	 adds r7,r7,#24
 4650              	.LCFI196:
 4651              	 .cfi_def_cfa_offset 8
 4652 0160 BD46     	 mov sp,r7
 4653              	.LCFI197:
 4654              	 .cfi_def_cfa_register 13
 4655              	 
 4656 0162 80BD     	 pop {r7,pc}
 4657              	 .cfi_endproc
 4658              	.LFE37:
 4660              	 .section .text.optiga_cmd_set_data_object,"ax",%progbits
 4661              	 .align 2
 4662              	 .global optiga_cmd_set_data_object
 4663              	 .thumb
 4664              	 .thumb_func
 4666              	optiga_cmd_set_data_object:
 4667              	.LFB38:
1903:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1904:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1905:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_set_data_object(optiga_cmd_t * me, uint8_t cmd_param,
1906:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                optiga_set_data_object_params_t * params)
1907:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 4668              	 .loc 1 1907 0
 4669              	 .cfi_startproc
 4670              	 
 4671              	 
 4672 0000 80B5     	 push {r7,lr}
 4673              	.LCFI198:
 4674              	 .cfi_def_cfa_offset 8
 4675              	 .cfi_offset 7,-8
 4676              	 .cfi_offset 14,-4
 4677 0002 88B0     	 sub sp,sp,#32
 4678              	.LCFI199:
 4679              	 .cfi_def_cfa_offset 40
 4680 0004 04AF     	 add r7,sp,#16
 4681              	.LCFI200:
 4682              	 .cfi_def_cfa 7,24
 4683 0006 F860     	 str r0,[r7,#12]
 4684 0008 0B46     	 mov r3,r1
 4685 000a 7A60     	 str r2,[r7,#4]
 4686 000c FB72     	 strb r3,[r7,#11]
1908:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1909:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
 4687              	 .loc 1 1909 0
 4688 000e FA7A     	 ldrb r2,[r7,#11]
 4689 0010 0623     	 movs r3,#6
 4690 0012 0093     	 str r3,[sp]
 4691 0014 7B68     	 ldr r3,[r7,#4]
 4692 0016 0193     	 str r3,[sp,#4]
 4693 0018 8223     	 movs r3,#130
 4694 001a 0293     	 str r3,[sp,#8]
 4695 001c F868     	 ldr r0,[r7,#12]
 4696 001e 1146     	 mov r1,r2
 4697 0020 044A     	 ldr r2,.L256
 4698 0022 0223     	 movs r3,#2
 4699 0024 FFF7FEFF 	 bl optiga_cmd_execute
1910:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1911:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_set_data_object_handler,
1912:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
1913:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
1914:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        params,
1915:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1916:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_SET_DATA_OBJECT, OPTIGA_CMD_ZERO_LENGTH_
1917:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1918:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
 4700              	 .loc 1 1918 0
 4701 0028 0023     	 movs r3,#0
1919:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 4702              	 .loc 1 1919 0
 4703 002a 1846     	 mov r0,r3
 4704 002c 1037     	 adds r7,r7,#16
 4705              	.LCFI201:
 4706              	 .cfi_def_cfa_offset 8
 4707 002e BD46     	 mov sp,r7
 4708              	.LCFI202:
 4709              	 .cfi_def_cfa_register 13
 4710              	 
 4711 0030 80BD     	 pop {r7,pc}
 4712              	.L257:
 4713 0032 00BF     	 .align 2
 4714              	.L256:
 4715 0034 00000000 	 .word optiga_cmd_set_data_object_handler
 4716              	 .cfi_endproc
 4717              	.LFE38:
 4719              	 .section .text.optiga_cmd_get_random_handler,"ax",%progbits
 4720              	 .align 2
 4721              	 .thumb
 4722              	 .thumb_func
 4724              	optiga_cmd_get_random_handler:
 4725              	.LFB39:
1920:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1921:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_RANDOM_ENABLED
1922:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
1923:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Get Random handler
1924:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
1925:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_get_random_handler(optiga_cmd_t * me)
1926:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 4726              	 .loc 1 1926 0
 4727              	 .cfi_startproc
 4728              	 
 4729              	 
 4730 0000 80B5     	 push {r7,lr}
 4731              	.LCFI203:
 4732              	 .cfi_def_cfa_offset 8
 4733              	 .cfi_offset 7,-8
 4734              	 .cfi_offset 14,-4
 4735 0002 86B0     	 sub sp,sp,#24
 4736              	.LCFI204:
 4737              	 .cfi_def_cfa_offset 32
 4738 0004 00AF     	 add r7,sp,#0
 4739              	.LCFI205:
 4740              	 .cfi_def_cfa_register 7
 4741 0006 7860     	 str r0,[r7,#4]
1927:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_get_random_params_t * p_random_params = (optiga_get_random_params_t *)me->p_input;
 4742              	 .loc 1 1927 0
 4743 0008 7B68     	 ldr r3,[r7,#4]
 4744 000a 9B68     	 ldr r3,[r3,#8]
 4745 000c 3B61     	 str r3,[r7,#16]
1928:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 4746              	 .loc 1 1928 0
 4747 000e 40F20223 	 movw r3,#514
 4748 0012 FB82     	 strh r3,[r7,#22]
1929:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 4749              	 .loc 1 1929 0
 4750 0014 0423     	 movs r3,#4
 4751 0016 FB81     	 strh r3,[r7,#14]
1930:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1931:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 4752              	 .loc 1 1931 0
 4753 0018 7B68     	 ldr r3,[r7,#4]
 4754 001a 9B7D     	 ldrb r3,[r3,#22]
 4755 001c 022B     	 cmp r3,#2
 4756 001e 02D0     	 beq .L260
 4757 0020 032B     	 cmp r3,#3
 4758 0022 21D0     	 beq .L261
1932:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
1933:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
1934:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1935:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending get random command...");
1936:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1937:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             /// Copy the random data length
1938:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
1939:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      p_random_params->random_data_length);
1940:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
1941:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1942:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_GET_RANDOM,
1943:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
1944:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSET),
1945:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
1946:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1947:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = index_for_data - OPTIGA_COMMS_DATA_OFFSET;
1948:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1949:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1950:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1951:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1952:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
1953:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
1954:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for get random command...");
1955:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if the random data retrieval app was successful
1956:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
1957:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
1958:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing get random response...");
1959:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1960:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
1961:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
1962:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
1963:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
1964:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             
1965:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //copy data from optiga comms buffer to user provided buffer
1966:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(p_random_params->random_data,
1967:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
1968:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_random_params->random_data_length);
1969:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1970:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of get random command is processed...");
1971:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
1972:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
1973:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
1974:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
1975:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 4759              	 .loc 1 1975 0
 4760 0024 41E0     	 b .L262
 4761              	.L260:
1938:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      p_random_params->random_data_length);
 4762              	 .loc 1 1938 0
 4763 0026 7B68     	 ldr r3,[r7,#4]
 4764 0028 1A68     	 ldr r2,[r3]
 4765 002a FB89     	 ldrh r3,[r7,#14]
 4766 002c 0833     	 adds r3,r3,#8
 4767 002e 1344     	 add r3,r3,r2
 4768 0030 5A1D     	 adds r2,r3,#5
 4769 0032 3B69     	 ldr r3,[r7,#16]
 4770 0034 1B88     	 ldrh r3,[r3]
 4771 0036 1046     	 mov r0,r2
 4772 0038 1946     	 mov r1,r3
 4773 003a FFF7FEFF 	 bl optiga_common_set_uint16
1940:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4774              	 .loc 1 1940 0
 4775 003e FB89     	 ldrh r3,[r7,#14]
 4776 0040 0233     	 adds r3,r3,#2
 4777 0042 FB81     	 strh r3,[r7,#14]
1942:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 4778              	 .loc 1 1942 0
 4779 0044 7B68     	 ldr r3,[r7,#4]
 4780 0046 597E     	 ldrb r1,[r3,#25]
 4781 0048 FB89     	 ldrh r3,[r7,#14]
 4782 004a 043B     	 subs r3,r3,#4
 4783 004c 9AB2     	 uxth r2,r3
1945:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4784              	 .loc 1 1945 0
 4785 004e 7B68     	 ldr r3,[r7,#4]
 4786 0050 1B68     	 ldr r3,[r3]
 4787 0052 0D33     	 adds r3,r3,#13
1942:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 4788              	 .loc 1 1942 0
 4789 0054 8C20     	 movs r0,#140
 4790 0056 FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
1947:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4791              	 .loc 1 1947 0
 4792 005a 7B68     	 ldr r3,[r7,#4]
 4793 005c 1B68     	 ldr r3,[r3]
 4794 005e FA89     	 ldrh r2,[r7,#14]
 4795 0060 9A80     	 strh r2,[r3,#4]
1949:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 4796              	 .loc 1 1949 0
 4797 0062 0023     	 movs r3,#0
 4798 0064 FB82     	 strh r3,[r7,#22]
1951:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 4799              	 .loc 1 1951 0
 4800 0066 20E0     	 b .L262
 4801              	.L261:
1956:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4802              	 .loc 1 1956 0
 4803 0068 7B68     	 ldr r3,[r7,#4]
 4804 006a 1B68     	 ldr r3,[r3]
 4805 006c 5B7B     	 ldrb r3,[r3,#13]
 4806 006e 002B     	 cmp r3,#0
 4807 0070 0BD0     	 beq .L263
1961:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 4808              	 .loc 1 1961 0
 4809 0072 7B68     	 ldr r3,[r7,#4]
 4810 0074 9B7E     	 ldrb r3,[r3,#26]
 4811 0076 03F07F03 	 and r3,r3,#127
 4812 007a DAB2     	 uxtb r2,r3
 4813 007c 7B68     	 ldr r3,[r7,#4]
 4814 007e 9A76     	 strb r2,[r3,#26]
 4815 0080 7B68     	 ldr r3,[r7,#4]
 4816 0082 9A7E     	 ldrb r2,[r3,#26]
 4817 0084 7B68     	 ldr r3,[r7,#4]
 4818 0086 9A76     	 strb r2,[r3,#26]
1962:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4819              	 .loc 1 1962 0
 4820 0088 0FE0     	 b .L262
 4821              	.L263:
1966:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
 4822              	 .loc 1 1966 0
 4823 008a 3B69     	 ldr r3,[r7,#16]
 4824 008c 5968     	 ldr r1,[r3,#4]
1967:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_random_params->random_data_length);
 4825              	 .loc 1 1967 0
 4826 008e 7B68     	 ldr r3,[r7,#4]
 4827 0090 1B68     	 ldr r3,[r3]
 4828 0092 03F11102 	 add r2,r3,#17
1968:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 4829              	 .loc 1 1968 0
 4830 0096 3B69     	 ldr r3,[r7,#16]
 4831 0098 1B88     	 ldrh r3,[r3]
1966:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET,
 4832              	 .loc 1 1966 0
 4833 009a 0846     	 mov r0,r1
 4834 009c 1146     	 mov r1,r2
 4835 009e 1A46     	 mov r2,r3
 4836 00a0 FFF7FEFF 	 bl pal_os_memcpy
1971:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 4837              	 .loc 1 1971 0
 4838 00a4 0023     	 movs r3,#0
 4839 00a6 FB82     	 strh r3,[r7,#22]
1973:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 4840              	 .loc 1 1973 0
 4841 00a8 00BF     	 nop
 4842              	.L262:
1976:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
1977:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1978:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 4843              	 .loc 1 1978 0
 4844 00aa FB8A     	 ldrh r3,[r7,#22]
1979:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 4845              	 .loc 1 1979 0
 4846 00ac 1846     	 mov r0,r3
 4847 00ae 1837     	 adds r7,r7,#24
 4848              	.LCFI206:
 4849              	 .cfi_def_cfa_offset 8
 4850 00b0 BD46     	 mov sp,r7
 4851              	.LCFI207:
 4852              	 .cfi_def_cfa_register 13
 4853              	 
 4854 00b2 80BD     	 pop {r7,pc}
 4855              	 .cfi_endproc
 4856              	.LFE39:
 4858              	 .section .text.optiga_cmd_get_random,"ax",%progbits
 4859              	 .align 2
 4860              	 .global optiga_cmd_get_random
 4861              	 .thumb
 4862              	 .thumb_func
 4864              	optiga_cmd_get_random:
 4865              	.LFB40:
1980:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1981:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1982:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_get_random(optiga_cmd_t * me, uint8_t cmd_param, optiga_get_random_p
1983:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 4866              	 .loc 1 1983 0
 4867              	 .cfi_startproc
 4868              	 
 4869              	 
 4870 0000 80B5     	 push {r7,lr}
 4871              	.LCFI208:
 4872              	 .cfi_def_cfa_offset 8
 4873              	 .cfi_offset 7,-8
 4874              	 .cfi_offset 14,-4
 4875 0002 8AB0     	 sub sp,sp,#40
 4876              	.LCFI209:
 4877              	 .cfi_def_cfa_offset 48
 4878 0004 04AF     	 add r7,sp,#16
 4879              	.LCFI210:
 4880              	 .cfi_def_cfa 7,32
 4881 0006 F860     	 str r0,[r7,#12]
 4882 0008 0B46     	 mov r3,r1
 4883 000a 7A60     	 str r2,[r7,#4]
 4884 000c FB72     	 strb r3,[r7,#11]
1984:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t cmd_handler_state = OPTIGA_CMD_EXEC_REQUEST_LOCK;
 4885              	 .loc 1 1984 0
 4886 000e 0623     	 movs r3,#6
 4887 0010 FB75     	 strb r3,[r7,#23]
1985:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
1986:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1987:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
 4888              	 .loc 1 1987 0
 4889 0012 FA7A     	 ldrb r2,[r7,#11]
 4890 0014 FB7D     	 ldrb r3,[r7,#23]
 4891 0016 0093     	 str r3,[sp]
 4892 0018 7B68     	 ldr r3,[r7,#4]
 4893 001a 0193     	 str r3,[sp,#4]
 4894 001c 8C23     	 movs r3,#140
 4895 001e 0293     	 str r3,[sp,#8]
 4896 0020 F868     	 ldr r0,[r7,#12]
 4897 0022 1146     	 mov r1,r2
 4898 0024 044A     	 ldr r2,.L267
 4899 0026 0223     	 movs r3,#2
 4900 0028 FFF7FEFF 	 bl optiga_cmd_execute
1988:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        cmd_param,
1989:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_get_random_handler,
1990:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
1991:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        cmd_handler_state,
1992:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        params,
1993:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
1994:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_GET_RANDOM, OPTIGA_CMD_ZERO_LENGTH_OR_VA
1995:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
1996:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
 4901              	 .loc 1 1996 0
 4902 002c 0023     	 movs r3,#0
1997:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 4903              	 .loc 1 1997 0
 4904 002e 1846     	 mov r0,r3
 4905 0030 1837     	 adds r7,r7,#24
 4906              	.LCFI211:
 4907              	 .cfi_def_cfa_offset 8
 4908 0032 BD46     	 mov sp,r7
 4909              	.LCFI212:
 4910              	 .cfi_def_cfa_register 13
 4911              	 
 4912 0034 80BD     	 pop {r7,pc}
 4913              	.L268:
 4914 0036 00BF     	 .align 2
 4915              	.L267:
 4916 0038 00000000 	 .word optiga_cmd_get_random_handler
 4917              	 .cfi_endproc
 4918              	.LFE40:
 4920              	 .section .text.optiga_cmd_calc_sign_handler,"ax",%progbits
 4921              	 .align 2
 4922              	 .thumb
 4923              	 .thumb_func
 4925              	optiga_cmd_calc_sign_handler:
 4926              	.LFB41:
1998:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_RANDOM_ENABLED
1999:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2000:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_ECDSA_SIGN_ENABLED
2001:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
2002:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * CalcSign handler
2003:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
2004:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_calc_sign_handler(optiga_cmd_t * me)
2005:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 4927              	 .loc 1 2005 0
 4928              	 .cfi_startproc
 4929              	 
 4930              	 
 4931 0000 80B5     	 push {r7,lr}
 4932              	.LCFI213:
 4933              	 .cfi_def_cfa_offset 8
 4934              	 .cfi_offset 7,-8
 4935              	 .cfi_offset 14,-4
 4936 0002 86B0     	 sub sp,sp,#24
 4937              	.LCFI214:
 4938              	 .cfi_def_cfa_offset 32
 4939 0004 00AF     	 add r7,sp,#0
 4940              	.LCFI215:
 4941              	 .cfi_def_cfa_register 7
 4942 0006 7860     	 str r0,[r7,#4]
2006:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
2007:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_calc_sign_params_t * p_optiga_ecdsa_sign = (optiga_calc_sign_params_t *)me->p_input;
 4943              	 .loc 1 2007 0
 4944 0008 7B68     	 ldr r3,[r7,#4]
 4945 000a 9B68     	 ldr r3,[r3,#8]
 4946 000c 3B61     	 str r3,[r7,#16]
2008:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 4947              	 .loc 1 2008 0
 4948 000e 40F20223 	 movw r3,#514
 4949 0012 FB82     	 strh r3,[r7,#22]
2009:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t private_key_oid;
2010:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 4950              	 .loc 1 2010 0
 4951 0014 0423     	 movs r3,#4
 4952 0016 BB81     	 strh r3,[r7,#12]
2011:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2012:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 4953              	 .loc 1 2012 0
 4954 0018 7B68     	 ldr r3,[r7,#4]
 4955 001a 9B7D     	 ldrb r3,[r3,#22]
 4956 001c 022B     	 cmp r3,#2
 4957 001e 02D0     	 beq .L271
 4958 0020 032B     	 cmp r3,#3
 4959 0022 69D0     	 beq .L272
2013:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2014:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2015:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2016:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // APDU headed length + TLV of Digest + TLV of signature key OID
2017:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending calculate sign command..");
2018:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_TAG_LENGTH_SIZE + p_optiga
2019:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2020:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
2021:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2022:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2023:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_ecdsa_sign->p_signature_length) = 0x00;
2024:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
2025:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2026:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // Tag and length for digest
2027:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header(OPTIGA_CMD_SIGN_DIGEST_TAG,
2028:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_ecdsa_sign->digest_length,
2029:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
2030:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2031:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //Digest data
2032:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2033:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_ecdsa_sign->p_digest,
2034:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_ecdsa_sign->digest_length);
2035:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2036:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_ecdsa_sign->digest_length;
2037:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2038:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // Tag and length for OID of signature key
2039:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header(OPTIGA_CMD_SIGN_OID_TAG,
2040:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           OPTIGA_CMD_SIGN_OID_LEN,
2041:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
2042:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2043:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //oid
2044:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             private_key_oid = me->session_oid;
2045:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_KEY_ID_SESSION_BASED != p_optiga_ecdsa_sign->private_key_oid)
2046:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2047:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 private_key_oid = (uint16_t)p_optiga_ecdsa_sign->private_key_oid;
2048:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2049:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_set_uint16(&me->p_optiga->optiga_comms_buffer[index_for_data],
2050:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      private_key_oid);
2051:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2052:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2053:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // prepare apdu
2054:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_CALC_SIGN,
2055:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
2056:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSET),
2057:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
2058:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2059:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (index_for_data - OPTIGA_COMMS_DATA_OFFSET);
2060:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2061:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2062:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2063:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2064:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2065:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for calculate sign command...");
2066:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if the calculate signature command was successful
2067:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
2068:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2069:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // if the received signature length is greater than the user provided signature buf
2070:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if ((*(p_optiga_ecdsa_sign->p_signature_length)) <
2071:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     (me->p_optiga->comms_rx_size - OPTIGA_CMD_APDU_HEADER_SIZE))
2072:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2073:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Error in processing calculate sign response...");
2074:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_ecdsa_sign->p_signature_length) = 0x00;
2075:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2076:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2077:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
2078:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2079:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *(p_optiga_ecdsa_sign->p_signature_length) = me->p_optiga->comms_rx_size - OPTI
2080:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     //copy signed data from optiga comms buffer to user provided buffer
2081:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2082:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     pal_os_memcpy(p_optiga_ecdsa_sign->p_signature,
2083:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET
2084:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   *(p_optiga_ecdsa_sign->p_signature_length));
2085:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Response of calculate sign command is processed...");
2086:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
2087:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2088:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2089:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
2090:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2091:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing calculate sign response...");
2092:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2093:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2094:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
2095:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_ecdsa_sign->p_signature_length) = 0x00;
2096:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2097:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2098:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2099:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
2100:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 4960              	 .loc 1 2100 0
 4961 0024 A8E0     	 b .L274
 4962              	.L271:
2018:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 4963              	 .loc 1 2018 0
 4964 0026 3B69     	 ldr r3,[r7,#16]
 4965 0028 9B7B     	 ldrb r3,[r3,#14]
 4966 002a 9BB2     	 uxth r3,r3
 4967 002c 0C33     	 adds r3,r3,#12
 4968 002e FB81     	 strh r3,[r7,#14]
2020:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 4969              	 .loc 1 2020 0
 4970 0030 FB89     	 ldrh r3,[r7,#14]
 4971 0032 40F21562 	 movw r2,#1557
 4972 0036 9342     	 cmp r3,r2
 4973 0038 07D9     	 bls .L273
2022:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_ecdsa_sign->p_signature_length) = 0x00;
 4974              	 .loc 1 2022 0
 4975 003a 4FF40173 	 mov r3,#516
 4976 003e FB82     	 strh r3,[r7,#22]
2023:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 4977              	 .loc 1 2023 0
 4978 0040 3B69     	 ldr r3,[r7,#16]
 4979 0042 9B68     	 ldr r3,[r3,#8]
 4980 0044 0022     	 movs r2,#0
 4981 0046 1A80     	 strh r2,[r3]
2024:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 4982              	 .loc 1 2024 0
 4983 0048 96E0     	 b .L274
 4984              	.L273:
2028:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
 4985              	 .loc 1 2028 0
 4986 004a 3B69     	 ldr r3,[r7,#16]
 4987 004c 9B7B     	 ldrb r3,[r3,#14]
2027:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_ecdsa_sign->digest_length,
 4988              	 .loc 1 2027 0
 4989 004e 99B2     	 uxth r1,r3
2029:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
 4990              	 .loc 1 2029 0
 4991 0050 7B68     	 ldr r3,[r7,#4]
 4992 0052 1B68     	 ldr r3,[r3]
 4993 0054 03F10D02 	 add r2,r3,#13
2027:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_ecdsa_sign->digest_length,
 4994              	 .loc 1 2027 0
 4995 0058 07F10C03 	 add r3,r7,#12
 4996 005c 0120     	 movs r0,#1
 4997 005e FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2032:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_ecdsa_sign->p_digest,
 4998              	 .loc 1 2032 0
 4999 0062 7B68     	 ldr r3,[r7,#4]
 5000 0064 1A68     	 ldr r2,[r3]
 5001 0066 BB89     	 ldrh r3,[r7,#12]
 5002 0068 0833     	 adds r3,r3,#8
 5003 006a 1344     	 add r3,r3,r2
 5004 006c 591D     	 adds r1,r3,#5
2033:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_ecdsa_sign->digest_length);
 5005              	 .loc 1 2033 0
 5006 006e 3B69     	 ldr r3,[r7,#16]
 5007 0070 1A68     	 ldr r2,[r3]
2034:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5008              	 .loc 1 2034 0
 5009 0072 3B69     	 ldr r3,[r7,#16]
 5010 0074 9B7B     	 ldrb r3,[r3,#14]
2032:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_ecdsa_sign->p_digest,
 5011              	 .loc 1 2032 0
 5012 0076 0846     	 mov r0,r1
 5013 0078 1146     	 mov r1,r2
 5014 007a 1A46     	 mov r2,r3
 5015 007c FFF7FEFF 	 bl pal_os_memcpy
2036:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5016              	 .loc 1 2036 0
 5017 0080 3B69     	 ldr r3,[r7,#16]
 5018 0082 9B7B     	 ldrb r3,[r3,#14]
 5019 0084 9AB2     	 uxth r2,r3
 5020 0086 BB89     	 ldrh r3,[r7,#12]
 5021 0088 1344     	 add r3,r3,r2
 5022 008a 9BB2     	 uxth r3,r3
 5023 008c BB81     	 strh r3,[r7,#12]
2041:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
 5024              	 .loc 1 2041 0
 5025 008e 7B68     	 ldr r3,[r7,#4]
 5026 0090 1B68     	 ldr r3,[r3]
 5027 0092 03F10D02 	 add r2,r3,#13
2039:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           OPTIGA_CMD_SIGN_OID_LEN,
 5028              	 .loc 1 2039 0
 5029 0096 07F10C03 	 add r3,r7,#12
 5030 009a 0320     	 movs r0,#3
 5031 009c 0221     	 movs r1,#2
 5032 009e FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2044:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_KEY_ID_SESSION_BASED != p_optiga_ecdsa_sign->private_key_oid)
 5033              	 .loc 1 2044 0
 5034 00a2 7B68     	 ldr r3,[r7,#4]
 5035 00a4 9B8A     	 ldrh r3,[r3,#20]
 5036 00a6 BB82     	 strh r3,[r7,#20]
2045:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5037              	 .loc 1 2045 0
 5038 00a8 3B69     	 ldr r3,[r7,#16]
 5039 00aa 9B89     	 ldrh r3,[r3,#12]
 5040 00ac 002B     	 cmp r3,#0
 5041 00ae 02D0     	 beq .L275
2047:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5042              	 .loc 1 2047 0
 5043 00b0 3B69     	 ldr r3,[r7,#16]
 5044 00b2 9B89     	 ldrh r3,[r3,#12]
 5045 00b4 BB82     	 strh r3,[r7,#20]
 5046              	.L275:
2049:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      private_key_oid);
 5047              	 .loc 1 2049 0
 5048 00b6 7B68     	 ldr r3,[r7,#4]
 5049 00b8 1A68     	 ldr r2,[r3]
 5050 00ba BB89     	 ldrh r3,[r7,#12]
 5051 00bc 0833     	 adds r3,r3,#8
 5052 00be 1344     	 add r3,r3,r2
 5053 00c0 5A1D     	 adds r2,r3,#5
 5054 00c2 BB8A     	 ldrh r3,[r7,#20]
 5055 00c4 1046     	 mov r0,r2
 5056 00c6 1946     	 mov r1,r3
 5057 00c8 FFF7FEFF 	 bl optiga_common_set_uint16
2051:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5058              	 .loc 1 2051 0
 5059 00cc BB89     	 ldrh r3,[r7,#12]
 5060 00ce 0233     	 adds r3,r3,#2
 5061 00d0 9BB2     	 uxth r3,r3
 5062 00d2 BB81     	 strh r3,[r7,#12]
2054:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 5063              	 .loc 1 2054 0
 5064 00d4 7B68     	 ldr r3,[r7,#4]
 5065 00d6 597E     	 ldrb r1,[r3,#25]
 5066 00d8 BB89     	 ldrh r3,[r7,#12]
 5067 00da 043B     	 subs r3,r3,#4
 5068 00dc 9AB2     	 uxth r2,r3
2057:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5069              	 .loc 1 2057 0
 5070 00de 7B68     	 ldr r3,[r7,#4]
 5071 00e0 1B68     	 ldr r3,[r3]
 5072 00e2 0D33     	 adds r3,r3,#13
2054:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 5073              	 .loc 1 2054 0
 5074 00e4 B120     	 movs r0,#177
 5075 00e6 FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
2059:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 5076              	 .loc 1 2059 0
 5077 00ea 7B68     	 ldr r3,[r7,#4]
 5078 00ec 1B68     	 ldr r3,[r3]
 5079 00ee BA89     	 ldrh r2,[r7,#12]
 5080 00f0 9A80     	 strh r2,[r3,#4]
2060:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 5081              	 .loc 1 2060 0
 5082 00f2 0023     	 movs r3,#0
 5083 00f4 FB82     	 strh r3,[r7,#22]
2062:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 5084              	 .loc 1 2062 0
 5085 00f6 3FE0     	 b .L274
 5086              	.L272:
2067:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5087              	 .loc 1 2067 0
 5088 00f8 7B68     	 ldr r3,[r7,#4]
 5089 00fa 1B68     	 ldr r3,[r3]
 5090 00fc 5B7B     	 ldrb r3,[r3,#13]
 5091 00fe 002B     	 cmp r3,#0
 5092 0100 2AD1     	 bne .L276
2070:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     (me->p_optiga->comms_rx_size - OPTIGA_CMD_APDU_HEADER_SIZE))
 5093              	 .loc 1 2070 0
 5094 0102 3B69     	 ldr r3,[r7,#16]
 5095 0104 9B68     	 ldr r3,[r3,#8]
 5096 0106 1B88     	 ldrh r3,[r3]
 5097 0108 1A46     	 mov r2,r3
2071:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 5098              	 .loc 1 2071 0
 5099 010a 7B68     	 ldr r3,[r7,#4]
 5100 010c 1B68     	 ldr r3,[r3]
 5101 010e DB88     	 ldrh r3,[r3,#6]
 5102 0110 043B     	 subs r3,r3,#4
2070:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     (me->p_optiga->comms_rx_size - OPTIGA_CMD_APDU_HEADER_SIZE))
 5103              	 .loc 1 2070 0
 5104 0112 9A42     	 cmp r2,r3
 5105 0114 07DA     	 bge .L277
2074:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
 5106              	 .loc 1 2074 0
 5107 0116 3B69     	 ldr r3,[r7,#16]
 5108 0118 9B68     	 ldr r3,[r3,#8]
 5109 011a 0022     	 movs r2,#0
 5110 011c 1A80     	 strh r2,[r3]
2075:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 5111              	 .loc 1 2075 0
 5112 011e 4FF40173 	 mov r3,#516
 5113 0122 FB82     	 strh r3,[r7,#22]
2098:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 5114              	 .loc 1 2098 0
 5115 0124 27E0     	 b .L281
 5116              	.L277:
2079:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     //copy signed data from optiga comms buffer to user provided buffer
 5117              	 .loc 1 2079 0
 5118 0126 3B69     	 ldr r3,[r7,#16]
 5119 0128 9B68     	 ldr r3,[r3,#8]
 5120 012a 7A68     	 ldr r2,[r7,#4]
 5121 012c 1268     	 ldr r2,[r2]
 5122 012e D288     	 ldrh r2,[r2,#6]
 5123 0130 043A     	 subs r2,r2,#4
 5124 0132 92B2     	 uxth r2,r2
 5125 0134 1A80     	 strh r2,[r3]
2082:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET
 5126              	 .loc 1 2082 0
 5127 0136 3B69     	 ldr r3,[r7,#16]
 5128 0138 5968     	 ldr r1,[r3,#4]
2083:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   *(p_optiga_ecdsa_sign->p_signature_length));
 5129              	 .loc 1 2083 0
 5130 013a 7B68     	 ldr r3,[r7,#4]
 5131 013c 1B68     	 ldr r3,[r3]
 5132 013e 03F11102 	 add r2,r3,#17
2084:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Response of calculate sign command is processed...");
 5133              	 .loc 1 2084 0
 5134 0142 3B69     	 ldr r3,[r7,#16]
 5135 0144 9B68     	 ldr r3,[r3,#8]
 5136 0146 1B88     	 ldrh r3,[r3]
2082:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   me->p_optiga->optiga_comms_buffer + OPTIGA_CMD_APDU_INDATA_OFFSET
 5137              	 .loc 1 2082 0
 5138 0148 0846     	 mov r0,r1
 5139 014a 1146     	 mov r1,r2
 5140 014c 1A46     	 mov r2,r3
 5141 014e FFF7FEFF 	 bl pal_os_memcpy
2086:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 5142              	 .loc 1 2086 0
 5143 0152 0023     	 movs r3,#0
 5144 0154 FB82     	 strh r3,[r7,#22]
2098:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 5145              	 .loc 1 2098 0
 5146 0156 0EE0     	 b .L281
 5147              	.L276:
2094:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(p_optiga_ecdsa_sign->p_signature_length) = 0x00;
 5148              	 .loc 1 2094 0
 5149 0158 7B68     	 ldr r3,[r7,#4]
 5150 015a 9B7E     	 ldrb r3,[r3,#26]
 5151 015c 03F07F03 	 and r3,r3,#127
 5152 0160 DAB2     	 uxtb r2,r3
 5153 0162 7B68     	 ldr r3,[r7,#4]
 5154 0164 9A76     	 strb r2,[r3,#26]
 5155 0166 7B68     	 ldr r3,[r7,#4]
 5156 0168 9A7E     	 ldrb r2,[r3,#26]
 5157 016a 7B68     	 ldr r3,[r7,#4]
 5158 016c 9A76     	 strb r2,[r3,#26]
2095:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5159              	 .loc 1 2095 0
 5160 016e 3B69     	 ldr r3,[r7,#16]
 5161 0170 9B68     	 ldr r3,[r3,#8]
 5162 0172 0022     	 movs r2,#0
 5163 0174 1A80     	 strh r2,[r3]
 5164              	.L281:
2098:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 5165              	 .loc 1 2098 0
 5166 0176 00BF     	 nop
 5167              	.L274:
2101:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2102:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2103:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 5168              	 .loc 1 2103 0
 5169 0178 FB8A     	 ldrh r3,[r7,#22]
2104:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 5170              	 .loc 1 2104 0
 5171 017a 1846     	 mov r0,r3
 5172 017c 1837     	 adds r7,r7,#24
 5173              	.LCFI216:
 5174              	 .cfi_def_cfa_offset 8
 5175 017e BD46     	 mov sp,r7
 5176              	.LCFI217:
 5177              	 .cfi_def_cfa_register 13
 5178              	 
 5179 0180 80BD     	 pop {r7,pc}
 5180              	 .cfi_endproc
 5181              	.LFE41:
 5183 0182 00BF     	 .section .text.optiga_cmd_calc_sign,"ax",%progbits
 5184              	 .align 2
 5185              	 .global optiga_cmd_calc_sign
 5186              	 .thumb
 5187              	 .thumb_func
 5189              	optiga_cmd_calc_sign:
 5190              	.LFB42:
2105:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2106:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2107:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_calc_sign(optiga_cmd_t * me, uint8_t cmd_param, optiga_calc_sign_par
2108:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 5191              	 .loc 1 2108 0
 5192              	 .cfi_startproc
 5193              	 
 5194              	 
 5195 0000 80B5     	 push {r7,lr}
 5196              	.LCFI218:
 5197              	 .cfi_def_cfa_offset 8
 5198              	 .cfi_offset 7,-8
 5199              	 .cfi_offset 14,-4
 5200 0002 8AB0     	 sub sp,sp,#40
 5201              	.LCFI219:
 5202              	 .cfi_def_cfa_offset 48
 5203 0004 04AF     	 add r7,sp,#16
 5204              	.LCFI220:
 5205              	 .cfi_def_cfa 7,32
 5206 0006 F860     	 str r0,[r7,#12]
 5207 0008 0B46     	 mov r3,r1
 5208 000a 7A60     	 str r2,[r7,#4]
 5209 000c FB72     	 strb r3,[r7,#11]
2109:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR_INVALID_INPUT;
 5210              	 .loc 1 2109 0
 5211 000e 40F20323 	 movw r3,#515
 5212 0012 FB82     	 strh r3,[r7,#22]
2110:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_calc_sign_params_t * p_optiga_ecdsa_sign = (optiga_calc_sign_params_t*)params;
 5213              	 .loc 1 2110 0
 5214 0014 7B68     	 ldr r3,[r7,#4]
 5215 0016 3B61     	 str r3,[r7,#16]
2111:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t cmd_handler_state = OPTIGA_CMD_EXEC_REQUEST_LOCK;
 5216              	 .loc 1 2111 0
 5217 0018 0623     	 movs r3,#6
 5218 001a 7B75     	 strb r3,[r7,#21]
2112:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2113:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     do
2114:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2115:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecdsa_sign->private_key_oid)
 5219              	 .loc 1 2115 0
 5220 001c 3B69     	 ldr r3,[r7,#16]
 5221 001e 9B89     	 ldrh r3,[r3,#12]
 5222 0020 002B     	 cmp r3,#0
 5223 0022 06D1     	 bne .L283
2116:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2117:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_ZERO_LENGTH_OR_VALUE == me->session_oid)
 5224              	 .loc 1 2117 0
 5225 0024 FB68     	 ldr r3,[r7,#12]
 5226 0026 9B8A     	 ldrh r3,[r3,#20]
 5227 0028 002B     	 cmp r3,#0
 5228 002a 00D1     	 bne .L284
2118:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2119:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 5229              	 .loc 1 2119 0
 5230 002c 10E0     	 b .L285
 5231              	.L284:
2120:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2121:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             cmd_handler_state = OPTIGA_CMD_EXEC_REQUEST_SESSION;
 5232              	 .loc 1 2121 0
 5233 002e 0523     	 movs r3,#5
 5234 0030 7B75     	 strb r3,[r7,#21]
 5235              	.L283:
2122:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2123:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2124:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2125:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_cmd_execute(me,
 5236              	 .loc 1 2125 0
 5237 0032 FA7A     	 ldrb r2,[r7,#11]
 5238 0034 7B7D     	 ldrb r3,[r7,#21]
 5239 0036 0093     	 str r3,[sp]
 5240 0038 7B68     	 ldr r3,[r7,#4]
 5241 003a 0193     	 str r3,[sp,#4]
 5242 003c B123     	 movs r3,#177
 5243 003e 0293     	 str r3,[sp,#8]
 5244 0040 F868     	 ldr r0,[r7,#12]
 5245 0042 1146     	 mov r1,r2
 5246 0044 054A     	 ldr r2,.L287
 5247 0046 0223     	 movs r3,#2
 5248 0048 FFF7FEFF 	 bl optiga_cmd_execute
2126:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            cmd_param,
2127:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            optiga_cmd_calc_sign_handler,
2128:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2129:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            cmd_handler_state,
2130:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            params,
2131:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and 
2132:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_CALC_SIGN, OPTIGA_CMD_ZERO_LENGTH_OR
2133:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2134:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         return_status = OPTIGA_LIB_SUCCESS;
 5249              	 .loc 1 2134 0
 5250 004c 0023     	 movs r3,#0
 5251 004e FB82     	 strh r3,[r7,#22]
 5252              	.L285:
2135:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     } while (FALSE);
2136:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 5253              	 .loc 1 2136 0
 5254 0050 FB8A     	 ldrh r3,[r7,#22]
2137:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 5255              	 .loc 1 2137 0
 5256 0052 1846     	 mov r0,r3
 5257 0054 1837     	 adds r7,r7,#24
 5258              	.LCFI221:
 5259              	 .cfi_def_cfa_offset 8
 5260 0056 BD46     	 mov sp,r7
 5261              	.LCFI222:
 5262              	 .cfi_def_cfa_register 13
 5263              	 
 5264 0058 80BD     	 pop {r7,pc}
 5265              	.L288:
 5266 005a 00BF     	 .align 2
 5267              	.L287:
 5268 005c 00000000 	 .word optiga_cmd_calc_sign_handler
 5269              	 .cfi_endproc
 5270              	.LFE42:
 5272              	 .section .text.optiga_cmd_verify_sign_handler,"ax",%progbits
 5273              	 .align 2
 5274              	 .thumb
 5275              	 .thumb_func
 5277              	optiga_cmd_verify_sign_handler:
 5278              	.LFB43:
2138:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //(OPTIGA_CRYPT_ECDSA_SIGN_ENABLED)
2139:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2140:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_ECDSA_VERIFY_ENABLED
2141:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
2142:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * VerifySign handler
2143:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
2144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_verify_sign_handler(optiga_cmd_t * me)
2145:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 5279              	 .loc 1 2145 0
 5280              	 .cfi_startproc
 5281              	 
 5282              	 
 5283 0000 80B5     	 push {r7,lr}
 5284              	.LCFI223:
 5285              	 .cfi_def_cfa_offset 8
 5286              	 .cfi_offset 7,-8
 5287              	 .cfi_offset 14,-4
 5288 0002 86B0     	 sub sp,sp,#24
 5289              	.LCFI224:
 5290              	 .cfi_def_cfa_offset 32
 5291 0004 00AF     	 add r7,sp,#0
 5292              	.LCFI225:
 5293              	 .cfi_def_cfa_register 7
 5294 0006 7860     	 str r0,[r7,#4]
2146:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
2147:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_verify_sign_params_t * p_optiga_verify_sign = (optiga_verify_sign_params_t *)me->p_input
 5295              	 .loc 1 2147 0
 5296 0008 7B68     	 ldr r3,[r7,#4]
 5297 000a 9B68     	 ldr r3,[r3,#8]
 5298 000c 3B61     	 str r3,[r7,#16]
2148:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 5299              	 .loc 1 2148 0
 5300 000e 0423     	 movs r3,#4
 5301 0010 BB81     	 strh r3,[r7,#12]
2149:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 5302              	 .loc 1 2149 0
 5303 0012 40F20223 	 movw r3,#514
 5304 0016 FB82     	 strh r3,[r7,#22]
2150:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2151:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 5305              	 .loc 1 2151 0
 5306 0018 7B68     	 ldr r3,[r7,#4]
 5307 001a 9B7D     	 ldrb r3,[r3,#22]
 5308 001c 022B     	 cmp r3,#2
 5309 001e 03D0     	 beq .L291
 5310 0020 032B     	 cmp r3,#3
 5311 0022 00F0CE80 	 beq .L292
2152:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2153:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2154:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2155:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending verify sign command..");
2156:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // APDU header length + TLV of digest + TLV of signature +
2157:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // If public key from OID (TLV of public key OID)
2158:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // If public key from host (TLV of algo ID + TLV of public key)
2159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_TAG_LENGTH_SIZE + p_optiga
2160:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
2161:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CRYPT_OID_DATA == p_optiga_verify_sign->public_key_sour
2162:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      (OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES)
2163:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
2164:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      p_optiga_verify_sign->public_key->length));
2165:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
2166:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2167:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2168:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
2169:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2170:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //TLV formation for digest
2171:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_SIGN_DIGEST_TAG,
2172:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->digest_length,
2173:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
2174:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2175:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2176:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2177:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->p_digest,
2178:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->digest_length);
2179:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_verify_sign->digest_length;
2180:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2181:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //TLV formation for signature
2182:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_SIGN_SIGNATURE_TAG,
2183:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->signature_length,
2184:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
2185:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2186:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2187:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2188:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->p_signature,
2189:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->signature_length);
2190:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_verify_sign->signature_length;
2191:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2192:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CRYPT_OID_DATA == p_optiga_verify_sign->public_key_source_type)
2193:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2194:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //TLV formation for public key certificate OID
2195:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_TAG,
2196:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_LENGTH,
2197:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2198:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
2199:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2200:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2201:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          p_optiga_verify_sign->certificate_oid);
2202:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2203:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2204:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
2205:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2206:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //TLV formation for public key from host
2207:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_ALGO_ID_TAG,
2208:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_VERIFY_ALGO_ID_LENGTH,
2209:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2210:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
2211:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2212:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data++) = (uint8_t)p_optiga_verify_
2213:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2214:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(OPTIGA_CMD_VERIFY_PUBLIC_KEY_TAG,
2215:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               p_optiga_verify_sign->public_key->length,
2216:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2217:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
2218:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2219:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2220:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_verify_sign->public_key->public_key,
2221:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_verify_sign->public_key->length);
2222:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += p_optiga_verify_sign->public_key->length;
2223:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2224:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2225:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //form apdu header
2226:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_VERIFY_SIGN,
2227:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
2228:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSE
2229:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
2230:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2231:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (uint16_t)(index_for_data - OPTIGA_COMMS_DATA_OFFSET);
2232:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2233:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2234:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2235:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2236:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2237:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2238:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for verify sign command...");
2239:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_FAILURE == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
2240:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2241:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing verify sign response...");
2242:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2243:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2244:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
2245:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
2246:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2247:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of veriy sign command is processed...");
2248:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2249:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2250:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2251:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
2252:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 5312              	 .loc 1 2252 0
 5313 0026 E0E0     	 b .L296
 5314              	.L291:
2159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 5315              	 .loc 1 2159 0
 5316 0028 3B69     	 ldr r3,[r7,#16]
 5317 002a 1B79     	 ldrb r3,[r3,#4]
 5318 002c 9AB2     	 uxth r2,r3
2160:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CRYPT_OID_DATA == p_optiga_verify_sign->public_key_sour
 5319              	 .loc 1 2160 0
 5320 002e 3B69     	 ldr r3,[r7,#16]
 5321 0030 9B89     	 ldrh r3,[r3,#12]
2159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 5322              	 .loc 1 2159 0
 5323 0032 1344     	 add r3,r3,r2
 5324 0034 9AB2     	 uxth r2,r3
2161:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      (OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES)
 5325              	 .loc 1 2161 0
 5326 0036 3B69     	 ldr r3,[r7,#16]
 5327 0038 9B7B     	 ldrb r3,[r3,#14]
2159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 5328              	 .loc 1 2159 0
 5329 003a 002B     	 cmp r3,#0
 5330 003c 05D0     	 beq .L293
2164:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
 5331              	 .loc 1 2164 0 discriminator 1
 5332 003e 3B69     	 ldr r3,[r7,#16]
 5333 0040 1B69     	 ldr r3,[r3,#16]
 5334 0042 9B88     	 ldrh r3,[r3,#4]
2159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 5335              	 .loc 1 2159 0 discriminator 1
 5336 0044 0933     	 adds r3,r3,#9
 5337 0046 9BB2     	 uxth r3,r3
 5338 0048 00E0     	 b .L294
 5339              	.L293:
2159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 5340              	 .loc 1 2159 0 is_stmt 0 discriminator 2
 5341 004a 0523     	 movs r3,#5
 5342              	.L294:
2159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     OPTIGA_CMD_TAG_LENGTH_SIZE + (p_optiga_verify_sign->signature_l
 5343              	 .loc 1 2159 0 discriminator 4
 5344 004c 1344     	 add r3,r3,r2
 5345 004e 9BB2     	 uxth r3,r3
 5346 0050 0A33     	 adds r3,r3,#10
 5347 0052 FB81     	 strh r3,[r7,#14]
2165:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5348              	 .loc 1 2165 0 is_stmt 1 discriminator 4
 5349 0054 FB89     	 ldrh r3,[r7,#14]
 5350 0056 40F21562 	 movw r2,#1557
 5351 005a 9342     	 cmp r3,r2
 5352 005c 03D9     	 bls .L295
2167:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 5353              	 .loc 1 2167 0
 5354 005e 4FF40173 	 mov r3,#516
 5355 0062 FB82     	 strh r3,[r7,#22]
2168:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5356              	 .loc 1 2168 0
 5357 0064 C1E0     	 b .L296
 5358              	.L295:
2172:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
 5359              	 .loc 1 2172 0
 5360 0066 3B69     	 ldr r3,[r7,#16]
 5361 0068 1B79     	 ldrb r3,[r3,#4]
2171:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->digest_length,
 5362              	 .loc 1 2171 0
 5363 006a 99B2     	 uxth r1,r3
2173:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
 5364              	 .loc 1 2173 0
 5365 006c 7B68     	 ldr r3,[r7,#4]
 5366 006e 1B68     	 ldr r3,[r3]
 5367 0070 03F10D02 	 add r2,r3,#13
2171:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->digest_length,
 5368              	 .loc 1 2171 0
 5369 0074 07F10C03 	 add r3,r7,#12
 5370 0078 0120     	 movs r0,#1
 5371 007a FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2176:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->p_digest,
 5372              	 .loc 1 2176 0
 5373 007e 7B68     	 ldr r3,[r7,#4]
 5374 0080 1A68     	 ldr r2,[r3]
 5375 0082 BB89     	 ldrh r3,[r7,#12]
 5376 0084 0833     	 adds r3,r3,#8
 5377 0086 1344     	 add r3,r3,r2
 5378 0088 591D     	 adds r1,r3,#5
2177:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->digest_length);
 5379              	 .loc 1 2177 0
 5380 008a 3B69     	 ldr r3,[r7,#16]
 5381 008c 1A68     	 ldr r2,[r3]
2178:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_verify_sign->digest_length;
 5382              	 .loc 1 2178 0
 5383 008e 3B69     	 ldr r3,[r7,#16]
 5384 0090 1B79     	 ldrb r3,[r3,#4]
2176:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->p_digest,
 5385              	 .loc 1 2176 0
 5386 0092 0846     	 mov r0,r1
 5387 0094 1146     	 mov r1,r2
 5388 0096 1A46     	 mov r2,r3
 5389 0098 FFF7FEFF 	 bl pal_os_memcpy
2179:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5390              	 .loc 1 2179 0
 5391 009c 3B69     	 ldr r3,[r7,#16]
 5392 009e 1B79     	 ldrb r3,[r3,#4]
 5393 00a0 9AB2     	 uxth r2,r3
 5394 00a2 BB89     	 ldrh r3,[r7,#12]
 5395 00a4 1344     	 add r3,r3,r2
 5396 00a6 9BB2     	 uxth r3,r3
 5397 00a8 BB81     	 strh r3,[r7,#12]
2182:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->signature_length,
 5398              	 .loc 1 2182 0
 5399 00aa 3B69     	 ldr r3,[r7,#16]
 5400 00ac 9989     	 ldrh r1,[r3,#12]
2184:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
 5401              	 .loc 1 2184 0
 5402 00ae 7B68     	 ldr r3,[r7,#4]
 5403 00b0 1B68     	 ldr r3,[r3]
 5404 00b2 03F10D02 	 add r2,r3,#13
2182:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_verify_sign->signature_length,
 5405              	 .loc 1 2182 0
 5406 00b6 07F10C03 	 add r3,r7,#12
 5407 00ba 0220     	 movs r0,#2
 5408 00bc FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2187:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->p_signature,
 5409              	 .loc 1 2187 0
 5410 00c0 7B68     	 ldr r3,[r7,#4]
 5411 00c2 1A68     	 ldr r2,[r3]
 5412 00c4 BB89     	 ldrh r3,[r7,#12]
 5413 00c6 0833     	 adds r3,r3,#8
 5414 00c8 1344     	 add r3,r3,r2
 5415 00ca 591D     	 adds r1,r3,#5
2188:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->signature_length);
 5416              	 .loc 1 2188 0
 5417 00cc 3B69     	 ldr r3,[r7,#16]
 5418 00ce 9A68     	 ldr r2,[r3,#8]
2189:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_verify_sign->signature_length;
 5419              	 .loc 1 2189 0
 5420 00d0 3B69     	 ldr r3,[r7,#16]
 5421 00d2 9B89     	 ldrh r3,[r3,#12]
2187:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_verify_sign->p_signature,
 5422              	 .loc 1 2187 0
 5423 00d4 0846     	 mov r0,r1
 5424 00d6 1146     	 mov r1,r2
 5425 00d8 1A46     	 mov r2,r3
 5426 00da FFF7FEFF 	 bl pal_os_memcpy
2190:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5427              	 .loc 1 2190 0
 5428 00de 3B69     	 ldr r3,[r7,#16]
 5429 00e0 9A89     	 ldrh r2,[r3,#12]
 5430 00e2 BB89     	 ldrh r3,[r7,#12]
 5431 00e4 1344     	 add r3,r3,r2
 5432 00e6 9BB2     	 uxth r3,r3
 5433 00e8 BB81     	 strh r3,[r7,#12]
2192:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5434              	 .loc 1 2192 0
 5435 00ea 3B69     	 ldr r3,[r7,#16]
 5436 00ec 9B7B     	 ldrb r3,[r3,#14]
 5437 00ee 002B     	 cmp r3,#0
 5438 00f0 1AD1     	 bne .L297
2197:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
 5439              	 .loc 1 2197 0
 5440 00f2 7B68     	 ldr r3,[r7,#4]
 5441 00f4 1B68     	 ldr r3,[r3]
 5442 00f6 03F10D02 	 add r2,r3,#13
2195:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_VERIFY_SIGN_PUB_KEY_CERT_OID_LENGTH,
 5443              	 .loc 1 2195 0
 5444 00fa 07F10C03 	 add r3,r7,#12
 5445 00fe 0420     	 movs r0,#4
 5446 0100 0221     	 movs r1,#2
 5447 0102 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2200:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          p_optiga_verify_sign->certificate_oid);
 5448              	 .loc 1 2200 0
 5449 0106 7B68     	 ldr r3,[r7,#4]
 5450 0108 1A68     	 ldr r2,[r3]
 5451 010a BB89     	 ldrh r3,[r7,#12]
 5452 010c 0833     	 adds r3,r3,#8
 5453 010e 1344     	 add r3,r3,r2
 5454 0110 5A1D     	 adds r2,r3,#5
 5455 0112 3B69     	 ldr r3,[r7,#16]
 5456 0114 9B8A     	 ldrh r3,[r3,#20]
 5457 0116 1046     	 mov r0,r2
 5458 0118 1946     	 mov r1,r3
 5459 011a FFF7FEFF 	 bl optiga_common_set_uint16
2202:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5460              	 .loc 1 2202 0
 5461 011e BB89     	 ldrh r3,[r7,#12]
 5462 0120 0233     	 adds r3,r3,#2
 5463 0122 9BB2     	 uxth r3,r3
 5464 0124 BB81     	 strh r3,[r7,#12]
 5465 0126 3AE0     	 b .L298
 5466              	.L297:
2209:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
 5467              	 .loc 1 2209 0
 5468 0128 7B68     	 ldr r3,[r7,#4]
 5469 012a 1B68     	 ldr r3,[r3]
 5470 012c 03F10D02 	 add r2,r3,#13
2207:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_VERIFY_ALGO_ID_LENGTH,
 5471              	 .loc 1 2207 0
 5472 0130 07F10C03 	 add r3,r7,#12
 5473 0134 0520     	 movs r0,#5
 5474 0136 0121     	 movs r1,#1
 5475 0138 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2212:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5476              	 .loc 1 2212 0
 5477 013c 7B68     	 ldr r3,[r7,#4]
 5478 013e 1A68     	 ldr r2,[r3]
 5479 0140 BB89     	 ldrh r3,[r7,#12]
 5480 0142 591C     	 adds r1,r3,#1
 5481 0144 89B2     	 uxth r1,r1
 5482 0146 B981     	 strh r1,[r7,#12]
 5483 0148 1846     	 mov r0,r3
 5484 014a 3B69     	 ldr r3,[r7,#16]
 5485 014c 1B69     	 ldr r3,[r3,#16]
 5486 014e 9979     	 ldrb r1,[r3,#6]
 5487 0150 1318     	 adds r3,r2,r0
 5488 0152 0A46     	 mov r2,r1
 5489 0154 5A73     	 strb r2,[r3,#13]
2215:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
 5490              	 .loc 1 2215 0
 5491 0156 3B69     	 ldr r3,[r7,#16]
 5492 0158 1B69     	 ldr r3,[r3,#16]
2214:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               p_optiga_verify_sign->public_key->length,
 5493              	 .loc 1 2214 0
 5494 015a 9988     	 ldrh r1,[r3,#4]
2216:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               &index_for_data);
 5495              	 .loc 1 2216 0
 5496 015c 7B68     	 ldr r3,[r7,#4]
 5497 015e 1B68     	 ldr r3,[r3]
 5498 0160 03F10D02 	 add r2,r3,#13
2214:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               p_optiga_verify_sign->public_key->length,
 5499              	 .loc 1 2214 0
 5500 0164 07F10C03 	 add r3,r7,#12
 5501 0168 0620     	 movs r0,#6
 5502 016a FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2219:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_verify_sign->public_key->public_key,
 5503              	 .loc 1 2219 0
 5504 016e 7B68     	 ldr r3,[r7,#4]
 5505 0170 1A68     	 ldr r2,[r3]
 5506 0172 BB89     	 ldrh r3,[r7,#12]
 5507 0174 0833     	 adds r3,r3,#8
 5508 0176 1344     	 add r3,r3,r2
 5509 0178 591D     	 adds r1,r3,#5
2220:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_verify_sign->public_key->length);
 5510              	 .loc 1 2220 0
 5511 017a 3B69     	 ldr r3,[r7,#16]
 5512 017c 1B69     	 ldr r3,[r3,#16]
 5513 017e 1A68     	 ldr r2,[r3]
2221:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += p_optiga_verify_sign->public_key->length;
 5514              	 .loc 1 2221 0
 5515 0180 3B69     	 ldr r3,[r7,#16]
 5516 0182 1B69     	 ldr r3,[r3,#16]
 5517 0184 9B88     	 ldrh r3,[r3,#4]
2219:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_verify_sign->public_key->public_key,
 5518              	 .loc 1 2219 0
 5519 0186 0846     	 mov r0,r1
 5520 0188 1146     	 mov r1,r2
 5521 018a 1A46     	 mov r2,r3
 5522 018c FFF7FEFF 	 bl pal_os_memcpy
2222:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5523              	 .loc 1 2222 0
 5524 0190 3B69     	 ldr r3,[r7,#16]
 5525 0192 1B69     	 ldr r3,[r3,#16]
 5526 0194 9A88     	 ldrh r2,[r3,#4]
 5527 0196 BB89     	 ldrh r3,[r7,#12]
 5528 0198 1344     	 add r3,r3,r2
 5529 019a 9BB2     	 uxth r3,r3
 5530 019c BB81     	 strh r3,[r7,#12]
 5531              	.L298:
2226:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 5532              	 .loc 1 2226 0
 5533 019e 7B68     	 ldr r3,[r7,#4]
 5534 01a0 597E     	 ldrb r1,[r3,#25]
 5535 01a2 BB89     	 ldrh r3,[r7,#12]
 5536 01a4 043B     	 subs r3,r3,#4
 5537 01a6 9AB2     	 uxth r2,r3
2229:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5538              	 .loc 1 2229 0
 5539 01a8 7B68     	 ldr r3,[r7,#4]
 5540 01aa 1B68     	 ldr r3,[r3]
 5541 01ac 0D33     	 adds r3,r3,#13
2226:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 5542              	 .loc 1 2226 0
 5543 01ae B220     	 movs r0,#178
 5544 01b0 FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
2231:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5545              	 .loc 1 2231 0
 5546 01b4 7B68     	 ldr r3,[r7,#4]
 5547 01b6 1B68     	 ldr r3,[r3]
 5548 01b8 BA89     	 ldrh r2,[r7,#12]
 5549 01ba 9A80     	 strh r2,[r3,#4]
2233:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 5550              	 .loc 1 2233 0
 5551 01bc 0023     	 movs r3,#0
 5552 01be FB82     	 strh r3,[r7,#22]
2235:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 5553              	 .loc 1 2235 0
 5554 01c0 13E0     	 b .L296
 5555              	.L292:
2239:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5556              	 .loc 1 2239 0
 5557 01c2 7B68     	 ldr r3,[r7,#4]
 5558 01c4 1B68     	 ldr r3,[r3]
 5559 01c6 5B7B     	 ldrb r3,[r3,#13]
 5560 01c8 FF2B     	 cmp r3,#255
 5561 01ca 0BD1     	 bne .L299
2244:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 5562              	 .loc 1 2244 0
 5563 01cc 7B68     	 ldr r3,[r7,#4]
 5564 01ce 9B7E     	 ldrb r3,[r3,#26]
 5565 01d0 03F07F03 	 and r3,r3,#127
 5566 01d4 DAB2     	 uxtb r2,r3
 5567 01d6 7B68     	 ldr r3,[r7,#4]
 5568 01d8 9A76     	 strb r2,[r3,#26]
 5569 01da 7B68     	 ldr r3,[r7,#4]
 5570 01dc 9A7E     	 ldrb r2,[r3,#26]
 5571 01de 7B68     	 ldr r3,[r7,#4]
 5572 01e0 9A76     	 strb r2,[r3,#26]
2245:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5573              	 .loc 1 2245 0
 5574 01e2 02E0     	 b .L296
 5575              	.L299:
2248:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 5576              	 .loc 1 2248 0
 5577 01e4 0023     	 movs r3,#0
 5578 01e6 FB82     	 strh r3,[r7,#22]
2250:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 5579              	 .loc 1 2250 0
 5580 01e8 00BF     	 nop
 5581              	.L296:
2253:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2254:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2255:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 5582              	 .loc 1 2255 0
 5583 01ea FB8A     	 ldrh r3,[r7,#22]
2256:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 5584              	 .loc 1 2256 0
 5585 01ec 1846     	 mov r0,r3
 5586 01ee 1837     	 adds r7,r7,#24
 5587              	.LCFI226:
 5588              	 .cfi_def_cfa_offset 8
 5589 01f0 BD46     	 mov sp,r7
 5590              	.LCFI227:
 5591              	 .cfi_def_cfa_register 13
 5592              	 
 5593 01f2 80BD     	 pop {r7,pc}
 5594              	 .cfi_endproc
 5595              	.LFE43:
 5597              	 .section .text.optiga_cmd_verify_sign,"ax",%progbits
 5598              	 .align 2
 5599              	 .global optiga_cmd_verify_sign
 5600              	 .thumb
 5601              	 .thumb_func
 5603              	optiga_cmd_verify_sign:
 5604              	.LFB44:
2257:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2258:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_verify_sign(optiga_cmd_t * me,
2259:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            uint8_t cmd_param,
2260:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            optiga_verify_sign_params_t * params)
2261:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 5605              	 .loc 1 2261 0
 5606              	 .cfi_startproc
 5607              	 
 5608              	 
 5609 0000 80B5     	 push {r7,lr}
 5610              	.LCFI228:
 5611              	 .cfi_def_cfa_offset 8
 5612              	 .cfi_offset 7,-8
 5613              	 .cfi_offset 14,-4
 5614 0002 88B0     	 sub sp,sp,#32
 5615              	.LCFI229:
 5616              	 .cfi_def_cfa_offset 40
 5617 0004 04AF     	 add r7,sp,#16
 5618              	.LCFI230:
 5619              	 .cfi_def_cfa 7,24
 5620 0006 F860     	 str r0,[r7,#12]
 5621 0008 0B46     	 mov r3,r1
 5622 000a 7A60     	 str r2,[r7,#4]
 5623 000c FB72     	 strb r3,[r7,#11]
2262:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2263:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
 5624              	 .loc 1 2263 0
 5625 000e FA7A     	 ldrb r2,[r7,#11]
 5626 0010 0623     	 movs r3,#6
 5627 0012 0093     	 str r3,[sp]
 5628 0014 7B68     	 ldr r3,[r7,#4]
 5629 0016 0193     	 str r3,[sp,#4]
 5630 0018 B223     	 movs r3,#178
 5631 001a 0293     	 str r3,[sp,#8]
 5632 001c F868     	 ldr r0,[r7,#12]
 5633 001e 1146     	 mov r1,r2
 5634 0020 044A     	 ldr r2,.L303
 5635 0022 0223     	 movs r3,#2
 5636 0024 FFF7FEFF 	 bl optiga_cmd_execute
2264:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        cmd_param,
2265:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_verify_sign_handler,
2266:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2267:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
2268:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        params,
2269:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
2270:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_VERIFY_SIGN, OPTIGA_CMD_ZERO_LENGTH_OR_V
2271:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2272:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
 5637              	 .loc 1 2272 0
 5638 0028 0023     	 movs r3,#0
2273:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 5639              	 .loc 1 2273 0
 5640 002a 1846     	 mov r0,r3
 5641 002c 1037     	 adds r7,r7,#16
 5642              	.LCFI231:
 5643              	 .cfi_def_cfa_offset 8
 5644 002e BD46     	 mov sp,r7
 5645              	.LCFI232:
 5646              	 .cfi_def_cfa_register 13
 5647              	 
 5648 0030 80BD     	 pop {r7,pc}
 5649              	.L304:
 5650 0032 00BF     	 .align 2
 5651              	.L303:
 5652 0034 00000000 	 .word optiga_cmd_verify_sign_handler
 5653              	 .cfi_endproc
 5654              	.LFE44:
 5656              	 .section .text.optiga_cmd_gen_keypair_handler,"ax",%progbits
 5657              	 .align 2
 5658              	 .thumb
 5659              	 .thumb_func
 5661              	optiga_cmd_gen_keypair_handler:
 5662              	.LFB45:
2274:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_ECDSA_VERIFY_ENABLED
2275:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2276:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED
2277:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
2278:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * GenKeyPair handler
2279:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
2280:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_gen_keypair_handler(optiga_cmd_t * me)
2281:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 5663              	 .loc 1 2281 0
 5664              	 .cfi_startproc
 5665              	 
 5666              	 
 5667 0000 80B5     	 push {r7,lr}
 5668              	.LCFI233:
 5669              	 .cfi_def_cfa_offset 8
 5670              	 .cfi_offset 7,-8
 5671              	 .cfi_offset 14,-4
 5672 0002 88B0     	 sub sp,sp,#32
 5673              	.LCFI234:
 5674              	 .cfi_def_cfa_offset 40
 5675 0004 00AF     	 add r7,sp,#0
 5676              	.LCFI235:
 5677              	 .cfi_def_cfa_register 7
 5678 0006 7860     	 str r0,[r7,#4]
2282:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
2283:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_gen_keypair_params_t * p_optiga_ecc_gen_keypair = (optiga_gen_keypair_params_t *)me->p_i
 5679              	 .loc 1 2283 0
 5680 0008 7B68     	 ldr r3,[r7,#4]
 5681 000a 9B68     	 ldr r3,[r3,#8]
 5682 000c BB61     	 str r3,[r7,#24]
2284:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t header_offset;
2285:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t private_key_length;
2286:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 5683              	 .loc 1 2286 0
 5684 000e 0423     	 movs r3,#4
 5685 0010 7B82     	 strh r3,[r7,#18]
2287:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t out_data_size;
2288:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t public_key_length;
2289:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 5686              	 .loc 1 2289 0
 5687 0012 40F20223 	 movw r3,#514
 5688 0016 BB83     	 strh r3,[r7,#28]
2290:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2291:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 5689              	 .loc 1 2291 0
 5690 0018 7B68     	 ldr r3,[r7,#4]
 5691 001a 9B7D     	 ldrb r3,[r3,#22]
 5692 001c 022B     	 cmp r3,#2
 5693 001e 02D0     	 beq .L307
 5694 0020 032B     	 cmp r3,#3
 5695 0022 6DD0     	 beq .L308
2292:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2293:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2294:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2295:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending generate keypair command..");
2296:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // APDU header length +
2297:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // If private key option to store in OID (TLV of private key + TLV of key usages)
2298:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // If private key option to export (TLV of export key pair)
2299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE +
2300:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (FALSE == p_optiga_ecc_gen_keypair->export_private_key ?
2301:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
2302:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CMD_TAG_LENGTH_SIZE ));
2303:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
2304:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2305:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2306:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *p_optiga_ecc_gen_keypair->public_key_length = 0;
2307:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
2308:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2309:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (FALSE == p_optiga_ecc_gen_keypair->export_private_key)
2310:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2311:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for private key OID
2312:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header (OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_TAG,
2313:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_LENGTH,
2314:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                me->p_optiga->optiga_comms_buffer,
2315:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
2316:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 ///Update OID based on input param
2317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2318:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
2319:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          me->session_oid:(uint16_t)p_optiga_ecc_gen_keypair->privat
2320:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2321:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2322:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for key usage
2323:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header (OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_TAG,
2324:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_LENGTH,
2325:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                me->p_optiga->optiga_comms_buffer,
2326:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
2327:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2328:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data++) = p_optiga_ecc_gen_keypair-
2329:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2330:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
2331:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2332:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for export key
2333:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header (OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_TAG,
2334:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_LENGTH,
2335:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                me->p_optiga->optiga_comms_buffer,
2336:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
2337:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2338:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2339:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //form apdu header
2340:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_GEN_KEYPAIR, me->cmd_param,
2341:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                             (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFS
2342:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OFFSET);
2343:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2344:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (uint16_t)(index_for_data - OPTIGA_COMMS_DATA_OFFSET);
2345:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2346:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2347:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2348:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2349:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2350:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2351:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for generate keypair command...");
2352:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if the write was successful
2353:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_FAILURE == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
2354:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2355:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing generate keypair response...");
2356:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *p_optiga_ecc_gen_keypair->public_key_length = 0;
2357:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2358:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2359:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
2360:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
2361:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2362:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             header_offset = 0;
2363:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFS
2364:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      &out_data_size);
2365:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2366:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             while (out_data_size > header_offset)
2367:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2368:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_CMD_GEN_KEY_PAIR_PUBLIC_KEY_TAG ==
2369:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + header_offset
2370:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2371:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_IND
2372:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                 header_offset + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &pu
2373:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     if (public_key_length > *p_optiga_ecc_gen_keypair->public_key_length)
2374:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     {
2375:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         OPTIGA_CMD_LOG_MESSAGE("Error in processing generate keypair response...");
2376:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2377:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         *p_optiga_ecc_gen_keypair->public_key_length = 0;
2378:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         break;
2379:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     }
2380:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     *p_optiga_ecc_gen_keypair->public_key_length = public_key_length;
2381:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     pal_os_memcpy(p_optiga_ecc_gen_keypair->public_key,
2382:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
2383:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                    OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_NO_OF_BYTES_IN_TAG]
2384:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                    *p_optiga_ecc_gen_keypair->public_key_length);
2385:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     header_offset +=  (uint16_t)OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_B
2386:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                         *p_optiga_ecc_gen_keypair->public_key_length;
2387:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
2388:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2389:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else if (OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_TAG == me->p_optiga->optiga_comms_buff
2390:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                              header_offset])
2391:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2392:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_IND
2393:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                              + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &private_key_length)
2394:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2395:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     pal_os_memcpy(p_optiga_ecc_gen_keypair->private_key,
2396:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
2397:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TAG], 
2398:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     header_offset +=  OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TA
2399:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
2400:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2401:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 else
2402:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2403:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
2404:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2405:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2406:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of generate keypair command is processed...");
2407:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2408:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2409:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
2410:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 5696              	 .loc 1 2410 0
 5697 0024 03E1     	 b .L312
 5698              	.L307:
2300:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (OPTIGA_CMD_TAG_LENGTH_SIZE + OPTIGA_CMD_UINT16_SIZE_IN_BYTES +
 5699              	 .loc 1 2300 0
 5700 0026 BB69     	 ldr r3,[r7,#24]
 5701 0028 5B78     	 ldrb r3,[r3,#1]
2299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (FALSE == p_optiga_ecc_gen_keypair->export_private_key ?
 5702              	 .loc 1 2299 0
 5703 002a 002B     	 cmp r3,#0
 5704 002c 01D1     	 bne .L309
2299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (FALSE == p_optiga_ecc_gen_keypair->export_private_key ?
 5705              	 .loc 1 2299 0 is_stmt 0 discriminator 1
 5706 002e 0D23     	 movs r3,#13
 5707 0030 00E0     	 b .L310
 5708              	.L309:
2299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (FALSE == p_optiga_ecc_gen_keypair->export_private_key ?
 5709              	 .loc 1 2299 0 discriminator 2
 5710 0032 0723     	 movs r3,#7
 5711              	.L310:
2299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                     (FALSE == p_optiga_ecc_gen_keypair->export_private_key ?
 5712              	 .loc 1 2299 0 discriminator 4
 5713 0034 FB82     	 strh r3,[r7,#22]
2303:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5714              	 .loc 1 2303 0 is_stmt 1 discriminator 4
 5715 0036 FB8A     	 ldrh r3,[r7,#22]
 5716 0038 40F21562 	 movw r2,#1557
 5717 003c 9342     	 cmp r3,r2
 5718 003e 07D9     	 bls .L311
2305:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *p_optiga_ecc_gen_keypair->public_key_length = 0;
 5719              	 .loc 1 2305 0
 5720 0040 4FF40173 	 mov r3,#516
 5721 0044 BB83     	 strh r3,[r7,#28]
2306:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 5722              	 .loc 1 2306 0
 5723 0046 BB69     	 ldr r3,[r7,#24]
 5724 0048 1B69     	 ldr r3,[r3,#16]
 5725 004a 0022     	 movs r2,#0
 5726 004c 1A80     	 strh r2,[r3]
2307:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5727              	 .loc 1 2307 0
 5728 004e EEE0     	 b .L312
 5729              	.L311:
2309:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5730              	 .loc 1 2309 0
 5731 0050 BB69     	 ldr r3,[r7,#24]
 5732 0052 5B78     	 ldrb r3,[r3,#1]
 5733 0054 002B     	 cmp r3,#0
 5734 0056 37D1     	 bne .L313
2314:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
 5735              	 .loc 1 2314 0
 5736 0058 7B68     	 ldr r3,[r7,#4]
 5737 005a 1B68     	 ldr r3,[r3]
 5738 005c 03F10D02 	 add r2,r3,#13
2312:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_PRIVATE_KEY_OID_LENGTH,
 5739              	 .loc 1 2312 0
 5740 0060 07F11203 	 add r3,r7,#18
 5741 0064 0120     	 movs r0,#1
 5742 0066 0221     	 movs r1,#2
 5743 0068 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 5744              	 .loc 1 2317 0
 5745 006c 7B68     	 ldr r3,[r7,#4]
 5746 006e 1A68     	 ldr r2,[r3]
 5747 0070 7B8A     	 ldrh r3,[r7,#18]
 5748 0072 0833     	 adds r3,r3,#8
 5749 0074 1344     	 add r3,r3,r2
 5750 0076 5A1D     	 adds r2,r3,#5
2318:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          me->session_oid:(uint16_t)p_optiga_ecc_gen_keypair->privat
 5751              	 .loc 1 2318 0
 5752 0078 BB69     	 ldr r3,[r7,#24]
 5753 007a 5B88     	 ldrh r3,[r3,#2]
2317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 5754              	 .loc 1 2317 0
 5755 007c 002B     	 cmp r3,#0
 5756 007e 02D1     	 bne .L314
2317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 5757              	 .loc 1 2317 0 is_stmt 0 discriminator 1
 5758 0080 7B68     	 ldr r3,[r7,#4]
 5759 0082 9B8A     	 ldrh r3,[r3,#20]
 5760 0084 01E0     	 b .L315
 5761              	.L314:
2317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 5762              	 .loc 1 2317 0 discriminator 2
 5763 0086 BB69     	 ldr r3,[r7,#24]
 5764 0088 5B88     	 ldrh r3,[r3,#2]
 5765              	.L315:
2317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair-
 5766              	 .loc 1 2317 0 discriminator 4
 5767 008a 1046     	 mov r0,r2
 5768 008c 1946     	 mov r1,r3
 5769 008e FFF7FEFF 	 bl optiga_common_set_uint16
2321:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 ///TLV formation for key usage
 5770              	 .loc 1 2321 0 is_stmt 1 discriminator 4
 5771 0092 7B8A     	 ldrh r3,[r7,#18]
 5772 0094 0233     	 adds r3,r3,#2
 5773 0096 9BB2     	 uxth r3,r3
 5774 0098 7B82     	 strh r3,[r7,#18]
2325:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
 5775              	 .loc 1 2325 0 discriminator 4
 5776 009a 7B68     	 ldr r3,[r7,#4]
 5777 009c 1B68     	 ldr r3,[r3]
 5778 009e 03F10D02 	 add r2,r3,#13
2323:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_KEY_USAGE_LENGTH,
 5779              	 .loc 1 2323 0 discriminator 4
 5780 00a2 07F11203 	 add r3,r7,#18
 5781 00a6 0220     	 movs r0,#2
 5782 00a8 0121     	 movs r1,#1
 5783 00aa FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2328:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5784              	 .loc 1 2328 0 discriminator 4
 5785 00ae 7B68     	 ldr r3,[r7,#4]
 5786 00b0 1A68     	 ldr r2,[r3]
 5787 00b2 7B8A     	 ldrh r3,[r7,#18]
 5788 00b4 591C     	 adds r1,r3,#1
 5789 00b6 89B2     	 uxth r1,r1
 5790 00b8 7982     	 strh r1,[r7,#18]
 5791 00ba 1846     	 mov r0,r3
 5792 00bc BB69     	 ldr r3,[r7,#24]
 5793 00be 1978     	 ldrb r1,[r3]
 5794 00c0 1318     	 adds r3,r2,r0
 5795 00c2 0A46     	 mov r2,r1
 5796 00c4 5A73     	 strb r2,[r3,#13]
 5797 00c6 09E0     	 b .L316
 5798              	.L313:
2335:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                &index_for_data);
 5799              	 .loc 1 2335 0
 5800 00c8 7B68     	 ldr r3,[r7,#4]
 5801 00ca 1B68     	 ldr r3,[r3]
 5802 00cc 03F10D02 	 add r2,r3,#13
2333:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_GEN_KEY_PAIR_EXPORT_KEY_LENGTH,
 5803              	 .loc 1 2333 0
 5804 00d0 07F11203 	 add r3,r7,#18
 5805 00d4 0720     	 movs r0,#7
 5806 00d6 0021     	 movs r1,#0
 5807 00d8 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 5808              	.L316:
2340:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                             (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFS
 5809              	 .loc 1 2340 0
 5810 00dc 7B68     	 ldr r3,[r7,#4]
 5811 00de 597E     	 ldrb r1,[r3,#25]
 5812 00e0 7B8A     	 ldrh r3,[r7,#18]
 5813 00e2 043B     	 subs r3,r3,#4
 5814 00e4 9AB2     	 uxth r2,r3
2342:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5815              	 .loc 1 2342 0
 5816 00e6 7B68     	 ldr r3,[r7,#4]
 5817 00e8 1B68     	 ldr r3,[r3]
 5818 00ea 0D33     	 adds r3,r3,#13
2340:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                             (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFS
 5819              	 .loc 1 2340 0
 5820 00ec B820     	 movs r0,#184
 5821 00ee FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
2344:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5822              	 .loc 1 2344 0
 5823 00f2 7B68     	 ldr r3,[r7,#4]
 5824 00f4 1B68     	 ldr r3,[r3]
 5825 00f6 7A8A     	 ldrh r2,[r7,#18]
 5826 00f8 9A80     	 strh r2,[r3,#4]
2346:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 5827              	 .loc 1 2346 0
 5828 00fa 0023     	 movs r3,#0
 5829 00fc BB83     	 strh r3,[r7,#28]
2348:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 5830              	 .loc 1 2348 0
 5831 00fe 96E0     	 b .L312
 5832              	.L308:
2353:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5833              	 .loc 1 2353 0
 5834 0100 7B68     	 ldr r3,[r7,#4]
 5835 0102 1B68     	 ldr r3,[r3]
 5836 0104 5B7B     	 ldrb r3,[r3,#13]
 5837 0106 FF2B     	 cmp r3,#255
 5838 0108 0FD1     	 bne .L317
2356:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
 5839              	 .loc 1 2356 0
 5840 010a BB69     	 ldr r3,[r7,#24]
 5841 010c 1B69     	 ldr r3,[r3,#16]
 5842 010e 0022     	 movs r2,#0
 5843 0110 1A80     	 strh r2,[r3]
2359:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 5844              	 .loc 1 2359 0
 5845 0112 7B68     	 ldr r3,[r7,#4]
 5846 0114 9B7E     	 ldrb r3,[r3,#26]
 5847 0116 03F07F03 	 and r3,r3,#127
 5848 011a DAB2     	 uxtb r2,r3
 5849 011c 7B68     	 ldr r3,[r7,#4]
 5850 011e 9A76     	 strb r2,[r3,#26]
 5851 0120 7B68     	 ldr r3,[r7,#4]
 5852 0122 9A7E     	 ldrb r2,[r3,#26]
 5853 0124 7B68     	 ldr r3,[r7,#4]
 5854 0126 9A76     	 strb r2,[r3,#26]
2360:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 5855              	 .loc 1 2360 0
 5856 0128 81E0     	 b .L312
 5857              	.L317:
2362:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFS
 5858              	 .loc 1 2362 0
 5859 012a 0023     	 movs r3,#0
 5860 012c FB83     	 strh r3,[r7,#30]
2363:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                      &out_data_size);
 5861              	 .loc 1 2363 0
 5862 012e 7B68     	 ldr r3,[r7,#4]
 5863 0130 1B68     	 ldr r3,[r3]
 5864 0132 03F10F02 	 add r2,r3,#15
 5865 0136 07F11003 	 add r3,r7,#16
 5866 013a 1046     	 mov r0,r2
 5867 013c 1946     	 mov r1,r3
 5868 013e FFF7FEFF 	 bl optiga_common_get_uint16
2366:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 5869              	 .loc 1 2366 0
 5870 0142 6FE0     	 b .L318
 5871              	.L323:
2369:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 5872              	 .loc 1 2369 0
 5873 0144 7B68     	 ldr r3,[r7,#4]
 5874 0146 1A68     	 ldr r2,[r3]
 5875 0148 FB8B     	 ldrh r3,[r7,#30]
 5876 014a 0433     	 adds r3,r3,#4
 5877 014c 1344     	 add r3,r3,r2
 5878 014e 5B7B     	 ldrb r3,[r3,#13]
2368:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + header_offset
 5879              	 .loc 1 2368 0
 5880 0150 022B     	 cmp r3,#2
 5881 0152 3AD1     	 bne .L319
2371:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                 header_offset + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &pu
 5882              	 .loc 1 2371 0
 5883 0154 7B68     	 ldr r3,[r7,#4]
 5884 0156 1A68     	 ldr r2,[r3]
2372:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     if (public_key_length > *p_optiga_ecc_gen_keypair->public_key_length)
 5885              	 .loc 1 2372 0
 5886 0158 FB8B     	 ldrh r3,[r7,#30]
 5887 015a 0533     	 adds r3,r3,#5
2371:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                 header_offset + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &pu
 5888              	 .loc 1 2371 0
 5889 015c 0833     	 adds r3,r3,#8
 5890 015e 1344     	 add r3,r3,r2
 5891 0160 5A1D     	 adds r2,r3,#5
 5892 0162 07F10E03 	 add r3,r7,#14
 5893 0166 1046     	 mov r0,r2
 5894 0168 1946     	 mov r1,r3
 5895 016a FFF7FEFF 	 bl optiga_common_get_uint16
2373:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     {
 5896              	 .loc 1 2373 0
 5897 016e BB69     	 ldr r3,[r7,#24]
 5898 0170 1B69     	 ldr r3,[r3,#16]
 5899 0172 1A88     	 ldrh r2,[r3]
 5900 0174 FB89     	 ldrh r3,[r7,#14]
 5901 0176 9A42     	 cmp r2,r3
 5902 0178 07D2     	 bcs .L320
2376:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         *p_optiga_ecc_gen_keypair->public_key_length = 0;
 5903              	 .loc 1 2376 0
 5904 017a 4FF40173 	 mov r3,#516
 5905 017e BB83     	 strh r3,[r7,#28]
2377:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                         break;
 5906              	 .loc 1 2377 0
 5907 0180 BB69     	 ldr r3,[r7,#24]
 5908 0182 1B69     	 ldr r3,[r3,#16]
 5909 0184 0022     	 movs r2,#0
 5910 0186 1A80     	 strh r2,[r3]
2378:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     }
 5911              	 .loc 1 2378 0
 5912 0188 50E0     	 b .L321
 5913              	.L320:
2380:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     pal_os_memcpy(p_optiga_ecc_gen_keypair->public_key,
 5914              	 .loc 1 2380 0
 5915 018a BB69     	 ldr r3,[r7,#24]
 5916 018c 1B69     	 ldr r3,[r3,#16]
 5917 018e FA89     	 ldrh r2,[r7,#14]
 5918 0190 1A80     	 strh r2,[r3]
2381:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
 5919              	 .loc 1 2381 0
 5920 0192 BB69     	 ldr r3,[r7,#24]
 5921 0194 D968     	 ldr r1,[r3,#12]
2382:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                    OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_NO_OF_BYTES_IN_TAG]
 5922              	 .loc 1 2382 0
 5923 0196 7B68     	 ldr r3,[r7,#4]
 5924 0198 1A68     	 ldr r2,[r3]
2383:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                    *p_optiga_ecc_gen_keypair->public_key_length);
 5925              	 .loc 1 2383 0
 5926 019a FB8B     	 ldrh r3,[r7,#30]
 5927 019c 0733     	 adds r3,r3,#7
2382:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                    OPTIGA_CMD_UINT16_SIZE_IN_BYTES + OPTIGA_CMD_NO_OF_BYTES_IN_TAG]
 5928              	 .loc 1 2382 0
 5929 019e 0833     	 adds r3,r3,#8
 5930 01a0 1344     	 add r3,r3,r2
 5931 01a2 5A1D     	 adds r2,r3,#5
2384:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     header_offset +=  (uint16_t)OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_B
 5932              	 .loc 1 2384 0
 5933 01a4 BB69     	 ldr r3,[r7,#24]
 5934 01a6 1B69     	 ldr r3,[r3,#16]
 5935 01a8 1B88     	 ldrh r3,[r3]
2381:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
 5936              	 .loc 1 2381 0
 5937 01aa 0846     	 mov r0,r1
 5938 01ac 1146     	 mov r1,r2
 5939 01ae 1A46     	 mov r2,r3
 5940 01b0 FFF7FEFF 	 bl pal_os_memcpy
2386:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
 5941              	 .loc 1 2386 0
 5942 01b4 BB69     	 ldr r3,[r7,#24]
 5943 01b6 1B69     	 ldr r3,[r3,#16]
 5944 01b8 1A88     	 ldrh r2,[r3]
2385:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                         *p_optiga_ecc_gen_keypair->public_key_length;
 5945              	 .loc 1 2385 0
 5946 01ba FB8B     	 ldrh r3,[r7,#30]
 5947 01bc 1344     	 add r3,r3,r2
 5948 01be 9BB2     	 uxth r3,r3
 5949 01c0 0333     	 adds r3,r3,#3
 5950 01c2 FB83     	 strh r3,[r7,#30]
2387:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 5951              	 .loc 1 2387 0
 5952 01c4 0023     	 movs r3,#0
 5953 01c6 BB83     	 strh r3,[r7,#28]
 5954 01c8 2CE0     	 b .L318
 5955              	.L319:
2389:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                              header_offset])
 5956              	 .loc 1 2389 0
 5957 01ca 7B68     	 ldr r3,[r7,#4]
 5958 01cc 1A68     	 ldr r2,[r3]
 5959 01ce FB8B     	 ldrh r3,[r7,#30]
 5960 01d0 0433     	 adds r3,r3,#4
 5961 01d2 1344     	 add r3,r3,r2
 5962 01d4 5B7B     	 ldrb r3,[r3,#13]
 5963 01d6 012B     	 cmp r3,#1
 5964 01d8 23D1     	 bne .L322
2392:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                              + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &private_key_length)
 5965              	 .loc 1 2392 0
 5966 01da 7B68     	 ldr r3,[r7,#4]
 5967 01dc 1A68     	 ldr r2,[r3]
2393:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 5968              	 .loc 1 2393 0
 5969 01de FB8B     	 ldrh r3,[r7,#30]
 5970 01e0 0533     	 adds r3,r3,#5
2392:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                              + OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &private_key_length)
 5971              	 .loc 1 2392 0
 5972 01e2 0833     	 adds r3,r3,#8
 5973 01e4 1344     	 add r3,r3,r2
 5974 01e6 5A1D     	 adds r2,r3,#5
 5975 01e8 07F11403 	 add r3,r7,#20
 5976 01ec 1046     	 mov r0,r2
 5977 01ee 1946     	 mov r1,r3
 5978 01f0 FFF7FEFF 	 bl optiga_common_get_uint16
2395:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
 5979              	 .loc 1 2395 0
 5980 01f4 BB69     	 ldr r3,[r7,#24]
 5981 01f6 5968     	 ldr r1,[r3,#4]
2396:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TAG], 
 5982              	 .loc 1 2396 0
 5983 01f8 7B68     	 ldr r3,[r7,#4]
 5984 01fa 1A68     	 ldr r2,[r3]
2397:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     header_offset +=  OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TA
 5985              	 .loc 1 2397 0
 5986 01fc FB8B     	 ldrh r3,[r7,#30]
 5987 01fe 0733     	 adds r3,r3,#7
2396:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   OPTIGA_CMD_UINT16_SIZE_IN_BYTES+ OPTIGA_CMD_NO_OF_BYTES_IN_TAG], 
 5988              	 .loc 1 2396 0
 5989 0200 0833     	 adds r3,r3,#8
 5990 0202 1344     	 add r3,r3,r2
 5991 0204 0533     	 adds r3,r3,#5
2395:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                   &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET 
 5992              	 .loc 1 2395 0
 5993 0206 BA8A     	 ldrh r2,[r7,#20]
 5994 0208 0846     	 mov r0,r1
 5995 020a 1946     	 mov r1,r3
 5996 020c FFF7FEFF 	 bl pal_os_memcpy
2398:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_LIB_SUCCESS;
 5997              	 .loc 1 2398 0
 5998 0210 BA8A     	 ldrh r2,[r7,#20]
 5999 0212 FB8B     	 ldrh r3,[r7,#30]
 6000 0214 1344     	 add r3,r3,r2
 6001 0216 9BB2     	 uxth r3,r3
 6002 0218 0333     	 adds r3,r3,#3
 6003 021a FB83     	 strh r3,[r7,#30]
2399:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 6004              	 .loc 1 2399 0
 6005 021c 0023     	 movs r3,#0
 6006 021e BB83     	 strh r3,[r7,#28]
 6007 0220 00E0     	 b .L318
 6008              	.L322:
2403:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 6009              	 .loc 1 2403 0
 6010 0222 03E0     	 b .L321
 6011              	.L318:
2366:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6012              	 .loc 1 2366 0
 6013 0224 3B8A     	 ldrh r3,[r7,#16]
 6014 0226 FA8B     	 ldrh r2,[r7,#30]
 6015 0228 9A42     	 cmp r2,r3
 6016 022a 8BD3     	 bcc .L323
 6017              	.L321:
2408:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 6018              	 .loc 1 2408 0 discriminator 1
 6019 022c 00BF     	 nop
 6020              	.L312:
2411:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2412:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2413:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 6021              	 .loc 1 2413 0
 6022 022e BB8B     	 ldrh r3,[r7,#28]
2414:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 6023              	 .loc 1 2414 0
 6024 0230 1846     	 mov r0,r3
 6025 0232 2037     	 adds r7,r7,#32
 6026              	.LCFI236:
 6027              	 .cfi_def_cfa_offset 8
 6028 0234 BD46     	 mov sp,r7
 6029              	.LCFI237:
 6030              	 .cfi_def_cfa_register 13
 6031              	 
 6032 0236 80BD     	 pop {r7,pc}
 6033              	 .cfi_endproc
 6034              	.LFE45:
 6036              	 .section .text.optiga_cmd_gen_keypair,"ax",%progbits
 6037              	 .align 2
 6038              	 .global optiga_cmd_gen_keypair
 6039              	 .thumb
 6040              	 .thumb_func
 6042              	optiga_cmd_gen_keypair:
 6043              	.LFB46:
2415:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2416:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_gen_keypair(optiga_cmd_t * me, uint8_t cmd_param, optiga_gen_keypair
2417:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 6044              	 .loc 1 2417 0
 6045              	 .cfi_startproc
 6046              	 
 6047              	 
 6048 0000 80B5     	 push {r7,lr}
 6049              	.LCFI238:
 6050              	 .cfi_def_cfa_offset 8
 6051              	 .cfi_offset 7,-8
 6052              	 .cfi_offset 14,-4
 6053 0002 8AB0     	 sub sp,sp,#40
 6054              	.LCFI239:
 6055              	 .cfi_def_cfa_offset 48
 6056 0004 04AF     	 add r7,sp,#16
 6057              	.LCFI240:
 6058              	 .cfi_def_cfa 7,32
 6059 0006 F860     	 str r0,[r7,#12]
 6060 0008 0B46     	 mov r3,r1
 6061 000a 7A60     	 str r2,[r7,#4]
 6062 000c FB72     	 strb r3,[r7,#11]
2418:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_gen_keypair_params_t * p_optiga_ecc_gen_keypair = (optiga_gen_keypair_params_t*)params;
 6063              	 .loc 1 2418 0
 6064 000e 7B68     	 ldr r3,[r7,#4]
 6065 0010 7B61     	 str r3,[r7,#20]
2419:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2420:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2421:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if ((OPTIGA_KEY_ID_SESSION_BASED == p_optiga_ecc_gen_keypair->private_key_oid)
 6066              	 .loc 1 2421 0
 6067 0012 7B69     	 ldr r3,[r7,#20]
 6068 0014 5B88     	 ldrh r3,[r3,#2]
 6069 0016 002B     	 cmp r3,#0
 6070 0018 11D1     	 bne .L326
2422:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         && (FALSE == p_optiga_ecc_gen_keypair->export_private_key))
 6071              	 .loc 1 2422 0
 6072 001a 7B69     	 ldr r3,[r7,#20]
 6073 001c 5B78     	 ldrb r3,[r3,#1]
 6074 001e 002B     	 cmp r3,#0
 6075 0020 0DD1     	 bne .L326
2423:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2424:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_cmd_execute(me,
 6076              	 .loc 1 2424 0
 6077 0022 FA7A     	 ldrb r2,[r7,#11]
 6078 0024 0523     	 movs r3,#5
 6079 0026 0093     	 str r3,[sp]
 6080 0028 7B68     	 ldr r3,[r7,#4]
 6081 002a 0193     	 str r3,[sp,#4]
 6082 002c B823     	 movs r3,#184
 6083 002e 0293     	 str r3,[sp,#8]
 6084 0030 F868     	 ldr r0,[r7,#12]
 6085 0032 1146     	 mov r1,r2
 6086 0034 0B4A     	 ldr r2,.L329
 6087 0036 0223     	 movs r3,#2
 6088 0038 FFF7FEFF 	 bl optiga_cmd_execute
 6089 003c 0CE0     	 b .L327
 6090              	.L326:
2425:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            cmd_param,
2426:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            optiga_cmd_gen_keypair_handler,
2427:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2428:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_REQUEST_SESSION,
2429:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            params,
2430:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and 
2431:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_GEN_KEYPAIR, OPTIGA_CMD_ZERO_LENGTH_
2432:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2433:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     else
2434:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2435:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_cmd_execute(me,
 6091              	 .loc 1 2435 0
 6092 003e FA7A     	 ldrb r2,[r7,#11]
 6093 0040 0623     	 movs r3,#6
 6094 0042 0093     	 str r3,[sp]
 6095 0044 7B68     	 ldr r3,[r7,#4]
 6096 0046 0193     	 str r3,[sp,#4]
 6097 0048 B823     	 movs r3,#184
 6098 004a 0293     	 str r3,[sp,#8]
 6099 004c F868     	 ldr r0,[r7,#12]
 6100 004e 1146     	 mov r1,r2
 6101 0050 044A     	 ldr r2,.L329
 6102 0052 0223     	 movs r3,#2
 6103 0054 FFF7FEFF 	 bl optiga_cmd_execute
 6104              	.L327:
2436:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            cmd_param,
2437:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            optiga_cmd_gen_keypair_handler,
2438:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2439:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_EXEC_REQUEST_LOCK,
2440:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            params,
2441:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and 
2442:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_GEN_KEYPAIR, OPTIGA_CMD_ZERO_LENGTH_
2443:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2444:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2445:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
 6105              	 .loc 1 2445 0
 6106 0058 0023     	 movs r3,#0
2446:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 6107              	 .loc 1 2446 0
 6108 005a 1846     	 mov r0,r3
 6109 005c 1837     	 adds r7,r7,#24
 6110              	.LCFI241:
 6111              	 .cfi_def_cfa_offset 8
 6112 005e BD46     	 mov sp,r7
 6113              	.LCFI242:
 6114              	 .cfi_def_cfa_register 13
 6115              	 
 6116 0060 80BD     	 pop {r7,pc}
 6117              	.L330:
 6118 0062 00BF     	 .align 2
 6119              	.L329:
 6120 0064 00000000 	 .word optiga_cmd_gen_keypair_handler
 6121              	 .cfi_endproc
 6122              	.LFE46:
 6124              	 .section .text.optiga_cmd_calc_hash_set_current_hash_sequence,"ax",%progbits
 6125              	 .align 2
 6126              	 .thumb
 6127              	 .thumb_func
 6129              	optiga_cmd_calc_hash_set_current_hash_sequence:
 6130              	.LFB47:
2447:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_ECC_GENERATE_KEYPAIR_ENABLED
2448:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2449:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #ifdef OPTIGA_CRYPT_HASH_ENABLED
2450:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2451:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H void optiga_cmd_calc_hash_set_current_hash_sequence(const optiga_cmd_t * me)
2452:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 6131              	 .loc 1 2452 0
 6132              	 .cfi_startproc
 6133              	 
 6134              	 
 6135              	 
 6136 0000 80B4     	 push {r7}
 6137              	.LCFI243:
 6138              	 .cfi_def_cfa_offset 4
 6139              	 .cfi_offset 7,-4
 6140 0002 85B0     	 sub sp,sp,#20
 6141              	.LCFI244:
 6142              	 .cfi_def_cfa_offset 24
 6143 0004 00AF     	 add r7,sp,#0
 6144              	.LCFI245:
 6145              	 .cfi_def_cfa_register 7
 6146 0006 7860     	 str r0,[r7,#4]
2453:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t *)me->p_input;
 6147              	 .loc 1 2453 0
 6148 0008 7B68     	 ldr r3,[r7,#4]
 6149 000a 9B68     	 ldr r3,[r3,#8]
 6150 000c FB60     	 str r3,[r7,#12]
2454:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint32_t apparent_comms_buffer_size = (OPTIGA_MAX_COMMS_BUFFER_SIZE - (OPTIGA_CMD_APDU_INDATA_O
 6151              	 .loc 1 2454 0
 6152 000e 4FF4C163 	 mov r3,#1544
 6153 0012 BB60     	 str r3,[r7,#8]
2455:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           + OPTIGA_CMD_INTERMEDIATE_CONTEXT_HEADER));
2456:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2457:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     p_optiga_calc_hash->current_hash_sequence = p_optiga_calc_hash->hash_sequence;
 6154              	 .loc 1 2457 0
 6155 0014 FB68     	 ldr r3,[r7,#12]
 6156 0016 1A7B     	 ldrb r2,[r3,#12]
 6157 0018 FB68     	 ldr r3,[r7,#12]
 6158 001a 5A73     	 strb r2,[r3,#13]
2458:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2459:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // Check for hash sequence as S&F
2460:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if(OPTIGA_CRYPT_HASH_START_FINAL == p_optiga_calc_hash->hash_sequence)
 6159              	 .loc 1 2460 0
 6160 001c FB68     	 ldr r3,[r7,#12]
 6161 001e 1B7B     	 ldrb r3,[r3,#12]
 6162 0020 012B     	 cmp r3,#1
 6163 0022 1DD1     	 bne .L331
2461:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2462:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         // Calculate the apparent comms buffer size and compare with hash data length
2463:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if(apparent_comms_buffer_size < p_optiga_calc_hash->p_hash_data->length)
 6164              	 .loc 1 2463 0
 6165 0024 FB68     	 ldr r3,[r7,#12]
 6166 0026 5B68     	 ldr r3,[r3,#4]
 6167 0028 5A68     	 ldr r2,[r3,#4]
 6168 002a BB68     	 ldr r3,[r7,#8]
 6169 002c 9A42     	 cmp r2,r3
 6170 002e 17D9     	 bls .L331
2464:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2465:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // sent data is 0 hence change the hash sequence to S
2466:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if( 0 == p_optiga_calc_hash->data_sent)
 6171              	 .loc 1 2466 0
 6172 0030 FB68     	 ldr r3,[r7,#12]
 6173 0032 1B69     	 ldr r3,[r3,#16]
 6174 0034 002B     	 cmp r3,#0
 6175 0036 03D1     	 bne .L333
2467:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2468:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->current_hash_sequence = OPTIGA_CRYPT_HASH_START;
 6176              	 .loc 1 2468 0
 6177 0038 FB68     	 ldr r3,[r7,#12]
 6178 003a 0022     	 movs r2,#0
 6179 003c 5A73     	 strb r2,[r3,#13]
 6180 003e 0FE0     	 b .L331
 6181              	.L333:
2469:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2470:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // sent data is greater than 0 and next fragment is greater than apparent_comms_buffer_
2471:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else if((p_optiga_calc_hash->data_sent + apparent_comms_buffer_size) < p_optiga_calc_ha
 6182              	 .loc 1 2471 0
 6183 0040 FB68     	 ldr r3,[r7,#12]
 6184 0042 1A69     	 ldr r2,[r3,#16]
 6185 0044 BB68     	 ldr r3,[r7,#8]
 6186 0046 1A44     	 add r2,r2,r3
 6187 0048 FB68     	 ldr r3,[r7,#12]
 6188 004a 5B68     	 ldr r3,[r3,#4]
 6189 004c 5B68     	 ldr r3,[r3,#4]
 6190 004e 9A42     	 cmp r2,r3
 6191 0050 03D2     	 bcs .L334
2472:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2473:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->current_hash_sequence = OPTIGA_CRYPT_HASH_CONTINUE;
 6192              	 .loc 1 2473 0
 6193 0052 FB68     	 ldr r3,[r7,#12]
 6194 0054 0222     	 movs r2,#2
 6195 0056 5A73     	 strb r2,[r3,#13]
 6196 0058 02E0     	 b .L331
 6197              	.L334:
2474:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2475:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // sent data is greater than 0 and next fragment is less than apparent_comms_buffer_siz
2476:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
2477:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2478:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->current_hash_sequence = OPTIGA_CRYPT_HASH_FINAL;
 6198              	 .loc 1 2478 0
 6199 005a FB68     	 ldr r3,[r7,#12]
 6200 005c 0322     	 movs r2,#3
 6201 005e 5A73     	 strb r2,[r3,#13]
 6202              	.L331:
2479:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2480:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2481:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2482:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 6203              	 .loc 1 2482 0
 6204 0060 1437     	 adds r7,r7,#20
 6205              	.LCFI246:
 6206              	 .cfi_def_cfa_offset 4
 6207 0062 BD46     	 mov sp,r7
 6208              	.LCFI247:
 6209              	 .cfi_def_cfa_register 13
 6210              	 
 6211 0064 5DF8047B 	 ldr r7,[sp],#4
 6212              	.LCFI248:
 6213              	 .cfi_restore 7
 6214              	 .cfi_def_cfa_offset 0
 6215 0068 7047     	 bx lr
 6216              	 .cfi_endproc
 6217              	.LFE47:
 6219 006a 00BF     	 .section .text.optiga_cmd_calc_hash_handler,"ax",%progbits
 6220              	 .align 2
 6221              	 .thumb
 6222              	 .thumb_func
 6224              	optiga_cmd_calc_hash_handler:
 6225              	.LFB48:
2483:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2484:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
2485:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * CalCHash handler
2486:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
2487:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_calc_hash_handler(optiga_cmd_t * me)
2488:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 6226              	 .loc 1 2488 0
 6227              	 .cfi_startproc
 6228              	 
 6229              	 
 6230 0000 90B5     	 push {r4,r7,lr}
 6231              	.LCFI249:
 6232              	 .cfi_def_cfa_offset 12
 6233              	 .cfi_offset 4,-12
 6234              	 .cfi_offset 7,-8
 6235              	 .cfi_offset 14,-4
 6236 0002 87B0     	 sub sp,sp,#28
 6237              	.LCFI250:
 6238              	 .cfi_def_cfa_offset 40
 6239 0004 00AF     	 add r7,sp,#0
 6240              	.LCFI251:
 6241              	 .cfi_def_cfa_register 7
 6242 0006 7860     	 str r0,[r7,#4]
2489:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t *)me->p_input;
 6243              	 .loc 1 2489 0
 6244 0008 7B68     	 ldr r3,[r7,#4]
 6245 000a 9B68     	 ldr r3,[r3,#8]
 6246 000c 3B61     	 str r3,[r7,#16]
2490:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 6247              	 .loc 1 2490 0
 6248 000e 0423     	 movs r3,#4
 6249 0010 7B81     	 strh r3,[r7,#10]
2491:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t out_data_size;
2492:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint32_t length_to_hash;
2493:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 6250              	 .loc 1 2493 0
 6251 0012 40F20223 	 movw r3,#514
 6252 0016 FB82     	 strh r3,[r7,#22]
2494:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2495:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2496:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 6253              	 .loc 1 2496 0
 6254 0018 7B68     	 ldr r3,[r7,#4]
 6255 001a 9B7D     	 ldrb r3,[r3,#22]
 6256 001c 022B     	 cmp r3,#2
 6257 001e 03D0     	 beq .L337
 6258 0020 032B     	 cmp r3,#3
 6259 0022 00F01581 	 beq .L338
2497:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2498:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2499:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2500:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_calc_hash_set_current_hash_sequence(me);
2501:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending calculate hash command..");
2502:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //Hash Input
2503:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // tag setting
2504:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->chaining_ongoing = FALSE;
2505:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2506:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // add data if available
2507:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (NULL != p_optiga_calc_hash->p_hash_data)
2508:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2509:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                  //lint --e{734} suppress "length_to_hash parameter is of uint16 type, while the ar
2510:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                  //calculating are of uint32 type. The final value calculated never crosses uint16 
2511:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                  // future use case, explicit type-casting is not done "
2512:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 length_to_hash = MIN(((OPTIGA_MAX_COMMS_BUFFER_SIZE - (index_for_data + OPTIGA_CMD_
2513:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                        p_optiga_calc_hash->apparent_context_size),(p_optiga_calc_ha
2514:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2515:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data++) = p_optiga_calc_hash->curre
2516:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2517:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // add length
2518:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data), leng
2519:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2520:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2521:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2522:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_data->buffer + p_optiga_calc_hash->data_se
2523:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               length_to_hash);
2524:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += length_to_hash;
2525:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2526:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->data_sent += length_to_hash;
2527:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_calc_hash->data_sent != p_optiga_calc_hash->p_hash_data->length)
2528:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2529:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     me->chaining_ongoing = TRUE;
2530:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2531:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2532:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else if (NULL != p_optiga_calc_hash->p_hash_oid)
2533:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2534:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //OID data
2535:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(p_optiga_calc_hash->current_hash_sequence,
2536:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_OID_DATA_LENGTH,
2537:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2538:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               (uint16_t*)&index_for_data);
2539:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2540:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2541:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->oid);
2542:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2543:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2544:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->offset);
2545:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2546:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2547:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->length);
2548:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2549:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2550:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
2551:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2552:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // Tag header in case of sequence as START
2553:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header (p_optiga_calc_hash->current_hash_sequence,
2554:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
2555:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                me->p_optiga->optiga_comms_buffer,
2556:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                (uint16_t*)&index_for_data);
2557:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2558:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //Hash Context
2559:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if ((NULL != p_optiga_calc_hash->p_hash_context) &&
2560:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 (0 != p_optiga_calc_hash->apparent_context_size))
2561:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2562:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 *(me->p_optiga->optiga_comms_buffer + index_for_data++) = OPTIGA_CRYPT_INTERMEDIATE
2563:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
2564:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           (uint16_t )p_optiga_calc_hash->p_hash_context->context_bu
2565:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
2566:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2567:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2568:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_context->context_buffer,
2569:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               (uint16_t)p_optiga_calc_hash->p_hash_context->context_buffer_length);
2570:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2571:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += (uint16_t)p_optiga_calc_hash->p_hash_context->context_buffer_leng
2572:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->apparent_context_size = 0;
2573:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2574:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2575:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //Export Option
2576:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if((TRUE == p_optiga_calc_hash->export_hash_ctx) && (FALSE == me->chaining_ongoing))
2577:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2578:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_cmd_prepare_tag_header(OPTIGA_CRYPT_HASH_CONTX_OUT,
2579:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
2580:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               me->p_optiga->optiga_comms_buffer,
2581:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               (uint16_t*)&index_for_data);
2582:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2583:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2584:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             //form apdu header
2585:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_CALC_HASH,
2586:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
2587:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (uint16_t)(index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSE
2588:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
2589:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2590:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (uint16_t)(index_for_data - OPTIGA_COMMS_DATA_OFFSET);
2591:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2592:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2593:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2594:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2595:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2596:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for calculate hash command...");
2597:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check for response status code
2598:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_FAILURE == me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
2599:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2600:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing calculate hash response...");
2601:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2602:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2603:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
2604:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
2605:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2606:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // Copy the digest to buffer, if chaining is false and digest out buffer is not NULL
2607:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if((FALSE == me->chaining_ongoing) && (NULL != p_optiga_calc_hash->p_out_digest))
2608:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2609:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // If the out data tag is not the digest out then return failure
2610:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_CRYPT_HASH_START_FINAL != me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_A
2611:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2612:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                    break;
2613:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2614:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_
2615:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &out_data_size);
2616:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2617:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(p_optiga_calc_hash->p_out_digest,
2618:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
2619:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               OPTIGA_CMD_NO_OF_BYTES_IN_TAG], out_data_size);
2620:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2621:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // Copy the intermediate hash context
2622:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else if ((TRUE == p_optiga_calc_hash->export_hash_ctx) && (FALSE == me->chaining_ongoin
2623:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2624:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 // If the out data tag is not the intermediate tag then return failure
2625:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (OPTIGA_CRYPT_INTERMEDIATE != me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_
2626:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2627:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
2628:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2629:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2630:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_get_uint16(&me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_
2631:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &out_data_size);
2632:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_calc_hash->p_hash_context->context_buffer_length < out_data_size)
2633:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
2634:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     OPTIGA_CMD_LOG_MESSAGE("Error in processing calculate hash response...");
2635:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2636:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
2637:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
2638:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2639:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_memcpy(p_optiga_calc_hash->p_hash_context->context_buffer,
2640:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
2641:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               OPTIGA_CMD_NO_OF_BYTES_IN_TAG], out_data_size);
2642:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->p_hash_context->context_buffer_length = out_data_size;
2643:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2644:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of calculate hash command is processed...");
2645:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2646:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2647:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2648:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
2649:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 6260              	 .loc 1 2649 0
 6261 0026 83E1     	 b .L345
 6262              	.L337:
2500:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending calculate hash command..");
 6263              	 .loc 1 2500 0
 6264 0028 7868     	 ldr r0,[r7,#4]
 6265 002a FFF7FEFF 	 bl optiga_cmd_calc_hash_set_current_hash_sequence
2504:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6266              	 .loc 1 2504 0
 6267 002e 7B68     	 ldr r3,[r7,#4]
 6268 0030 0022     	 movs r2,#0
 6269 0032 1A76     	 strb r2,[r3,#24]
2507:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6270              	 .loc 1 2507 0
 6271 0034 3B69     	 ldr r3,[r7,#16]
 6272 0036 5B68     	 ldr r3,[r3,#4]
 6273 0038 002B     	 cmp r3,#0
 6274 003a 55D0     	 beq .L339
2512:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                        p_optiga_calc_hash->apparent_context_size),(p_optiga_calc_ha
 6275              	 .loc 1 2512 0
 6276 003c 3B69     	 ldr r3,[r7,#16]
 6277 003e 5B68     	 ldr r3,[r3,#4]
 6278 0040 5A68     	 ldr r2,[r3,#4]
 6279 0042 3B69     	 ldr r3,[r7,#16]
 6280 0044 1B69     	 ldr r3,[r3,#16]
 6281 0046 D21A     	 subs r2,r2,r3
 6282 0048 7B89     	 ldrh r3,[r7,#10]
 6283 004a 5B42     	 negs r3,r3
 6284 004c 1946     	 mov r1,r3
 6285 004e 3B69     	 ldr r3,[r7,#16]
 6286 0050 DB69     	 ldr r3,[r3,#28]
 6287 0052 CB1A     	 subs r3,r1,r3
 6288 0054 03F20C63 	 addw r3,r3,#1548
 6289 0058 9342     	 cmp r3,r2
 6290 005a 28BF     	 it cs
 6291 005c 1346     	 movcs r3,r2
 6292 005e FB60     	 str r3,[r7,#12]
2515:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6293              	 .loc 1 2515 0
 6294 0060 7B68     	 ldr r3,[r7,#4]
 6295 0062 1A68     	 ldr r2,[r3]
 6296 0064 7B89     	 ldrh r3,[r7,#10]
 6297 0066 591C     	 adds r1,r3,#1
 6298 0068 89B2     	 uxth r1,r1
 6299 006a 7981     	 strh r1,[r7,#10]
 6300 006c 1846     	 mov r0,r3
 6301 006e 3B69     	 ldr r3,[r7,#16]
 6302 0070 597B     	 ldrb r1,[r3,#13]
 6303 0072 1318     	 adds r3,r2,r0
 6304 0074 0A46     	 mov r2,r1
 6305 0076 5A73     	 strb r2,[r3,#13]
2518:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 6306              	 .loc 1 2518 0
 6307 0078 7B68     	 ldr r3,[r7,#4]
 6308 007a 1A68     	 ldr r2,[r3]
 6309 007c 7B89     	 ldrh r3,[r7,#10]
 6310 007e 0833     	 adds r3,r3,#8
 6311 0080 1344     	 add r3,r3,r2
 6312 0082 5A1D     	 adds r2,r3,#5
 6313 0084 FB68     	 ldr r3,[r7,#12]
 6314 0086 9BB2     	 uxth r3,r3
 6315 0088 1046     	 mov r0,r2
 6316 008a 1946     	 mov r1,r3
 6317 008c FFF7FEFF 	 bl optiga_common_set_uint16
2519:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6318              	 .loc 1 2519 0
 6319 0090 7B89     	 ldrh r3,[r7,#10]
 6320 0092 0233     	 adds r3,r3,#2
 6321 0094 9BB2     	 uxth r3,r3
 6322 0096 7B81     	 strh r3,[r7,#10]
2521:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_data->buffer + p_optiga_calc_hash->data_se
 6323              	 .loc 1 2521 0
 6324 0098 7B68     	 ldr r3,[r7,#4]
 6325 009a 1A68     	 ldr r2,[r3]
 6326 009c 7B89     	 ldrh r3,[r7,#10]
 6327 009e 0833     	 adds r3,r3,#8
 6328 00a0 1344     	 add r3,r3,r2
 6329 00a2 591D     	 adds r1,r3,#5
2522:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               length_to_hash);
 6330              	 .loc 1 2522 0
 6331 00a4 3B69     	 ldr r3,[r7,#16]
 6332 00a6 5B68     	 ldr r3,[r3,#4]
 6333 00a8 1A68     	 ldr r2,[r3]
 6334 00aa 3B69     	 ldr r3,[r7,#16]
 6335 00ac 1B69     	 ldr r3,[r3,#16]
2521:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_data->buffer + p_optiga_calc_hash->data_se
 6336              	 .loc 1 2521 0
 6337 00ae 1344     	 add r3,r3,r2
 6338 00b0 0846     	 mov r0,r1
 6339 00b2 1946     	 mov r1,r3
 6340 00b4 FA68     	 ldr r2,[r7,#12]
 6341 00b6 FFF7FEFF 	 bl pal_os_memcpy
2524:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6342              	 .loc 1 2524 0
 6343 00ba FB68     	 ldr r3,[r7,#12]
 6344 00bc 9AB2     	 uxth r2,r3
 6345 00be 7B89     	 ldrh r3,[r7,#10]
 6346 00c0 1344     	 add r3,r3,r2
 6347 00c2 9BB2     	 uxth r3,r3
 6348 00c4 7B81     	 strh r3,[r7,#10]
2526:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 if (p_optiga_calc_hash->data_sent != p_optiga_calc_hash->p_hash_data->length)
 6349              	 .loc 1 2526 0
 6350 00c6 3B69     	 ldr r3,[r7,#16]
 6351 00c8 1A69     	 ldr r2,[r3,#16]
 6352 00ca FB68     	 ldr r3,[r7,#12]
 6353 00cc 1A44     	 add r2,r2,r3
 6354 00ce 3B69     	 ldr r3,[r7,#16]
 6355 00d0 1A61     	 str r2,[r3,#16]
2527:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 6356              	 .loc 1 2527 0
 6357 00d2 3B69     	 ldr r3,[r7,#16]
 6358 00d4 1A69     	 ldr r2,[r3,#16]
 6359 00d6 3B69     	 ldr r3,[r7,#16]
 6360 00d8 5B68     	 ldr r3,[r3,#4]
 6361 00da 5B68     	 ldr r3,[r3,#4]
 6362 00dc 9A42     	 cmp r2,r3
 6363 00de 53D0     	 beq .L341
2529:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 6364              	 .loc 1 2529 0
 6365 00e0 7B68     	 ldr r3,[r7,#4]
 6366 00e2 0122     	 movs r2,#1
 6367 00e4 1A76     	 strb r2,[r3,#24]
 6368 00e6 4FE0     	 b .L341
 6369              	.L339:
2532:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6370              	 .loc 1 2532 0
 6371 00e8 3B69     	 ldr r3,[r7,#16]
 6372 00ea 1B68     	 ldr r3,[r3]
 6373 00ec 002B     	 cmp r3,#0
 6374 00ee 3FD0     	 beq .L342
2535:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_OID_DATA_LENGTH,
 6375              	 .loc 1 2535 0
 6376 00f0 3B69     	 ldr r3,[r7,#16]
 6377 00f2 597B     	 ldrb r1,[r3,#13]
2537:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               (uint16_t*)&index_for_data);
 6378              	 .loc 1 2537 0
 6379 00f4 7B68     	 ldr r3,[r7,#4]
 6380 00f6 1B68     	 ldr r3,[r3]
 6381 00f8 03F10D02 	 add r2,r3,#13
2535:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_OID_DATA_LENGTH,
 6382              	 .loc 1 2535 0
 6383 00fc 07F10A03 	 add r3,r7,#10
 6384 0100 0846     	 mov r0,r1
 6385 0102 0621     	 movs r1,#6
 6386 0104 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2540:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->oid);
 6387              	 .loc 1 2540 0
 6388 0108 7B68     	 ldr r3,[r7,#4]
 6389 010a 1A68     	 ldr r2,[r3]
 6390 010c 7B89     	 ldrh r3,[r7,#10]
 6391 010e 0833     	 adds r3,r3,#8
 6392 0110 1344     	 add r3,r3,r2
 6393 0112 5A1D     	 adds r2,r3,#5
2541:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 6394              	 .loc 1 2541 0
 6395 0114 3B69     	 ldr r3,[r7,#16]
 6396 0116 1B68     	 ldr r3,[r3]
2540:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->oid);
 6397              	 .loc 1 2540 0
 6398 0118 1B88     	 ldrh r3,[r3]
 6399 011a 1046     	 mov r0,r2
 6400 011c 1946     	 mov r1,r3
 6401 011e FFF7FEFF 	 bl optiga_common_set_uint16
2542:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 6402              	 .loc 1 2542 0
 6403 0122 7B89     	 ldrh r3,[r7,#10]
 6404 0124 0233     	 adds r3,r3,#2
 6405 0126 9BB2     	 uxth r3,r3
 6406 0128 7B81     	 strh r3,[r7,#10]
2543:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->offset);
 6407              	 .loc 1 2543 0
 6408 012a 7B68     	 ldr r3,[r7,#4]
 6409 012c 1A68     	 ldr r2,[r3]
 6410 012e 7B89     	 ldrh r3,[r7,#10]
 6411 0130 0833     	 adds r3,r3,#8
 6412 0132 1344     	 add r3,r3,r2
 6413 0134 5A1D     	 adds r2,r3,#5
2544:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 6414              	 .loc 1 2544 0
 6415 0136 3B69     	 ldr r3,[r7,#16]
 6416 0138 1B68     	 ldr r3,[r3]
2543:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->offset);
 6417              	 .loc 1 2543 0
 6418 013a 5B88     	 ldrh r3,[r3,#2]
 6419 013c 1046     	 mov r0,r2
 6420 013e 1946     	 mov r1,r3
 6421 0140 FFF7FEFF 	 bl optiga_common_set_uint16
2545:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 6422              	 .loc 1 2545 0
 6423 0144 7B89     	 ldrh r3,[r7,#10]
 6424 0146 0233     	 adds r3,r3,#2
 6425 0148 9BB2     	 uxth r3,r3
 6426 014a 7B81     	 strh r3,[r7,#10]
2546:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->length);
 6427              	 .loc 1 2546 0
 6428 014c 7B68     	 ldr r3,[r7,#4]
 6429 014e 1A68     	 ldr r2,[r3]
 6430 0150 7B89     	 ldrh r3,[r7,#10]
 6431 0152 0833     	 adds r3,r3,#8
 6432 0154 1344     	 add r3,r3,r2
 6433 0156 5A1D     	 adds r2,r3,#5
2547:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 6434              	 .loc 1 2547 0
 6435 0158 3B69     	 ldr r3,[r7,#16]
 6436 015a 1B68     	 ldr r3,[r3]
2546:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_calc_hash->p_hash_oid->length);
 6437              	 .loc 1 2546 0
 6438 015c 9B88     	 ldrh r3,[r3,#4]
 6439 015e 1046     	 mov r0,r2
 6440 0160 1946     	 mov r1,r3
 6441 0162 FFF7FEFF 	 bl optiga_common_set_uint16
2548:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 6442              	 .loc 1 2548 0
 6443 0166 7B89     	 ldrh r3,[r7,#10]
 6444 0168 0233     	 adds r3,r3,#2
 6445 016a 9BB2     	 uxth r3,r3
 6446 016c 7B81     	 strh r3,[r7,#10]
 6447 016e 0BE0     	 b .L341
 6448              	.L342:
2553:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
 6449              	 .loc 1 2553 0
 6450 0170 3B69     	 ldr r3,[r7,#16]
 6451 0172 597B     	 ldrb r1,[r3,#13]
2555:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                (uint16_t*)&index_for_data);
 6452              	 .loc 1 2555 0
 6453 0174 7B68     	 ldr r3,[r7,#4]
 6454 0176 1B68     	 ldr r3,[r3]
 6455 0178 03F10D02 	 add r2,r3,#13
2553:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
 6456              	 .loc 1 2553 0
 6457 017c 07F10A03 	 add r3,r7,#10
 6458 0180 0846     	 mov r0,r1
 6459 0182 0021     	 movs r1,#0
 6460 0184 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 6461              	.L341:
2559:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 (0 != p_optiga_calc_hash->apparent_context_size))
 6462              	 .loc 1 2559 0
 6463 0188 3B69     	 ldr r3,[r7,#16]
 6464 018a 9B68     	 ldr r3,[r3,#8]
 6465 018c 002B     	 cmp r3,#0
 6466 018e 3BD0     	 beq .L343
2560:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6467              	 .loc 1 2560 0 discriminator 1
 6468 0190 3B69     	 ldr r3,[r7,#16]
 6469 0192 DB69     	 ldr r3,[r3,#28]
2559:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 (0 != p_optiga_calc_hash->apparent_context_size))
 6470              	 .loc 1 2559 0 discriminator 1
 6471 0194 002B     	 cmp r3,#0
 6472 0196 37D0     	 beq .L343
2562:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 optiga_common_set_uint16((me->p_optiga->optiga_comms_buffer + index_for_data),
 6473              	 .loc 1 2562 0
 6474 0198 7B68     	 ldr r3,[r7,#4]
 6475 019a 1A68     	 ldr r2,[r3]
 6476 019c 7B89     	 ldrh r3,[r7,#10]
 6477 019e 591C     	 adds r1,r3,#1
 6478 01a0 89B2     	 uxth r1,r1
 6479 01a2 7981     	 strh r1,[r7,#10]
 6480 01a4 1344     	 add r3,r3,r2
 6481 01a6 0622     	 movs r2,#6
 6482 01a8 5A73     	 strb r2,[r3,#13]
2563:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           (uint16_t )p_optiga_calc_hash->p_hash_context->context_bu
 6483              	 .loc 1 2563 0
 6484 01aa 7B68     	 ldr r3,[r7,#4]
 6485 01ac 1A68     	 ldr r2,[r3]
 6486 01ae 7B89     	 ldrh r3,[r7,#10]
 6487 01b0 0833     	 adds r3,r3,#8
 6488 01b2 1344     	 add r3,r3,r2
 6489 01b4 5A1D     	 adds r2,r3,#5
2564:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 index_for_data += OPTIGA_CMD_UINT16_SIZE_IN_BYTES;
 6490              	 .loc 1 2564 0
 6491 01b6 3B69     	 ldr r3,[r7,#16]
 6492 01b8 9B68     	 ldr r3,[r3,#8]
 6493 01ba 5B68     	 ldr r3,[r3,#4]
2563:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           (uint16_t )p_optiga_calc_hash->p_hash_context->context_bu
 6494              	 .loc 1 2563 0
 6495 01bc 9BB2     	 uxth r3,r3
 6496 01be 1046     	 mov r0,r2
 6497 01c0 1946     	 mov r1,r3
 6498 01c2 FFF7FEFF 	 bl optiga_common_set_uint16
2565:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6499              	 .loc 1 2565 0
 6500 01c6 7B89     	 ldrh r3,[r7,#10]
 6501 01c8 0233     	 adds r3,r3,#2
 6502 01ca 9BB2     	 uxth r3,r3
 6503 01cc 7B81     	 strh r3,[r7,#10]
2567:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_context->context_buffer,
 6504              	 .loc 1 2567 0
 6505 01ce 7B68     	 ldr r3,[r7,#4]
 6506 01d0 1A68     	 ldr r2,[r3]
 6507 01d2 7B89     	 ldrh r3,[r7,#10]
 6508 01d4 0833     	 adds r3,r3,#8
 6509 01d6 1344     	 add r3,r3,r2
 6510 01d8 591D     	 adds r1,r3,#5
2568:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               (uint16_t)p_optiga_calc_hash->p_hash_context->context_buffer_length);
 6511              	 .loc 1 2568 0
 6512 01da 3B69     	 ldr r3,[r7,#16]
 6513 01dc 9B68     	 ldr r3,[r3,#8]
 6514 01de 1A68     	 ldr r2,[r3]
2569:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6515              	 .loc 1 2569 0
 6516 01e0 3B69     	 ldr r3,[r7,#16]
 6517 01e2 9B68     	 ldr r3,[r3,#8]
 6518 01e4 5B68     	 ldr r3,[r3,#4]
 6519 01e6 9BB2     	 uxth r3,r3
2567:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               p_optiga_calc_hash->p_hash_context->context_buffer,
 6520              	 .loc 1 2567 0
 6521 01e8 0846     	 mov r0,r1
 6522 01ea 1146     	 mov r1,r2
 6523 01ec 1A46     	 mov r2,r3
 6524 01ee FFF7FEFF 	 bl pal_os_memcpy
2571:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 p_optiga_calc_hash->apparent_context_size = 0;
 6525              	 .loc 1 2571 0
 6526 01f2 3B69     	 ldr r3,[r7,#16]
 6527 01f4 9B68     	 ldr r3,[r3,#8]
 6528 01f6 5B68     	 ldr r3,[r3,#4]
 6529 01f8 9AB2     	 uxth r2,r3
 6530 01fa 7B89     	 ldrh r3,[r7,#10]
 6531 01fc 1344     	 add r3,r3,r2
 6532 01fe 9BB2     	 uxth r3,r3
 6533 0200 7B81     	 strh r3,[r7,#10]
2572:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 6534              	 .loc 1 2572 0
 6535 0202 3B69     	 ldr r3,[r7,#16]
 6536 0204 0022     	 movs r2,#0
 6537 0206 DA61     	 str r2,[r3,#28]
 6538              	.L343:
2576:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6539              	 .loc 1 2576 0
 6540 0208 3B69     	 ldr r3,[r7,#16]
 6541 020a 1B7E     	 ldrb r3,[r3,#24]
 6542 020c 012B     	 cmp r3,#1
 6543 020e 0DD1     	 bne .L344
2576:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6544              	 .loc 1 2576 0 is_stmt 0 discriminator 1
 6545 0210 7B68     	 ldr r3,[r7,#4]
 6546 0212 1B7E     	 ldrb r3,[r3,#24]
 6547 0214 002B     	 cmp r3,#0
 6548 0216 09D1     	 bne .L344
2580:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               (uint16_t*)&index_for_data);
 6549              	 .loc 1 2580 0 is_stmt 1
 6550 0218 7B68     	 ldr r3,[r7,#4]
 6551 021a 1B68     	 ldr r3,[r3]
 6552 021c 03F10D02 	 add r2,r3,#13
2578:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                               OPTIGA_CMD_ZERO_LENGTH_OR_VALUE,
 6553              	 .loc 1 2578 0
 6554 0220 07F10A03 	 add r3,r7,#10
 6555 0224 0720     	 movs r0,#7
 6556 0226 0021     	 movs r1,#0
 6557 0228 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
 6558              	.L344:
2585:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 6559              	 .loc 1 2585 0
 6560 022c 7B68     	 ldr r3,[r7,#4]
 6561 022e 597E     	 ldrb r1,[r3,#25]
 6562 0230 7B89     	 ldrh r3,[r7,#10]
 6563 0232 043B     	 subs r3,r3,#4
 6564 0234 9AB2     	 uxth r2,r3
2588:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6565              	 .loc 1 2588 0
 6566 0236 7B68     	 ldr r3,[r7,#4]
 6567 0238 1B68     	 ldr r3,[r3]
 6568 023a 0D33     	 adds r3,r3,#13
2585:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 6569              	 .loc 1 2585 0
 6570 023c B020     	 movs r0,#176
 6571 023e FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
2590:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
 6572              	 .loc 1 2590 0
 6573 0242 7B68     	 ldr r3,[r7,#4]
 6574 0244 1B68     	 ldr r3,[r3]
 6575 0246 7A89     	 ldrh r2,[r7,#10]
 6576 0248 9A80     	 strh r2,[r3,#4]
2591:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 6577              	 .loc 1 2591 0
 6578 024a 0023     	 movs r3,#0
 6579 024c FB82     	 strh r3,[r7,#22]
2593:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
 6580              	 .loc 1 2593 0
 6581 024e 6FE0     	 b .L345
 6582              	.L338:
2598:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6583              	 .loc 1 2598 0
 6584 0250 7B68     	 ldr r3,[r7,#4]
 6585 0252 1B68     	 ldr r3,[r3]
 6586 0254 5B7B     	 ldrb r3,[r3,#13]
 6587 0256 FF2B     	 cmp r3,#255
 6588 0258 0BD1     	 bne .L346
2603:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 6589              	 .loc 1 2603 0
 6590 025a 7B68     	 ldr r3,[r7,#4]
 6591 025c 9B7E     	 ldrb r3,[r3,#26]
 6592 025e 03F07F03 	 and r3,r3,#127
 6593 0262 DAB2     	 uxtb r2,r3
 6594 0264 7B68     	 ldr r3,[r7,#4]
 6595 0266 9A76     	 strb r2,[r3,#26]
 6596 0268 7B68     	 ldr r3,[r7,#4]
 6597 026a 9A7E     	 ldrb r2,[r3,#26]
 6598 026c 7B68     	 ldr r3,[r7,#4]
 6599 026e 9A76     	 strb r2,[r3,#26]
2604:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 6600              	 .loc 1 2604 0
 6601 0270 5EE0     	 b .L345
 6602              	.L346:
2607:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6603              	 .loc 1 2607 0
 6604 0272 7B68     	 ldr r3,[r7,#4]
 6605 0274 1B7E     	 ldrb r3,[r3,#24]
 6606 0276 002B     	 cmp r3,#0
 6607 0278 20D1     	 bne .L347
2607:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6608              	 .loc 1 2607 0 is_stmt 0 discriminator 1
 6609 027a 3B69     	 ldr r3,[r7,#16]
 6610 027c 5B69     	 ldr r3,[r3,#20]
 6611 027e 002B     	 cmp r3,#0
 6612 0280 1CD0     	 beq .L347
2610:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 6613              	 .loc 1 2610 0 is_stmt 1
 6614 0282 7B68     	 ldr r3,[r7,#4]
 6615 0284 1B68     	 ldr r3,[r3]
 6616 0286 5B7C     	 ldrb r3,[r3,#17]
 6617 0288 012B     	 cmp r3,#1
 6618 028a 00D0     	 beq .L348
2612:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 6619              	 .loc 1 2612 0
 6620 028c 50E0     	 b .L345
 6621              	.L348:
2614:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &out_data_size);
 6622              	 .loc 1 2614 0
 6623 028e 7B68     	 ldr r3,[r7,#4]
 6624 0290 1B68     	 ldr r3,[r3]
 6625 0292 03F11202 	 add r2,r3,#18
 6626 0296 07F10803 	 add r3,r7,#8
 6627 029a 1046     	 mov r0,r2
 6628 029c 1946     	 mov r1,r3
 6629 029e FFF7FEFF 	 bl optiga_common_get_uint16
2617:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
 6630              	 .loc 1 2617 0
 6631 02a2 3B69     	 ldr r3,[r7,#16]
 6632 02a4 5A69     	 ldr r2,[r3,#20]
2618:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               OPTIGA_CMD_NO_OF_BYTES_IN_TAG], out_data_size);
 6633              	 .loc 1 2618 0
 6634 02a6 7B68     	 ldr r3,[r7,#4]
 6635 02a8 1B68     	 ldr r3,[r3]
 6636 02aa 1433     	 adds r3,r3,#20
2617:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
 6637              	 .loc 1 2617 0
 6638 02ac 3989     	 ldrh r1,[r7,#8]
 6639 02ae 0C46     	 mov r4,r1
 6640 02b0 1046     	 mov r0,r2
 6641 02b2 1946     	 mov r1,r3
 6642 02b4 2246     	 mov r2,r4
 6643 02b6 FFF7FEFF 	 bl pal_os_memcpy
 6644 02ba 36E0     	 b .L349
 6645              	.L347:
2622:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6646              	 .loc 1 2622 0
 6647 02bc 3B69     	 ldr r3,[r7,#16]
 6648 02be 1B7E     	 ldrb r3,[r3,#24]
 6649 02c0 012B     	 cmp r3,#1
 6650 02c2 32D1     	 bne .L349
2622:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6651              	 .loc 1 2622 0 is_stmt 0 discriminator 1
 6652 02c4 7B68     	 ldr r3,[r7,#4]
 6653 02c6 1B7E     	 ldrb r3,[r3,#24]
 6654 02c8 002B     	 cmp r3,#0
 6655 02ca 2ED1     	 bne .L349
2622:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6656              	 .loc 1 2622 0 discriminator 2
 6657 02cc 3B69     	 ldr r3,[r7,#16]
 6658 02ce 9B68     	 ldr r3,[r3,#8]
 6659 02d0 002B     	 cmp r3,#0
 6660 02d2 2AD0     	 beq .L349
2625:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 6661              	 .loc 1 2625 0 is_stmt 1
 6662 02d4 7B68     	 ldr r3,[r7,#4]
 6663 02d6 1B68     	 ldr r3,[r3]
 6664 02d8 5B7C     	 ldrb r3,[r3,#17]
 6665 02da 062B     	 cmp r3,#6
 6666 02dc 00D0     	 beq .L350
2627:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 6667              	 .loc 1 2627 0
 6668 02de 27E0     	 b .L345
 6669              	.L350:
2630:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          OPTIGA_CMD_NO_OF_BYTES_IN_TAG], &out_data_size);
 6670              	 .loc 1 2630 0
 6671 02e0 7B68     	 ldr r3,[r7,#4]
 6672 02e2 1B68     	 ldr r3,[r3]
 6673 02e4 03F11202 	 add r2,r3,#18
 6674 02e8 07F10803 	 add r3,r7,#8
 6675 02ec 1046     	 mov r0,r2
 6676 02ee 1946     	 mov r1,r3
 6677 02f0 FFF7FEFF 	 bl optiga_common_get_uint16
2632:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 {
 6678              	 .loc 1 2632 0
 6679 02f4 3B69     	 ldr r3,[r7,#16]
 6680 02f6 9B68     	 ldr r3,[r3,#8]
 6681 02f8 5B68     	 ldr r3,[r3,#4]
 6682 02fa 3A89     	 ldrh r2,[r7,#8]
 6683 02fc 9342     	 cmp r3,r2
 6684 02fe 03D2     	 bcs .L351
2635:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                     break;
 6685              	 .loc 1 2635 0
 6686 0300 4FF40173 	 mov r3,#516
 6687 0304 FB82     	 strh r3,[r7,#22]
2636:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 }
 6688              	 .loc 1 2636 0
 6689 0306 13E0     	 b .L345
 6690              	.L351:
2639:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
 6691              	 .loc 1 2639 0
 6692 0308 3B69     	 ldr r3,[r7,#16]
 6693 030a 9B68     	 ldr r3,[r3,#8]
 6694 030c 1A68     	 ldr r2,[r3]
2640:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               OPTIGA_CMD_NO_OF_BYTES_IN_TAG], out_data_size);
 6695              	 .loc 1 2640 0
 6696 030e 7B68     	 ldr r3,[r7,#4]
 6697 0310 1B68     	 ldr r3,[r3]
 6698 0312 1433     	 adds r3,r3,#20
2639:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                               &me->p_optiga->optiga_comms_buffer[OPTIGA_CMD_APDU_INDATA_OFFSET + OP
 6699              	 .loc 1 2639 0
 6700 0314 3989     	 ldrh r1,[r7,#8]
 6701 0316 0C46     	 mov r4,r1
 6702 0318 1046     	 mov r0,r2
 6703 031a 1946     	 mov r1,r3
 6704 031c 2246     	 mov r2,r4
 6705 031e FFF7FEFF 	 bl pal_os_memcpy
2642:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 6706              	 .loc 1 2642 0
 6707 0322 3B69     	 ldr r3,[r7,#16]
 6708 0324 9B68     	 ldr r3,[r3,#8]
 6709 0326 3A89     	 ldrh r2,[r7,#8]
 6710 0328 5A60     	 str r2,[r3,#4]
 6711              	.L349:
2645:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 6712              	 .loc 1 2645 0
 6713 032a 0023     	 movs r3,#0
 6714 032c FB82     	 strh r3,[r7,#22]
2647:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 6715              	 .loc 1 2647 0
 6716 032e 00BF     	 nop
 6717              	.L345:
2650:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2651:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2652:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 6718              	 .loc 1 2652 0
 6719 0330 FB8A     	 ldrh r3,[r7,#22]
2653:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 6720              	 .loc 1 2653 0
 6721 0332 1846     	 mov r0,r3
 6722 0334 1C37     	 adds r7,r7,#28
 6723              	.LCFI252:
 6724              	 .cfi_def_cfa_offset 12
 6725 0336 BD46     	 mov sp,r7
 6726              	.LCFI253:
 6727              	 .cfi_def_cfa_register 13
 6728              	 
 6729 0338 90BD     	 pop {r4,r7,pc}
 6730              	 .cfi_endproc
 6731              	.LFE48:
 6733 033a 00BF     	 .section .text.optiga_cmd_calc_hash,"ax",%progbits
 6734              	 .align 2
 6735              	 .global optiga_cmd_calc_hash
 6736              	 .thumb
 6737              	 .thumb_func
 6739              	optiga_cmd_calc_hash:
 6740              	.LFB49:
2654:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2655:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_calc_hash(optiga_cmd_t * me,
2656:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          uint8_t cmd_param,
2657:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                          optiga_calc_hash_params_t * params)
2658:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 6741              	 .loc 1 2658 0
 6742              	 .cfi_startproc
 6743              	 
 6744              	 
 6745 0000 80B5     	 push {r7,lr}
 6746              	.LCFI254:
 6747              	 .cfi_def_cfa_offset 8
 6748              	 .cfi_offset 7,-8
 6749              	 .cfi_offset 14,-4
 6750 0002 8AB0     	 sub sp,sp,#40
 6751              	.LCFI255:
 6752              	 .cfi_def_cfa_offset 48
 6753 0004 04AF     	 add r7,sp,#16
 6754              	.LCFI256:
 6755              	 .cfi_def_cfa 7,32
 6756 0006 F860     	 str r0,[r7,#12]
 6757 0008 0B46     	 mov r3,r1
 6758 000a 7A60     	 str r2,[r7,#4]
 6759 000c FB72     	 strb r3,[r7,#11]
2659:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_calc_hash_params_t * p_optiga_calc_hash = (optiga_calc_hash_params_t*)params;
 6760              	 .loc 1 2659 0
 6761 000e 7B68     	 ldr r3,[r7,#4]
 6762 0010 7B61     	 str r3,[r7,#20]
2660:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2661:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2662:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     p_optiga_calc_hash->data_sent = 0;
 6763              	 .loc 1 2662 0
 6764 0012 7B69     	 ldr r3,[r7,#20]
 6765 0014 0022     	 movs r2,#0
 6766 0016 1A61     	 str r2,[r3,#16]
2663:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2664:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_execute(me,
 6767              	 .loc 1 2664 0
 6768 0018 FA7A     	 ldrb r2,[r7,#11]
 6769 001a 0623     	 movs r3,#6
 6770 001c 0093     	 str r3,[sp]
 6771 001e 7B68     	 ldr r3,[r7,#4]
 6772 0020 0193     	 str r3,[sp,#4]
 6773 0022 B023     	 movs r3,#176
 6774 0024 0293     	 str r3,[sp,#8]
 6775 0026 F868     	 ldr r0,[r7,#12]
 6776 0028 1146     	 mov r1,r2
 6777 002a 044A     	 ldr r2,.L355
 6778 002c 0223     	 movs r3,#2
 6779 002e FFF7FEFF 	 bl optiga_cmd_execute
2665:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        cmd_param,
2666:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        optiga_cmd_calc_hash_handler,
2667:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_PREPARE_COMMAND,
2668:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_EXEC_REQUEST_LOCK,
2669:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        params,
2670:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and is r
2671:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                        OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_CALC_HASH, OPTIGA_CMD_ZERO_LENGTH_OR_VAL
2672:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2673:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (OPTIGA_LIB_SUCCESS);
 6780              	 .loc 1 2673 0
 6781 0032 0023     	 movs r3,#0
2674:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 6782              	 .loc 1 2674 0
 6783 0034 1846     	 mov r0,r3
 6784 0036 1837     	 adds r7,r7,#24
 6785              	.LCFI257:
 6786              	 .cfi_def_cfa_offset 8
 6787 0038 BD46     	 mov sp,r7
 6788              	.LCFI258:
 6789              	 .cfi_def_cfa_register 13
 6790              	 
 6791 003a 80BD     	 pop {r7,pc}
 6792              	.L356:
 6793              	 .align 2
 6794              	.L355:
 6795 003c 00000000 	 .word optiga_cmd_calc_hash_handler
 6796              	 .cfi_endproc
 6797              	.LFE49:
 6799              	 .section .text.optiga_cmd_set_object_protected_handler,"ax",%progbits
 6800              	 .align 2
 6801              	 .thumb
 6802              	 .thumb_func
 6804              	optiga_cmd_set_object_protected_handler:
 6805              	.LFB50:
2675:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** #endif //OPTIGA_CRYPT_HASH_ENABLED
2676:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2677:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** /*
2678:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** * Set Data Object handler for protected update
2679:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** */
2680:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** _STATIC_H optiga_lib_status_t optiga_cmd_set_object_protected_handler(optiga_cmd_t * me)
2681:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 6806              	 .loc 1 2681 0
 6807              	 .cfi_startproc
 6808              	 
 6809              	 
 6810 0000 80B5     	 push {r7,lr}
 6811              	.LCFI259:
 6812              	 .cfi_def_cfa_offset 8
 6813              	 .cfi_offset 7,-8
 6814              	 .cfi_offset 14,-4
 6815 0002 86B0     	 sub sp,sp,#24
 6816              	.LCFI260:
 6817              	 .cfi_def_cfa_offset 32
 6818 0004 00AF     	 add r7,sp,#0
 6819              	.LCFI261:
 6820              	 .cfi_def_cfa_register 7
 6821 0006 7860     	 str r0,[r7,#4]
2682:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t total_apdu_length;
2683:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_set_object_protected_params_t * p_optiga_write_protected_data = (optiga_set_object_prote
 6822              	 .loc 1 2683 0
 6823 0008 7B68     	 ldr r3,[r7,#4]
 6824 000a 9B68     	 ldr r3,[r3,#8]
 6825 000c 3B61     	 str r3,[r7,#16]
2684:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_CMD_ERROR;
 6826              	 .loc 1 2684 0
 6827 000e 40F20223 	 movw r3,#514
 6828 0012 FB82     	 strh r3,[r7,#22]
2685:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     uint16_t index_for_data = OPTIGA_CMD_APDU_INDATA_OFFSET;
 6829              	 .loc 1 2685 0
 6830 0014 0423     	 movs r3,#4
 6831 0016 BB81     	 strh r3,[r7,#12]
2686:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2687:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     switch ((uint8_t)me->cmd_next_execution_state)
 6832              	 .loc 1 2687 0
 6833 0018 7B68     	 ldr r3,[r7,#4]
 6834 001a 9B7D     	 ldrb r3,[r3,#22]
 6835 001c 022B     	 cmp r3,#2
 6836 001e 02D0     	 beq .L359
 6837 0020 032B     	 cmp r3,#3
 6838 0022 46D0     	 beq .L360
2688:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2689:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PREPARE_COMMAND:
2690:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2691:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Sending set data object command..");
2692:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->chaining_ongoing = FALSE;
2693:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2694:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // APDU header size + Set Object protected tag 1 bytes + length of buffer 2 bytes + siz
2695:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             total_apdu_length = OPTIGA_CMD_APDU_HEADER_SIZE + OPTIGA_CMD_NO_OF_BYTES_IN_TAG + OPTIG
2696:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                 p_optiga_write_protected_data->p_protected_update_buffer_length;
2697:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
2698:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2699:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 return_status = OPTIGA_CMD_ERROR_MEMORY_INSUFFICIENT;
2700:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
2701:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2702:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2703:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // Copy the tag and protected length
2704:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_tag_header((OPTIGA_CMD_SET_OBJECT_PROTECTED_TAG |
2705:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (uint8_t)p_optiga_write_protected_data->set_obj_protecte
2706:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_write_protected_data->p_protected_update_buffer_
2707:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           me->p_optiga->optiga_comms_buffer,
2708:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
2709:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // data to be written
2710:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             pal_os_memcpy(me->p_optiga->optiga_comms_buffer + index_for_data,
2711:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_write_protected_data->p_protected_update_buffer,
2712:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_write_protected_data->p_protected_update_buffer_length);
2713:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2714:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             index_for_data += p_optiga_write_protected_data->p_protected_update_buffer_length;
2715:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // prepare apdu
2716:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             optiga_cmd_prepare_apdu_header(OPTIGA_CMD_SET_OBJECT_PROTECTED,
2717:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
2718:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (index_for_data - OPTIGA_CMD_APDU_INDATA_OFFSET),
2719:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->p_optiga->optiga_comms_buffer + OPTIGA_COMMS_DATA_OF
2720:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2721:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             me->p_optiga->comms_tx_size = (index_for_data - OPTIGA_COMMS_DATA_OFFSET);
2722:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2723:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2724:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2725:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2726:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2727:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         case OPTIGA_CMD_EXEC_PROCESS_RESPONSE:
2728:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2729:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Processing response for set data object data command...");
2730:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // check if the write was successful
2731:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_CMD_APDU_SUCCESS != me->p_optiga->optiga_comms_buffer[OPTIGA_COMMS_DATA_OFFS
2732:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2733:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 OPTIGA_CMD_LOG_MESSAGE("Error in processing set data object response...");
2734:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{835} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2735:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 //lint --e{845} suppress "SET_DEV_ERROR_NOTIFICATION is generically written for any
2736:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 SET_DEV_ERROR_NOTIFICATION(OPTIGA_CMD_EXIT_HANDLER_CALL);
2737:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
2738:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2739:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_SET_PROTECTED_UPDATE_FINAL == p_optiga_write_protected_data->set_obj_protect
2740:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2741:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_EXEC_RELEASE_LOCK;
2742:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2743:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             else
2744:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
2745:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 me->cmd_sub_execution_state = OPTIGA_CMD_STATE_EXIT;
2746:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_event_start(me->p_optiga->p_pal_os_event_ctx, optiga_cmd_queue_scheduler, me
2747:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
2748:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             OPTIGA_CMD_LOG_MESSAGE("Response of set data object command is processed...");
2749:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             return_status = OPTIGA_LIB_SUCCESS;
2750:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2751:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         break;
2752:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
2753:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             break;
 6839              	 .loc 1 2753 0
 6840 0024 6FE0     	 b .L362
 6841              	.L359:
2692:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6842              	 .loc 1 2692 0
 6843 0026 7B68     	 ldr r3,[r7,#4]
 6844 0028 0022     	 movs r2,#0
 6845 002a 1A76     	 strb r2,[r3,#24]
2696:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             if (OPTIGA_MAX_COMMS_BUFFER_SIZE < total_apdu_length)
 6846              	 .loc 1 2696 0
 6847 002c 3B69     	 ldr r3,[r7,#16]
 6848 002e 9B88     	 ldrh r3,[r3,#4]
2695:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                 p_optiga_write_protected_data->p_protected_update_buffer_length;
 6849              	 .loc 1 2695 0
 6850 0030 0733     	 adds r3,r3,#7
 6851 0032 FB81     	 strh r3,[r7,#14]
2697:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6852              	 .loc 1 2697 0
 6853 0034 FB89     	 ldrh r3,[r7,#14]
 6854 0036 40F21562 	 movw r2,#1557
 6855 003a 9342     	 cmp r3,r2
 6856 003c 03D9     	 bls .L361
2699:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 6857              	 .loc 1 2699 0
 6858 003e 4FF40173 	 mov r3,#516
 6859 0042 FB82     	 strh r3,[r7,#22]
2700:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 6860              	 .loc 1 2700 0
 6861 0044 5FE0     	 b .L362
 6862              	.L361:
2705:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           p_optiga_write_protected_data->p_protected_update_buffer_
 6863              	 .loc 1 2705 0
 6864 0046 3B69     	 ldr r3,[r7,#16]
 6865 0048 9B79     	 ldrb r3,[r3,#6]
2704:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (uint8_t)p_optiga_write_protected_data->set_obj_protecte
 6866              	 .loc 1 2704 0
 6867 004a 43F03003 	 orr r3,r3,#48
 6868 004e D8B2     	 uxtb r0,r3
 6869 0050 3B69     	 ldr r3,[r7,#16]
 6870 0052 9988     	 ldrh r1,[r3,#4]
2707:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                           &index_for_data);
 6871              	 .loc 1 2707 0
 6872 0054 7B68     	 ldr r3,[r7,#4]
 6873 0056 1B68     	 ldr r3,[r3]
 6874 0058 03F10D02 	 add r2,r3,#13
2704:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            (uint8_t)p_optiga_write_protected_data->set_obj_protecte
 6875              	 .loc 1 2704 0
 6876 005c 07F10C03 	 add r3,r7,#12
 6877 0060 FFF7FEFF 	 bl optiga_cmd_prepare_tag_header
2710:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_write_protected_data->p_protected_update_buffer,
 6878              	 .loc 1 2710 0
 6879 0064 7B68     	 ldr r3,[r7,#4]
 6880 0066 1A68     	 ldr r2,[r3]
 6881 0068 BB89     	 ldrh r3,[r7,#12]
 6882 006a 0833     	 adds r3,r3,#8
 6883 006c 1344     	 add r3,r3,r2
 6884 006e 591D     	 adds r1,r3,#5
2711:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_write_protected_data->p_protected_update_buffer_length);
 6885              	 .loc 1 2711 0
 6886 0070 3B69     	 ldr r3,[r7,#16]
 6887 0072 1A68     	 ldr r2,[r3]
2712:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6888              	 .loc 1 2712 0
 6889 0074 3B69     	 ldr r3,[r7,#16]
 6890 0076 9B88     	 ldrh r3,[r3,#4]
2710:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                           p_optiga_write_protected_data->p_protected_update_buffer,
 6891              	 .loc 1 2710 0
 6892 0078 0846     	 mov r0,r1
 6893 007a 1146     	 mov r1,r2
 6894 007c 1A46     	 mov r2,r3
 6895 007e FFF7FEFF 	 bl pal_os_memcpy
2714:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             // prepare apdu
 6896              	 .loc 1 2714 0
 6897 0082 3B69     	 ldr r3,[r7,#16]
 6898 0084 9A88     	 ldrh r2,[r3,#4]
 6899 0086 BB89     	 ldrh r3,[r7,#12]
 6900 0088 1344     	 add r3,r3,r2
 6901 008a 9BB2     	 uxth r3,r3
 6902 008c BB81     	 strh r3,[r7,#12]
2716:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 6903              	 .loc 1 2716 0
 6904 008e 7B68     	 ldr r3,[r7,#4]
 6905 0090 597E     	 ldrb r1,[r3,#25]
 6906 0092 BB89     	 ldrh r3,[r7,#12]
 6907 0094 043B     	 subs r3,r3,#4
 6908 0096 9AB2     	 uxth r2,r3
2719:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6909              	 .loc 1 2719 0
 6910 0098 7B68     	 ldr r3,[r7,#4]
 6911 009a 1B68     	 ldr r3,[r3]
 6912 009c 0D33     	 adds r3,r3,#13
2716:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                            me->cmd_param,
 6913              	 .loc 1 2716 0
 6914 009e 8320     	 movs r0,#131
 6915 00a0 FFF7FEFF 	 bl optiga_cmd_prepare_apdu_header
2721:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6916              	 .loc 1 2721 0
 6917 00a4 7B68     	 ldr r3,[r7,#4]
 6918 00a6 1B68     	 ldr r3,[r3]
 6919 00a8 BA89     	 ldrh r2,[r7,#12]
 6920 00aa 9A80     	 strh r2,[r3,#4]
2723:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 6921              	 .loc 1 2723 0
 6922 00ac 0023     	 movs r3,#0
 6923 00ae FB82     	 strh r3,[r7,#22]
2725:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
 6924              	 .loc 1 2725 0
 6925 00b0 29E0     	 b .L362
 6926              	.L360:
2731:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6927              	 .loc 1 2731 0
 6928 00b2 7B68     	 ldr r3,[r7,#4]
 6929 00b4 1B68     	 ldr r3,[r3]
 6930 00b6 5B7B     	 ldrb r3,[r3,#13]
 6931 00b8 002B     	 cmp r3,#0
 6932 00ba 0BD0     	 beq .L363
2736:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 break;
 6933              	 .loc 1 2736 0
 6934 00bc 7B68     	 ldr r3,[r7,#4]
 6935 00be 9B7E     	 ldrb r3,[r3,#26]
 6936 00c0 03F07F03 	 and r3,r3,#127
 6937 00c4 DAB2     	 uxtb r2,r3
 6938 00c6 7B68     	 ldr r3,[r7,#4]
 6939 00c8 9A76     	 strb r2,[r3,#26]
 6940 00ca 7B68     	 ldr r3,[r7,#4]
 6941 00cc 9A7E     	 ldrb r2,[r3,#26]
 6942 00ce 7B68     	 ldr r3,[r7,#4]
 6943 00d0 9A76     	 strb r2,[r3,#26]
2737:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 6944              	 .loc 1 2737 0
 6945 00d2 18E0     	 b .L362
 6946              	.L363:
2739:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             {
 6947              	 .loc 1 2739 0
 6948 00d4 3B69     	 ldr r3,[r7,#16]
 6949 00d6 9B79     	 ldrb r3,[r3,#6]
 6950 00d8 012B     	 cmp r3,#1
 6951 00da 03D1     	 bne .L364
2741:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 6952              	 .loc 1 2741 0
 6953 00dc 7B68     	 ldr r3,[r7,#4]
 6954 00de 0B22     	 movs r2,#11
 6955 00e0 DA75     	 strb r2,[r3,#23]
 6956 00e2 0DE0     	 b .L365
 6957              	.L364:
2745:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                 pal_os_event_start(me->p_optiga->p_pal_os_event_ctx, optiga_cmd_queue_scheduler, me
 6958              	 .loc 1 2745 0
 6959 00e4 7B68     	 ldr r3,[r7,#4]
 6960 00e6 0C22     	 movs r2,#12
 6961 00e8 DA75     	 strb r2,[r3,#23]
2746:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             }
 6962              	 .loc 1 2746 0
 6963 00ea 7B68     	 ldr r3,[r7,#4]
 6964 00ec 1B68     	 ldr r3,[r3]
 6965 00ee D3F86C26 	 ldr r2,[r3,#1644]
 6966 00f2 7B68     	 ldr r3,[r7,#4]
 6967 00f4 1B68     	 ldr r3,[r3]
 6968 00f6 1046     	 mov r0,r2
 6969 00f8 0549     	 ldr r1,.L367
 6970 00fa 1A46     	 mov r2,r3
 6971 00fc FFF7FEFF 	 bl pal_os_event_start
 6972              	.L365:
2749:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
 6973              	 .loc 1 2749 0
 6974 0100 0023     	 movs r3,#0
 6975 0102 FB82     	 strh r3,[r7,#22]
2751:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         default:
 6976              	 .loc 1 2751 0
 6977 0104 00BF     	 nop
 6978              	.L362:
2754:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2755:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 6979              	 .loc 1 2755 0
 6980 0106 FB8A     	 ldrh r3,[r7,#22]
2756:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 6981              	 .loc 1 2756 0
 6982 0108 1846     	 mov r0,r3
 6983 010a 1837     	 adds r7,r7,#24
 6984              	.LCFI262:
 6985              	 .cfi_def_cfa_offset 8
 6986 010c BD46     	 mov sp,r7
 6987              	.LCFI263:
 6988              	 .cfi_def_cfa_register 13
 6989              	 
 6990 010e 80BD     	 pop {r7,pc}
 6991              	.L368:
 6992              	 .align 2
 6993              	.L367:
 6994 0110 00000000 	 .word optiga_cmd_queue_scheduler
 6995              	 .cfi_endproc
 6996              	.LFE50:
 6998              	 .section .text.optiga_cmd_set_object_protected,"ax",%progbits
 6999              	 .align 2
 7000              	 .global optiga_cmd_set_object_protected
 7001              	 .thumb
 7002              	 .thumb_func
 7004              	optiga_cmd_set_object_protected:
 7005              	.LFB51:
2757:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2758:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** optiga_lib_status_t optiga_cmd_set_object_protected(optiga_cmd_t * me, uint8_t cmd_param,
2759:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                                                     optiga_set_object_protected_params_t * params)
2760:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** {
 7006              	 .loc 1 2760 0
 7007              	 .cfi_startproc
 7008              	 
 7009              	 
 7010 0000 90B5     	 push {r4,r7,lr}
 7011              	.LCFI264:
 7012              	 .cfi_def_cfa_offset 12
 7013              	 .cfi_offset 4,-12
 7014              	 .cfi_offset 7,-8
 7015              	 .cfi_offset 14,-4
 7016 0002 8BB0     	 sub sp,sp,#44
 7017              	.LCFI265:
 7018              	 .cfi_def_cfa_offset 56
 7019 0004 04AF     	 add r7,sp,#16
 7020              	.LCFI266:
 7021              	 .cfi_def_cfa 7,40
 7022 0006 F860     	 str r0,[r7,#12]
 7023 0008 0B46     	 mov r3,r1
 7024 000a 7A60     	 str r2,[r7,#4]
 7025 000c FB72     	 strb r3,[r7,#11]
2761:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_state_t next_execution_state = OPTIGA_CMD_EXEC_PREPARE_COMMAND;
 7026              	 .loc 1 2761 0
 7027 000e 0223     	 movs r3,#2
 7028 0010 FB75     	 strb r3,[r7,#23]
2762:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_cmd_sub_state_t next_execution_sub_state = OPTIGA_CMD_EXEC_REQUEST_STRICT_LOCK;
 7029              	 .loc 1 2762 0
 7030 0012 0723     	 movs r3,#7
 7031 0014 BB75     	 strb r3,[r7,#22]
2763:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     optiga_lib_status_t return_status = OPTIGA_LIB_SUCCESS;
 7032              	 .loc 1 2763 0
 7033 0016 0023     	 movs r3,#0
 7034 0018 BB82     	 strh r3,[r7,#20]
2764:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     OPTIGA_CMD_LOG_MESSAGE(__FUNCTION__);
2765:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2766:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     // Continue or Final API is invoked without strict lock acquired by instance
2767:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     if (((OPTIGA_SET_PROTECTED_UPDATE_FINAL == params->set_obj_protected_tag) ||
 7035              	 .loc 1 2767 0
 7036 001a 7B68     	 ldr r3,[r7,#4]
 7037 001c 9B79     	 ldrb r3,[r3,#6]
 7038 001e 012B     	 cmp r3,#1
 7039 0020 03D0     	 beq .L370
2768:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****        (OPTIGA_SET_PROTECTED_UPDATE_CONTINUE == params->set_obj_protected_tag)) &&
 7040              	 .loc 1 2768 0 discriminator 1
 7041 0022 7B68     	 ldr r3,[r7,#4]
 7042 0024 9B79     	 ldrb r3,[r3,#6]
2767:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****        (OPTIGA_SET_PROTECTED_UPDATE_CONTINUE == params->set_obj_protected_tag)) &&
 7043              	 .loc 1 2767 0 discriminator 1
 7044 0026 022B     	 cmp r3,#2
 7045 0028 11D1     	 bne .L371
 7046              	.L370:
2769:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****        ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != optiga_cmd_queue_get_state_of(me, OPTIGA_CMD_QUEUE
 7047              	 .loc 1 2769 0
 7048 002a F868     	 ldr r0,[r7,#12]
 7049 002c 0821     	 movs r1,#8
 7050 002e FFF7FEFF 	 bl optiga_cmd_queue_get_state_of
 7051 0032 0346     	 mov r3,r0
2768:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****        (OPTIGA_SET_PROTECTED_UPDATE_CONTINUE == params->set_obj_protected_tag)) &&
 7052              	 .loc 1 2768 0
 7053 0034 232B     	 cmp r3,#35
 7054 0036 06D1     	 bne .L372
2770:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****        (OPTIGA_CMD_QUEUE_PROCESSING != optiga_cmd_queue_get_state_of(me, OPTIGA_CMD_QUEUE_SLOT_STAT
 7055              	 .loc 1 2770 0
 7056 0038 F868     	 ldr r0,[r7,#12]
 7057 003a 0921     	 movs r1,#9
 7058 003c FFF7FEFF 	 bl optiga_cmd_queue_get_state_of
 7059 0040 0346     	 mov r3,r0
2769:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****        ((OPTIGA_CMD_QUEUE_REQUEST_STRICT_LOCK != optiga_cmd_queue_get_state_of(me, OPTIGA_CMD_QUEUE
 7060              	 .loc 1 2769 0
 7061 0042 042B     	 cmp r3,#4
 7062 0044 03D0     	 beq .L371
 7063              	.L372:
2771:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2772:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2773:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         return_status = OPTIGA_CMD_ERROR_INVALID_INPUT;
 7064              	 .loc 1 2773 0
 7065 0046 40F20323 	 movw r3,#515
 7066 004a BB82     	 strh r3,[r7,#20]
 7067 004c 19E0     	 b .L373
 7068              	.L371:
2774:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2775:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     else
2776:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     {
2777:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         if (( NULL == params->p_protected_update_buffer ) &&
 7069              	 .loc 1 2777 0
 7070 004e 7B68     	 ldr r3,[r7,#4]
 7071 0050 1B68     	 ldr r3,[r3]
 7072 0052 002B     	 cmp r3,#0
 7073 0054 07D1     	 bne .L374
2778:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             (OPTIGA_SET_PROTECTED_UPDATE_FINAL == params->set_obj_protected_tag))
 7074              	 .loc 1 2778 0 discriminator 1
 7075 0056 7B68     	 ldr r3,[r7,#4]
 7076 0058 9B79     	 ldrb r3,[r3,#6]
2777:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             (OPTIGA_SET_PROTECTED_UPDATE_FINAL == params->set_obj_protected_tag))
 7077              	 .loc 1 2777 0 discriminator 1
 7078 005a 012B     	 cmp r3,#1
 7079 005c 03D1     	 bne .L374
2779:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         {
2780:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             /// Release the strict sequence
2781:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             next_execution_state = OPTIGA_CMD_EXEC_PROCESS_RESPONSE;
 7080              	 .loc 1 2781 0
 7081 005e 0323     	 movs r3,#3
 7082 0060 FB75     	 strb r3,[r7,#23]
2782:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****             next_execution_sub_state = OPTIGA_CMD_EXEC_RELEASE_LOCK;
 7083              	 .loc 1 2782 0
 7084 0062 0B23     	 movs r3,#11
 7085 0064 BB75     	 strb r3,[r7,#22]
 7086              	.L374:
2783:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         }
2784:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2785:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****         optiga_cmd_execute(me,
 7087              	 .loc 1 2785 0
 7088 0066 FA7A     	 ldrb r2,[r7,#11]
 7089 0068 FC7D     	 ldrb r4,[r7,#23]
 7090 006a BB7D     	 ldrb r3,[r7,#22]
 7091 006c 0093     	 str r3,[sp]
 7092 006e 7B68     	 ldr r3,[r7,#4]
 7093 0070 0193     	 str r3,[sp,#4]
 7094 0072 8323     	 movs r3,#131
 7095 0074 0293     	 str r3,[sp,#8]
 7096 0076 F868     	 ldr r0,[r7,#12]
 7097 0078 1146     	 mov r1,r2
 7098 007a 044A     	 ldr r2,.L376
 7099 007c 2346     	 mov r3,r4
 7100 007e FFF7FEFF 	 bl optiga_cmd_execute
 7101              	.L373:
2786:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            cmd_param,
2787:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            optiga_cmd_set_object_protected_handler,
2788:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            next_execution_state,
2789:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            next_execution_sub_state,
2790:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            params,
2791:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            //lint --e{835} suppress "Upper 8 bits of apdu_data is kept as zero and 
2792:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****                            OPTIGA_CMD_SET_APDU_DATA(OPTIGA_CMD_SET_OBJECT_PROTECTED, OPTIGA_CMD_ZER
2793:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     }
2794:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** 
2795:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c ****     return (return_status);
 7102              	 .loc 1 2795 0
 7103 0082 BB8A     	 ldrh r3,[r7,#20]
2796:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/cmd\optiga_cmd.c **** }
 7104              	 .loc 1 2796 0
 7105 0084 1846     	 mov r0,r3
 7106 0086 1C37     	 adds r7,r7,#28
 7107              	.LCFI267:
 7108              	 .cfi_def_cfa_offset 12
 7109 0088 BD46     	 mov sp,r7
 7110              	.LCFI268:
 7111              	 .cfi_def_cfa_register 13
 7112              	 
 7113 008a 90BD     	 pop {r4,r7,pc}
 7114              	.L377:
 7115              	 .align 2
 7116              	.L376:
 7117 008c 00000000 	 .word optiga_cmd_set_object_protected_handler
 7118              	 .cfi_endproc
 7119              	.LFE51:
 7121              	 .text
 7122              	.Letext0:
 7123              	 .file 2 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 7124              	 .file 3 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 7125              	 .file 4 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/include/optiga/common/optiga_lib_types.h"
 7126              	 .file 5 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/include/optiga/common/optiga_lib_common.h"
 7127              	 .file 6 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/include/optiga/cmd/optiga_cmd.h"
 7128              	 .file 7 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/include/optiga/comms/optiga_comms.h"
 7129              	 .file 8 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/include/optiga/pal/pal_os_event.h"
DEFINED SYMBOLS
                            *ABS*:00000000 optiga_cmd.c
    {standard input}:20     .bss.g_optiga:00000000 $d
    {standard input}:23     .bss.g_optiga:00000000 g_optiga
    {standard input}:26     .data.g_optiga_list:00000000 $d
    {standard input}:29     .data.g_optiga_list:00000000 g_optiga_list
    {standard input}:32     .data.g_hibernate_datastore_id_list:00000000 $d
    {standard input}:35     .data.g_hibernate_datastore_id_list:00000000 g_hibernate_datastore_id_list
    {standard input}:42     .rodata.g_optiga_unique_application_identifier:00000000 g_optiga_unique_application_identifier
    {standard input}:39     .rodata.g_optiga_unique_application_identifier:00000000 $d
    {standard input}:60     .text.optiga_cmd_prepare_apdu_header:00000000 $t
    {standard input}:64     .text.optiga_cmd_prepare_apdu_header:00000000 optiga_cmd_prepare_apdu_header
    {standard input}:129    .text.optiga_cmd_prepare_tag_header:00000000 $t
    {standard input}:133    .text.optiga_cmd_prepare_tag_header:00000000 optiga_cmd_prepare_tag_header
    {standard input}:212    .text.optiga_cmd_event_trigger_execute:00000000 $t
    {standard input}:216    .text.optiga_cmd_event_trigger_execute:00000000 optiga_cmd_event_trigger_execute
    {standard input}:2922   .text.optiga_cmd_execute_handler:00000000 optiga_cmd_execute_handler
    {standard input}:251    .text.optiga_cmd_execute:00000000 $t
    {standard input}:255    .text.optiga_cmd_execute:00000000 optiga_cmd_execute
    {standard input}:324    .text.optiga_cmd_session_available:00000000 $t
    {standard input}:328    .text.optiga_cmd_session_available:00000000 optiga_cmd_session_available
    {standard input}:377    .text.optiga_cmd_session_assign:00000000 $t
    {standard input}:381    .text.optiga_cmd_session_assign:00000000 optiga_cmd_session_assign
    {standard input}:464    .text.optiga_cmd_session_assign:0000005c $d
    {standard input}:469    .text.optiga_cmd_session_free:00000000 $t
    {standard input}:473    .text.optiga_cmd_session_free:00000000 optiga_cmd_session_free
    {standard input}:535    .text.optiga_cmd_queue_get_state_of:00000000 $t
    {standard input}:539    .text.optiga_cmd_queue_get_state_of:00000000 optiga_cmd_queue_get_state_of
    {standard input}:625    .text.optiga_cmd_queue_get_count_of:00000000 $t
    {standard input}:629    .text.optiga_cmd_queue_get_count_of:00000000 optiga_cmd_queue_get_count_of
    {standard input}:738    .text.optiga_cmd_queue_assign_slot:00000000 $t
    {standard input}:742    .text.optiga_cmd_queue_assign_slot:00000000 optiga_cmd_queue_assign_slot
    {standard input}:825    .text.optiga_cmd_queue_deassign_slot:00000000 $t
    {standard input}:829    .text.optiga_cmd_queue_deassign_slot:00000000 optiga_cmd_queue_deassign_slot
    {standard input}:896    .text.optiga_cmd_queue_scheduler:00000000 $t
    {standard input}:900    .text.optiga_cmd_queue_scheduler:00000000 optiga_cmd_queue_scheduler
    {standard input}:1244   .text.optiga_cmd_queue_scheduler:00000224 $d
    {standard input}:1250   .text.optiga_cmd_queue_update_slot:00000000 $t
    {standard input}:1254   .text.optiga_cmd_queue_update_slot:00000000 optiga_cmd_queue_update_slot
    {standard input}:1419   .text.optiga_cmd_queue_reset_slot:00000000 $t
    {standard input}:1423   .text.optiga_cmd_queue_reset_slot:00000000 optiga_cmd_queue_reset_slot
    {standard input}:1519   .text.optiga_cmd_queue_reset_slot:00000098 $d
    {standard input}:1524   .text.optiga_cmd_request_session:00000000 $t
    {standard input}:1529   .text.optiga_cmd_request_session:00000000 optiga_cmd_request_session
    {standard input}:1567   .text.optiga_cmd_release_session:00000000 $t
    {standard input}:1572   .text.optiga_cmd_release_session:00000000 optiga_cmd_release_session
    {standard input}:1609   .text.optiga_cmd_request_lock:00000000 $t
    {standard input}:1614   .text.optiga_cmd_request_lock:00000000 optiga_cmd_request_lock
    {standard input}:1655   .text.optiga_cmd_release_lock:00000000 $t
    {standard input}:1660   .text.optiga_cmd_release_lock:00000000 optiga_cmd_release_lock
    {standard input}:1697   .text.optiga_cmd_restore_context:00000000 $t
    {standard input}:1701   .text.optiga_cmd_restore_context:00000000 optiga_cmd_restore_context
    {standard input}:1797   .text.optiga_cmd_store_context:00000000 $t
    {standard input}:1801   .text.optiga_cmd_store_context:00000000 optiga_cmd_store_context
    {standard input}:1868   .text.optiga_cmd_execute_comms_open:00000000 $t
    {standard input}:1872   .text.optiga_cmd_execute_comms_open:00000000 optiga_cmd_execute_comms_open
    {standard input}:2036   .text.optiga_cmd_execute_comms_open:000000ec $d
    {standard input}:2041   .text.optiga_cmd_execute_comms_close:00000000 $t
    {standard input}:2045   .text.optiga_cmd_execute_comms_close:00000000 optiga_cmd_execute_comms_close
    {standard input}:2183   .text.optiga_cmd_execute_prepare_command:00000000 $t
    {standard input}:2187   .text.optiga_cmd_execute_prepare_command:00000000 optiga_cmd_execute_prepare_command
    {standard input}:2222   .text.optiga_cmd_execute_prepare_command:00000024 $d
    {standard input}:2226   .text.optiga_cmd_execute_prepare_command:00000034 $t
    {standard input}:2465   .text.optiga_cmd_execute_get_device_error:00000000 $t
    {standard input}:2469   .text.optiga_cmd_execute_get_device_error:00000000 optiga_cmd_execute_get_device_error
    {standard input}:3265   .text.optiga_cmd_get_error_code_handler:00000000 optiga_cmd_get_error_code_handler
    {standard input}:2550   .text.optiga_cmd_execute_process_optiga_response:00000000 $t
    {standard input}:2554   .text.optiga_cmd_execute_process_optiga_response:00000000 optiga_cmd_execute_process_optiga_response
    {standard input}:2738   .text.optiga_cmd_execute_process_optiga_response:0000010c $d
    {standard input}:2743   .text.optiga_cmd_execute_process_response:00000000 $t
    {standard input}:2747   .text.optiga_cmd_execute_process_response:00000000 optiga_cmd_execute_process_response
    {standard input}:2777   .text.optiga_cmd_execute_process_response:0000001c $d
    {standard input}:2781   .text.optiga_cmd_execute_process_response:0000002c $t
    {standard input}:2865   .text.optiga_cmd_execute_error_handler:00000000 $t
    {standard input}:2869   .text.optiga_cmd_execute_error_handler:00000000 optiga_cmd_execute_error_handler
    {standard input}:2918   .text.optiga_cmd_execute_handler:00000000 $t
    {standard input}:2970   .text.optiga_cmd_execute_handler:00000034 $d
    {standard input}:2975   .text.optiga_cmd_execute_handler:00000048 $t
    {standard input}:3037   .text.optiga_cmd_create:00000000 $t
    {standard input}:3042   .text.optiga_cmd_create:00000000 optiga_cmd_create
    {standard input}:3192   .text.optiga_cmd_create:000000e0 $d
    {standard input}:3200   .text.optiga_cmd_destroy:00000000 $t
    {standard input}:3205   .text.optiga_cmd_destroy:00000000 optiga_cmd_destroy
    {standard input}:3261   .text.optiga_cmd_get_error_code_handler:00000000 $t
    {standard input}:3502   .text.optiga_cmd_get_error_code_handler:00000184 $d
    {standard input}:3507   .text.optiga_cmd_open_application_handler:00000000 $t
    {standard input}:3511   .text.optiga_cmd_open_application_handler:00000000 optiga_cmd_open_application_handler
    {standard input}:3738   .text.optiga_cmd_open_application_handler:0000013c $d
    {standard input}:3743   .text.optiga_cmd_open_application:00000000 $t
    {standard input}:3748   .text.optiga_cmd_open_application:00000000 optiga_cmd_open_application
    {standard input}:3797   .text.optiga_cmd_open_application:00000034 $d
    {standard input}:3802   .text.optiga_cmd_close_application_handler:00000000 $t
    {standard input}:3806   .text.optiga_cmd_close_application_handler:00000000 optiga_cmd_close_application_handler
    {standard input}:3951   .text.optiga_cmd_close_application:00000000 $t
    {standard input}:3956   .text.optiga_cmd_close_application:00000000 optiga_cmd_close_application
    {standard input}:4005   .text.optiga_cmd_close_application:00000034 $d
    {standard input}:4010   .text.optiga_cmd_get_data_object_handler:00000000 $t
    {standard input}:4014   .text.optiga_cmd_get_data_object_handler:00000000 optiga_cmd_get_data_object_handler
    {standard input}:4360   .text.optiga_cmd_get_data_object:00000000 $t
    {standard input}:4365   .text.optiga_cmd_get_data_object:00000000 optiga_cmd_get_data_object
    {standard input}:4414   .text.optiga_cmd_get_data_object:00000034 $d
    {standard input}:4419   .text.optiga_cmd_set_data_object_handler:00000000 $t
    {standard input}:4423   .text.optiga_cmd_set_data_object_handler:00000000 optiga_cmd_set_data_object_handler
    {standard input}:4661   .text.optiga_cmd_set_data_object:00000000 $t
    {standard input}:4666   .text.optiga_cmd_set_data_object:00000000 optiga_cmd_set_data_object
    {standard input}:4715   .text.optiga_cmd_set_data_object:00000034 $d
    {standard input}:4720   .text.optiga_cmd_get_random_handler:00000000 $t
    {standard input}:4724   .text.optiga_cmd_get_random_handler:00000000 optiga_cmd_get_random_handler
    {standard input}:4859   .text.optiga_cmd_get_random:00000000 $t
    {standard input}:4864   .text.optiga_cmd_get_random:00000000 optiga_cmd_get_random
    {standard input}:4916   .text.optiga_cmd_get_random:00000038 $d
    {standard input}:4921   .text.optiga_cmd_calc_sign_handler:00000000 $t
    {standard input}:4925   .text.optiga_cmd_calc_sign_handler:00000000 optiga_cmd_calc_sign_handler
    {standard input}:5184   .text.optiga_cmd_calc_sign:00000000 $t
    {standard input}:5189   .text.optiga_cmd_calc_sign:00000000 optiga_cmd_calc_sign
    {standard input}:5268   .text.optiga_cmd_calc_sign:0000005c $d
    {standard input}:5273   .text.optiga_cmd_verify_sign_handler:00000000 $t
    {standard input}:5277   .text.optiga_cmd_verify_sign_handler:00000000 optiga_cmd_verify_sign_handler
    {standard input}:5598   .text.optiga_cmd_verify_sign:00000000 $t
    {standard input}:5603   .text.optiga_cmd_verify_sign:00000000 optiga_cmd_verify_sign
    {standard input}:5652   .text.optiga_cmd_verify_sign:00000034 $d
    {standard input}:5657   .text.optiga_cmd_gen_keypair_handler:00000000 $t
    {standard input}:5661   .text.optiga_cmd_gen_keypair_handler:00000000 optiga_cmd_gen_keypair_handler
    {standard input}:6037   .text.optiga_cmd_gen_keypair:00000000 $t
    {standard input}:6042   .text.optiga_cmd_gen_keypair:00000000 optiga_cmd_gen_keypair
    {standard input}:6120   .text.optiga_cmd_gen_keypair:00000064 $d
    {standard input}:6125   .text.optiga_cmd_calc_hash_set_current_hash_sequence:00000000 $t
    {standard input}:6129   .text.optiga_cmd_calc_hash_set_current_hash_sequence:00000000 optiga_cmd_calc_hash_set_current_hash_sequence
    {standard input}:6220   .text.optiga_cmd_calc_hash_handler:00000000 $t
    {standard input}:6224   .text.optiga_cmd_calc_hash_handler:00000000 optiga_cmd_calc_hash_handler
    {standard input}:6734   .text.optiga_cmd_calc_hash:00000000 $t
    {standard input}:6739   .text.optiga_cmd_calc_hash:00000000 optiga_cmd_calc_hash
    {standard input}:6795   .text.optiga_cmd_calc_hash:0000003c $d
    {standard input}:6800   .text.optiga_cmd_set_object_protected_handler:00000000 $t
    {standard input}:6804   .text.optiga_cmd_set_object_protected_handler:00000000 optiga_cmd_set_object_protected_handler
    {standard input}:6994   .text.optiga_cmd_set_object_protected_handler:00000110 $d
    {standard input}:6999   .text.optiga_cmd_set_object_protected:00000000 $t
    {standard input}:7004   .text.optiga_cmd_set_object_protected:00000000 optiga_cmd_set_object_protected
    {standard input}:7117   .text.optiga_cmd_set_object_protected:0000008c $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
optiga_common_get_uint32
pal_os_event_register_callback_oneshot
pal_os_event_stop
pal_os_timer_get_time_in_microseconds
pal_os_event_start
pal_os_datastore_read
pal_os_datastore_write
optiga_comms_set_callback_context
optiga_comms_open
optiga_comms_close
optiga_comms_transceive
pal_os_lock_enter_critical_section
pal_os_calloc
pal_os_event_create
optiga_comms_create
pal_os_free
pal_os_lock_exit_critical_section
optiga_common_set_uint16
pal_os_memcpy
pal_os_memset
optiga_common_get_uint16
