   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,6
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "pal_crypt_mbedtls.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.pal_crypt_tls_prf_sha256,"ax",%progbits
  20              	 .align 2
  21              	 .global pal_crypt_tls_prf_sha256
  22              	 .thumb
  23              	 .thumb_func
  25              	pal_crypt_tls_prf_sha256:
  26              	.LFB12:
  27              	 .file 1 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal/pal_crypt_mbedtls.c"
   1:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** /**
   2:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * \copyright
   3:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * MIT License
   4:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
   5:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * Copyright (c) 2020 Infineon Technologies AG
   6:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
   7:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * Permission is hereby granted, free of charge, to any person obtaining a copy
   8:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * of this software and associated documentation files (the "Software"), to deal
   9:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * in the Software without restriction, including without limitation the rights
  10:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  11:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * copies of the Software, and to permit persons to whom the Software is
  12:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * furnished to do so, subject to the following conditions:
  13:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
  14:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * The above copyright notice and this permission notice shall be included in all
  15:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * copies or substantial portions of the Software.
  16:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
  17:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  18:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  19:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  20:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  21:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  22:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  23:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * SOFTWARE
  24:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
  25:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * \endcopyright
  26:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
  27:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * \author Infineon Technologies AG
  28:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
  29:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * \file pal_crypt_mbedtls.c
  30:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
  31:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * \brief   This file implements the platform abstraction layer APIs for cryptographic functions usi
  32:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
  33:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * \ingroup  grPAL
  34:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** *
  35:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** * @{
  36:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** */
  37:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
  38:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #include "optiga/common/optiga_lib_common.h"
  39:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #include "optiga/pal/pal_crypt.h"
  40:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #include "optiga/pal/pal_os_memory.h"
  41:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #include "mbedtls/ccm.h"
  42:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #include "mbedtls/md.h"
  43:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #include "mbedtls/ssl.h"
  44:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #include "mbedtls/version.h"
  45:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
  46:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #define PAL_CRYPT_MAX_LABEL_SEED_LENGTH     (96U)
  47:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** //lint --e{818, 715, 830} suppress "argument "p_pal_crypt" is not used in the implementation but ke
  48:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** pal_status_t pal_crypt_tls_prf_sha256(pal_crypt_t* p_pal_crypt,
  49:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                       const uint8_t * p_secret,
  50:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                       uint16_t secret_length,
  51:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                       const uint8_t * p_label,
  52:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                       uint16_t label_length,
  53:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                       const uint8_t * p_seed,
  54:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                       uint16_t seed_length,
  55:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                       uint8_t * p_derived_key,
  56:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                       uint16_t derived_key_length)
  57:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** {
  28              	 .loc 1 57 0
  29              	 .cfi_startproc
  30              	 
  31              	 
  32 0000 90B5     	 push {r4,r7,lr}
  33              	.LCFI0:
  34              	 .cfi_def_cfa_offset 12
  35              	 .cfi_offset 4,-12
  36              	 .cfi_offset 7,-8
  37              	 .cfi_offset 14,-4
  38 0002 B5B0     	 sub sp,sp,#212
  39              	.LCFI1:
  40              	 .cfi_def_cfa_offset 224
  41 0004 00AF     	 add r7,sp,#0
  42              	.LCFI2:
  43              	 .cfi_def_cfa_register 7
  44 0006 F860     	 str r0,[r7,#12]
  45 0008 B960     	 str r1,[r7,#8]
  46 000a 3B60     	 str r3,[r7]
  47 000c 1346     	 mov r3,r2
  48 000e FB80     	 strh r3,[r7,#6]
  58:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     #define PAL_CRYPT_DIGEST_MAX_SIZE    (32U)
  59:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
  60:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     pal_status_t return_value = PAL_STATUS_FAILURE;
  49              	 .loc 1 60 0
  50 0010 0123     	 movs r3,#1
  51 0012 A7F8CE30 	 strh r3,[r7,#206]
  61:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     uint8_t message_digest_length = PAL_CRYPT_DIGEST_MAX_SIZE;
  52              	 .loc 1 61 0
  53 0016 2023     	 movs r3,#32
  54 0018 87F8C930 	 strb r3,[r7,#201]
  62:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     uint16_t derive_key_len_index, hmac_checksum_result_index;
  63:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     uint16_t hmac_result_length;
  64:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     uint8_t md_hmac_temp_array[PAL_CRYPT_MAX_LABEL_SEED_LENGTH + PAL_CRYPT_DIGEST_MAX_SIZE];
  65:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     uint8_t hmac_checksum_result[PAL_CRYPT_DIGEST_MAX_SIZE];
  66:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     const mbedtls_md_info_t *message_digest_info;
  67:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_md_context_t message_digest_context;
  68:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     uint16_t final_seed_length = 0;
  55              	 .loc 1 68 0
  56 001c 0023     	 movs r3,#0
  57 001e A7F8C630 	 strh r3,[r7,#198]
  69:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****        
  70:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_md_init(&message_digest_context);
  58              	 .loc 1 70 0
  59 0022 07F11003 	 add r3,r7,#16
  60 0026 1846     	 mov r0,r3
  61 0028 FFF7FEFF 	 bl mbedtls_md_init
  71:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     
  72:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     do
  73:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     {
  74:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
  75:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if ((NULL == p_secret) || (NULL == p_label) || (NULL == p_seed) || (NULL == p_derived_key))
  62              	 .loc 1 75 0
  63 002c BB68     	 ldr r3,[r7,#8]
  64 002e 002B     	 cmp r3,#0
  65 0030 00F01E81 	 beq .L2
  66              	 .loc 1 75 0 is_stmt 0 discriminator 1
  67 0034 3B68     	 ldr r3,[r7]
  68 0036 002B     	 cmp r3,#0
  69 0038 00F01A81 	 beq .L2
  70              	 .loc 1 75 0 discriminator 2
  71 003c D7F8E430 	 ldr r3,[r7,#228]
  72 0040 002B     	 cmp r3,#0
  73 0042 00F01581 	 beq .L2
  74              	 .loc 1 75 0 discriminator 3
  75 0046 D7F8EC30 	 ldr r3,[r7,#236]
  76 004a 002B     	 cmp r3,#0
  77 004c 00F01081 	 beq .L2
  76:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
  77:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
  78:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
  79:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #endif  //OPTIGA_LIB_DEBUG_NULL_CHECK
  80:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
  81:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (sizeof(md_hmac_temp_array ) < (uint32_t)(message_digest_length + label_length + seed_le
  78              	 .loc 1 81 0 is_stmt 1
  79 0050 97F8C920 	 ldrb r2,[r7,#201]
  80 0054 B7F8E030 	 ldrh r3,[r7,#224]
  81 0058 1A44     	 add r2,r2,r3
  82 005a B7F8E830 	 ldrh r3,[r7,#232]
  83 005e 1344     	 add r3,r3,r2
  84 0060 802B     	 cmp r3,#128
  85 0062 03D9     	 bls .L3
  82:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
  83:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             return_value = PAL_STATUS_INVALID_INPUT;
  86              	 .loc 1 83 0
  87 0064 0423     	 movs r3,#4
  88 0066 A7F8CE30 	 strh r3,[r7,#206]
  84:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
  89              	 .loc 1 84 0
  90 006a 01E1     	 b .L2
  91              	.L3:
  85:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
  86:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
  87:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         message_digest_info = mbedtls_md_info_from_type(MBEDTLS_MD_SHA256);
  92              	 .loc 1 87 0
  93 006c 0620     	 movs r0,#6
  94 006e FFF7FEFF 	 bl mbedtls_md_info_from_type
  95 0072 C7F8C000 	 str r0,[r7,#192]
  88:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
  89:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         memcpy(md_hmac_temp_array + message_digest_length, p_label, label_length);
  96              	 .loc 1 89 0
  97 0076 97F8C930 	 ldrb r3,[r7,#201]
  98 007a 07F13C02 	 add r2,r7,#60
  99 007e 1A44     	 add r2,r2,r3
 100 0080 B7F8E030 	 ldrh r3,[r7,#224]
 101 0084 1046     	 mov r0,r2
 102 0086 3968     	 ldr r1,[r7]
 103 0088 1A46     	 mov r2,r3
 104 008a FFF7FEFF 	 bl memcpy
  90:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         memcpy(md_hmac_temp_array + message_digest_length + label_length, p_seed, seed_length);
 105              	 .loc 1 90 0
 106 008e 97F8C920 	 ldrb r2,[r7,#201]
 107 0092 B7F8E030 	 ldrh r3,[r7,#224]
 108 0096 1344     	 add r3,r3,r2
 109 0098 07F13C02 	 add r2,r7,#60
 110 009c 1A44     	 add r2,r2,r3
 111 009e B7F8E830 	 ldrh r3,[r7,#232]
 112 00a2 1046     	 mov r0,r2
 113 00a4 D7F8E410 	 ldr r1,[r7,#228]
 114 00a8 1A46     	 mov r2,r3
 115 00aa FFF7FEFF 	 bl memcpy
  91:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         final_seed_length = label_length + seed_length;
 116              	 .loc 1 91 0
 117 00ae B7F8E020 	 ldrh r2,[r7,#224]
 118 00b2 B7F8E830 	 ldrh r3,[r7,#232]
 119 00b6 1344     	 add r3,r3,r2
 120 00b8 A7F8C630 	 strh r3,[r7,#198]
  92:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
  93:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (0 != (mbedtls_md_setup(&message_digest_context,message_digest_info,1)))
 121              	 .loc 1 93 0
 122 00bc 07F11003 	 add r3,r7,#16
 123 00c0 1846     	 mov r0,r3
 124 00c2 D7F8C010 	 ldr r1,[r7,#192]
 125 00c6 0122     	 movs r2,#1
 126 00c8 FFF7FEFF 	 bl mbedtls_md_setup
 127 00cc 0346     	 mov r3,r0
 128 00ce 002B     	 cmp r3,#0
 129 00d0 03D0     	 beq .L4
  94:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
  95:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             return_value = PAL_STATUS_INVALID_INPUT;
 130              	 .loc 1 95 0
 131 00d2 0423     	 movs r3,#4
 132 00d4 A7F8CE30 	 strh r3,[r7,#206]
  96:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 133              	 .loc 1 96 0
 134 00d8 CAE0     	 b .L2
 135              	.L4:
  97:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
  98:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
  99:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (0 != mbedtls_md_hmac_starts(&message_digest_context, p_secret, secret_length))
 136              	 .loc 1 99 0
 137 00da FB88     	 ldrh r3,[r7,#6]
 138 00dc 07F11002 	 add r2,r7,#16
 139 00e0 1046     	 mov r0,r2
 140 00e2 B968     	 ldr r1,[r7,#8]
 141 00e4 1A46     	 mov r2,r3
 142 00e6 FFF7FEFF 	 bl mbedtls_md_hmac_starts
 143 00ea 0346     	 mov r3,r0
 144 00ec 002B     	 cmp r3,#0
 145 00ee 00D0     	 beq .L5
 100:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 101:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 146              	 .loc 1 101 0
 147 00f0 BEE0     	 b .L2
 148              	.L5:
 102:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 103:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****        
 104:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (0 != mbedtls_md_hmac_update(&message_digest_context, md_hmac_temp_array + message_diges
 149              	 .loc 1 104 0
 150 00f2 97F8C930 	 ldrb r3,[r7,#201]
 151 00f6 07F13C02 	 add r2,r7,#60
 152 00fa 1A44     	 add r2,r2,r3
 153 00fc B7F8C630 	 ldrh r3,[r7,#198]
 154 0100 07F11001 	 add r1,r7,#16
 155 0104 0846     	 mov r0,r1
 156 0106 1146     	 mov r1,r2
 157 0108 1A46     	 mov r2,r3
 158 010a FFF7FEFF 	 bl mbedtls_md_hmac_update
 159 010e 0346     	 mov r3,r0
 160 0110 002B     	 cmp r3,#0
 161 0112 00D0     	 beq .L6
 105:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 106:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 162              	 .loc 1 106 0
 163 0114 ACE0     	 b .L2
 164              	.L6:
 107:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 108:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         
 109:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (0 != mbedtls_md_hmac_finish(&message_digest_context, md_hmac_temp_array))
 165              	 .loc 1 109 0
 166 0116 07F11002 	 add r2,r7,#16
 167 011a 07F13C03 	 add r3,r7,#60
 168 011e 1046     	 mov r0,r2
 169 0120 1946     	 mov r1,r3
 170 0122 FFF7FEFF 	 bl mbedtls_md_hmac_finish
 171 0126 0346     	 mov r3,r0
 172 0128 002B     	 cmp r3,#0
 173 012a 00D0     	 beq .L7
 110:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 111:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 174              	 .loc 1 111 0
 175 012c A0E0     	 b .L2
 176              	.L7:
 112:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 113:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 114:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         for (derive_key_len_index = 0; derive_key_len_index < derived_key_length; 
 177              	 .loc 1 114 0
 178 012e 0023     	 movs r3,#0
 179 0130 A7F8CC30 	 strh r3,[r7,#204]
 180 0134 8CE0     	 b .L8
 181              	.L20:
 115:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****              derive_key_len_index += message_digest_length)
 116:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 117:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             if (0 != mbedtls_md_hmac_reset(&message_digest_context))
 182              	 .loc 1 117 0
 183 0136 07F11003 	 add r3,r7,#16
 184 013a 1846     	 mov r0,r3
 185 013c FFF7FEFF 	 bl mbedtls_md_hmac_reset
 186 0140 0346     	 mov r3,r0
 187 0142 002B     	 cmp r3,#0
 188 0144 00D0     	 beq .L9
 118:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             {
 119:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                 break;
 189              	 .loc 1 119 0
 190 0146 8AE0     	 b .L10
 191              	.L9:
 120:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             }
 121:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             if (0 != mbedtls_md_hmac_update(&message_digest_context, md_hmac_temp_array, 
 122:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                             message_digest_length + final_seed_length))
 192              	 .loc 1 122 0
 193 0148 97F8C920 	 ldrb r2,[r7,#201]
 194 014c B7F8C630 	 ldrh r3,[r7,#198]
 195 0150 1344     	 add r3,r3,r2
 121:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                             message_digest_length + final_seed_length))
 196              	 .loc 1 121 0
 197 0152 1C46     	 mov r4,r3
 198 0154 07F11002 	 add r2,r7,#16
 199 0158 07F13C03 	 add r3,r7,#60
 200 015c 1046     	 mov r0,r2
 201 015e 1946     	 mov r1,r3
 202 0160 2246     	 mov r2,r4
 203 0162 FFF7FEFF 	 bl mbedtls_md_hmac_update
 204 0166 0346     	 mov r3,r0
 205 0168 002B     	 cmp r3,#0
 206 016a 00D0     	 beq .L11
 123:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             {
 124:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                 break;                
 207              	 .loc 1 124 0
 208 016c 77E0     	 b .L10
 209              	.L11:
 125:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             }
 126:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             if (0 != mbedtls_md_hmac_finish(&message_digest_context, hmac_checksum_result))
 210              	 .loc 1 126 0
 211 016e 07F11002 	 add r2,r7,#16
 212 0172 07F11C03 	 add r3,r7,#28
 213 0176 1046     	 mov r0,r2
 214 0178 1946     	 mov r1,r3
 215 017a FFF7FEFF 	 bl mbedtls_md_hmac_finish
 216 017e 0346     	 mov r3,r0
 217 0180 002B     	 cmp r3,#0
 218 0182 00D0     	 beq .L12
 127:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             {
 128:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                 break;                                
 219              	 .loc 1 128 0
 220 0184 6BE0     	 b .L10
 221              	.L12:
 129:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             }
 130:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 131:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             if (0 != mbedtls_md_hmac_reset(&message_digest_context))
 222              	 .loc 1 131 0
 223 0186 07F11003 	 add r3,r7,#16
 224 018a 1846     	 mov r0,r3
 225 018c FFF7FEFF 	 bl mbedtls_md_hmac_reset
 226 0190 0346     	 mov r3,r0
 227 0192 002B     	 cmp r3,#0
 228 0194 00D0     	 beq .L13
 132:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             {
 133:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                 break;                
 229              	 .loc 1 133 0
 230 0196 62E0     	 b .L10
 231              	.L13:
 134:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             }
 135:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             if (0 != mbedtls_md_hmac_update(&message_digest_context, md_hmac_temp_array, message_di
 232              	 .loc 1 135 0
 233 0198 97F8C930 	 ldrb r3,[r7,#201]
 234 019c 07F11001 	 add r1,r7,#16
 235 01a0 07F13C02 	 add r2,r7,#60
 236 01a4 0846     	 mov r0,r1
 237 01a6 1146     	 mov r1,r2
 238 01a8 1A46     	 mov r2,r3
 239 01aa FFF7FEFF 	 bl mbedtls_md_hmac_update
 240 01ae 0346     	 mov r3,r0
 241 01b0 002B     	 cmp r3,#0
 242 01b2 00D0     	 beq .L14
 136:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             {
 137:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                 break;                                
 243              	 .loc 1 137 0
 244 01b4 53E0     	 b .L10
 245              	.L14:
 138:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             }
 139:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             if (0 != mbedtls_md_hmac_finish(&message_digest_context, md_hmac_temp_array))
 246              	 .loc 1 139 0
 247 01b6 07F11002 	 add r2,r7,#16
 248 01ba 07F13C03 	 add r3,r7,#60
 249 01be 1046     	 mov r0,r2
 250 01c0 1946     	 mov r1,r3
 251 01c2 FFF7FEFF 	 bl mbedtls_md_hmac_finish
 252 01c6 0346     	 mov r3,r0
 253 01c8 002B     	 cmp r3,#0
 254 01ca 00D0     	 beq .L15
 140:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             {
 141:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                 break;                                
 255              	 .loc 1 141 0
 256 01cc 47E0     	 b .L10
 257              	.L15:
 142:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             }
 143:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             hmac_result_length = ((derive_key_len_index + message_digest_length) > derived_key_leng
 258              	 .loc 1 144 0
 259 01ce B7F8CC20 	 ldrh r2,[r7,#204]
 260 01d2 97F8C930 	 ldrb r3,[r7,#201]
 261 01d6 1A44     	 add r2,r2,r3
 262 01d8 B7F8F030 	 ldrh r3,[r7,#240]
 263 01dc 9A42     	 cmp r2,r3
 264 01de 0ADD     	 ble .L16
 145:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                   (derived_key_length % message_digest_length) : (message_digest_le
 265              	 .loc 1 145 0 discriminator 1
 266 01e0 B7F8F030 	 ldrh r3,[r7,#240]
 267 01e4 97F8C920 	 ldrb r2,[r7,#201]
 268 01e8 93FBF2F1 	 sdiv r1,r3,r2
 269 01ec 02FB01F2 	 mul r2,r2,r1
 270 01f0 9B1A     	 subs r3,r3,r2
 144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                   (derived_key_length % message_digest_length) : (message_digest_le
 271              	 .loc 1 144 0 discriminator 1
 272 01f2 9BB2     	 uxth r3,r3
 273 01f4 02E0     	 b .L17
 274              	.L16:
 144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                   (derived_key_length % message_digest_length) : (message_digest_le
 275              	 .loc 1 144 0 is_stmt 0 discriminator 2
 276 01f6 97F8C930 	 ldrb r3,[r7,#201]
 277 01fa 9BB2     	 uxth r3,r3
 278              	.L17:
 144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                   (derived_key_length % message_digest_length) : (message_digest_le
 279              	 .loc 1 144 0 discriminator 4
 280 01fc A7F8BE30 	 strh r3,[r7,#190]
 146:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 147:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             for (hmac_checksum_result_index = 0; hmac_checksum_result_index < hmac_result_length; 
 281              	 .loc 1 147 0 is_stmt 1 discriminator 4
 282 0200 0023     	 movs r3,#0
 283 0202 A7F8CA30 	 strh r3,[r7,#202]
 284 0206 15E0     	 b .L18
 285              	.L19:
 148:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                  hmac_checksum_result_index++)
 149:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             {
 150:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                 p_derived_key[derive_key_len_index + hmac_checksum_result_index] = 
 286              	 .loc 1 150 0
 287 0208 B7F8CC20 	 ldrh r2,[r7,#204]
 288 020c B7F8CA30 	 ldrh r3,[r7,#202]
 289 0210 1344     	 add r3,r3,r2
 290 0212 1A46     	 mov r2,r3
 291 0214 D7F8EC30 	 ldr r3,[r7,#236]
 292 0218 1344     	 add r3,r3,r2
 151:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                                                     hmac_checksum_result[hmac_check
 293              	 .loc 1 151 0
 294 021a B7F8CA20 	 ldrh r2,[r7,#202]
 295 021e 07F1D001 	 add r1,r7,#208
 296 0222 0A44     	 add r2,r2,r1
 297 0224 12F8B42C 	 ldrb r2,[r2,#-180]
 150:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                                                     hmac_checksum_result[hmac_check
 298              	 .loc 1 150 0
 299 0228 1A70     	 strb r2,[r3]
 148:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                  hmac_checksum_result_index++)
 300              	 .loc 1 148 0
 301 022a B7F8CA30 	 ldrh r3,[r7,#202]
 302 022e 0133     	 adds r3,r3,#1
 303 0230 A7F8CA30 	 strh r3,[r7,#202]
 304              	.L18:
 147:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                  hmac_checksum_result_index++)
 305              	 .loc 1 147 0 discriminator 1
 306 0234 B7F8CA20 	 ldrh r2,[r7,#202]
 307 0238 B7F8BE30 	 ldrh r3,[r7,#190]
 308 023c 9A42     	 cmp r2,r3
 309 023e E3D3     	 bcc .L19
 115:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 310              	 .loc 1 115 0
 311 0240 97F8C930 	 ldrb r3,[r7,#201]
 312 0244 9AB2     	 uxth r2,r3
 313 0246 B7F8CC30 	 ldrh r3,[r7,#204]
 314 024a 1344     	 add r3,r3,r2
 315 024c A7F8CC30 	 strh r3,[r7,#204]
 316              	.L8:
 114:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****              derive_key_len_index += message_digest_length)
 317              	 .loc 1 114 0 discriminator 1
 318 0250 B7F8CC20 	 ldrh r2,[r7,#204]
 319 0254 B7F8F030 	 ldrh r3,[r7,#240]
 320 0258 9A42     	 cmp r2,r3
 321 025a FFF46CAF 	 bcc .L20
 322              	.L10:
 152:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             }
 153:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 154:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (derive_key_len_index >= derived_key_length)
 323              	 .loc 1 154 0
 324 025e B7F8CC20 	 ldrh r2,[r7,#204]
 325 0262 B7F8F030 	 ldrh r3,[r7,#240]
 326 0266 9A42     	 cmp r2,r3
 327 0268 02D3     	 bcc .L2
 155:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 156:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             return_value = PAL_STATUS_SUCCESS;
 328              	 .loc 1 156 0
 329 026a 0023     	 movs r3,#0
 330 026c A7F8CE30 	 strh r3,[r7,#206]
 331              	.L2:
 157:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 158:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     } while (FALSE);
 159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     
 160:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_md_free(&message_digest_context);
 332              	 .loc 1 160 0
 333 0270 07F11003 	 add r3,r7,#16
 334 0274 1846     	 mov r0,r3
 335 0276 FFF7FEFF 	 bl mbedtls_md_free
 161:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 162:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     memset(md_hmac_temp_array, 0x00, sizeof(md_hmac_temp_array));
 336              	 .loc 1 162 0
 337 027a 07F13C03 	 add r3,r7,#60
 338 027e 1846     	 mov r0,r3
 339 0280 0021     	 movs r1,#0
 340 0282 8022     	 movs r2,#128
 341 0284 FFF7FEFF 	 bl memset
 163:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     memset(hmac_checksum_result, 0x00, sizeof(hmac_checksum_result));    
 342              	 .loc 1 163 0
 343 0288 07F11C03 	 add r3,r7,#28
 344 028c 1846     	 mov r0,r3
 345 028e 0021     	 movs r1,#0
 346 0290 2022     	 movs r2,#32
 347 0292 FFF7FEFF 	 bl memset
 164:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     #undef PAL_CRYPT_DIGEST_MAX_SIZE
 165:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     return return_value;
 348              	 .loc 1 165 0
 349 0296 B7F8CE30 	 ldrh r3,[r7,#206]
 166:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** }
 350              	 .loc 1 166 0
 351 029a 1846     	 mov r0,r3
 352 029c D437     	 adds r7,r7,#212
 353              	.LCFI3:
 354              	 .cfi_def_cfa_offset 12
 355 029e BD46     	 mov sp,r7
 356              	.LCFI4:
 357              	 .cfi_def_cfa_register 13
 358              	 
 359 02a0 90BD     	 pop {r4,r7,pc}
 360              	 .cfi_endproc
 361              	.LFE12:
 363 02a2 00BF     	 .section .text.pal_crypt_encrypt_aes128_ccm,"ax",%progbits
 364              	 .align 2
 365              	 .global pal_crypt_encrypt_aes128_ccm
 366              	 .thumb
 367              	 .thumb_func
 369              	pal_crypt_encrypt_aes128_ccm:
 370              	.LFB13:
 167:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 168:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** //lint --e{818, 715, 830} suppress "argument "p_pal_crypt" is not used in the implementation but ke
 169:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** pal_status_t pal_crypt_encrypt_aes128_ccm(pal_crypt_t* p_pal_crypt,
 170:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           const uint8_t * p_plain_text,
 171:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint16_t plain_text_length,
 172:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           const uint8_t * p_encrypt_key,
 173:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           const uint8_t * p_nonce,
 174:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint16_t nonce_length,
 175:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           const uint8_t * p_associated_data,
 176:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint16_t associated_data_length,
 177:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint8_t mac_size,
 178:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint8_t * p_cipher_text)
 179:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** {
 371              	 .loc 1 179 0
 372              	 .cfi_startproc
 373              	 
 374              	 
 375 0000 B0B5     	 push {r4,r5,r7,lr}
 376              	.LCFI5:
 377              	 .cfi_def_cfa_offset 16
 378              	 .cfi_offset 4,-16
 379              	 .cfi_offset 5,-12
 380              	 .cfi_offset 7,-8
 381              	 .cfi_offset 14,-4
 382 0002 9EB0     	 sub sp,sp,#120
 383              	.LCFI6:
 384              	 .cfi_def_cfa_offset 136
 385 0004 06AF     	 add r7,sp,#24
 386              	.LCFI7:
 387              	 .cfi_def_cfa 7,112
 388 0006 F860     	 str r0,[r7,#12]
 389 0008 B960     	 str r1,[r7,#8]
 390 000a 3B60     	 str r3,[r7]
 391 000c 1346     	 mov r3,r2
 392 000e FB80     	 strh r3,[r7,#6]
 180:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     #define AES128_KEY_BITS_SIZE    (16U)
 181:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     #define MAC_TAG_BUFFER_SIZE     (16U)
 182:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     
 183:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     pal_status_t return_status = PAL_STATUS_FAILURE;
 393              	 .loc 1 183 0
 394 0010 0123     	 movs r3,#1
 395 0012 A7F85E30 	 strh r3,[r7,#94]
 184:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     uint8_t mac_output[MAC_TAG_BUFFER_SIZE];
 185:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_ccm_context sEncrypt;
 186:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 187:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_ccm_init(&sEncrypt);
 396              	 .loc 1 187 0
 397 0016 07F11403 	 add r3,r7,#20
 398 001a 1846     	 mov r0,r3
 399 001c FFF7FEFF 	 bl mbedtls_ccm_init
 188:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 189:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     do
 190:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     {
 191:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 192:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if ((NULL == p_cipher_text) || (NULL == p_plain_text) ||
 400              	 .loc 1 192 0
 401 0020 D7F88430 	 ldr r3,[r7,#132]
 402 0024 002B     	 cmp r3,#0
 403 0026 45D0     	 beq .L23
 404              	 .loc 1 192 0 is_stmt 0 discriminator 1
 405 0028 BB68     	 ldr r3,[r7,#8]
 406 002a 002B     	 cmp r3,#0
 407 002c 42D0     	 beq .L23
 408              	 .loc 1 192 0 discriminator 2
 409 002e 3B6F     	 ldr r3,[r7,#112]
 410 0030 002B     	 cmp r3,#0
 411 0032 3FD0     	 beq .L23
 193:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             (NULL == p_nonce) || (NULL == p_associated_data) || (NULL == p_encrypt_key))
 412              	 .loc 1 193 0 is_stmt 1
 413 0034 BB6F     	 ldr r3,[r7,#120]
 414 0036 002B     	 cmp r3,#0
 415 0038 3CD0     	 beq .L23
 416              	 .loc 1 193 0 is_stmt 0 discriminator 1
 417 003a 3B68     	 ldr r3,[r7]
 418 003c 002B     	 cmp r3,#0
 419 003e 39D0     	 beq .L23
 194:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 195:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 196:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 197:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #endif
 198:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 199:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (0 != mbedtls_ccm_setkey(&sEncrypt, MBEDTLS_CIPHER_ID_AES, p_encrypt_key, 8 * AES128_KEY
 420              	 .loc 1 199 0 is_stmt 1
 421 0040 07F11403 	 add r3,r7,#20
 422 0044 1846     	 mov r0,r3
 423 0046 0221     	 movs r1,#2
 424 0048 3A68     	 ldr r2,[r7]
 425 004a 8023     	 movs r3,#128
 426 004c FFF7FEFF 	 bl mbedtls_ccm_setkey
 427 0050 0346     	 mov r3,r0
 428 0052 002B     	 cmp r3,#0
 429 0054 00D0     	 beq .L24
 200:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 201:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 430              	 .loc 1 201 0
 431 0056 2DE0     	 b .L23
 432              	.L24:
 202:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 203:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         
 204:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (0 != mbedtls_ccm_encrypt_and_tag(&sEncrypt,
 433              	 .loc 1 204 0
 434 0058 FD88     	 ldrh r5,[r7,#6]
 435 005a B7F87440 	 ldrh r4,[r7,#116]
 436 005e B7F87C20 	 ldrh r2,[r7,#124]
 437 0062 97F88030 	 ldrb r3,[r7,#128]
 438 0066 07F11400 	 add r0,r7,#20
 439 006a B96F     	 ldr r1,[r7,#120]
 440 006c 0091     	 str r1,[sp]
 441 006e 0192     	 str r2,[sp,#4]
 442 0070 BA68     	 ldr r2,[r7,#8]
 443 0072 0292     	 str r2,[sp,#8]
 444 0074 D7F88420 	 ldr r2,[r7,#132]
 445 0078 0392     	 str r2,[sp,#12]
 446 007a 07F14C02 	 add r2,r7,#76
 447 007e 0492     	 str r2,[sp,#16]
 448 0080 0593     	 str r3,[sp,#20]
 449 0082 2946     	 mov r1,r5
 450 0084 3A6F     	 ldr r2,[r7,#112]
 451 0086 2346     	 mov r3,r4
 452 0088 FFF7FEFF 	 bl mbedtls_ccm_encrypt_and_tag
 453 008c 0346     	 mov r3,r0
 454 008e 002B     	 cmp r3,#0
 455 0090 00D0     	 beq .L25
 205:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               plain_text_length,
 206:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               p_nonce,
 207:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               nonce_length,
 208:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               p_associated_data,
 209:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               associated_data_length,
 210:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               p_plain_text,
 211:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               p_cipher_text,
 212:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               mac_output,
 213:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                               mac_size))
 214:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         
 215:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 216:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 456              	 .loc 1 216 0
 457 0092 0FE0     	 b .L23
 458              	.L25:
 217:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 218:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 219:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         memcpy((p_cipher_text + plain_text_length), mac_output, mac_size);
 459              	 .loc 1 219 0
 460 0094 FB88     	 ldrh r3,[r7,#6]
 461 0096 D7F88420 	 ldr r2,[r7,#132]
 462 009a D118     	 adds r1,r2,r3
 463 009c 97F88030 	 ldrb r3,[r7,#128]
 464 00a0 07F14C02 	 add r2,r7,#76
 465 00a4 0846     	 mov r0,r1
 466 00a6 1146     	 mov r1,r2
 467 00a8 1A46     	 mov r2,r3
 468 00aa FFF7FEFF 	 bl memcpy
 220:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         return_status = PAL_STATUS_SUCCESS;
 469              	 .loc 1 220 0
 470 00ae 0023     	 movs r3,#0
 471 00b0 A7F85E30 	 strh r3,[r7,#94]
 472              	.L23:
 221:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     } while (FALSE);
 222:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_ccm_free(&sEncrypt);
 473              	 .loc 1 222 0
 474 00b4 07F11403 	 add r3,r7,#20
 475 00b8 1846     	 mov r0,r3
 476 00ba FFF7FEFF 	 bl mbedtls_ccm_free
 223:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     #undef AES128_KEY_BITS_SIZE
 224:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     #undef MAC_TAG_BUFFER_SIZE    
 225:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     return return_status;
 477              	 .loc 1 225 0
 478 00be B7F85E30 	 ldrh r3,[r7,#94]
 226:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** }
 479              	 .loc 1 226 0
 480 00c2 1846     	 mov r0,r3
 481 00c4 6037     	 adds r7,r7,#96
 482              	.LCFI8:
 483              	 .cfi_def_cfa_offset 16
 484 00c6 BD46     	 mov sp,r7
 485              	.LCFI9:
 486              	 .cfi_def_cfa_register 13
 487              	 
 488 00c8 B0BD     	 pop {r4,r5,r7,pc}
 489              	 .cfi_endproc
 490              	.LFE13:
 492 00ca 00BF     	 .section .text.pal_crypt_decrypt_aes128_ccm,"ax",%progbits
 493              	 .align 2
 494              	 .global pal_crypt_decrypt_aes128_ccm
 495              	 .thumb
 496              	 .thumb_func
 498              	pal_crypt_decrypt_aes128_ccm:
 499              	.LFB14:
 227:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 228:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** //lint --e{818, 715, 830} suppress "argument "p_pal_crypt" is not used in the implementation but ke
 229:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** pal_status_t pal_crypt_decrypt_aes128_ccm(pal_crypt_t* p_pal_crypt,
 230:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           const uint8_t * p_cipher_text,
 231:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint16_t cipher_text_length,
 232:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           const uint8_t * p_decrypt_key,
 233:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           const uint8_t * p_nonce,
 234:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint16_t nonce_length,
 235:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           const uint8_t * p_associated_data,
 236:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint16_t associated_data_length,
 237:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint8_t mac_size,
 238:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           uint8_t * p_plain_text)
 239:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** {
 500              	 .loc 1 239 0
 501              	 .cfi_startproc
 502              	 
 503              	 
 504 0000 F0B5     	 push {r4,r5,r6,r7,lr}
 505              	.LCFI10:
 506              	 .cfi_def_cfa_offset 20
 507              	 .cfi_offset 4,-20
 508              	 .cfi_offset 5,-16
 509              	 .cfi_offset 6,-12
 510              	 .cfi_offset 7,-8
 511              	 .cfi_offset 14,-4
 512 0002 9BB0     	 sub sp,sp,#108
 513              	.LCFI11:
 514              	 .cfi_def_cfa_offset 128
 515 0004 06AF     	 add r7,sp,#24
 516              	.LCFI12:
 517              	 .cfi_def_cfa 7,104
 518 0006 F860     	 str r0,[r7,#12]
 519 0008 B960     	 str r1,[r7,#8]
 520 000a 3B60     	 str r3,[r7]
 521 000c 1346     	 mov r3,r2
 522 000e FB80     	 strh r3,[r7,#6]
 240:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     #define AES128_KEY_BITS_SIZE    (16U)
 241:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     pal_status_t return_status = PAL_STATUS_FAILURE;
 523              	 .loc 1 241 0
 524 0010 0123     	 movs r3,#1
 525 0012 A7F84E30 	 strh r3,[r7,#78]
 242:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_ccm_context sDecrypt;
 243:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 244:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_ccm_init(&sDecrypt);
 526              	 .loc 1 244 0
 527 0016 07F11403 	 add r3,r7,#20
 528 001a 1846     	 mov r0,r3
 529 001c FFF7FEFF 	 bl mbedtls_ccm_init
 245:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 246:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     do
 247:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     {
 248:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #ifdef OPTIGA_LIB_DEBUG_NULL_CHECK
 249:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if ((NULL == p_plain_text) || (NULL == p_cipher_text) ||
 530              	 .loc 1 249 0
 531 0020 FB6F     	 ldr r3,[r7,#124]
 532 0022 002B     	 cmp r3,#0
 533 0024 41D0     	 beq .L28
 534              	 .loc 1 249 0 is_stmt 0 discriminator 1
 535 0026 BB68     	 ldr r3,[r7,#8]
 536 0028 002B     	 cmp r3,#0
 537 002a 3ED0     	 beq .L28
 538              	 .loc 1 249 0 discriminator 2
 539 002c BB6E     	 ldr r3,[r7,#104]
 540 002e 002B     	 cmp r3,#0
 541 0030 3BD0     	 beq .L28
 250:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             (NULL == p_nonce) || (NULL == p_associated_data) || (NULL == p_decrypt_key))
 542              	 .loc 1 250 0 is_stmt 1
 543 0032 3B6F     	 ldr r3,[r7,#112]
 544 0034 002B     	 cmp r3,#0
 545 0036 38D0     	 beq .L28
 546              	 .loc 1 250 0 is_stmt 0 discriminator 1
 547 0038 3B68     	 ldr r3,[r7]
 548 003a 002B     	 cmp r3,#0
 549 003c 35D0     	 beq .L28
 251:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 252:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 253:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 254:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** #endif
 255:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 256:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (0 != mbedtls_ccm_setkey(&sDecrypt, MBEDTLS_CIPHER_ID_AES, p_decrypt_key, 8 * AES128_KEY
 550              	 .loc 1 256 0 is_stmt 1
 551 003e 07F11403 	 add r3,r7,#20
 552 0042 1846     	 mov r0,r3
 553 0044 0221     	 movs r1,#2
 554 0046 3A68     	 ldr r2,[r7]
 555 0048 8023     	 movs r3,#128
 556 004a FFF7FEFF 	 bl mbedtls_ccm_setkey
 557 004e 0346     	 mov r3,r0
 558 0050 002B     	 cmp r3,#0
 559 0052 00D0     	 beq .L29
 257:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 258:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 560              	 .loc 1 258 0
 561 0054 29E0     	 b .L28
 562              	.L29:
 259:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 260:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 261:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (0 != mbedtls_ccm_auth_decrypt(&sDecrypt,
 262:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           (cipher_text_length - mac_size),
 563              	 .loc 1 262 0
 564 0056 FA88     	 ldrh r2,[r7,#6]
 565 0058 97F87830 	 ldrb r3,[r7,#120]
 566 005c D31A     	 subs r3,r2,r3
 261:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           (cipher_text_length - mac_size),
 567              	 .loc 1 261 0
 568 005e 1E46     	 mov r6,r3
 569 0060 B7F86C40 	 ldrh r4,[r7,#108]
 570 0064 B7F87410 	 ldrh r1,[r7,#116]
 263:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           p_nonce,
 264:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           nonce_length,
 265:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           p_associated_data,
 266:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           associated_data_length,
 267:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           p_cipher_text,
 268:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           p_plain_text, 
 269:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           &p_cipher_text[cipher_text_length - mac_size],
 571              	 .loc 1 269 0
 572 0068 FA88     	 ldrh r2,[r7,#6]
 573 006a 97F87830 	 ldrb r3,[r7,#120]
 574 006e D31A     	 subs r3,r2,r3
 261:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           (cipher_text_length - mac_size),
 575              	 .loc 1 261 0
 576 0070 1A46     	 mov r2,r3
 577 0072 BB68     	 ldr r3,[r7,#8]
 578 0074 1A44     	 add r2,r2,r3
 579 0076 97F87830 	 ldrb r3,[r7,#120]
 580 007a 07F11405 	 add r5,r7,#20
 581 007e 386F     	 ldr r0,[r7,#112]
 582 0080 0090     	 str r0,[sp]
 583 0082 0191     	 str r1,[sp,#4]
 584 0084 B968     	 ldr r1,[r7,#8]
 585 0086 0291     	 str r1,[sp,#8]
 586 0088 F96F     	 ldr r1,[r7,#124]
 587 008a 0391     	 str r1,[sp,#12]
 588 008c 0492     	 str r2,[sp,#16]
 589 008e 0593     	 str r3,[sp,#20]
 590 0090 2846     	 mov r0,r5
 591 0092 3146     	 mov r1,r6
 592 0094 BA6E     	 ldr r2,[r7,#104]
 593 0096 2346     	 mov r3,r4
 594 0098 FFF7FEFF 	 bl mbedtls_ccm_auth_decrypt
 595 009c 0346     	 mov r3,r0
 596 009e 002B     	 cmp r3,#0
 597 00a0 00D0     	 beq .L30
 270:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****                                           mac_size))
 271:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 272:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 598              	 .loc 1 272 0
 599 00a2 02E0     	 b .L28
 600              	.L30:
 273:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 274:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         return_status = PAL_STATUS_SUCCESS;
 601              	 .loc 1 274 0
 602 00a4 0023     	 movs r3,#0
 603 00a6 A7F84E30 	 strh r3,[r7,#78]
 604              	.L28:
 275:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     } while (FALSE);
 276:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     mbedtls_ccm_free(&sDecrypt);
 605              	 .loc 1 276 0
 606 00aa 07F11403 	 add r3,r7,#20
 607 00ae 1846     	 mov r0,r3
 608 00b0 FFF7FEFF 	 bl mbedtls_ccm_free
 277:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     #undef AES128_KEY_BITS_SIZE
 278:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     return return_status;
 609              	 .loc 1 278 0
 610 00b4 B7F84E30 	 ldrh r3,[r7,#78]
 279:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** }
 611              	 .loc 1 279 0
 612 00b8 1846     	 mov r0,r3
 613 00ba 5437     	 adds r7,r7,#84
 614              	.LCFI13:
 615              	 .cfi_def_cfa_offset 20
 616 00bc BD46     	 mov sp,r7
 617              	.LCFI14:
 618              	 .cfi_def_cfa_register 13
 619              	 
 620 00be F0BD     	 pop {r4,r5,r6,r7,pc}
 621              	 .cfi_endproc
 622              	.LFE14:
 624              	 .section .rodata
 625              	 .align 2
 626              	.LC0:
 627 0000 322E3136 	 .ascii "2.16.0\000"
 627      2E3000
 628 0007 00       	 .section .text.pal_crypt_version,"ax",%progbits
 629              	 .align 2
 630              	 .global pal_crypt_version
 631              	 .thumb
 632              	 .thumb_func
 634              	pal_crypt_version:
 635              	.LFB15:
 280:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 281:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** pal_status_t pal_crypt_version(uint8_t * p_crypt_lib_version_info, uint16_t * length)
 282:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** {
 636              	 .loc 1 282 0
 637              	 .cfi_startproc
 638              	 
 639              	 
 640 0000 80B5     	 push {r7,lr}
 641              	.LCFI15:
 642              	 .cfi_def_cfa_offset 8
 643              	 .cfi_offset 7,-8
 644              	 .cfi_offset 14,-4
 645 0002 84B0     	 sub sp,sp,#16
 646              	.LCFI16:
 647              	 .cfi_def_cfa_offset 24
 648 0004 00AF     	 add r7,sp,#0
 649              	.LCFI17:
 650              	 .cfi_def_cfa_register 7
 651 0006 7860     	 str r0,[r7,#4]
 652 0008 3960     	 str r1,[r7]
 283:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     pal_status_t return_value  = PAL_STATUS_FAILURE;    
 653              	 .loc 1 283 0
 654 000a 0123     	 movs r3,#1
 655 000c FB81     	 strh r3,[r7,#14]
 284:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     uint8_t sizeof_version_number  = (uint8_t)strlen(MBEDTLS_VERSION_STRING);
 656              	 .loc 1 284 0
 657 000e 0623     	 movs r3,#6
 658 0010 7B73     	 strb r3,[r7,#13]
 285:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 286:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     do
 287:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     {
 288:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         if (sizeof_version_number > *length)
 659              	 .loc 1 288 0
 660 0012 7B7B     	 ldrb r3,[r7,#13]
 661 0014 9AB2     	 uxth r2,r3
 662 0016 3B68     	 ldr r3,[r7]
 663 0018 1B88     	 ldrh r3,[r3]
 664 001a 9A42     	 cmp r2,r3
 665 001c 00D9     	 bls .L33
 289:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         {
 290:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****             break;
 666              	 .loc 1 290 0
 667 001e 0BE0     	 b .L34
 668              	.L33:
 291:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         }
 292:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 293:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         pal_os_memcpy(p_crypt_lib_version_info, MBEDTLS_VERSION_STRING, sizeof_version_number);
 669              	 .loc 1 293 0
 670 0020 7B7B     	 ldrb r3,[r7,#13]
 671 0022 7868     	 ldr r0,[r7,#4]
 672 0024 0749     	 ldr r1,.L36
 673 0026 1A46     	 mov r2,r3
 674 0028 FFF7FEFF 	 bl pal_os_memcpy
 294:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         *length = sizeof_version_number;
 675              	 .loc 1 294 0
 676 002c 7B7B     	 ldrb r3,[r7,#13]
 677 002e 9AB2     	 uxth r2,r3
 678 0030 3B68     	 ldr r3,[r7]
 679 0032 1A80     	 strh r2,[r3]
 295:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 296:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****         return_value = PAL_STATUS_SUCCESS;
 680              	 .loc 1 296 0
 681 0034 0023     	 movs r3,#0
 682 0036 FB81     	 strh r3,[r7,#14]
 683              	.L34:
 297:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** 
 298:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     } while (0);
 299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c ****     return return_value;
 684              	 .loc 1 299 0
 685 0038 FB89     	 ldrh r3,[r7,#14]
 300:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/pal\pal_crypt_mbedtls.c **** }
 686              	 .loc 1 300 0
 687 003a 1846     	 mov r0,r3
 688 003c 1037     	 adds r7,r7,#16
 689              	.LCFI18:
 690              	 .cfi_def_cfa_offset 8
 691 003e BD46     	 mov sp,r7
 692              	.LCFI19:
 693              	 .cfi_def_cfa_register 13
 694              	 
 695 0040 80BD     	 pop {r7,pc}
 696              	.L37:
 697 0042 00BF     	 .align 2
 698              	.L36:
 699 0044 00000000 	 .word .LC0
 700              	 .cfi_endproc
 701              	.LFE15:
 703              	 .text
 704              	.Letext0:
 705              	 .file 2 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 706              	 .file 3 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\lib\\gcc\\arm-none-eabi\\4.9.3\\include\\stddef.h"
 707              	 .file 4 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 708              	 .file 5 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/include/optiga/pal/pal.h"
 709              	 .file 6 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/optiga/include/optiga/pal/pal_crypt.h"
 710              	 .file 7 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/include/mbedtls/cipher.h"
 711              	 .file 8 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/include/mbedtls/ccm.h"
 712              	 .file 9 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/include/mbedtls/md.h"
DEFINED SYMBOLS
                            *ABS*:00000000 pal_crypt_mbedtls.c
    {standard input}:20     .text.pal_crypt_tls_prf_sha256:00000000 $t
    {standard input}:25     .text.pal_crypt_tls_prf_sha256:00000000 pal_crypt_tls_prf_sha256
    {standard input}:364    .text.pal_crypt_encrypt_aes128_ccm:00000000 $t
    {standard input}:369    .text.pal_crypt_encrypt_aes128_ccm:00000000 pal_crypt_encrypt_aes128_ccm
    {standard input}:493    .text.pal_crypt_decrypt_aes128_ccm:00000000 $t
    {standard input}:498    .text.pal_crypt_decrypt_aes128_ccm:00000000 pal_crypt_decrypt_aes128_ccm
    {standard input}:625    .rodata:00000000 $d
    {standard input}:629    .text.pal_crypt_version:00000000 $t
    {standard input}:634    .text.pal_crypt_version:00000000 pal_crypt_version
    {standard input}:699    .text.pal_crypt_version:00000044 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
mbedtls_md_init
mbedtls_md_info_from_type
memcpy
mbedtls_md_setup
mbedtls_md_hmac_starts
mbedtls_md_hmac_update
mbedtls_md_hmac_finish
mbedtls_md_hmac_reset
mbedtls_md_free
memset
mbedtls_ccm_init
mbedtls_ccm_setkey
mbedtls_ccm_encrypt_and_tag
mbedtls_ccm_free
mbedtls_ccm_auth_decrypt
pal_os_memcpy
