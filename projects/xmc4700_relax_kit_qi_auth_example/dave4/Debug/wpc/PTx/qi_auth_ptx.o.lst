   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,6
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "qi_auth_ptx.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.qi_auth_ptx_error,"ax",%progbits
  20              	 .align 2
  21              	 .global qi_auth_ptx_error
  22              	 .thumb
  23              	 .thumb_func
  25              	qi_auth_ptx_error:
  26              	.LFB0:
  27              	 .file 1 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx/qi_auth_ptx.c"
   1:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** /**
   2:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * MIT License
   3:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
   4:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * Copyright (c) 2020 Infineon Technologies AG
   5:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
   6:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * Permission is hereby granted, free of charge, to any person obtaining a copy
   7:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * of this software and associated documentation files (the "Software"), to deal
   8:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * in the Software without restriction, including without limitation the rights
   9:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  10:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * copies of the Software, and to permit persons to whom the Software is
  11:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * furnished to do so, subject to the following conditions:
  12:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
  13:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * The above copyright notice and this permission notice shall be included in all
  14:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * copies or substantial portions of the Software.
  15:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
  16:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  17:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  18:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  19:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  20:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  21:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  22:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * SOFTWARE
  23:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
  24:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
  25:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
  26:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * \file    qi_auth_ptx.c
  27:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
  28:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** * \brief   This file implements the APIs, types and data structures for WPC Qi Auth Rel 1.3 impleme
  29:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** *
  30:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** */
  31:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  32:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #include "qi_auth_ptx.h"
  33:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #include "qi_auth_ptx_crypt.h"
  34:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #include "optiga/common/optiga_lib_logger.h"
  35:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  36:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  37:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #define QI_AUTH_PROTO_VER                   0x1
  38:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  39:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #define MSGTYPE_RESP_DIGESTS                0x1
  40:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #define MSGTYPE_RESP_CERTIFICATE            0x2
  41:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #define MSGTYPE_RESP_CHALLENGE_AUTH         0x3
  42:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #define MSGTYPE_RESP_ERROR                  0x7
  43:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  44:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #define MAX_CERTIFICATE_OFFSET              (3*256 + 1023)
  45:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** #define MAX_CERTIFICATE_LENGTH              (3*256 + 1023)
  46:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  47:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** uint16_t qi_auth_ptx_error(uint8_t error_code, uint8_t error_data, uint8_t* p_resp, uint16_t* resp_
  48:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** {
  28              	 .loc 1 48 0
  29              	 .cfi_startproc
  30              	 
  31              	 
  32              	 
  33 0000 80B4     	 push {r7}
  34              	.LCFI0:
  35              	 .cfi_def_cfa_offset 4
  36              	 .cfi_offset 7,-4
  37 0002 87B0     	 sub sp,sp,#28
  38              	.LCFI1:
  39              	 .cfi_def_cfa_offset 32
  40 0004 00AF     	 add r7,sp,#0
  41              	.LCFI2:
  42              	 .cfi_def_cfa_register 7
  43 0006 BA60     	 str r2,[r7,#8]
  44 0008 7B60     	 str r3,[r7,#4]
  45 000a 0346     	 mov r3,r0
  46 000c FB73     	 strb r3,[r7,#15]
  47 000e 0B46     	 mov r3,r1
  48 0010 BB73     	 strb r3,[r7,#14]
  49:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint16_t return_status = CRYPT_LIB_ERROR;
  49              	 .loc 1 49 0
  50 0012 0123     	 movs r3,#1
  51 0014 FB82     	 strh r3,[r7,#22]
  50:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  51:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     do {
  52:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (NULL == p_resp)
  52              	 .loc 1 52 0
  53 0016 BB68     	 ldr r3,[r7,#8]
  54 0018 002B     	 cmp r3,#0
  55 001a 00D1     	 bne .L2
  53:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
  56              	 .loc 1 53 0
  57 001c 13E0     	 b .L3
  58              	.L2:
  54:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  55:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (0 == resp_size)
  59              	 .loc 1 55 0
  60 001e 7B68     	 ldr r3,[r7,#4]
  61 0020 002B     	 cmp r3,#0
  62 0022 00D1     	 bne .L4
  56:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
  63              	 .loc 1 56 0
  64 0024 0FE0     	 b .L3
  65              	.L4:
  57:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  58:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Version and Message type
  59:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_resp[0] = (QI_AUTH_PROTO_VER << 4) | MSGTYPE_RESP_ERROR;
  66              	 .loc 1 59 0
  67 0026 BB68     	 ldr r3,[r7,#8]
  68 0028 1722     	 movs r2,#23
  69 002a 1A70     	 strb r2,[r3]
  60:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  61:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Error Code
  62:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_resp[1] = error_code;
  70              	 .loc 1 62 0
  71 002c BB68     	 ldr r3,[r7,#8]
  72 002e 0133     	 adds r3,r3,#1
  73 0030 FA7B     	 ldrb r2,[r7,#15]
  74 0032 1A70     	 strb r2,[r3]
  63:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  64:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Error Data
  65:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_resp[2] = error_data;
  75              	 .loc 1 65 0
  76 0034 BB68     	 ldr r3,[r7,#8]
  77 0036 0233     	 adds r3,r3,#2
  78 0038 BA7B     	 ldrb r2,[r7,#14]
  79 003a 1A70     	 strb r2,[r3]
  66:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  67:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         *resp_size = 3;
  80              	 .loc 1 67 0
  81 003c 7B68     	 ldr r3,[r7,#4]
  82 003e 0322     	 movs r2,#3
  83 0040 1A80     	 strh r2,[r3]
  68:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  69:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         return_status = CRYPT_LIB_OK;
  84              	 .loc 1 69 0
  85 0042 0023     	 movs r3,#0
  86 0044 FB82     	 strh r3,[r7,#22]
  87              	.L3:
  70:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  71:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     }while(0);
  72:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  73:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     return return_status;
  88              	 .loc 1 73 0
  89 0046 FB8A     	 ldrh r3,[r7,#22]
  74:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** }
  90              	 .loc 1 74 0
  91 0048 1846     	 mov r0,r3
  92 004a 1C37     	 adds r7,r7,#28
  93              	.LCFI3:
  94              	 .cfi_def_cfa_offset 4
  95 004c BD46     	 mov sp,r7
  96              	.LCFI4:
  97              	 .cfi_def_cfa_register 13
  98              	 
  99 004e 5DF8047B 	 ldr r7,[sp],#4
 100              	.LCFI5:
 101              	 .cfi_restore 7
 102              	 .cfi_def_cfa_offset 0
 103 0052 7047     	 bx lr
 104              	 .cfi_endproc
 105              	.LFE0:
 107              	 .section .text.qi_auth_ptx_digests,"ax",%progbits
 108              	 .align 2
 109              	 .global qi_auth_ptx_digests
 110              	 .thumb
 111              	 .thumb_func
 113              	qi_auth_ptx_digests:
 114              	.LFB1:
  75:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  76:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** uint16_t qi_auth_ptx_digests(uint8_t slot, uint8_t* p_digest, uint16_t* digest_size)
  77:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** {
 115              	 .loc 1 77 0
 116              	 .cfi_startproc
 117              	 
 118              	 
 119 0000 80B5     	 push {r7,lr}
 120              	.LCFI6:
 121              	 .cfi_def_cfa_offset 8
 122              	 .cfi_offset 7,-8
 123              	 .cfi_offset 14,-4
 124 0002 86B0     	 sub sp,sp,#24
 125              	.LCFI7:
 126              	 .cfi_def_cfa_offset 32
 127 0004 00AF     	 add r7,sp,#0
 128              	.LCFI8:
 129              	 .cfi_def_cfa_register 7
 130 0006 0346     	 mov r3,r0
 131 0008 B960     	 str r1,[r7,#8]
 132 000a 7A60     	 str r2,[r7,#4]
 133 000c FB73     	 strb r3,[r7,#15]
  78:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint16_t return_status = CRYPT_LIB_ERROR;
 134              	 .loc 1 78 0
 135 000e 0123     	 movs r3,#1
 136 0010 FB82     	 strh r3,[r7,#22]
  79:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  80:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     do {
  81:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (NULL == p_digest)
 137              	 .loc 1 81 0
 138 0012 BB68     	 ldr r3,[r7,#8]
 139 0014 002B     	 cmp r3,#0
 140 0016 00D1     	 bne .L7
  82:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 141              	 .loc 1 82 0
 142 0018 1CE0     	 b .L8
 143              	.L7:
  83:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  84:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (0 == digest_size)
 144              	 .loc 1 84 0
 145 001a 7B68     	 ldr r3,[r7,#4]
 146 001c 002B     	 cmp r3,#0
 147 001e 00D1     	 bne .L9
  85:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 148              	 .loc 1 85 0
 149 0020 18E0     	 b .L8
 150              	.L9:
  86:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  87:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (0 != slot)
 151              	 .loc 1 87 0
 152 0022 FB7B     	 ldrb r3,[r7,#15]
 153 0024 002B     	 cmp r3,#0
 154 0026 00D0     	 beq .L10
  88:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 155              	 .loc 1 88 0
 156 0028 14E0     	 b .L8
 157              	.L10:
  89:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  90:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Version and Message type
  91:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_digest[0] = (QI_AUTH_PROTO_VER << 4) | MSGTYPE_RESP_DIGESTS;
 158              	 .loc 1 91 0
 159 002a BB68     	 ldr r3,[r7,#8]
 160 002c 1122     	 movs r2,#17
 161 002e 1A70     	 strb r2,[r3]
  92:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  93:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Slots Populated Mask and Slots Returned Mask
  94:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_digest[1] = 0x1 | 0x1;
 162              	 .loc 1 94 0
 163 0030 BB68     	 ldr r3,[r7,#8]
 164 0032 0133     	 adds r3,r3,#1
 165 0034 0122     	 movs r2,#1
 166 0036 1A70     	 strb r2,[r3]
  95:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
  96:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         return_status = qi_auth_ptx_crypt_certchain_sha256(&p_digest[2]);
 167              	 .loc 1 96 0
 168 0038 BB68     	 ldr r3,[r7,#8]
 169 003a 0233     	 adds r3,r3,#2
 170 003c 1846     	 mov r0,r3
 171 003e FFF7FEFF 	 bl qi_auth_ptx_crypt_certchain_sha256
 172 0042 0346     	 mov r3,r0
 173 0044 FB82     	 strh r3,[r7,#22]
  97:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (return_status != CRYPT_LIB_OK)
 174              	 .loc 1 97 0
 175 0046 FB8A     	 ldrh r3,[r7,#22]
 176 0048 002B     	 cmp r3,#0
 177 004a 00D0     	 beq .L11
  98:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 178              	 .loc 1 98 0
 179 004c 02E0     	 b .L8
 180              	.L11:
  99:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 100:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         *digest_size = 34;
 181              	 .loc 1 100 0
 182 004e 7B68     	 ldr r3,[r7,#4]
 183 0050 2222     	 movs r2,#34
 184 0052 1A80     	 strh r2,[r3]
 185              	.L8:
 101:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 102:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     }while(0);
 103:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 104:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     return return_status;
 186              	 .loc 1 104 0
 187 0054 FB8A     	 ldrh r3,[r7,#22]
 105:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** }
 188              	 .loc 1 105 0
 189 0056 1846     	 mov r0,r3
 190 0058 1837     	 adds r7,r7,#24
 191              	.LCFI9:
 192              	 .cfi_def_cfa_offset 8
 193 005a BD46     	 mov sp,r7
 194              	.LCFI10:
 195              	 .cfi_def_cfa_register 13
 196              	 
 197 005c 80BD     	 pop {r7,pc}
 198              	 .cfi_endproc
 199              	.LFE1:
 201 005e 00BF     	 .section .text.qi_auth_ptx_certificate,"ax",%progbits
 202              	 .align 2
 203              	 .global qi_auth_ptx_certificate
 204              	 .thumb
 205              	 .thumb_func
 207              	qi_auth_ptx_certificate:
 208              	.LFB2:
 106:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 107:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** uint16_t qi_auth_ptx_certificate(uint8_t slot, uint8_t* p_certchain, uint16_t* certchain_size)
 108:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** {
 209              	 .loc 1 108 0
 210              	 .cfi_startproc
 211              	 
 212              	 
 213 0000 80B5     	 push {r7,lr}
 214              	.LCFI11:
 215              	 .cfi_def_cfa_offset 8
 216              	 .cfi_offset 7,-8
 217              	 .cfi_offset 14,-4
 218 0002 86B0     	 sub sp,sp,#24
 219              	.LCFI12:
 220              	 .cfi_def_cfa_offset 32
 221 0004 00AF     	 add r7,sp,#0
 222              	.LCFI13:
 223              	 .cfi_def_cfa_register 7
 224 0006 0346     	 mov r3,r0
 225 0008 B960     	 str r1,[r7,#8]
 226 000a 7A60     	 str r2,[r7,#4]
 227 000c FB73     	 strb r3,[r7,#15]
 109:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint16_t  return_status = CRYPT_LIB_ERROR;
 228              	 .loc 1 109 0
 229 000e 0123     	 movs r3,#1
 230 0010 FB82     	 strh r3,[r7,#22]
 110:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 111:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     do {
 112:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 113:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if ((0 != slot) || (NULL == p_certchain) || (0 == certchain_size))
 231              	 .loc 1 113 0
 232 0012 FB7B     	 ldrb r3,[r7,#15]
 233 0014 002B     	 cmp r3,#0
 234 0016 1AD1     	 bne .L14
 235              	 .loc 1 113 0 is_stmt 0 discriminator 1
 236 0018 BB68     	 ldr r3,[r7,#8]
 237 001a 002B     	 cmp r3,#0
 238 001c 17D0     	 beq .L14
 239              	 .loc 1 113 0 discriminator 2
 240 001e 7B68     	 ldr r3,[r7,#4]
 241 0020 002B     	 cmp r3,#0
 242 0022 14D0     	 beq .L14
 114:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 115:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 116:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Version and Message type
 117:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_certchain[0] = (QI_AUTH_PROTO_VER << 4) | MSGTYPE_RESP_CERTIFICATE;
 243              	 .loc 1 117 0 is_stmt 1
 244 0024 BB68     	 ldr r3,[r7,#8]
 245 0026 1222     	 movs r2,#18
 246 0028 1A70     	 strb r2,[r3]
 118:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 119:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         return_status = qi_auth_ptx_crypt_certchain(p_certchain+1, certchain_size);
 247              	 .loc 1 119 0
 248 002a BB68     	 ldr r3,[r7,#8]
 249 002c 0133     	 adds r3,r3,#1
 250 002e 1846     	 mov r0,r3
 251 0030 7968     	 ldr r1,[r7,#4]
 252 0032 FFF7FEFF 	 bl qi_auth_ptx_crypt_certchain
 253 0036 0346     	 mov r3,r0
 254 0038 FB82     	 strh r3,[r7,#22]
 120:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (return_status != CRYPT_LIB_OK)
 255              	 .loc 1 120 0
 256 003a FB8A     	 ldrh r3,[r7,#22]
 257 003c 002B     	 cmp r3,#0
 258 003e 00D0     	 beq .L15
 121:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 259              	 .loc 1 121 0
 260 0040 05E0     	 b .L14
 261              	.L15:
 122:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 123:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         *certchain_size += 1;
 262              	 .loc 1 123 0
 263 0042 7B68     	 ldr r3,[r7,#4]
 264 0044 1B88     	 ldrh r3,[r3]
 265 0046 0133     	 adds r3,r3,#1
 266 0048 9AB2     	 uxth r2,r3
 267 004a 7B68     	 ldr r3,[r7,#4]
 268 004c 1A80     	 strh r2,[r3]
 269              	.L14:
 124:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 125:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     }while(0);
 126:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 127:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     return return_status;
 270              	 .loc 1 127 0
 271 004e FB8A     	 ldrh r3,[r7,#22]
 128:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** }
 272              	 .loc 1 128 0
 273 0050 1846     	 mov r0,r3
 274 0052 1837     	 adds r7,r7,#24
 275              	.LCFI14:
 276              	 .cfi_def_cfa_offset 8
 277 0054 BD46     	 mov sp,r7
 278              	.LCFI15:
 279              	 .cfi_def_cfa_register 13
 280              	 
 281 0056 80BD     	 pop {r7,pc}
 282              	 .cfi_endproc
 283              	.LFE2:
 285              	 .section .text.qi_auth_ptx_challenge_auth,"ax",%progbits
 286              	 .align 2
 287              	 .global qi_auth_ptx_challenge_auth
 288              	 .thumb
 289              	 .thumb_func
 291              	qi_auth_ptx_challenge_auth:
 292              	.LFB3:
 129:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 130:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** uint16_t qi_auth_ptx_challenge_auth(uint8_t slot, uint8_t* p_challreq, uint8_t challreq_size,
 131:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****                                             uint8_t* p_challresp, uint8_t* challresp_size)
 132:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** {
 293              	 .loc 1 132 0
 294              	 .cfi_startproc
 295              	 
 296              	 
 297 0000 B0B5     	 push {r4,r5,r7,lr}
 298              	.LCFI16:
 299              	 .cfi_def_cfa_offset 16
 300              	 .cfi_offset 4,-16
 301              	 .cfi_offset 5,-12
 302              	 .cfi_offset 7,-8
 303              	 .cfi_offset 14,-4
 304 0002 B4B0     	 sub sp,sp,#208
 305              	.LCFI17:
 306              	 .cfi_def_cfa_offset 224
 307 0004 00AF     	 add r7,sp,#0
 308              	.LCFI18:
 309              	 .cfi_def_cfa_register 7
 310 0006 B960     	 str r1,[r7,#8]
 311 0008 7B60     	 str r3,[r7,#4]
 312 000a 0346     	 mov r3,r0
 313 000c FB73     	 strb r3,[r7,#15]
 314 000e 1346     	 mov r3,r2
 315 0010 BB73     	 strb r3,[r7,#14]
 133:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint16_t return_status = CRYPT_LIB_ERROR;
 316              	 .loc 1 133 0
 317 0012 0123     	 movs r3,#1
 318 0014 A7F8CE30 	 strh r3,[r7,#206]
 134:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint8_t certchain_hash[32];
 135:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     // To Be Signed data
 136:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint8_t tbs_auth[54] = {0x41};
 319              	 .loc 1 136 0
 320 0018 07F17403 	 add r3,r7,#116
 321 001c 0022     	 movs r2,#0
 322 001e 1A60     	 str r2,[r3]
 323 0020 0433     	 adds r3,r3,#4
 324 0022 0022     	 movs r2,#0
 325 0024 1A60     	 str r2,[r3]
 326 0026 0433     	 adds r3,r3,#4
 327 0028 0022     	 movs r2,#0
 328 002a 1A60     	 str r2,[r3]
 329 002c 0433     	 adds r3,r3,#4
 330 002e 0022     	 movs r2,#0
 331 0030 1A60     	 str r2,[r3]
 332 0032 0433     	 adds r3,r3,#4
 333 0034 0022     	 movs r2,#0
 334 0036 1A60     	 str r2,[r3]
 335 0038 0433     	 adds r3,r3,#4
 336 003a 0022     	 movs r2,#0
 337 003c 1A60     	 str r2,[r3]
 338 003e 0433     	 adds r3,r3,#4
 339 0040 0022     	 movs r2,#0
 340 0042 1A60     	 str r2,[r3]
 341 0044 0433     	 adds r3,r3,#4
 342 0046 0022     	 movs r2,#0
 343 0048 1A60     	 str r2,[r3]
 344 004a 0433     	 adds r3,r3,#4
 345 004c 0022     	 movs r2,#0
 346 004e 1A60     	 str r2,[r3]
 347 0050 0433     	 adds r3,r3,#4
 348 0052 0022     	 movs r2,#0
 349 0054 1A60     	 str r2,[r3]
 350 0056 0433     	 adds r3,r3,#4
 351 0058 0022     	 movs r2,#0
 352 005a 1A60     	 str r2,[r3]
 353 005c 0433     	 adds r3,r3,#4
 354 005e 0022     	 movs r2,#0
 355 0060 1A60     	 str r2,[r3]
 356 0062 0433     	 adds r3,r3,#4
 357 0064 0022     	 movs r2,#0
 358 0066 1A60     	 str r2,[r3]
 359 0068 0433     	 adds r3,r3,#4
 360 006a 0022     	 movs r2,#0
 361 006c 1A80     	 strh r2,[r3]
 362 006e 0233     	 adds r3,r3,#2
 363 0070 4123     	 movs r3,#65
 364 0072 87F87430 	 strb r3,[r7,#116]
 137:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint8_t digest_tbs_auth[32];
 138:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     //Signature
 139:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint8_t signature[64];
 140:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     uint16_t signature_len = 64;
 365              	 .loc 1 140 0
 366 0076 4023     	 movs r3,#64
 367 0078 7B82     	 strh r3,[r7,#18]
 141:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 142:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     do {
 143:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if ((0 != slot) ||
 368              	 .loc 1 143 0
 369 007a FB7B     	 ldrb r3,[r7,#15]
 370 007c 002B     	 cmp r3,#0
 371 007e 40F09A80 	 bne .L18
 372              	 .loc 1 143 0 is_stmt 0 discriminator 1
 373 0082 BB68     	 ldr r3,[r7,#8]
 374 0084 002B     	 cmp r3,#0
 375 0086 00F09680 	 beq .L18
 144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             (NULL == p_challreq) || (0 == challreq_size) ||
 376              	 .loc 1 144 0 is_stmt 1
 377 008a BB7B     	 ldrb r3,[r7,#14]
 378 008c 002B     	 cmp r3,#0
 379 008e 00F09280 	 beq .L18
 380              	 .loc 1 144 0 is_stmt 0 discriminator 1
 381 0092 7B68     	 ldr r3,[r7,#4]
 382 0094 002B     	 cmp r3,#0
 383 0096 00F08E80 	 beq .L18
 145:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             (NULL == p_challresp) || (NULL == challresp_size) || (0 == *challresp_size))
 384              	 .loc 1 145 0 is_stmt 1
 385 009a D7F8E030 	 ldr r3,[r7,#224]
 386 009e 002B     	 cmp r3,#0
 387 00a0 00F08980 	 beq .L18
 388              	 .loc 1 145 0 is_stmt 0 discriminator 1
 389 00a4 D7F8E030 	 ldr r3,[r7,#224]
 390 00a8 1B78     	 ldrb r3,[r3]
 391 00aa 002B     	 cmp r3,#0
 392 00ac 00F08380 	 beq .L18
 146:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 147:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 148:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         *challresp_size = 0;
 393              	 .loc 1 148 0 is_stmt 1
 394 00b0 D7F8E030 	 ldr r3,[r7,#224]
 395 00b4 0022     	 movs r2,#0
 396 00b6 1A70     	 strb r2,[r3]
 149:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 150:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Version and Message type
 151:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_challresp[0] = (QI_AUTH_PROTO_VER << 4) | MSGTYPE_RESP_CHALLENGE_AUTH;
 397              	 .loc 1 151 0
 398 00b8 7B68     	 ldr r3,[r7,#4]
 399 00ba 1322     	 movs r2,#19
 400 00bc 1A70     	 strb r2,[r3]
 152:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         *challresp_size += 1;
 401              	 .loc 1 152 0
 402 00be D7F8E030 	 ldr r3,[r7,#224]
 403 00c2 1B78     	 ldrb r3,[r3]
 404 00c4 0133     	 adds r3,r3,#1
 405 00c6 DAB2     	 uxtb r2,r3
 406 00c8 D7F8E030 	 ldr r3,[r7,#224]
 407 00cc 1A70     	 strb r2,[r3]
 153:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 154:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Maximum Qi Authentication Certificate Structure Version
 155:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_challresp[1] = 0x1 | 0x1;
 408              	 .loc 1 155 0
 409 00ce 7B68     	 ldr r3,[r7,#4]
 410 00d0 0133     	 adds r3,r3,#1
 411 00d2 0122     	 movs r2,#1
 412 00d4 1A70     	 strb r2,[r3]
 156:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         *challresp_size += 1;
 413              	 .loc 1 156 0
 414 00d6 D7F8E030 	 ldr r3,[r7,#224]
 415 00da 1B78     	 ldrb r3,[r3]
 416 00dc 0133     	 adds r3,r3,#1
 417 00de DAB2     	 uxtb r2,r3
 418 00e0 D7F8E030 	 ldr r3,[r7,#224]
 419 00e4 1A70     	 strb r2,[r3]
 157:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 158:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         //Certificate Chain Hash LSB
 159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         return_status = qi_auth_ptx_crypt_certchain_sha256(certchain_hash);
 420              	 .loc 1 159 0
 421 00e6 07F1AC03 	 add r3,r7,#172
 422 00ea 1846     	 mov r0,r3
 423 00ec FFF7FEFF 	 bl qi_auth_ptx_crypt_certchain_sha256
 424 00f0 0346     	 mov r3,r0
 425 00f2 A7F8CE30 	 strh r3,[r7,#206]
 160:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (return_status != CRYPT_LIB_OK)
 426              	 .loc 1 160 0
 427 00f6 B7F8CE30 	 ldrh r3,[r7,#206]
 428 00fa 002B     	 cmp r3,#0
 429 00fc 00D0     	 beq .L19
 161:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 430              	 .loc 1 161 0
 431 00fe 5AE0     	 b .L18
 432              	.L19:
 162:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 163:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         p_challresp[2] = certchain_hash[31];
 433              	 .loc 1 163 0
 434 0100 7B68     	 ldr r3,[r7,#4]
 435 0102 0233     	 adds r3,r3,#2
 436 0104 97F8CB20 	 ldrb r2,[r7,#203]
 437 0108 1A70     	 strb r2,[r3]
 164:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         *challresp_size += 1;
 438              	 .loc 1 164 0
 439 010a D7F8E030 	 ldr r3,[r7,#224]
 440 010e 1B78     	 ldrb r3,[r3]
 441 0110 0133     	 adds r3,r3,#1
 442 0112 DAB2     	 uxtb r2,r3
 443 0114 D7F8E030 	 ldr r3,[r7,#224]
 444 0118 1A70     	 strb r2,[r3]
 165:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 166:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         memcpy(&tbs_auth[1], certchain_hash, 32);
 445              	 .loc 1 166 0
 446 011a 07F17504 	 add r4,r7,#117
 447 011e 07F1AC05 	 add r5,r7,#172
 448 0122 0FCD     	 ldmia r5!,{r0,r1,r2,r3}
 449 0124 2060     	 str r0,[r4]
 450 0126 6160     	 str r1,[r4,#4]
 451 0128 A260     	 str r2,[r4,#8]
 452 012a E360     	 str r3,[r4,#12]
 453 012c 0FCD     	 ldmia r5!,{r0,r1,r2,r3}
 454 012e 2061     	 str r0,[r4,#16]
 455 0130 6161     	 str r1,[r4,#20]
 456 0132 A261     	 str r2,[r4,#24]
 457 0134 E361     	 str r3,[r4,#28]
 167:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 168:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Table 15. B0 to B17 of the Challenge Request Message to which the CHALLENGE_AUTH is a re
 169:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         memcpy(&tbs_auth[1 + 32], p_challreq, 18);
 458              	 .loc 1 169 0
 459 0136 07F17403 	 add r3,r7,#116
 460 013a 2133     	 adds r3,r3,#33
 461 013c 1846     	 mov r0,r3
 462 013e B968     	 ldr r1,[r7,#8]
 463 0140 1222     	 movs r2,#18
 464 0142 FFF7FEFF 	 bl memcpy
 170:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 171:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // Table 15. B0 to B2 of the Challenge Auth Response (Without the signature)
 172:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         memcpy(&tbs_auth[1 + 32 + 18], p_challresp, 3);
 465              	 .loc 1 172 0
 466 0146 07F17403 	 add r3,r7,#116
 467 014a 3333     	 adds r3,r3,#51
 468 014c 1846     	 mov r0,r3
 469 014e 7968     	 ldr r1,[r7,#4]
 470 0150 0322     	 movs r2,#3
 471 0152 FFF7FEFF 	 bl memcpy
 173:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 174:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         // We need to hash TBS Auth Data and sign it afterwards
 175:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         qi_auth_ptx_crypt_generate_sha256(tbs_auth, 54, digest_tbs_auth);
 472              	 .loc 1 175 0
 473 0156 07F17402 	 add r2,r7,#116
 474 015a 07F15403 	 add r3,r7,#84
 475 015e 1046     	 mov r0,r2
 476 0160 3621     	 movs r1,#54
 477 0162 1A46     	 mov r2,r3
 478 0164 FFF7FEFF 	 bl qi_auth_ptx_crypt_generate_sha256
 176:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 177:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         return_status = qi_auth_ptx_crypt_sign(digest_tbs_auth, 32, signature, &signature_len);
 479              	 .loc 1 177 0
 480 0168 07F15401 	 add r1,r7,#84
 481 016c 07F11402 	 add r2,r7,#20
 482 0170 07F11203 	 add r3,r7,#18
 483 0174 0846     	 mov r0,r1
 484 0176 2021     	 movs r1,#32
 485 0178 FFF7FEFF 	 bl qi_auth_ptx_crypt_sign
 486 017c 0346     	 mov r3,r0
 487 017e A7F8CE30 	 strh r3,[r7,#206]
 178:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         if (return_status != CRYPT_LIB_OK)
 488              	 .loc 1 178 0
 489 0182 B7F8CE30 	 ldrh r3,[r7,#206]
 490 0186 002B     	 cmp r3,#0
 491 0188 00D0     	 beq .L20
 179:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****             break;
 492              	 .loc 1 179 0
 493 018a 14E0     	 b .L18
 494              	.L20:
 180:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 181:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         memcpy(&p_challresp[3], signature, signature_len);
 495              	 .loc 1 181 0
 496 018c 7B68     	 ldr r3,[r7,#4]
 497 018e DA1C     	 adds r2,r3,#3
 498 0190 7B8A     	 ldrh r3,[r7,#18]
 499 0192 1C46     	 mov r4,r3
 500 0194 07F11403 	 add r3,r7,#20
 501 0198 1046     	 mov r0,r2
 502 019a 1946     	 mov r1,r3
 503 019c 2246     	 mov r2,r4
 504 019e FFF7FEFF 	 bl memcpy
 182:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 183:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****         *challresp_size += signature_len;
 505              	 .loc 1 183 0
 506 01a2 D7F8E030 	 ldr r3,[r7,#224]
 507 01a6 1A78     	 ldrb r2,[r3]
 508 01a8 7B8A     	 ldrh r3,[r7,#18]
 509 01aa DBB2     	 uxtb r3,r3
 510 01ac 1344     	 add r3,r3,r2
 511 01ae DAB2     	 uxtb r2,r3
 512 01b0 D7F8E030 	 ldr r3,[r7,#224]
 513 01b4 1A70     	 strb r2,[r3]
 514              	.L18:
 184:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 185:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     }while(0);
 186:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 187:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c ****     return return_status;
 515              	 .loc 1 187 0
 516 01b6 B7F8CE30 	 ldrh r3,[r7,#206]
 188:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** }
 517              	 .loc 1 188 0
 518 01ba 1846     	 mov r0,r3
 519 01bc D037     	 adds r7,r7,#208
 520              	.LCFI19:
 521              	 .cfi_def_cfa_offset 16
 522 01be BD46     	 mov sp,r7
 523              	.LCFI20:
 524              	 .cfi_def_cfa_register 13
 525              	 
 526 01c0 B0BD     	 pop {r4,r5,r7,pc}
 527              	 .cfi_endproc
 528              	.LFE3:
 530 01c2 00BF     	 .section .text.qi_auth_ptx_init,"ax",%progbits
 531              	 .align 2
 532              	 .global qi_auth_ptx_init
 533              	 .thumb
 534              	 .thumb_func
 536              	qi_auth_ptx_init:
 537              	.LFB4:
 189:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 190:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** int32_t qi_auth_ptx_init(void)
 191:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** {
 538              	 .loc 1 191 0
 539              	 .cfi_startproc
 540              	 
 541              	 
 542 0000 80B5     	 push {r7,lr}
 543              	.LCFI21:
 544              	 .cfi_def_cfa_offset 8
 545              	 .cfi_offset 7,-8
 546              	 .cfi_offset 14,-4
 547 0002 00AF     	 add r7,sp,#0
 548              	.LCFI22:
 549              	 .cfi_def_cfa_register 7
 192:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 	return (qi_auth_ptx_crypt_init(0));
 550              	 .loc 1 192 0
 551 0004 0020     	 movs r0,#0
 552 0006 FFF7FEFF 	 bl qi_auth_ptx_crypt_init
 553 000a 0346     	 mov r3,r0
 193:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** }
 554              	 .loc 1 193 0
 555 000c 1846     	 mov r0,r3
 556 000e 80BD     	 pop {r7,pc}
 557              	 .cfi_endproc
 558              	.LFE4:
 560              	 .section .text.qi_auth_ptx_deinit,"ax",%progbits
 561              	 .align 2
 562              	 .global qi_auth_ptx_deinit
 563              	 .thumb
 564              	 .thumb_func
 566              	qi_auth_ptx_deinit:
 567              	.LFB5:
 194:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 
 195:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** int32_t qi_auth_ptx_deinit(void)
 196:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** {
 568              	 .loc 1 196 0
 569              	 .cfi_startproc
 570              	 
 571              	 
 572 0000 80B5     	 push {r7,lr}
 573              	.LCFI23:
 574              	 .cfi_def_cfa_offset 8
 575              	 .cfi_offset 7,-8
 576              	 .cfi_offset 14,-4
 577 0002 00AF     	 add r7,sp,#0
 578              	.LCFI24:
 579              	 .cfi_def_cfa_register 7
 197:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** 	return (qi_auth_ptx_crypt_deinit(0));
 580              	 .loc 1 197 0
 581 0004 0020     	 movs r0,#0
 582 0006 FFF7FEFF 	 bl qi_auth_ptx_crypt_deinit
 583 000a 0346     	 mov r3,r0
 198:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/wpc/PTx\qi_auth_ptx.c **** }
 584              	 .loc 1 198 0
 585 000c 1846     	 mov r0,r3
 586 000e 80BD     	 pop {r7,pc}
 587              	 .cfi_endproc
 588              	.LFE5:
 590              	 .text
 591              	.Letext0:
 592              	 .file 2 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 593              	 .file 3 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
DEFINED SYMBOLS
                            *ABS*:00000000 qi_auth_ptx.c
    {standard input}:20     .text.qi_auth_ptx_error:00000000 $t
    {standard input}:25     .text.qi_auth_ptx_error:00000000 qi_auth_ptx_error
    {standard input}:108    .text.qi_auth_ptx_digests:00000000 $t
    {standard input}:113    .text.qi_auth_ptx_digests:00000000 qi_auth_ptx_digests
    {standard input}:202    .text.qi_auth_ptx_certificate:00000000 $t
    {standard input}:207    .text.qi_auth_ptx_certificate:00000000 qi_auth_ptx_certificate
    {standard input}:286    .text.qi_auth_ptx_challenge_auth:00000000 $t
    {standard input}:291    .text.qi_auth_ptx_challenge_auth:00000000 qi_auth_ptx_challenge_auth
    {standard input}:531    .text.qi_auth_ptx_init:00000000 $t
    {standard input}:536    .text.qi_auth_ptx_init:00000000 qi_auth_ptx_init
    {standard input}:561    .text.qi_auth_ptx_deinit:00000000 $t
    {standard input}:566    .text.qi_auth_ptx_deinit:00000000 qi_auth_ptx_deinit
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
qi_auth_ptx_crypt_certchain_sha256
qi_auth_ptx_crypt_certchain
memcpy
qi_auth_ptx_crypt_generate_sha256
qi_auth_ptx_crypt_sign
qi_auth_ptx_crypt_init
qi_auth_ptx_crypt_deinit
