   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,6
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "ccm.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .section .text.mbedtls_ccm_init,"ax",%progbits
  20              	 .align 2
  21              	 .global mbedtls_ccm_init
  22              	 .thumb
  23              	 .thumb_func
  25              	mbedtls_ccm_init:
  26              	.LFB7:
  27              	 .file 1 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library/ccm.c"
   1:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
   2:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  NIST SP800-38C compliant CCM implementation
   3:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *
   4:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
   5:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  SPDX-License-Identifier: Apache-2.0
   6:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *
   7:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  Licensed under the Apache License, Version 2.0 (the "License"); you may
   8:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  not use this file except in compliance with the License.
   9:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  You may obtain a copy of the License at
  10:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *
  11:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  http://www.apache.org/licenses/LICENSE-2.0
  12:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *
  13:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  Unless required by applicable law or agreed to in writing, software
  14:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  15:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  16:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  See the License for the specific language governing permissions and
  17:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  limitations under the License.
  18:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *
  19:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *  This file is part of mbed TLS (https://tls.mbed.org)
  20:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
  21:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  22:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
  23:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Definition of CCM:
  24:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * http://csrc.nist.gov/publications/nistpubs/800-38C/SP800-38C_updated-July20_2007.pdf
  25:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * RFC 3610 "Counter with CBC-MAC (CCM)"
  26:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  *
  27:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Related:
  28:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * RFC 5116 "An Interface and Algorithms for Authenticated Encryption"
  29:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
  30:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  31:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #if !defined(MBEDTLS_CONFIG_FILE)
  32:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #include "mbedtls/config.h"
  33:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #else
  34:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #include MBEDTLS_CONFIG_FILE
  35:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #endif
  36:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  37:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #if defined(MBEDTLS_CCM_C)
  38:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  39:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #include "mbedtls/ccm.h"
  40:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #include "mbedtls/platform_util.h"
  41:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  42:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #include <string.h>
  43:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  44:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #if defined(MBEDTLS_SELF_TEST) && defined(MBEDTLS_AES_C)
  45:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #if defined(MBEDTLS_PLATFORM_C)
  46:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #include "mbedtls/platform.h"
  47:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #else
  48:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #include <stdio.h>
  49:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #define mbedtls_printf printf
  50:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #endif /* MBEDTLS_PLATFORM_C */
  51:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #endif /* MBEDTLS_SELF_TEST && MBEDTLS_AES_C */
  52:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  53:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #if !defined(MBEDTLS_CCM_ALT)
  54:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  55:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #define CCM_VALIDATE_RET( cond ) \
  56:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     MBEDTLS_INTERNAL_VALIDATE_RET( cond, MBEDTLS_ERR_CCM_BAD_INPUT )
  57:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #define CCM_VALIDATE( cond ) \
  58:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     MBEDTLS_INTERNAL_VALIDATE( cond )
  59:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  60:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #define CCM_ENCRYPT 0
  61:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #define CCM_DECRYPT 1
  62:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  63:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
  64:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Initialize context
  65:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
  66:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** void mbedtls_ccm_init( mbedtls_ccm_context *ctx )
  67:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** {
  28              	 .loc 1 67 0
  29              	 .cfi_startproc
  30              	 
  31              	 
  32 0000 80B5     	 push {r7,lr}
  33              	.LCFI0:
  34              	 .cfi_def_cfa_offset 8
  35              	 .cfi_offset 7,-8
  36              	 .cfi_offset 14,-4
  37 0002 82B0     	 sub sp,sp,#8
  38              	.LCFI1:
  39              	 .cfi_def_cfa_offset 16
  40 0004 00AF     	 add r7,sp,#0
  41              	.LCFI2:
  42              	 .cfi_def_cfa_register 7
  43 0006 7860     	 str r0,[r7,#4]
  68:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE( ctx != NULL );
  69:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     memset( ctx, 0, sizeof( mbedtls_ccm_context ) );
  44              	 .loc 1 69 0
  45 0008 7868     	 ldr r0,[r7,#4]
  46 000a 0021     	 movs r1,#0
  47 000c 3822     	 movs r2,#56
  48 000e FFF7FEFF 	 bl memset
  70:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** }
  49              	 .loc 1 70 0
  50 0012 0837     	 adds r7,r7,#8
  51              	.LCFI3:
  52              	 .cfi_def_cfa_offset 8
  53 0014 BD46     	 mov sp,r7
  54              	.LCFI4:
  55              	 .cfi_def_cfa_register 13
  56              	 
  57 0016 80BD     	 pop {r7,pc}
  58              	 .cfi_endproc
  59              	.LFE7:
  61              	 .section .text.mbedtls_ccm_setkey,"ax",%progbits
  62              	 .align 2
  63              	 .global mbedtls_ccm_setkey
  64              	 .thumb
  65              	 .thumb_func
  67              	mbedtls_ccm_setkey:
  68              	.LFB8:
  71:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  72:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** int mbedtls_ccm_setkey( mbedtls_ccm_context *ctx,
  73:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                         mbedtls_cipher_id_t cipher,
  74:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                         const unsigned char *key,
  75:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                         unsigned int keybits )
  76:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** {
  69              	 .loc 1 76 0
  70              	 .cfi_startproc
  71              	 
  72              	 
  73 0000 80B5     	 push {r7,lr}
  74              	.LCFI5:
  75              	 .cfi_def_cfa_offset 8
  76              	 .cfi_offset 7,-8
  77              	 .cfi_offset 14,-4
  78 0002 86B0     	 sub sp,sp,#24
  79              	.LCFI6:
  80              	 .cfi_def_cfa_offset 32
  81 0004 00AF     	 add r7,sp,#0
  82              	.LCFI7:
  83              	 .cfi_def_cfa_register 7
  84 0006 F860     	 str r0,[r7,#12]
  85 0008 7A60     	 str r2,[r7,#4]
  86 000a 3B60     	 str r3,[r7]
  87 000c 0B46     	 mov r3,r1
  88 000e FB72     	 strb r3,[r7,#11]
  77:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     int ret;
  78:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     const mbedtls_cipher_info_t *cipher_info;
  79:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  80:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( ctx != NULL );
  81:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( key != NULL );
  82:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  83:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     cipher_info = mbedtls_cipher_info_from_values( cipher, keybits, MBEDTLS_MODE_ECB );
  89              	 .loc 1 83 0
  90 0010 3B68     	 ldr r3,[r7]
  91 0012 FA7A     	 ldrb r2,[r7,#11]
  92 0014 1046     	 mov r0,r2
  93 0016 1946     	 mov r1,r3
  94 0018 0122     	 movs r2,#1
  95 001a FFF7FEFF 	 bl mbedtls_cipher_info_from_values
  96 001e 7861     	 str r0,[r7,#20]
  84:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( cipher_info == NULL )
  97              	 .loc 1 84 0
  98 0020 7B69     	 ldr r3,[r7,#20]
  99 0022 002B     	 cmp r3,#0
 100 0024 02D1     	 bne .L3
  85:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_BAD_INPUT );
 101              	 .loc 1 85 0
 102 0026 6FF00C03 	 mvn r3,#12
 103 002a 24E0     	 b .L4
 104              	.L3:
  86:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  87:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( cipher_info->block_size != 16 )
 105              	 .loc 1 87 0
 106 002c 7B69     	 ldr r3,[r7,#20]
 107 002e 5B69     	 ldr r3,[r3,#20]
 108 0030 102B     	 cmp r3,#16
 109 0032 02D0     	 beq .L5
  88:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_BAD_INPUT );
 110              	 .loc 1 88 0
 111 0034 6FF00C03 	 mvn r3,#12
 112 0038 1DE0     	 b .L4
 113              	.L5:
  89:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  90:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     mbedtls_cipher_free( &ctx->cipher_ctx );
 114              	 .loc 1 90 0
 115 003a FB68     	 ldr r3,[r7,#12]
 116 003c 1846     	 mov r0,r3
 117 003e FFF7FEFF 	 bl mbedtls_cipher_free
  91:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  92:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( ( ret = mbedtls_cipher_setup( &ctx->cipher_ctx, cipher_info ) ) != 0 )
 118              	 .loc 1 92 0
 119 0042 FB68     	 ldr r3,[r7,#12]
 120 0044 1846     	 mov r0,r3
 121 0046 7969     	 ldr r1,[r7,#20]
 122 0048 FFF7FEFF 	 bl mbedtls_cipher_setup
 123 004c 3861     	 str r0,[r7,#16]
 124 004e 3B69     	 ldr r3,[r7,#16]
 125 0050 002B     	 cmp r3,#0
 126 0052 01D0     	 beq .L6
  93:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( ret );
 127              	 .loc 1 93 0
 128 0054 3B69     	 ldr r3,[r7,#16]
 129 0056 0EE0     	 b .L4
 130              	.L6:
  94:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
  95:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( ( ret = mbedtls_cipher_setkey( &ctx->cipher_ctx, key, keybits,
 131              	 .loc 1 95 0
 132 0058 FA68     	 ldr r2,[r7,#12]
 133 005a 3B68     	 ldr r3,[r7]
 134 005c 1046     	 mov r0,r2
 135 005e 7968     	 ldr r1,[r7,#4]
 136 0060 1A46     	 mov r2,r3
 137 0062 0123     	 movs r3,#1
 138 0064 FFF7FEFF 	 bl mbedtls_cipher_setkey
 139 0068 3861     	 str r0,[r7,#16]
 140 006a 3B69     	 ldr r3,[r7,#16]
 141 006c 002B     	 cmp r3,#0
 142 006e 01D0     	 beq .L7
  96:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                                MBEDTLS_ENCRYPT ) ) != 0 )
  97:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     {
  98:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( ret );
 143              	 .loc 1 98 0
 144 0070 3B69     	 ldr r3,[r7,#16]
 145 0072 00E0     	 b .L4
 146              	.L7:
  99:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     }
 100:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 101:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     return( 0 );
 147              	 .loc 1 101 0
 148 0074 0023     	 movs r3,#0
 149              	.L4:
 102:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** }
 150              	 .loc 1 102 0
 151 0076 1846     	 mov r0,r3
 152 0078 1837     	 adds r7,r7,#24
 153              	.LCFI8:
 154              	 .cfi_def_cfa_offset 8
 155 007a BD46     	 mov sp,r7
 156              	.LCFI9:
 157              	 .cfi_def_cfa_register 13
 158              	 
 159 007c 80BD     	 pop {r7,pc}
 160              	 .cfi_endproc
 161              	.LFE8:
 163 007e 00BF     	 .section .text.mbedtls_ccm_free,"ax",%progbits
 164              	 .align 2
 165              	 .global mbedtls_ccm_free
 166              	 .thumb
 167              	 .thumb_func
 169              	mbedtls_ccm_free:
 170              	.LFB9:
 103:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 104:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
 105:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Free context
 106:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
 107:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** void mbedtls_ccm_free( mbedtls_ccm_context *ctx )
 108:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** {
 171              	 .loc 1 108 0
 172              	 .cfi_startproc
 173              	 
 174              	 
 175 0000 80B5     	 push {r7,lr}
 176              	.LCFI10:
 177              	 .cfi_def_cfa_offset 8
 178              	 .cfi_offset 7,-8
 179              	 .cfi_offset 14,-4
 180 0002 82B0     	 sub sp,sp,#8
 181              	.LCFI11:
 182              	 .cfi_def_cfa_offset 16
 183 0004 00AF     	 add r7,sp,#0
 184              	.LCFI12:
 185              	 .cfi_def_cfa_register 7
 186 0006 7860     	 str r0,[r7,#4]
 109:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( ctx == NULL )
 187              	 .loc 1 109 0
 188 0008 7B68     	 ldr r3,[r7,#4]
 189 000a 002B     	 cmp r3,#0
 190 000c 00D1     	 bne .L9
 110:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return;
 191              	 .loc 1 110 0
 192 000e 07E0     	 b .L8
 193              	.L9:
 111:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     mbedtls_cipher_free( &ctx->cipher_ctx );
 194              	 .loc 1 111 0
 195 0010 7B68     	 ldr r3,[r7,#4]
 196 0012 1846     	 mov r0,r3
 197 0014 FFF7FEFF 	 bl mbedtls_cipher_free
 112:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     mbedtls_platform_zeroize( ctx, sizeof( mbedtls_ccm_context ) );
 198              	 .loc 1 112 0
 199 0018 7868     	 ldr r0,[r7,#4]
 200 001a 3821     	 movs r1,#56
 201 001c FFF7FEFF 	 bl mbedtls_platform_zeroize
 202              	.L8:
 113:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** }
 203              	 .loc 1 113 0
 204 0020 0837     	 adds r7,r7,#8
 205              	.LCFI13:
 206              	 .cfi_def_cfa_offset 8
 207 0022 BD46     	 mov sp,r7
 208              	.LCFI14:
 209              	 .cfi_def_cfa_register 13
 210              	 
 211 0024 80BD     	 pop {r7,pc}
 212              	 .cfi_endproc
 213              	.LFE9:
 215 0026 00BF     	 .section .text.ccm_auth_crypt,"ax",%progbits
 216              	 .align 2
 217              	 .thumb
 218              	 .thumb_func
 220              	ccm_auth_crypt:
 221              	.LFB10:
 114:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 115:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
 116:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Macros for common operations.
 117:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Results in smaller compiled code than static inline functions.
 118:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
 119:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 120:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
 121:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Update the CBC-MAC state in y using a block in b
 122:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * (Always using b as the source helps the compiler optimise a bit better.)
 123:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
 124:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #define UPDATE_CBC_MAC                                                      \
 125:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     for( i = 0; i < 16; i++ )                                               \
 126:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         y[i] ^= b[i];                                                       \
 127:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                                                                             \
 128:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( ( ret = mbedtls_cipher_update( &ctx->cipher_ctx, y, 16, y, &olen ) ) != 0 ) \
 129:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( ret );
 130:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 131:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
 132:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Encrypt or decrypt a partial block with CTR
 133:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Warning: using b for temporary storage! src and dst must not be b!
 134:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * This avoids allocating one more 16 bytes buffer while allowing src == dst.
 135:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
 136:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** #define CTR_CRYPT( dst, src, len  )                                            \
 137:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( ( ret = mbedtls_cipher_update( &ctx->cipher_ctx, ctr, 16, b, &olen ) ) != 0 )  \
 138:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( ret );                                                         \
 139:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                                                                                \
 140:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     for( i = 0; i < len; i++ )                                                 \
 141:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         dst[i] = src[i] ^ b[i];
 142:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 143:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
 144:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Authenticated encryption or decryption
 145:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
 146:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** static int ccm_auth_crypt( mbedtls_ccm_context *ctx, int mode, size_t length,
 147:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                            const unsigned char *iv, size_t iv_len,
 148:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                            const unsigned char *add, size_t add_len,
 149:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                            const unsigned char *input, unsigned char *output,
 150:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                            unsigned char *tag, size_t tag_len )
 151:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** {
 222              	 .loc 1 151 0
 223              	 .cfi_startproc
 224              	 
 225              	 
 226 0000 90B5     	 push {r4,r7,lr}
 227              	.LCFI15:
 228              	 .cfi_def_cfa_offset 12
 229              	 .cfi_offset 4,-12
 230              	 .cfi_offset 7,-8
 231              	 .cfi_offset 14,-4
 232 0002 9DB0     	 sub sp,sp,#116
 233              	.LCFI16:
 234              	 .cfi_def_cfa_offset 128
 235 0004 02AF     	 add r7,sp,#8
 236              	.LCFI17:
 237              	 .cfi_def_cfa 7,120
 238 0006 F860     	 str r0,[r7,#12]
 239 0008 B960     	 str r1,[r7,#8]
 240 000a 7A60     	 str r2,[r7,#4]
 241 000c 3B60     	 str r3,[r7]
 152:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     int ret;
 153:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     unsigned char i;
 154:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     unsigned char q;
 155:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     size_t len_left, olen;
 156:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     unsigned char b[16];
 157:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     unsigned char y[16];
 158:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     unsigned char ctr[16];
 159:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     const unsigned char *src;
 160:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     unsigned char *dst;
 161:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 162:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /*
 163:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * Check length requirements: SP800-38C A.1
 164:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * Additional requirement: a < 2^16 - 2^8 to simplify the code.
 165:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 'length' checked later (when writing it to the first block)
 166:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      *
 167:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * Also, loosen the requirements to enable support for CCM* (IEEE 802.15.4).
 168:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      */
 169:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( tag_len == 2 || tag_len > 16 || tag_len % 2 != 0 )
 242              	 .loc 1 169 0
 243 000e D7F89030 	 ldr r3,[r7,#144]
 244 0012 022B     	 cmp r3,#2
 245 0014 09D0     	 beq .L12
 246              	 .loc 1 169 0 is_stmt 0 discriminator 1
 247 0016 D7F89030 	 ldr r3,[r7,#144]
 248 001a 102B     	 cmp r3,#16
 249 001c 05D8     	 bhi .L12
 250              	 .loc 1 169 0 discriminator 2
 251 001e D7F89030 	 ldr r3,[r7,#144]
 252 0022 03F00103 	 and r3,r3,#1
 253 0026 002B     	 cmp r3,#0
 254 0028 02D0     	 beq .L13
 255              	.L12:
 170:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_BAD_INPUT );
 256              	 .loc 1 170 0 is_stmt 1
 257 002a 6FF00C03 	 mvn r3,#12
 258 002e F1E2     	 b .L54
 259              	.L13:
 171:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 172:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /* Also implies q is within bounds */
 173:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( iv_len < 7 || iv_len > 13 )
 260              	 .loc 1 173 0
 261 0030 BB6F     	 ldr r3,[r7,#120]
 262 0032 062B     	 cmp r3,#6
 263 0034 02D9     	 bls .L15
 264              	 .loc 1 173 0 is_stmt 0 discriminator 1
 265 0036 BB6F     	 ldr r3,[r7,#120]
 266 0038 0D2B     	 cmp r3,#13
 267 003a 02D9     	 bls .L16
 268              	.L15:
 174:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_BAD_INPUT );
 269              	 .loc 1 174 0 is_stmt 1
 270 003c 6FF00C03 	 mvn r3,#12
 271 0040 E8E2     	 b .L54
 272              	.L16:
 175:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 176:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( add_len > 0xFF00 )
 273              	 .loc 1 176 0
 274 0042 D7F88030 	 ldr r3,[r7,#128]
 275 0046 B3F57F4F 	 cmp r3,#65280
 276 004a 02D9     	 bls .L17
 177:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_BAD_INPUT );
 277              	 .loc 1 177 0
 278 004c 6FF00C03 	 mvn r3,#12
 279 0050 E0E2     	 b .L54
 280              	.L17:
 178:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 179:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     q = 16 - 1 - (unsigned char) iv_len;
 281              	 .loc 1 179 0
 282 0052 BB6F     	 ldr r3,[r7,#120]
 283 0054 DBB2     	 uxtb r3,r3
 284 0056 C3F10F03 	 rsb r3,r3,#15
 285 005a 87F85730 	 strb r3,[r7,#87]
 180:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 181:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /*
 182:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * First block B_0:
 183:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 0        .. 0        flags
 184:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 1        .. iv_len   nonce (aka iv)
 185:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * iv_len+1 .. 15       length
 186:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      *
 187:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * With flags as (bits):
 188:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 7        0
 189:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 6        add present?
 190:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 5 .. 3   (t - 2) / 2
 191:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 2 .. 0   q - 1
 192:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      */
 193:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     b[0] = 0;
 286              	 .loc 1 193 0
 287 005e 0023     	 movs r3,#0
 288 0060 87F83430 	 strb r3,[r7,#52]
 194:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     b[0] |= ( add_len > 0 ) << 6;
 289              	 .loc 1 194 0
 290 0064 97F83430 	 ldrb r3,[r7,#52]
 291 0068 DAB2     	 uxtb r2,r3
 292 006a D7F88030 	 ldr r3,[r7,#128]
 293 006e 002B     	 cmp r3,#0
 294 0070 01D0     	 beq .L18
 295              	 .loc 1 194 0 is_stmt 0 discriminator 1
 296 0072 4023     	 movs r3,#64
 297 0074 00E0     	 b .L19
 298              	.L18:
 299              	 .loc 1 194 0 discriminator 2
 300 0076 0023     	 movs r3,#0
 301              	.L19:
 302              	 .loc 1 194 0 discriminator 4
 303 0078 1343     	 orrs r3,r3,r2
 304 007a DBB2     	 uxtb r3,r3
 305 007c DBB2     	 uxtb r3,r3
 306 007e 87F83430 	 strb r3,[r7,#52]
 195:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     b[0] |= ( ( tag_len - 2 ) / 2 ) << 3;
 307              	 .loc 1 195 0 is_stmt 1 discriminator 4
 308 0082 97F83420 	 ldrb r2,[r7,#52]
 309 0086 D7F89030 	 ldr r3,[r7,#144]
 310 008a 023B     	 subs r3,r3,#2
 311 008c 5B08     	 lsrs r3,r3,#1
 312 008e DBB2     	 uxtb r3,r3
 313 0090 DB00     	 lsls r3,r3,#3
 314 0092 DBB2     	 uxtb r3,r3
 315 0094 1343     	 orrs r3,r3,r2
 316 0096 DBB2     	 uxtb r3,r3
 317 0098 87F83430 	 strb r3,[r7,#52]
 196:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     b[0] |= q - 1;
 318              	 .loc 1 196 0 discriminator 4
 319 009c 97F83430 	 ldrb r3,[r7,#52]
 320 00a0 DAB2     	 uxtb r2,r3
 321 00a2 97F85730 	 ldrb r3,[r7,#87]
 322 00a6 013B     	 subs r3,r3,#1
 323 00a8 DBB2     	 uxtb r3,r3
 324 00aa DBB2     	 uxtb r3,r3
 325 00ac 1343     	 orrs r3,r3,r2
 326 00ae DBB2     	 uxtb r3,r3
 327 00b0 DBB2     	 uxtb r3,r3
 328 00b2 87F83430 	 strb r3,[r7,#52]
 197:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 198:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     memcpy( b + 1, iv, iv_len );
 329              	 .loc 1 198 0 discriminator 4
 330 00b6 07F13403 	 add r3,r7,#52
 331 00ba 0133     	 adds r3,r3,#1
 332 00bc 1846     	 mov r0,r3
 333 00be 3968     	 ldr r1,[r7]
 334 00c0 BA6F     	 ldr r2,[r7,#120]
 335 00c2 FFF7FEFF 	 bl memcpy
 199:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 200:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     for( i = 0, len_left = length; i < q; i++, len_left >>= 8 )
 336              	 .loc 1 200 0 discriminator 4
 337 00c6 0023     	 movs r3,#0
 338 00c8 87F86730 	 strb r3,[r7,#103]
 339 00cc 7B68     	 ldr r3,[r7,#4]
 340 00ce 3B66     	 str r3,[r7,#96]
 341 00d0 12E0     	 b .L20
 342              	.L21:
 201:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         b[15-i] = (unsigned char)( len_left & 0xFF );
 343              	 .loc 1 201 0 discriminator 3
 344 00d2 97F86730 	 ldrb r3,[r7,#103]
 345 00d6 C3F10F03 	 rsb r3,r3,#15
 346 00da 3A6E     	 ldr r2,[r7,#96]
 347 00dc D2B2     	 uxtb r2,r2
 348 00de 07F16801 	 add r1,r7,#104
 349 00e2 0B44     	 add r3,r3,r1
 350 00e4 03F8342C 	 strb r2,[r3,#-52]
 200:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         b[15-i] = (unsigned char)( len_left & 0xFF );
 351              	 .loc 1 200 0 discriminator 3
 352 00e8 97F86730 	 ldrb r3,[r7,#103]
 353 00ec 0133     	 adds r3,r3,#1
 354 00ee 87F86730 	 strb r3,[r7,#103]
 355 00f2 3B6E     	 ldr r3,[r7,#96]
 356 00f4 1B0A     	 lsrs r3,r3,#8
 357 00f6 3B66     	 str r3,[r7,#96]
 358              	.L20:
 200:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         b[15-i] = (unsigned char)( len_left & 0xFF );
 359              	 .loc 1 200 0 is_stmt 0 discriminator 1
 360 00f8 97F86720 	 ldrb r2,[r7,#103]
 361 00fc 97F85730 	 ldrb r3,[r7,#87]
 362 0100 9A42     	 cmp r2,r3
 363 0102 E6D3     	 bcc .L21
 202:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 203:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( len_left > 0 )
 364              	 .loc 1 203 0 is_stmt 1
 365 0104 3B6E     	 ldr r3,[r7,#96]
 366 0106 002B     	 cmp r3,#0
 367 0108 02D0     	 beq .L22
 204:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_BAD_INPUT );
 368              	 .loc 1 204 0
 369 010a 6FF00C03 	 mvn r3,#12
 370 010e 81E2     	 b .L54
 371              	.L22:
 205:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 206:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 207:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /* Start CBC-MAC with first block */
 208:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     memset( y, 0, 16 );
 372              	 .loc 1 208 0
 373 0110 07F12403 	 add r3,r7,#36
 374 0114 1846     	 mov r0,r3
 375 0116 0021     	 movs r1,#0
 376 0118 1022     	 movs r2,#16
 377 011a FFF7FEFF 	 bl memset
 209:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     UPDATE_CBC_MAC;
 378              	 .loc 1 209 0
 379 011e 0023     	 movs r3,#0
 380 0120 87F86730 	 strb r3,[r7,#103]
 381 0124 1BE0     	 b .L23
 382              	.L24:
 383              	 .loc 1 209 0 is_stmt 0 discriminator 3
 384 0126 97F86730 	 ldrb r3,[r7,#103]
 385 012a 97F86720 	 ldrb r2,[r7,#103]
 386 012e 07F16801 	 add r1,r7,#104
 387 0132 0A44     	 add r2,r2,r1
 388 0134 12F8441C 	 ldrb r1,[r2,#-68]
 389 0138 97F86720 	 ldrb r2,[r7,#103]
 390 013c 07F16800 	 add r0,r7,#104
 391 0140 0244     	 add r2,r2,r0
 392 0142 12F8342C 	 ldrb r2,[r2,#-52]
 393 0146 4A40     	 eors r2,r2,r1
 394 0148 D2B2     	 uxtb r2,r2
 395 014a 07F16801 	 add r1,r7,#104
 396 014e 0B44     	 add r3,r3,r1
 397 0150 03F8442C 	 strb r2,[r3,#-68]
 398 0154 97F86730 	 ldrb r3,[r7,#103]
 399 0158 0133     	 adds r3,r3,#1
 400 015a 87F86730 	 strb r3,[r7,#103]
 401              	.L23:
 402              	 .loc 1 209 0 discriminator 1
 403 015e 97F86730 	 ldrb r3,[r7,#103]
 404 0162 0F2B     	 cmp r3,#15
 405 0164 DFD9     	 bls .L24
 406              	 .loc 1 209 0 discriminator 4
 407 0166 F968     	 ldr r1,[r7,#12]
 408 0168 07F12402 	 add r2,r7,#36
 409 016c 07F12404 	 add r4,r7,#36
 410 0170 07F14403 	 add r3,r7,#68
 411 0174 0093     	 str r3,[sp]
 412 0176 0846     	 mov r0,r1
 413 0178 1146     	 mov r1,r2
 414 017a 1022     	 movs r2,#16
 415 017c 2346     	 mov r3,r4
 416 017e FFF7FEFF 	 bl mbedtls_cipher_update
 417 0182 3865     	 str r0,[r7,#80]
 418 0184 3B6D     	 ldr r3,[r7,#80]
 419 0186 002B     	 cmp r3,#0
 420 0188 01D0     	 beq .L25
 421              	 .loc 1 209 0 discriminator 5
 422 018a 3B6D     	 ldr r3,[r7,#80]
 423 018c 42E2     	 b .L54
 424              	.L25:
 210:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 211:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /*
 212:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * If there is additional data, update CBC-MAC with
 213:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * add_len, add, 0 (padding to a block boundary)
 214:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      */
 215:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( add_len > 0 )
 425              	 .loc 1 215 0 is_stmt 1
 426 018e D7F88030 	 ldr r3,[r7,#128]
 427 0192 002B     	 cmp r3,#0
 428 0194 00F0BB80 	 beq .L26
 429              	.LBB2:
 216:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     {
 217:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         size_t use_len;
 218:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         len_left = add_len;
 430              	 .loc 1 218 0
 431 0198 D7F88030 	 ldr r3,[r7,#128]
 432 019c 3B66     	 str r3,[r7,#96]
 219:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         src = add;
 433              	 .loc 1 219 0
 434 019e FB6F     	 ldr r3,[r7,#124]
 435 01a0 FB65     	 str r3,[r7,#92]
 220:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 221:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         memset( b, 0, 16 );
 436              	 .loc 1 221 0
 437 01a2 07F13403 	 add r3,r7,#52
 438 01a6 1846     	 mov r0,r3
 439 01a8 0021     	 movs r1,#0
 440 01aa 1022     	 movs r2,#16
 441 01ac FFF7FEFF 	 bl memset
 222:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         b[0] = (unsigned char)( ( add_len >> 8 ) & 0xFF );
 442              	 .loc 1 222 0
 443 01b0 D7F88030 	 ldr r3,[r7,#128]
 444 01b4 1B0A     	 lsrs r3,r3,#8
 445 01b6 DBB2     	 uxtb r3,r3
 446 01b8 87F83430 	 strb r3,[r7,#52]
 223:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         b[1] = (unsigned char)( ( add_len      ) & 0xFF );
 447              	 .loc 1 223 0
 448 01bc D7F88030 	 ldr r3,[r7,#128]
 449 01c0 DBB2     	 uxtb r3,r3
 450 01c2 87F83530 	 strb r3,[r7,#53]
 224:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 225:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         use_len = len_left < 16 - 2 ? len_left : 16 - 2;
 451              	 .loc 1 225 0
 452 01c6 3B6E     	 ldr r3,[r7,#96]
 453 01c8 0E2B     	 cmp r3,#14
 454 01ca 28BF     	 it cs
 455 01cc 0E23     	 movcs r3,#14
 456 01ce FB64     	 str r3,[r7,#76]
 226:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         memcpy( b + 2, src, use_len );
 457              	 .loc 1 226 0
 458 01d0 07F13403 	 add r3,r7,#52
 459 01d4 0233     	 adds r3,r3,#2
 460 01d6 1846     	 mov r0,r3
 461 01d8 F96D     	 ldr r1,[r7,#92]
 462 01da FA6C     	 ldr r2,[r7,#76]
 463 01dc FFF7FEFF 	 bl memcpy
 227:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         len_left -= use_len;
 464              	 .loc 1 227 0
 465 01e0 3A6E     	 ldr r2,[r7,#96]
 466 01e2 FB6C     	 ldr r3,[r7,#76]
 467 01e4 D31A     	 subs r3,r2,r3
 468 01e6 3B66     	 str r3,[r7,#96]
 228:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         src += use_len;
 469              	 .loc 1 228 0
 470 01e8 FA6D     	 ldr r2,[r7,#92]
 471 01ea FB6C     	 ldr r3,[r7,#76]
 472 01ec 1344     	 add r3,r3,r2
 473 01ee FB65     	 str r3,[r7,#92]
 229:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 230:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         UPDATE_CBC_MAC;
 474              	 .loc 1 230 0
 475 01f0 0023     	 movs r3,#0
 476 01f2 87F86730 	 strb r3,[r7,#103]
 477 01f6 1BE0     	 b .L27
 478              	.L28:
 479              	 .loc 1 230 0 is_stmt 0 discriminator 3
 480 01f8 97F86730 	 ldrb r3,[r7,#103]
 481 01fc 97F86720 	 ldrb r2,[r7,#103]
 482 0200 07F16801 	 add r1,r7,#104
 483 0204 0A44     	 add r2,r2,r1
 484 0206 12F8441C 	 ldrb r1,[r2,#-68]
 485 020a 97F86720 	 ldrb r2,[r7,#103]
 486 020e 07F16800 	 add r0,r7,#104
 487 0212 0244     	 add r2,r2,r0
 488 0214 12F8342C 	 ldrb r2,[r2,#-52]
 489 0218 4A40     	 eors r2,r2,r1
 490 021a D2B2     	 uxtb r2,r2
 491 021c 07F16801 	 add r1,r7,#104
 492 0220 0B44     	 add r3,r3,r1
 493 0222 03F8442C 	 strb r2,[r3,#-68]
 494 0226 97F86730 	 ldrb r3,[r7,#103]
 495 022a 0133     	 adds r3,r3,#1
 496 022c 87F86730 	 strb r3,[r7,#103]
 497              	.L27:
 498              	 .loc 1 230 0 discriminator 1
 499 0230 97F86730 	 ldrb r3,[r7,#103]
 500 0234 0F2B     	 cmp r3,#15
 501 0236 DFD9     	 bls .L28
 502              	 .loc 1 230 0 discriminator 4
 503 0238 F968     	 ldr r1,[r7,#12]
 504 023a 07F12402 	 add r2,r7,#36
 505 023e 07F12404 	 add r4,r7,#36
 506 0242 07F14403 	 add r3,r7,#68
 507 0246 0093     	 str r3,[sp]
 508 0248 0846     	 mov r0,r1
 509 024a 1146     	 mov r1,r2
 510 024c 1022     	 movs r2,#16
 511 024e 2346     	 mov r3,r4
 512 0250 FFF7FEFF 	 bl mbedtls_cipher_update
 513 0254 3865     	 str r0,[r7,#80]
 514 0256 3B6D     	 ldr r3,[r7,#80]
 515 0258 002B     	 cmp r3,#0
 516 025a 01D0     	 beq .L29
 517              	 .loc 1 230 0 discriminator 5
 518 025c 3B6D     	 ldr r3,[r7,#80]
 519 025e D9E1     	 b .L54
 520              	.L29:
 231:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 232:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         while( len_left > 0 )
 521              	 .loc 1 232 0 is_stmt 1
 522 0260 52E0     	 b .L30
 523              	.L34:
 233:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         {
 234:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             use_len = len_left > 16 ? 16 : len_left;
 524              	 .loc 1 234 0
 525 0262 3B6E     	 ldr r3,[r7,#96]
 526 0264 102B     	 cmp r3,#16
 527 0266 28BF     	 it cs
 528 0268 1023     	 movcs r3,#16
 529 026a FB64     	 str r3,[r7,#76]
 235:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 236:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             memset( b, 0, 16 );
 530              	 .loc 1 236 0
 531 026c 07F13403 	 add r3,r7,#52
 532 0270 1846     	 mov r0,r3
 533 0272 0021     	 movs r1,#0
 534 0274 1022     	 movs r2,#16
 535 0276 FFF7FEFF 	 bl memset
 237:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             memcpy( b, src, use_len );
 536              	 .loc 1 237 0
 537 027a 07F13403 	 add r3,r7,#52
 538 027e 1846     	 mov r0,r3
 539 0280 F96D     	 ldr r1,[r7,#92]
 540 0282 FA6C     	 ldr r2,[r7,#76]
 541 0284 FFF7FEFF 	 bl memcpy
 238:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             UPDATE_CBC_MAC;
 542              	 .loc 1 238 0
 543 0288 0023     	 movs r3,#0
 544 028a 87F86730 	 strb r3,[r7,#103]
 545 028e 1BE0     	 b .L31
 546              	.L32:
 547              	 .loc 1 238 0 is_stmt 0 discriminator 3
 548 0290 97F86730 	 ldrb r3,[r7,#103]
 549 0294 97F86720 	 ldrb r2,[r7,#103]
 550 0298 07F16801 	 add r1,r7,#104
 551 029c 0A44     	 add r2,r2,r1
 552 029e 12F8441C 	 ldrb r1,[r2,#-68]
 553 02a2 97F86720 	 ldrb r2,[r7,#103]
 554 02a6 07F16800 	 add r0,r7,#104
 555 02aa 0244     	 add r2,r2,r0
 556 02ac 12F8342C 	 ldrb r2,[r2,#-52]
 557 02b0 4A40     	 eors r2,r2,r1
 558 02b2 D2B2     	 uxtb r2,r2
 559 02b4 07F16801 	 add r1,r7,#104
 560 02b8 0B44     	 add r3,r3,r1
 561 02ba 03F8442C 	 strb r2,[r3,#-68]
 562 02be 97F86730 	 ldrb r3,[r7,#103]
 563 02c2 0133     	 adds r3,r3,#1
 564 02c4 87F86730 	 strb r3,[r7,#103]
 565              	.L31:
 566              	 .loc 1 238 0 discriminator 1
 567 02c8 97F86730 	 ldrb r3,[r7,#103]
 568 02cc 0F2B     	 cmp r3,#15
 569 02ce DFD9     	 bls .L32
 570              	 .loc 1 238 0 discriminator 4
 571 02d0 F968     	 ldr r1,[r7,#12]
 572 02d2 07F12402 	 add r2,r7,#36
 573 02d6 07F12404 	 add r4,r7,#36
 574 02da 07F14403 	 add r3,r7,#68
 575 02de 0093     	 str r3,[sp]
 576 02e0 0846     	 mov r0,r1
 577 02e2 1146     	 mov r1,r2
 578 02e4 1022     	 movs r2,#16
 579 02e6 2346     	 mov r3,r4
 580 02e8 FFF7FEFF 	 bl mbedtls_cipher_update
 581 02ec 3865     	 str r0,[r7,#80]
 582 02ee 3B6D     	 ldr r3,[r7,#80]
 583 02f0 002B     	 cmp r3,#0
 584 02f2 01D0     	 beq .L33
 585              	 .loc 1 238 0 discriminator 5
 586 02f4 3B6D     	 ldr r3,[r7,#80]
 587 02f6 8DE1     	 b .L54
 588              	.L33:
 239:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 240:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             len_left -= use_len;
 589              	 .loc 1 240 0 is_stmt 1
 590 02f8 3A6E     	 ldr r2,[r7,#96]
 591 02fa FB6C     	 ldr r3,[r7,#76]
 592 02fc D31A     	 subs r3,r2,r3
 593 02fe 3B66     	 str r3,[r7,#96]
 241:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             src += use_len;
 594              	 .loc 1 241 0
 595 0300 FA6D     	 ldr r2,[r7,#92]
 596 0302 FB6C     	 ldr r3,[r7,#76]
 597 0304 1344     	 add r3,r3,r2
 598 0306 FB65     	 str r3,[r7,#92]
 599              	.L30:
 232:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         {
 600              	 .loc 1 232 0
 601 0308 3B6E     	 ldr r3,[r7,#96]
 602 030a 002B     	 cmp r3,#0
 603 030c A9D1     	 bne .L34
 604              	.L26:
 605              	.LBE2:
 242:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         }
 243:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     }
 244:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 245:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /*
 246:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * Prepare counter block for encryption:
 247:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 0        .. 0        flags
 248:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 1        .. iv_len   nonce (aka iv)
 249:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * iv_len+1 .. 15       counter (initially 1)
 250:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      *
 251:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * With flags as (bits):
 252:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 7 .. 3   0
 253:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * 2 .. 0   q - 1
 254:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      */
 255:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     ctr[0] = q - 1;
 606              	 .loc 1 255 0
 607 030e 97F85730 	 ldrb r3,[r7,#87]
 608 0312 013B     	 subs r3,r3,#1
 609 0314 DBB2     	 uxtb r3,r3
 610 0316 3B75     	 strb r3,[r7,#20]
 256:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     memcpy( ctr + 1, iv, iv_len );
 611              	 .loc 1 256 0
 612 0318 07F11403 	 add r3,r7,#20
 613 031c 0133     	 adds r3,r3,#1
 614 031e 1846     	 mov r0,r3
 615 0320 3968     	 ldr r1,[r7]
 616 0322 BA6F     	 ldr r2,[r7,#120]
 617 0324 FFF7FEFF 	 bl memcpy
 257:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     memset( ctr + 1 + iv_len, 0, q );
 618              	 .loc 1 257 0
 619 0328 BB6F     	 ldr r3,[r7,#120]
 620 032a 0133     	 adds r3,r3,#1
 621 032c 07F11402 	 add r2,r7,#20
 622 0330 1A44     	 add r2,r2,r3
 623 0332 97F85730 	 ldrb r3,[r7,#87]
 624 0336 1046     	 mov r0,r2
 625 0338 0021     	 movs r1,#0
 626 033a 1A46     	 mov r2,r3
 627 033c FFF7FEFF 	 bl memset
 258:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     ctr[15] = 1;
 628              	 .loc 1 258 0
 629 0340 0123     	 movs r3,#1
 630 0342 87F82330 	 strb r3,[r7,#35]
 259:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 260:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /*
 261:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * Authenticate and {en,de}crypt the message.
 262:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      *
 263:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * The only difference between encryption and decryption is
 264:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * the respective order of authentication and {en,de}cryption.
 265:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      */
 266:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     len_left = length;
 631              	 .loc 1 266 0
 632 0346 7B68     	 ldr r3,[r7,#4]
 633 0348 3B66     	 str r3,[r7,#96]
 267:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     src = input;
 634              	 .loc 1 267 0
 635 034a D7F88430 	 ldr r3,[r7,#132]
 636 034e FB65     	 str r3,[r7,#92]
 268:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     dst = output;
 637              	 .loc 1 268 0
 638 0350 D7F88830 	 ldr r3,[r7,#136]
 639 0354 BB65     	 str r3,[r7,#88]
 269:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 270:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     while( len_left > 0 )
 640              	 .loc 1 270 0
 641 0356 FEE0     	 b .L35
 642              	.L48:
 643              	.LBB3:
 271:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     {
 272:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         size_t use_len = len_left > 16 ? 16 : len_left;
 644              	 .loc 1 272 0
 645 0358 3B6E     	 ldr r3,[r7,#96]
 646 035a 102B     	 cmp r3,#16
 647 035c 28BF     	 it cs
 648 035e 1023     	 movcs r3,#16
 649 0360 BB64     	 str r3,[r7,#72]
 273:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 274:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         if( mode == CCM_ENCRYPT )
 650              	 .loc 1 274 0
 651 0362 BB68     	 ldr r3,[r7,#8]
 652 0364 002B     	 cmp r3,#0
 653 0366 45D1     	 bne .L36
 275:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         {
 276:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             memset( b, 0, 16 );
 654              	 .loc 1 276 0
 655 0368 07F13403 	 add r3,r7,#52
 656 036c 1846     	 mov r0,r3
 657 036e 0021     	 movs r1,#0
 658 0370 1022     	 movs r2,#16
 659 0372 FFF7FEFF 	 bl memset
 277:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             memcpy( b, src, use_len );
 660              	 .loc 1 277 0
 661 0376 07F13403 	 add r3,r7,#52
 662 037a 1846     	 mov r0,r3
 663 037c F96D     	 ldr r1,[r7,#92]
 664 037e BA6C     	 ldr r2,[r7,#72]
 665 0380 FFF7FEFF 	 bl memcpy
 278:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             UPDATE_CBC_MAC;
 666              	 .loc 1 278 0
 667 0384 0023     	 movs r3,#0
 668 0386 87F86730 	 strb r3,[r7,#103]
 669 038a 1BE0     	 b .L37
 670              	.L38:
 671              	 .loc 1 278 0 is_stmt 0 discriminator 3
 672 038c 97F86730 	 ldrb r3,[r7,#103]
 673 0390 97F86720 	 ldrb r2,[r7,#103]
 674 0394 07F16801 	 add r1,r7,#104
 675 0398 0A44     	 add r2,r2,r1
 676 039a 12F8441C 	 ldrb r1,[r2,#-68]
 677 039e 97F86720 	 ldrb r2,[r7,#103]
 678 03a2 07F16800 	 add r0,r7,#104
 679 03a6 0244     	 add r2,r2,r0
 680 03a8 12F8342C 	 ldrb r2,[r2,#-52]
 681 03ac 4A40     	 eors r2,r2,r1
 682 03ae D2B2     	 uxtb r2,r2
 683 03b0 07F16801 	 add r1,r7,#104
 684 03b4 0B44     	 add r3,r3,r1
 685 03b6 03F8442C 	 strb r2,[r3,#-68]
 686 03ba 97F86730 	 ldrb r3,[r7,#103]
 687 03be 0133     	 adds r3,r3,#1
 688 03c0 87F86730 	 strb r3,[r7,#103]
 689              	.L37:
 690              	 .loc 1 278 0 discriminator 1
 691 03c4 97F86730 	 ldrb r3,[r7,#103]
 692 03c8 0F2B     	 cmp r3,#15
 693 03ca DFD9     	 bls .L38
 694              	 .loc 1 278 0 discriminator 4
 695 03cc F968     	 ldr r1,[r7,#12]
 696 03ce 07F12402 	 add r2,r7,#36
 697 03d2 07F12404 	 add r4,r7,#36
 698 03d6 07F14403 	 add r3,r7,#68
 699 03da 0093     	 str r3,[sp]
 700 03dc 0846     	 mov r0,r1
 701 03de 1146     	 mov r1,r2
 702 03e0 1022     	 movs r2,#16
 703 03e2 2346     	 mov r3,r4
 704 03e4 FFF7FEFF 	 bl mbedtls_cipher_update
 705 03e8 3865     	 str r0,[r7,#80]
 706 03ea 3B6D     	 ldr r3,[r7,#80]
 707 03ec 002B     	 cmp r3,#0
 708 03ee 01D0     	 beq .L36
 709              	 .loc 1 278 0 discriminator 5
 710 03f0 3B6D     	 ldr r3,[r7,#80]
 711 03f2 0FE1     	 b .L54
 712              	.L36:
 279:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         }
 280:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 281:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         CTR_CRYPT( dst, src, use_len );
 713              	 .loc 1 281 0 is_stmt 1
 714 03f4 F968     	 ldr r1,[r7,#12]
 715 03f6 07F11402 	 add r2,r7,#20
 716 03fa 07F13404 	 add r4,r7,#52
 717 03fe 07F14403 	 add r3,r7,#68
 718 0402 0093     	 str r3,[sp]
 719 0404 0846     	 mov r0,r1
 720 0406 1146     	 mov r1,r2
 721 0408 1022     	 movs r2,#16
 722 040a 2346     	 mov r3,r4
 723 040c FFF7FEFF 	 bl mbedtls_cipher_update
 724 0410 3865     	 str r0,[r7,#80]
 725 0412 3B6D     	 ldr r3,[r7,#80]
 726 0414 002B     	 cmp r3,#0
 727 0416 01D0     	 beq .L39
 728              	 .loc 1 281 0 is_stmt 0 discriminator 1
 729 0418 3B6D     	 ldr r3,[r7,#80]
 730 041a FBE0     	 b .L54
 731              	.L39:
 732              	 .loc 1 281 0 discriminator 2
 733 041c 0023     	 movs r3,#0
 734 041e 87F86730 	 strb r3,[r7,#103]
 735 0422 17E0     	 b .L40
 736              	.L41:
 737              	 .loc 1 281 0 discriminator 5
 738 0424 97F86730 	 ldrb r3,[r7,#103]
 739 0428 BA6D     	 ldr r2,[r7,#88]
 740 042a 1344     	 add r3,r3,r2
 741 042c 97F86720 	 ldrb r2,[r7,#103]
 742 0430 F96D     	 ldr r1,[r7,#92]
 743 0432 0A44     	 add r2,r2,r1
 744 0434 1178     	 ldrb r1,[r2]
 745 0436 97F86720 	 ldrb r2,[r7,#103]
 746 043a 07F16800 	 add r0,r7,#104
 747 043e 0244     	 add r2,r2,r0
 748 0440 12F8342C 	 ldrb r2,[r2,#-52]
 749 0444 4A40     	 eors r2,r2,r1
 750 0446 D2B2     	 uxtb r2,r2
 751 0448 1A70     	 strb r2,[r3]
 752 044a 97F86730 	 ldrb r3,[r7,#103]
 753 044e 0133     	 adds r3,r3,#1
 754 0450 87F86730 	 strb r3,[r7,#103]
 755              	.L40:
 756              	 .loc 1 281 0 discriminator 3
 757 0454 97F86720 	 ldrb r2,[r7,#103]
 758 0458 BB6C     	 ldr r3,[r7,#72]
 759 045a 9A42     	 cmp r2,r3
 760 045c E2D3     	 bcc .L41
 282:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 283:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         if( mode == CCM_DECRYPT )
 761              	 .loc 1 283 0 is_stmt 1
 762 045e BB68     	 ldr r3,[r7,#8]
 763 0460 012B     	 cmp r3,#1
 764 0462 45D1     	 bne .L42
 284:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         {
 285:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             memset( b, 0, 16 );
 765              	 .loc 1 285 0
 766 0464 07F13403 	 add r3,r7,#52
 767 0468 1846     	 mov r0,r3
 768 046a 0021     	 movs r1,#0
 769 046c 1022     	 movs r2,#16
 770 046e FFF7FEFF 	 bl memset
 286:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             memcpy( b, dst, use_len );
 771              	 .loc 1 286 0
 772 0472 07F13403 	 add r3,r7,#52
 773 0476 1846     	 mov r0,r3
 774 0478 B96D     	 ldr r1,[r7,#88]
 775 047a BA6C     	 ldr r2,[r7,#72]
 776 047c FFF7FEFF 	 bl memcpy
 287:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             UPDATE_CBC_MAC;
 777              	 .loc 1 287 0
 778 0480 0023     	 movs r3,#0
 779 0482 87F86730 	 strb r3,[r7,#103]
 780 0486 1BE0     	 b .L43
 781              	.L44:
 782              	 .loc 1 287 0 is_stmt 0 discriminator 3
 783 0488 97F86730 	 ldrb r3,[r7,#103]
 784 048c 97F86720 	 ldrb r2,[r7,#103]
 785 0490 07F16801 	 add r1,r7,#104
 786 0494 0A44     	 add r2,r2,r1
 787 0496 12F8441C 	 ldrb r1,[r2,#-68]
 788 049a 97F86720 	 ldrb r2,[r7,#103]
 789 049e 07F16800 	 add r0,r7,#104
 790 04a2 0244     	 add r2,r2,r0
 791 04a4 12F8342C 	 ldrb r2,[r2,#-52]
 792 04a8 4A40     	 eors r2,r2,r1
 793 04aa D2B2     	 uxtb r2,r2
 794 04ac 07F16801 	 add r1,r7,#104
 795 04b0 0B44     	 add r3,r3,r1
 796 04b2 03F8442C 	 strb r2,[r3,#-68]
 797 04b6 97F86730 	 ldrb r3,[r7,#103]
 798 04ba 0133     	 adds r3,r3,#1
 799 04bc 87F86730 	 strb r3,[r7,#103]
 800              	.L43:
 801              	 .loc 1 287 0 discriminator 1
 802 04c0 97F86730 	 ldrb r3,[r7,#103]
 803 04c4 0F2B     	 cmp r3,#15
 804 04c6 DFD9     	 bls .L44
 805              	 .loc 1 287 0 discriminator 4
 806 04c8 F968     	 ldr r1,[r7,#12]
 807 04ca 07F12402 	 add r2,r7,#36
 808 04ce 07F12404 	 add r4,r7,#36
 809 04d2 07F14403 	 add r3,r7,#68
 810 04d6 0093     	 str r3,[sp]
 811 04d8 0846     	 mov r0,r1
 812 04da 1146     	 mov r1,r2
 813 04dc 1022     	 movs r2,#16
 814 04de 2346     	 mov r3,r4
 815 04e0 FFF7FEFF 	 bl mbedtls_cipher_update
 816 04e4 3865     	 str r0,[r7,#80]
 817 04e6 3B6D     	 ldr r3,[r7,#80]
 818 04e8 002B     	 cmp r3,#0
 819 04ea 01D0     	 beq .L42
 820              	 .loc 1 287 0 discriminator 5
 821 04ec 3B6D     	 ldr r3,[r7,#80]
 822 04ee 91E0     	 b .L54
 823              	.L42:
 288:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         }
 289:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 290:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         dst += use_len;
 824              	 .loc 1 290 0 is_stmt 1
 825 04f0 BA6D     	 ldr r2,[r7,#88]
 826 04f2 BB6C     	 ldr r3,[r7,#72]
 827 04f4 1344     	 add r3,r3,r2
 828 04f6 BB65     	 str r3,[r7,#88]
 291:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         src += use_len;
 829              	 .loc 1 291 0
 830 04f8 FA6D     	 ldr r2,[r7,#92]
 831 04fa BB6C     	 ldr r3,[r7,#72]
 832 04fc 1344     	 add r3,r3,r2
 833 04fe FB65     	 str r3,[r7,#92]
 292:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         len_left -= use_len;
 834              	 .loc 1 292 0
 835 0500 3A6E     	 ldr r2,[r7,#96]
 836 0502 BB6C     	 ldr r3,[r7,#72]
 837 0504 D31A     	 subs r3,r2,r3
 838 0506 3B66     	 str r3,[r7,#96]
 293:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 294:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         /*
 295:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****          * Increment counter.
 296:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****          * No need to check for overflow thanks to the length check above.
 297:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****          */
 298:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         for( i = 0; i < q; i++ )
 839              	 .loc 1 298 0
 840 0508 0023     	 movs r3,#0
 841 050a 87F86730 	 strb r3,[r7,#103]
 842 050e 1CE0     	 b .L45
 843              	.L47:
 299:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             if( ++ctr[15-i] != 0 )
 844              	 .loc 1 299 0
 845 0510 97F86730 	 ldrb r3,[r7,#103]
 846 0514 C3F10F03 	 rsb r3,r3,#15
 847 0518 07F16802 	 add r2,r7,#104
 848 051c 1A44     	 add r2,r2,r3
 849 051e 12F8542C 	 ldrb r2,[r2,#-84]
 850 0522 0132     	 adds r2,r2,#1
 851 0524 D1B2     	 uxtb r1,r2
 852 0526 07F16802 	 add r2,r7,#104
 853 052a 1A44     	 add r2,r2,r3
 854 052c 02F8541C 	 strb r1,[r2,#-84]
 855 0530 07F16802 	 add r2,r7,#104
 856 0534 1344     	 add r3,r3,r2
 857 0536 13F8543C 	 ldrb r3,[r3,#-84]
 858 053a 002B     	 cmp r3,#0
 859 053c 00D0     	 beq .L46
 300:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                 break;
 860              	 .loc 1 300 0
 861 053e 0AE0     	 b .L35
 862              	.L46:
 298:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             if( ++ctr[15-i] != 0 )
 863              	 .loc 1 298 0 discriminator 2
 864 0540 97F86730 	 ldrb r3,[r7,#103]
 865 0544 0133     	 adds r3,r3,#1
 866 0546 87F86730 	 strb r3,[r7,#103]
 867              	.L45:
 298:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****             if( ++ctr[15-i] != 0 )
 868              	 .loc 1 298 0 is_stmt 0 discriminator 1
 869 054a 97F86720 	 ldrb r2,[r7,#103]
 870 054e 97F85730 	 ldrb r3,[r7,#87]
 871 0552 9A42     	 cmp r2,r3
 872 0554 DCD3     	 bcc .L47
 873              	.L35:
 874              	.LBE3:
 270:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     {
 875              	 .loc 1 270 0 is_stmt 1
 876 0556 3B6E     	 ldr r3,[r7,#96]
 877 0558 002B     	 cmp r3,#0
 878 055a 7FF4FDAE 	 bne .L48
 301:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     }
 302:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 303:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /*
 304:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      * Authentication: reset counter and crypt/mask internal tag
 305:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****      */
 306:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     for( i = 0; i < q; i++ )
 879              	 .loc 1 306 0
 880 055e 0023     	 movs r3,#0
 881 0560 87F86730 	 strb r3,[r7,#103]
 882 0564 0EE0     	 b .L49
 883              	.L50:
 307:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         ctr[15-i] = 0;
 884              	 .loc 1 307 0 discriminator 3
 885 0566 97F86730 	 ldrb r3,[r7,#103]
 886 056a C3F10F03 	 rsb r3,r3,#15
 887 056e 07F16802 	 add r2,r7,#104
 888 0572 1344     	 add r3,r3,r2
 889 0574 0022     	 movs r2,#0
 890 0576 03F8542C 	 strb r2,[r3,#-84]
 306:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         ctr[15-i] = 0;
 891              	 .loc 1 306 0 discriminator 3
 892 057a 97F86730 	 ldrb r3,[r7,#103]
 893 057e 0133     	 adds r3,r3,#1
 894 0580 87F86730 	 strb r3,[r7,#103]
 895              	.L49:
 306:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         ctr[15-i] = 0;
 896              	 .loc 1 306 0 is_stmt 0 discriminator 1
 897 0584 97F86720 	 ldrb r2,[r7,#103]
 898 0588 97F85730 	 ldrb r3,[r7,#87]
 899 058c 9A42     	 cmp r2,r3
 900 058e EAD3     	 bcc .L50
 308:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 309:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CTR_CRYPT( y, y, 16 );
 901              	 .loc 1 309 0 is_stmt 1
 902 0590 F968     	 ldr r1,[r7,#12]
 903 0592 07F11402 	 add r2,r7,#20
 904 0596 07F13404 	 add r4,r7,#52
 905 059a 07F14403 	 add r3,r7,#68
 906 059e 0093     	 str r3,[sp]
 907 05a0 0846     	 mov r0,r1
 908 05a2 1146     	 mov r1,r2
 909 05a4 1022     	 movs r2,#16
 910 05a6 2346     	 mov r3,r4
 911 05a8 FFF7FEFF 	 bl mbedtls_cipher_update
 912 05ac 3865     	 str r0,[r7,#80]
 913 05ae 3B6D     	 ldr r3,[r7,#80]
 914 05b0 002B     	 cmp r3,#0
 915 05b2 01D0     	 beq .L51
 916              	 .loc 1 309 0 is_stmt 0 discriminator 1
 917 05b4 3B6D     	 ldr r3,[r7,#80]
 918 05b6 2DE0     	 b .L54
 919              	.L51:
 920              	 .loc 1 309 0 discriminator 2
 921 05b8 0023     	 movs r3,#0
 922 05ba 87F86730 	 strb r3,[r7,#103]
 923 05be 1BE0     	 b .L52
 924              	.L53:
 925              	 .loc 1 309 0 discriminator 5
 926 05c0 97F86730 	 ldrb r3,[r7,#103]
 927 05c4 97F86720 	 ldrb r2,[r7,#103]
 928 05c8 07F16801 	 add r1,r7,#104
 929 05cc 0A44     	 add r2,r2,r1
 930 05ce 12F8441C 	 ldrb r1,[r2,#-68]
 931 05d2 97F86720 	 ldrb r2,[r7,#103]
 932 05d6 07F16800 	 add r0,r7,#104
 933 05da 0244     	 add r2,r2,r0
 934 05dc 12F8342C 	 ldrb r2,[r2,#-52]
 935 05e0 4A40     	 eors r2,r2,r1
 936 05e2 D2B2     	 uxtb r2,r2
 937 05e4 07F16801 	 add r1,r7,#104
 938 05e8 0B44     	 add r3,r3,r1
 939 05ea 03F8442C 	 strb r2,[r3,#-68]
 940 05ee 97F86730 	 ldrb r3,[r7,#103]
 941 05f2 0133     	 adds r3,r3,#1
 942 05f4 87F86730 	 strb r3,[r7,#103]
 943              	.L52:
 944              	 .loc 1 309 0 discriminator 3
 945 05f8 97F86730 	 ldrb r3,[r7,#103]
 946 05fc 0F2B     	 cmp r3,#15
 947 05fe DFD9     	 bls .L53
 310:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     memcpy( tag, y, tag_len );
 948              	 .loc 1 310 0 is_stmt 1
 949 0600 07F12403 	 add r3,r7,#36
 950 0604 D7F88C00 	 ldr r0,[r7,#140]
 951 0608 1946     	 mov r1,r3
 952 060a D7F89020 	 ldr r2,[r7,#144]
 953 060e FFF7FEFF 	 bl memcpy
 311:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 312:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     return( 0 );
 954              	 .loc 1 312 0
 955 0612 0023     	 movs r3,#0
 956              	.L54:
 313:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** }
 957              	 .loc 1 313 0 discriminator 1
 958 0614 1846     	 mov r0,r3
 959 0616 6C37     	 adds r7,r7,#108
 960              	.LCFI18:
 961              	 .cfi_def_cfa_offset 12
 962 0618 BD46     	 mov sp,r7
 963              	.LCFI19:
 964              	 .cfi_def_cfa_register 13
 965              	 
 966 061a 90BD     	 pop {r4,r7,pc}
 967              	 .cfi_endproc
 968              	.LFE10:
 970              	 .section .text.mbedtls_ccm_star_encrypt_and_tag,"ax",%progbits
 971              	 .align 2
 972              	 .global mbedtls_ccm_star_encrypt_and_tag
 973              	 .thumb
 974              	 .thumb_func
 976              	mbedtls_ccm_star_encrypt_and_tag:
 977              	.LFB11:
 314:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 315:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
 316:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Authenticated encryption
 317:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
 318:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** int mbedtls_ccm_star_encrypt_and_tag( mbedtls_ccm_context *ctx, size_t length,
 319:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                          const unsigned char *iv, size_t iv_len,
 320:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                          const unsigned char *add, size_t add_len,
 321:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                          const unsigned char *input, unsigned char *output,
 322:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                          unsigned char *tag, size_t tag_len )
 323:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** {
 978              	 .loc 1 323 0
 979              	 .cfi_startproc
 980              	 
 981              	 
 982 0000 80B5     	 push {r7,lr}
 983              	.LCFI20:
 984              	 .cfi_def_cfa_offset 8
 985              	 .cfi_offset 7,-8
 986              	 .cfi_offset 14,-4
 987 0002 8CB0     	 sub sp,sp,#48
 988              	.LCFI21:
 989              	 .cfi_def_cfa_offset 56
 990 0004 08AF     	 add r7,sp,#32
 991              	.LCFI22:
 992              	 .cfi_def_cfa 7,24
 993 0006 F860     	 str r0,[r7,#12]
 994 0008 B960     	 str r1,[r7,#8]
 995 000a 7A60     	 str r2,[r7,#4]
 996 000c 3B60     	 str r3,[r7]
 324:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( ctx != NULL );
 325:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( iv != NULL );
 326:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( add_len == 0 || add != NULL );
 327:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( length == 0 || input != NULL );
 328:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( length == 0 || output != NULL );
 329:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( tag_len == 0 || tag != NULL );
 330:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     return( ccm_auth_crypt( ctx, CCM_ENCRYPT, length, iv, iv_len,
 997              	 .loc 1 330 0
 998 000e 3B68     	 ldr r3,[r7]
 999 0010 0093     	 str r3,[sp]
 1000 0012 BB69     	 ldr r3,[r7,#24]
 1001 0014 0193     	 str r3,[sp,#4]
 1002 0016 FB69     	 ldr r3,[r7,#28]
 1003 0018 0293     	 str r3,[sp,#8]
 1004 001a 3B6A     	 ldr r3,[r7,#32]
 1005 001c 0393     	 str r3,[sp,#12]
 1006 001e 7B6A     	 ldr r3,[r7,#36]
 1007 0020 0493     	 str r3,[sp,#16]
 1008 0022 BB6A     	 ldr r3,[r7,#40]
 1009 0024 0593     	 str r3,[sp,#20]
 1010 0026 FB6A     	 ldr r3,[r7,#44]
 1011 0028 0693     	 str r3,[sp,#24]
 1012 002a F868     	 ldr r0,[r7,#12]
 1013 002c 0021     	 movs r1,#0
 1014 002e BA68     	 ldr r2,[r7,#8]
 1015 0030 7B68     	 ldr r3,[r7,#4]
 1016 0032 FFF7FEFF 	 bl ccm_auth_crypt
 1017 0036 0346     	 mov r3,r0
 331:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                             add, add_len, input, output, tag, tag_len ) );
 332:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** }
 1018              	 .loc 1 332 0
 1019 0038 1846     	 mov r0,r3
 1020 003a 1037     	 adds r7,r7,#16
 1021              	.LCFI23:
 1022              	 .cfi_def_cfa_offset 8
 1023 003c BD46     	 mov sp,r7
 1024              	.LCFI24:
 1025              	 .cfi_def_cfa_register 13
 1026              	 
 1027 003e 80BD     	 pop {r7,pc}
 1028              	 .cfi_endproc
 1029              	.LFE11:
 1031              	 .section .text.mbedtls_ccm_encrypt_and_tag,"ax",%progbits
 1032              	 .align 2
 1033              	 .global mbedtls_ccm_encrypt_and_tag
 1034              	 .thumb
 1035              	 .thumb_func
 1037              	mbedtls_ccm_encrypt_and_tag:
 1038              	.LFB12:
 333:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 334:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** int mbedtls_ccm_encrypt_and_tag( mbedtls_ccm_context *ctx, size_t length,
 335:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                          const unsigned char *iv, size_t iv_len,
 336:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                          const unsigned char *add, size_t add_len,
 337:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                          const unsigned char *input, unsigned char *output,
 338:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                          unsigned char *tag, size_t tag_len )
 339:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** {
 1039              	 .loc 1 339 0
 1040              	 .cfi_startproc
 1041              	 
 1042              	 
 1043 0000 80B5     	 push {r7,lr}
 1044              	.LCFI25:
 1045              	 .cfi_def_cfa_offset 8
 1046              	 .cfi_offset 7,-8
 1047              	 .cfi_offset 14,-4
 1048 0002 8AB0     	 sub sp,sp,#40
 1049              	.LCFI26:
 1050              	 .cfi_def_cfa_offset 48
 1051 0004 06AF     	 add r7,sp,#24
 1052              	.LCFI27:
 1053              	 .cfi_def_cfa 7,24
 1054 0006 F860     	 str r0,[r7,#12]
 1055 0008 B960     	 str r1,[r7,#8]
 1056 000a 7A60     	 str r2,[r7,#4]
 1057 000c 3B60     	 str r3,[r7]
 340:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( ctx != NULL );
 341:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( iv != NULL );
 342:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( add_len == 0 || add != NULL );
 343:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( length == 0 || input != NULL );
 344:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( length == 0 || output != NULL );
 345:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( tag_len == 0 || tag != NULL );
 346:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( tag_len == 0 )
 1058              	 .loc 1 346 0
 1059 000e FB6A     	 ldr r3,[r7,#44]
 1060 0010 002B     	 cmp r3,#0
 1061 0012 02D1     	 bne .L58
 347:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_BAD_INPUT );
 1062              	 .loc 1 347 0
 1063 0014 6FF00C03 	 mvn r3,#12
 1064 0018 12E0     	 b .L59
 1065              	.L58:
 348:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 349:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     return( mbedtls_ccm_star_encrypt_and_tag( ctx, length, iv, iv_len, add,
 1066              	 .loc 1 349 0
 1067 001a BB69     	 ldr r3,[r7,#24]
 1068 001c 0093     	 str r3,[sp]
 1069 001e FB69     	 ldr r3,[r7,#28]
 1070 0020 0193     	 str r3,[sp,#4]
 1071 0022 3B6A     	 ldr r3,[r7,#32]
 1072 0024 0293     	 str r3,[sp,#8]
 1073 0026 7B6A     	 ldr r3,[r7,#36]
 1074 0028 0393     	 str r3,[sp,#12]
 1075 002a BB6A     	 ldr r3,[r7,#40]
 1076 002c 0493     	 str r3,[sp,#16]
 1077 002e FB6A     	 ldr r3,[r7,#44]
 1078 0030 0593     	 str r3,[sp,#20]
 1079 0032 F868     	 ldr r0,[r7,#12]
 1080 0034 B968     	 ldr r1,[r7,#8]
 1081 0036 7A68     	 ldr r2,[r7,#4]
 1082 0038 3B68     	 ldr r3,[r7]
 1083 003a FFF7FEFF 	 bl mbedtls_ccm_star_encrypt_and_tag
 1084 003e 0346     	 mov r3,r0
 1085              	.L59:
 350:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                 add_len, input, output, tag, tag_len ) );
 351:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** }
 1086              	 .loc 1 351 0
 1087 0040 1846     	 mov r0,r3
 1088 0042 1037     	 adds r7,r7,#16
 1089              	.LCFI28:
 1090              	 .cfi_def_cfa_offset 8
 1091 0044 BD46     	 mov sp,r7
 1092              	.LCFI29:
 1093              	 .cfi_def_cfa_register 13
 1094              	 
 1095 0046 80BD     	 pop {r7,pc}
 1096              	 .cfi_endproc
 1097              	.LFE12:
 1099              	 .section .text.mbedtls_ccm_star_auth_decrypt,"ax",%progbits
 1100              	 .align 2
 1101              	 .global mbedtls_ccm_star_auth_decrypt
 1102              	 .thumb
 1103              	 .thumb_func
 1105              	mbedtls_ccm_star_auth_decrypt:
 1106              	.LFB13:
 352:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 353:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** /*
 354:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  * Authenticated decryption
 355:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****  */
 356:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** int mbedtls_ccm_star_auth_decrypt( mbedtls_ccm_context *ctx, size_t length,
 357:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                       const unsigned char *iv, size_t iv_len,
 358:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                       const unsigned char *add, size_t add_len,
 359:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                       const unsigned char *input, unsigned char *output,
 360:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                       const unsigned char *tag, size_t tag_len )
 361:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** {
 1107              	 .loc 1 361 0
 1108              	 .cfi_startproc
 1109              	 
 1110              	 
 1111 0000 80B5     	 push {r7,lr}
 1112              	.LCFI30:
 1113              	 .cfi_def_cfa_offset 8
 1114              	 .cfi_offset 7,-8
 1115              	 .cfi_offset 14,-4
 1116 0002 94B0     	 sub sp,sp,#80
 1117              	.LCFI31:
 1118              	 .cfi_def_cfa_offset 88
 1119 0004 08AF     	 add r7,sp,#32
 1120              	.LCFI32:
 1121              	 .cfi_def_cfa 7,56
 1122 0006 F860     	 str r0,[r7,#12]
 1123 0008 B960     	 str r1,[r7,#8]
 1124 000a 7A60     	 str r2,[r7,#4]
 1125 000c 3B60     	 str r3,[r7]
 362:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     int ret;
 363:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     unsigned char check_tag[16];
 364:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     unsigned char i;
 365:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     int diff;
 366:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 367:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( ctx != NULL );
 368:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( iv != NULL );
 369:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( add_len == 0 || add != NULL );
 370:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( length == 0 || input != NULL );
 371:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( length == 0 || output != NULL );
 372:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( tag_len == 0 || tag != NULL );
 373:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 374:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( ( ret = ccm_auth_crypt( ctx, CCM_DECRYPT, length,
 1126              	 .loc 1 374 0
 1127 000e 3B68     	 ldr r3,[r7]
 1128 0010 0093     	 str r3,[sp]
 1129 0012 BB6B     	 ldr r3,[r7,#56]
 1130 0014 0193     	 str r3,[sp,#4]
 1131 0016 FB6B     	 ldr r3,[r7,#60]
 1132 0018 0293     	 str r3,[sp,#8]
 1133 001a 3B6C     	 ldr r3,[r7,#64]
 1134 001c 0393     	 str r3,[sp,#12]
 1135 001e 7B6C     	 ldr r3,[r7,#68]
 1136 0020 0493     	 str r3,[sp,#16]
 1137 0022 07F11403 	 add r3,r7,#20
 1138 0026 0593     	 str r3,[sp,#20]
 1139 0028 FB6C     	 ldr r3,[r7,#76]
 1140 002a 0693     	 str r3,[sp,#24]
 1141 002c F868     	 ldr r0,[r7,#12]
 1142 002e 0121     	 movs r1,#1
 1143 0030 BA68     	 ldr r2,[r7,#8]
 1144 0032 7B68     	 ldr r3,[r7,#4]
 1145 0034 FFF7FEFF 	 bl ccm_auth_crypt
 1146 0038 7862     	 str r0,[r7,#36]
 1147 003a 7B6A     	 ldr r3,[r7,#36]
 1148 003c 002B     	 cmp r3,#0
 1149 003e 01D0     	 beq .L61
 375:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                                 iv, iv_len, add, add_len,
 376:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                                 input, output, check_tag, tag_len ) ) != 0 )
 377:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     {
 378:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( ret );
 1150              	 .loc 1 378 0
 1151 0040 7B6A     	 ldr r3,[r7,#36]
 1152 0042 2CE0     	 b .L66
 1153              	.L61:
 379:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     }
 380:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 381:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     /* Check tag in "constant-time" */
 382:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     for( diff = 0, i = 0; i < tag_len; i++ )
 1154              	 .loc 1 382 0
 1155 0044 0023     	 movs r3,#0
 1156 0046 BB62     	 str r3,[r7,#40]
 1157 0048 0023     	 movs r3,#0
 1158 004a 87F82F30 	 strb r3,[r7,#47]
 1159 004e 16E0     	 b .L63
 1160              	.L64:
 383:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         diff |= tag[i] ^ check_tag[i];
 1161              	 .loc 1 383 0 discriminator 3
 1162 0050 97F82F30 	 ldrb r3,[r7,#47]
 1163 0054 BA6C     	 ldr r2,[r7,#72]
 1164 0056 1344     	 add r3,r3,r2
 1165 0058 1A78     	 ldrb r2,[r3]
 1166 005a 97F82F30 	 ldrb r3,[r7,#47]
 1167 005e 07F13001 	 add r1,r7,#48
 1168 0062 0B44     	 add r3,r3,r1
 1169 0064 13F81C3C 	 ldrb r3,[r3,#-28]
 1170 0068 5340     	 eors r3,r3,r2
 1171 006a DBB2     	 uxtb r3,r3
 1172 006c 1A46     	 mov r2,r3
 1173 006e BB6A     	 ldr r3,[r7,#40]
 1174 0070 1343     	 orrs r3,r3,r2
 1175 0072 BB62     	 str r3,[r7,#40]
 382:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         diff |= tag[i] ^ check_tag[i];
 1176              	 .loc 1 382 0 discriminator 3
 1177 0074 97F82F30 	 ldrb r3,[r7,#47]
 1178 0078 0133     	 adds r3,r3,#1
 1179 007a 87F82F30 	 strb r3,[r7,#47]
 1180              	.L63:
 382:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         diff |= tag[i] ^ check_tag[i];
 1181              	 .loc 1 382 0 is_stmt 0 discriminator 1
 1182 007e 97F82F20 	 ldrb r2,[r7,#47]
 1183 0082 FB6C     	 ldr r3,[r7,#76]
 1184 0084 9A42     	 cmp r2,r3
 1185 0086 E3D3     	 bcc .L64
 384:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 385:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( diff != 0 )
 1186              	 .loc 1 385 0 is_stmt 1
 1187 0088 BB6A     	 ldr r3,[r7,#40]
 1188 008a 002B     	 cmp r3,#0
 1189 008c 06D0     	 beq .L65
 386:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     {
 387:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         mbedtls_platform_zeroize( output, length );
 1190              	 .loc 1 387 0
 1191 008e 786C     	 ldr r0,[r7,#68]
 1192 0090 B968     	 ldr r1,[r7,#8]
 1193 0092 FFF7FEFF 	 bl mbedtls_platform_zeroize
 388:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_AUTH_FAILED );
 1194              	 .loc 1 388 0
 1195 0096 6FF00E03 	 mvn r3,#14
 1196 009a 00E0     	 b .L66
 1197              	.L65:
 389:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     }
 390:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 391:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     return( 0 );
 1198              	 .loc 1 391 0
 1199 009c 0023     	 movs r3,#0
 1200              	.L66:
 392:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** }
 1201              	 .loc 1 392 0 discriminator 1
 1202 009e 1846     	 mov r0,r3
 1203 00a0 3037     	 adds r7,r7,#48
 1204              	.LCFI33:
 1205              	 .cfi_def_cfa_offset 8
 1206 00a2 BD46     	 mov sp,r7
 1207              	.LCFI34:
 1208              	 .cfi_def_cfa_register 13
 1209              	 
 1210 00a4 80BD     	 pop {r7,pc}
 1211              	 .cfi_endproc
 1212              	.LFE13:
 1214 00a6 00BF     	 .section .text.mbedtls_ccm_auth_decrypt,"ax",%progbits
 1215              	 .align 2
 1216              	 .global mbedtls_ccm_auth_decrypt
 1217              	 .thumb
 1218              	 .thumb_func
 1220              	mbedtls_ccm_auth_decrypt:
 1221              	.LFB14:
 393:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 394:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** int mbedtls_ccm_auth_decrypt( mbedtls_ccm_context *ctx, size_t length,
 395:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                       const unsigned char *iv, size_t iv_len,
 396:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                       const unsigned char *add, size_t add_len,
 397:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                       const unsigned char *input, unsigned char *output,
 398:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                       const unsigned char *tag, size_t tag_len )
 399:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** {
 1222              	 .loc 1 399 0
 1223              	 .cfi_startproc
 1224              	 
 1225              	 
 1226 0000 80B5     	 push {r7,lr}
 1227              	.LCFI35:
 1228              	 .cfi_def_cfa_offset 8
 1229              	 .cfi_offset 7,-8
 1230              	 .cfi_offset 14,-4
 1231 0002 8AB0     	 sub sp,sp,#40
 1232              	.LCFI36:
 1233              	 .cfi_def_cfa_offset 48
 1234 0004 06AF     	 add r7,sp,#24
 1235              	.LCFI37:
 1236              	 .cfi_def_cfa 7,24
 1237 0006 F860     	 str r0,[r7,#12]
 1238 0008 B960     	 str r1,[r7,#8]
 1239 000a 7A60     	 str r2,[r7,#4]
 1240 000c 3B60     	 str r3,[r7]
 400:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( ctx != NULL );
 401:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( iv != NULL );
 402:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( add_len == 0 || add != NULL );
 403:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( length == 0 || input != NULL );
 404:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( length == 0 || output != NULL );
 405:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     CCM_VALIDATE_RET( tag_len == 0 || tag != NULL );
 406:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 407:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     if( tag_len == 0 )
 1241              	 .loc 1 407 0
 1242 000e FB6A     	 ldr r3,[r7,#44]
 1243 0010 002B     	 cmp r3,#0
 1244 0012 02D1     	 bne .L68
 408:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****         return( MBEDTLS_ERR_CCM_BAD_INPUT );
 1245              	 .loc 1 408 0
 1246 0014 6FF00C03 	 mvn r3,#12
 1247 0018 12E0     	 b .L69
 1248              	.L68:
 409:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** 
 410:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****     return( mbedtls_ccm_star_auth_decrypt( ctx, length, iv, iv_len, add,
 1249              	 .loc 1 410 0
 1250 001a BB69     	 ldr r3,[r7,#24]
 1251 001c 0093     	 str r3,[sp]
 1252 001e FB69     	 ldr r3,[r7,#28]
 1253 0020 0193     	 str r3,[sp,#4]
 1254 0022 3B6A     	 ldr r3,[r7,#32]
 1255 0024 0293     	 str r3,[sp,#8]
 1256 0026 7B6A     	 ldr r3,[r7,#36]
 1257 0028 0393     	 str r3,[sp,#12]
 1258 002a BB6A     	 ldr r3,[r7,#40]
 1259 002c 0493     	 str r3,[sp,#16]
 1260 002e FB6A     	 ldr r3,[r7,#44]
 1261 0030 0593     	 str r3,[sp,#20]
 1262 0032 F868     	 ldr r0,[r7,#12]
 1263 0034 B968     	 ldr r1,[r7,#8]
 1264 0036 7A68     	 ldr r2,[r7,#4]
 1265 0038 3B68     	 ldr r3,[r7]
 1266 003a FFF7FEFF 	 bl mbedtls_ccm_star_auth_decrypt
 1267 003e 0346     	 mov r3,r0
 1268              	.L69:
 411:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c ****                 add_len, input, output, tag, tag_len ) );
 412:C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/library\ccm.c **** }
 1269              	 .loc 1 412 0
 1270 0040 1846     	 mov r0,r3
 1271 0042 1037     	 adds r7,r7,#16
 1272              	.LCFI38:
 1273              	 .cfi_def_cfa_offset 8
 1274 0044 BD46     	 mov sp,r7
 1275              	.LCFI39:
 1276              	 .cfi_def_cfa_register 13
 1277              	 
 1278 0046 80BD     	 pop {r7,pc}
 1279              	 .cfi_endproc
 1280              	.LFE14:
 1282              	 .text
 1283              	.Letext0:
 1284              	 .file 2 "c:\\users\\yushev\\dave_4-4-2_32bit_2018-02-23\\dave-ide-4.4.2-32bit\\eclipse\\arm-gcc-49\\lib\\gcc\\arm-none-eabi\\4.9.3\\include\\stddef.h"
 1285              	 .file 3 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/include/mbedtls/cipher.h"
 1286              	 .file 4 "C:/Users/Yushev/git/wpcqi-optiga-trust-charge/optiga/externals/mbedtls/include/mbedtls/ccm.h"
DEFINED SYMBOLS
                            *ABS*:00000000 ccm.c
    {standard input}:20     .text.mbedtls_ccm_init:00000000 $t
    {standard input}:25     .text.mbedtls_ccm_init:00000000 mbedtls_ccm_init
    {standard input}:62     .text.mbedtls_ccm_setkey:00000000 $t
    {standard input}:67     .text.mbedtls_ccm_setkey:00000000 mbedtls_ccm_setkey
    {standard input}:164    .text.mbedtls_ccm_free:00000000 $t
    {standard input}:169    .text.mbedtls_ccm_free:00000000 mbedtls_ccm_free
    {standard input}:216    .text.ccm_auth_crypt:00000000 $t
    {standard input}:220    .text.ccm_auth_crypt:00000000 ccm_auth_crypt
    {standard input}:971    .text.mbedtls_ccm_star_encrypt_and_tag:00000000 $t
    {standard input}:976    .text.mbedtls_ccm_star_encrypt_and_tag:00000000 mbedtls_ccm_star_encrypt_and_tag
    {standard input}:1032   .text.mbedtls_ccm_encrypt_and_tag:00000000 $t
    {standard input}:1037   .text.mbedtls_ccm_encrypt_and_tag:00000000 mbedtls_ccm_encrypt_and_tag
    {standard input}:1100   .text.mbedtls_ccm_star_auth_decrypt:00000000 $t
    {standard input}:1105   .text.mbedtls_ccm_star_auth_decrypt:00000000 mbedtls_ccm_star_auth_decrypt
    {standard input}:1215   .text.mbedtls_ccm_auth_decrypt:00000000 $t
    {standard input}:1220   .text.mbedtls_ccm_auth_decrypt:00000000 mbedtls_ccm_auth_decrypt
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
memset
mbedtls_cipher_info_from_values
mbedtls_cipher_free
mbedtls_cipher_setup
mbedtls_cipher_setkey
mbedtls_platform_zeroize
memcpy
mbedtls_cipher_update
